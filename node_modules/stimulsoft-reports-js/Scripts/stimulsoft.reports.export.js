/*
Stimulsoft.Reports.JS
Version: 2022.3.2
Build date: 2022.06.23
License: https://www.stimulsoft.com/en/licensing/reports
*/
!function(e){var t;"undefined"!=typeof process&&process.__nwjs||"object"!=typeof exports||"undefined"==typeof module?"function"==typeof define&&define.amd?define(["./stimulsoft.reports.engine"],t=>Object.assign(t,e(t.Stimulsoft))):window.Stimulsoft?window.Stimulsoft.Report?Object.assign(window,e(window.Stimulsoft)):window.Stimulsoft.exportFactory=e:window.Stimulsoft={exportFactory:e}:module.exports=(t=require("./stimulsoft.reports.engine"),Object.assign(t,e(t.Stimulsoft)))}(function(rt){function r(t,e){for(var i in e)i in t?r(t[i],e[i]):t[i]=e[i];return t}rt&&"2022.3.2"!==rt.__engineVersion&&console.warn("Scripts versions mismatch: engine ver. = %s; export ver. = 2022.3.2",rt.__engineVersion);var rt=r(rt||{},{Report:{Export:{}},Reflection:{}}),at={};at.a=rt.Report,at.b=rt.Reflection,at.c=at.a.Export;let st=rt.System.StiMath,ot=rt.System.Char,nt=at.a.Components.StiCheckBox,S=rt.System.Globalization.CultureInfo,u=rt.Base.Zip.StiZipWriter20,v=at.a.ImageFormat,Lt=at.a.Components.IStiExportImageExtended,lt=at.a.Components.StiText,mt=rt.System.StiArray,ct=rt.System.Collections.Hashtable,G=at.a.Components.StiPageOrientation,T=at.a.Components.StiPagesCollection,gt=rt.System.DateTime,C=rt.System.Xml.Formatting,F=rt.System.Xml.XmlTextWriter,V=rt.System.Text.Encoding,et=rt.System.IO.StreamWriter,ht=rt.System.Drawing.Color,pt=rt.System.StiString,tt=rt.System.IO.MemoryStream,t=rt.Base.Localization.StiLocalization,wt=rt.Base.Drawing.StiTextHorAlignment,dt=rt.Base.Drawing.StiVertAlignment;{class oi{constructor(){this.BorderLeft="none",this.BorderRight="none",this.BorderTop="none",this.BorderBottom="none",this.BackColor=ht.transparent,this.VertAlign=dt.Bottom,this.FontName="Arial",this.FontSize=6,this.Bold=!1,this.Italic=!1,this.Underline=!1,this.FontColor=ht.black,this.HorAlign=wt.Left,this.Angle=0,this.Wordwrap=!1,this.DataStyle=-1}}class li{constructor(){this.isNumeric=!1,this.isCurrency=!1,this.isPercent=!1,this.isDate=!1,this.isTime=!1,this.isDefaultFormat=!1,this.DecimalDigits=2,this.DecimalComma=" ",this.GroupDigits=0,this.CurrencySymbol="$",this.CurrencyPositionBefore=!1,this.NegativeBraces=!1,this.DateTimeFormatString=null,this.CurrencyPositivePattern=null,this.CurrencyNegativePattern=null}}at.c.StiOdsExportService=class extends at.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1,this.matrix=null,this.imageCache=null,this.cellStyleList=null,this.dataStyleList=null,this.sheetNameList=null,this.matrixList=null,this.firstPageIndexList=null,this.minRowList=null,this.maxRowList=null,this.cellStyleTableList=null,this.imageQuality=.75,this.imageResolution=96,this.xmlIndentation=1}implements(){return[at.c.IStiOdsExportService]}get defaultExtension(){return"ods"}get exportFormat(){return at.a.StiExportFormat.Ods}get groupCategory(){return"Excel"}get position(){return at.c.StiExportPosition.Ods}get exportNameInMenu(){return t.get("Export","ExportTypeCalcFile")}getFilter(){return t.get("FileFilters","WriteCalcFilesrFiles")}exportTo(t,e,i){this.exportOds(t,e,i)}exportToAsync(t,e,i,r){setTimeout(async()=>{await at.c.StiExportImageHelper.convertAllImages(e,rt.System.Drawing.Imaging.ImageFormat.Jpeg,!1,this.exportFormat),this.exportTo(e,i,r),null!=e&&null!=e.preparedExportImages&&(e.preparedExportImages.clear(),e.preparedExportImages=null),t()})}doubleToString(t){return st.round2(t/100,4).toString().stimulsoft().replaceAll(",",".")+"in"}getColumnName(t){var e=t/26|0,t=t%26;let i="";return 0<e&&(i+=String.fromCharCode(65+e-1)),i+=String.fromCharCode(65+t)}getColorString(t){return"#"+pt.format("{0:X8}",t.toArgb()).substr(2)}getCellStyleNumber(i,r,e,n){let a=new oi,s=!0,o=!0;for(let t=0;t<e;t++)null==this.matrix.bordersY[i+t][r]&&(s=!1),null==this.matrix.bordersY[i+t][r+n]&&(o=!1);let l=!0,m=!0;for(let t=0;t<n;t++)null==this.matrix.bordersX[i][r+t]&&(l=!1),null==this.matrix.bordersX[i+e][r+t]&&(m=!1);if(l&&(a.BorderTop=this.getStringFromBorder(this.matrix.bordersX[i][r])),s&&(a.BorderLeft=this.getStringFromBorder(this.matrix.bordersY[i][r])),m&&(a.BorderBottom=this.getStringFromBorder(this.matrix.bordersX[i+e][r])),o&&(a.BorderRight=this.getStringFromBorder(this.matrix.bordersY[i][r+n])),null!=this.matrix.cells[i][r]){let t=this.matrix.cells[i][r];var c=t.cellStyle,c,c;a.BackColor=c.color,a.VertAlign=c.vertAlignment,a.FontName=c.font.name,a.FontSize=c.font.sizeInPoints,a.Bold=c.font.bold,a.Italic=c.font.italic,a.Underline=c.font.underline,a.FontColor=c.textColor,a.HorAlign=c.horAlignment;let e=0;null!=c.textOptions&&(e=c.textOptions.angle,a.Wordwrap=c.textOptions.wordWrap),a.Angle=0|Math.round(e),null!=t.component&&(null!=(c=t.component.stimulsoft().as(lt))&&(a.DataStyle=this.getDataStyleNumber(c)),null==(c=t.component.stimulsoft().as(nt))||pt.isNullOrEmpty(c.excelDataValue)||(a.FontName=rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.name,a.FontSize=rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.sizeInPoints,a.Bold=rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.bold,a.Italic=rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.italic,a.Underline=rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.underline,a.VertAlign=rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.VertAlignment,a.HorAlign=rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.HorAlignment))}if(0<this.cellStyleList.length)for(let e=0;e<this.cellStyleList.length;e++){let t=this.cellStyleList[e];if(t.BorderLeft==a.BorderLeft&&t.BorderRight==a.BorderRight&&t.BorderTop==a.BorderTop&&t.BorderBottom==a.BorderBottom&&t.BackColor.equals(a.BackColor)&&t.VertAlign==a.VertAlign&&t.FontName==a.FontName&&t.FontSize==a.FontSize&&t.Bold==a.Bold&&t.Italic==a.Italic&&t.Underline==a.Underline&&t.FontColor.equals(a.FontColor)&&t.HorAlign==a.HorAlign&&t.Angle==a.Angle&&t.Wordwrap==a.Wordwrap&&t.DataStyle==a.DataStyle)return e}return this.cellStyleList.push(a),this.cellStyleList.length-1}getStringFromBorder(t){return pt.format("{0} solid {1}",this.doubleToString(t.size),this.getColorString(t.color))}getDataStyleNumber(t){let i=new li,r=t.format;var e=null!=r?r.indexOf("|"):-1,n;if(-1!=e&&(i.CurrencyPositivePattern=at.c.StiExportUtils.getPositivePattern(r.charCodeAt(e+1)-65),i.CurrencyNegativePattern=at.c.StiExportUtils.getNegativePattern(r.charCodeAt(e+2)-65),r=r.substr(0,e)),pt.isNullOrEmpty(r))return-1;if("C"==r.charAt(0)&&(i.isCurrency=!0),"N"==r.charAt(0)&&(i.isNumeric=!0),"P"==r.charAt(0)&&(i.isPercent=!0),"D"==r.charAt(0)&&(i.isDate=!0,1<r.length&&(i.DateTimeFormatString=r.substr(1))),"T"==r.charAt(0)&&(i.isTime=!0,1<r.length&&(i.DateTimeFormatString=r.substr(1))),1==r.length)i.isDefaultFormat=!0;else if(i.isCurrency||i.isNumeric||i.isPercent){let e=1;if(ot.isDigit(r,e)){let t="";while(e<r.length&&ot.isDigit(r,e))t+=r.charAt(e),e++;i.DecimalDigits=parseInt(t)}e<r.length&&"G"==r.charAt(e)&&(e++,i.GroupDigits=3),e<r.length&&"("==r.charAt(e)&&(e++,i.NegativeBraces=!0),e<r.length&&("."==r.charAt(e)||","==r.charAt(e))&&(i.DecimalComma=r.charAt(e),e++),e<r.length&&("+"==r.charAt(e)||"-"==r.charAt(e))&&("+"==r.charAt(e)&&(i.CurrencyPositionBefore=!0),++e<r.length&&(i.CurrencySymbol=r.substr(e)))}if(t.hideZeros&&!pt.isNullOrEmpty(r)&&(i.isDefaultFormat=!1),0<this.dataStyleList.length)for(let t=0;t<this.dataStyleList.length;t++){var a=this.dataStyleList.stimulsoft().getByIndex(t);if(a.isNumeric==i.isNumeric&&a.isCurrency==i.isCurrency&&a.isPercent==i.isPercent&&a.isDate==i.isDate&&a.isTime==i.isTime&&a.isDefaultFormat==i.isDefaultFormat&&a.DecimalDigits==i.DecimalDigits&&a.DecimalComma==i.DecimalComma&&a.GroupDigits==i.GroupDigits&&a.CurrencySymbol==i.CurrencySymbol&&a.CurrencyPositionBefore==i.CurrencyPositionBefore&&a.DateTimeFormatString==i.DateTimeFormatString&&a.CurrencyPositivePattern==i.CurrencyPositivePattern&&a.CurrencyNegativePattern==i.CurrencyNegativePattern)return t}return this.dataStyleList.push(i),this.dataStyleList.stimulsoft().countItems-1}writeMimetype(){var t=new tt;let e=new et(t,V.ASCII);return e.write("application/vnd.oasis.opendocument.spreadsheet"),e.flush(),t}writeMeta(){var t=new tt;let e=new F(V.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("office:document-meta"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:meta");var i=gt.now.toString("yyyy-MM-ddTHH:mm:ss"),r=at.c.StiExportUtils.getReportVersion();return e.writeElementString("meta:generator",r),e.writeElementString("meta:creation-date",i),e.writeElementString("dc:date",i),e.writeElementString("meta:editing-cycles","1"),e.writeElementString("meta:editing-duration","PT0M0S"),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 1"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 2"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 3"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 4"),e.writeEndElement(),e.writeStartElement("meta:document-statistic"),e.writeAttributeString("meta:table-count","1"),e.writeAttributeString("meta:cell-count","1"),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeManifest(){var t=new tt;let e=new F(V.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("manifest:manifest"),e.writeAttributeString("xmlns:manifest","urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","application/vnd.oasis.opendocument.spreadsheet"),e.writeAttributeString("manifest:full-path","/"),e.writeEndElement();for(let t=0;t<this.imageCache.imagePackedStore.stimulsoft().countItems;t++)e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","image/jpeg"),e.writeAttributeString("manifest:full-path",pt.format("Pictures/{0:D5}.jpg",t+1)),e.writeEndElement();return e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","content.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","styles.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","meta.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","settings.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeImage(t){let e=new tt;var t=this.imageCache.imagePackedStore[t];return e.write(t,0,t.length),e}writeSettings(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("office:document-settings"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:config","urn:oasis:names:tc:opendocument:xmlns:config:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:settings"),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:view-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaWidth"),e.writeAttributeString("config:type","int"),e.writeString("43208"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaHeight"),e.writeAttributeString("config:type","int"),e.writeString("22174"),e.writeEndElement(),e.writeStartElement("config:config-item-map-indexed"),e.writeAttributeString("config:name","Views"),e.writeStartElement("config:config-item-map-entry"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewId"),e.writeAttributeString("config:type","string"),e.writeString("View1"),e.writeEndElement(),e.writeStartElement("config:config-item-map-named"),e.writeAttributeString("config:name","Tables"),e.writeStartElement("config:config-item-map-entry"),e.writeAttributeString("config:name","Sheet1"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CursorPositionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CursorPositionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalSplitMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VerticalSplitMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalSplitPosition"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VerticalSplitPosition"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ActiveSplitRange"),e.writeAttributeString("config:type","short"),e.writeString("2"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionLeft"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionRight"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionBottom"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ActiveTable"),e.writeAttributeString("config:type","string"),e.writeString("Sheet1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalScrollbarWidth"),e.writeAttributeString("config:type","int"),e.writeString("270"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomValue"),e.writeAttributeString("config:type","int"),e.writeString("100"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PageViewZoomValue"),e.writeAttributeString("config:type","int"),e.writeString("60"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreakPreview"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowZeroValues"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowNotes"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowGrid"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","GridColor"),e.writeAttributeString("config:type","long"),e.writeString("12632256"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreaks"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasColumnRowHeaders"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasSheetTabs"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsOutlineSymbolsSet"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSnapToRaster"),e.writeAttributeString("config:type","long"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterIsVisible"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionX"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionY"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsRasterAxisSynchronized"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:configuration-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowZeroValues"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowNotes"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowGrid"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","GridColor"),e.writeAttributeString("config:type","long"),e.writeString("12632256"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreaks"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LinkUpdateMode"),e.writeAttributeString("config:type","short"),e.writeString("3"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasColumnRowHeaders"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasSheetTabs"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsOutlineSymbolsSet"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSnapToRaster"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterIsVisible"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionX"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionY"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsRasterAxisSynchronized"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AutoCalculate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterSetup"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ApplyUserData"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CharacterCompressionType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsKernAsianPunctuation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveVersionOnClose"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UpdateFromTemplate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AllowPrintJobCancel"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LoadReadonly"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeStyles(t){var e=new tt;let i=new F(V.UTF8,e),r=(i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?C.None:C.Indented,i.writeStartDocument(),i.writeStartElement("office:document-styles"),i.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),i.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),i.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),i.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),i.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),i.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),i.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),i.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),i.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),i.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),i.writeAttributeString("xmlns:presentation","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"),i.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),i.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),i.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),i.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),i.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),i.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),i.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),i.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),i.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),i.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),i.writeAttributeString("office:version","1.1"),i.writeStartElement("office:font-face-decls"),i.writeStartElement("style:font-face"),i.writeAttributeString("style:name","Arial"),i.writeAttributeString("svg:font-family","Arial"),i.writeEndElement(),i.writeStartElement("style:font-face"),i.writeAttributeString("style:name","Tahoma"),i.writeAttributeString("svg:font-family","Tahoma"),i.writeAttributeString("style:font-family-generic","system"),i.writeAttributeString("style:font-pitch","variable"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("office:styles"),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","table-cell"),i.writeStartElement("style:table-cell-properties"),i.writeAttributeString("style:decimal-places","2"),i.writeEndElement(),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("style:tab-stop-distance","1.25cm"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("fo:language","ru"),i.writeAttributeString("fo:country","RU"),i.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),i.writeAttributeString("style:language-asian","zxx"),i.writeAttributeString("style:country-asian","none"),i.writeAttributeString("style:font-name-complex","Tahoma"),i.writeAttributeString("style:language-complex","zxx"),i.writeAttributeString("style:country-complex","none"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("number:number-style"),i.writeAttributeString("style:name","N0"),i.writeStartElement("number:number"),i.writeAttributeString("number:min-integer-digits","1"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Default"),i.writeAttributeString("style:family","table-cell"),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Result"),i.writeAttributeString("style:family","table-cell"),i.writeAttributeString("style:parent-style-name","Default"),i.writeStartElement("style:text-properties"),i.writeAttributeString("fo:font-style","italic"),i.writeAttributeString("style:text-underline-style","solid"),i.writeAttributeString("style:text-underline-width","auto"),i.writeAttributeString("style:text-underline-color","font-color"),i.writeAttributeString("fo:font-weight","bold"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Heading"),i.writeAttributeString("style:family","table-cell"),i.writeAttributeString("style:parent-style-name","Default"),i.writeStartElement("style:table-cell-properties"),i.writeAttributeString("style:text-align-source","fix"),i.writeAttributeString("style:repeat-content","false"),i.writeEndElement(),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:text-align","center"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("fo:font-size","16pt"),i.writeAttributeString("fo:font-style","italic"),i.writeAttributeString("fo:font-weight","bold"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Heading1"),i.writeAttributeString("style:family","table-cell"),i.writeAttributeString("style:parent-style-name","Heading"),i.writeStartElement("style:table-cell-properties"),i.writeAttributeString("style:rotation-angle","90"),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("office:automatic-styles"),t.getByIndex(0));var t=r.unit.convertToHInches(r.pageHeight*r.segmentPerHeight),n=r.unit.convertToHInches(r.pageWidth*r.segmentPerWidth),a=r.unit.convertToHInches(r.margins.left),s=r.unit.convertToHInches(r.margins.right),o=r.unit.convertToHInches(r.margins.top);let l=r.unit.convertToHInches(r.margins.bottom)-4;return l<0&&(l=0),i.writeStartElement("style:page-layout"),i.writeAttributeString("style:name","pm1"),i.writeStartElement("style:page-layout-properties"),i.writeAttributeString("fo:page-width",this.doubleToString(n)),i.writeAttributeString("fo:page-height",this.doubleToString(t)),i.writeAttributeString("style:num-format","1"),i.writeAttributeString("style:print-orientation",r.orientation==G.Portrait?"portrait":"landscape"),i.writeAttributeString("fo:margin-top",this.doubleToString(o)),i.writeAttributeString("fo:margin-bottom",this.doubleToString(l)),i.writeAttributeString("fo:margin-left",this.doubleToString(a)),i.writeAttributeString("fo:margin-right",this.doubleToString(s)),i.writeAttributeString("style:writing-mode","lr-tb"),i.writeEndElement(),i.writeStartElement("style:header-style"),i.writeStartElement("style:header-footer-properties"),i.writeAttributeString("fo:min-height","0.101cm"),i.writeAttributeString("fo:margin-left","0cm"),i.writeAttributeString("fo:margin-right","0cm"),i.writeAttributeString("fo:margin-bottom","0cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:footer-style"),i.writeStartElement("style:header-footer-properties"),i.writeAttributeString("fo:min-height","0.101cm"),i.writeAttributeString("fo:margin-left","0cm"),i.writeAttributeString("fo:margin-right","0cm"),i.writeAttributeString("fo:margin-top","0cm"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("office:master-styles"),i.writeStartElement("style:master-page"),i.writeAttributeString("style:name","Default"),i.writeAttributeString("style:page-layout-name","pm1"),i.writeStartElement("style:header"),i.writeAttributeString("style:display","false"),i.writeStartElement("text:p"),i.writeStartElement("text:sheet-name"),i.writeString("Sheet1"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:header-left"),i.writeAttributeString("style:display","false"),i.writeEndElement(),i.writeStartElement("style:footer"),i.writeAttributeString("style:display","false"),i.writeStartElement("text:p"),i.writeString("Page "),i.writeStartElement("text:page-number"),i.writeString("1"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:footer-left"),i.writeAttributeString("style:display","false"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeContent(a,s){var t=new tt,e,i;let r=new F(V.UTF8,t),o=(r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?C.None:C.Indented,r.writeStartDocument(),r.writeStartElement("office:document-content"),r.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),r.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),r.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),r.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),r.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),r.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),r.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),r.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),r.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),r.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),r.writeAttributeString("xmlns:presentation","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"),r.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),r.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),r.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),r.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),r.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),r.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),r.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),r.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),r.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),r.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),r.writeAttributeString("xmlns:xforms","http://www.w3.org/2002/xforms"),r.writeAttributeString("xmlns:xsd","http://www.w3.org/2001/XMLSchema"),r.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),r.writeAttributeString("office:version","1.1"),0);while(o<s.count){let t=new T(a,s);t.addV2Internal(s.getByIndex(o));var l=o,m=s.getByIndex(o).excelSheetValue;while(o<s.count-1&&s.getByIndex(o+1).excelSheetValue==m)o++,t.addV2Internal(s.getByIndex(o));t.cacheMode=a.renderedPages.cacheMode;let e=t.getByIndex(0).excelSheetValue,i=(pt.isNullOrEmpty(e)&&(e=pt.format("Page {0}",this.sheetNameList.stimulsoft().countItems+1)),""),r=1;if(this.matrix=new at.c.StiMatrix(t,rt["StiOptions"].Export.OpenDocumentCalc.divideBigCells,this),this.isStopped)return null;let n=0;do{this.firstPageIndexList.push(l),this.matrixList.push(this.matrix);let t=this.matrix.coordY.countItems-1;if(t-n>rt["StiOptions"].Export.OpenDocumentCalc.maximumSheetHeight?t=n+rt["StiOptions"].Export.OpenDocumentCalc.maximumSheetHeight:this.matrix=null,this.minRowList.push(n),this.maxRowList.push(t),n=t,(null!=this.matrix||0<i.length)&&(i=` part`+r++),this.sheetNameList.push(e+i),this.isStopped)return null}while(null!=this.matrix);o++}let c=new ct,g=new ct,h=new ct,p=new ct;for(let e=0;e<this.matrixList.stimulsoft().countItems;e++){this.matrix=this.matrixList.stimulsoft().getByIndex(e);var w=this.minRowList.stimulsoft().getByIndex(e),d=this.maxRowList.stimulsoft().getByIndex(e);let n=mt.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems),t=mt.create2(Number,this.matrix.coordY.countItems,this.matrix.coordX.countItems);for(let t=0;t<this.matrix.coordX.countItems-1;t++){var S=this.matrix.coordX.getByIndex(t+1)-this.matrix.coordX.getByIndex(t),u;h.containsKey(S)||(u=h.count,h.set(S,u),p.set(u,S))}for(let r=w+1;r<d+1;r++){var f=this.matrix.coordY.getByIndex(r)-this.matrix.coordY.getByIndex(r-1),v;c.containsKey(f)||(v=c.count,c.set(f,v),g.set(v,f));for(let i=1;i<this.matrix.coordX.countItems;i++){var E=this.matrix.cells[r-1][i-1];if(!n[r][i])if(null!=E){for(let e=0;e<=E.height;e++)for(let t=0;t<=E.width;t++)n[r+e][i+t]=!0;t[r-1][i-1]=this.getCellStyleNumber(r-1,i-1,E.height+1,E.width+1)}else t[r-1][i-1]=this.getCellStyleNumber(r-1,i-1,1,1)}}this.cellStyleTableList.push(t)}r.writeStartElement("office:scripts"),r.writeEndElement();let n=new ct;for(e of this.cellStyleList)n.set(e.FontName,e.FontName);r.writeStartElement("office:font-face-decls");for(i of n.keys){var b=n.get(i);r.writeStartElement("style:font-face"),r.writeAttributeString("style:name",b),r.writeAttributeString("svg:font-family",b),r.writeEndElement()}r.writeEndElement(),r.writeStartElement("office:automatic-styles");for(let t=0;t<h.count;t++){r.writeStartElement("style:style"),r.writeAttributeString("style:name",`co`+(t+1)),r.writeAttributeString("style:family","table-column"),r.writeStartElement("style:table-column-properties"),r.writeAttributeString("fo:break-before","auto");var x=p.get(t);r.writeAttributeString("style:column-width",this.doubleToString(x)),r.writeEndElement(),r.writeEndElement()}for(let t=0;t<c.count;t++){r.writeStartElement("style:style"),r.writeAttributeString("style:name",`ro`+(t+1)),r.writeAttributeString("style:family","table-row"),r.writeStartElement("style:table-row-properties");var y=g.get(t);r.writeAttributeString("style:row-height",this.doubleToString(y)),r.writeAttributeString("fo:break-before","auto"),r.writeAttributeString("style:use-optimal-row-height","false"),r.writeEndElement(),r.writeEndElement()}r.writeStartElement("style:style"),r.writeAttributeString("style:name","ta1"),r.writeAttributeString("style:family","table"),r.writeAttributeString("style:master-page-name","Default"),r.writeStartElement("style:table-properties"),r.writeAttributeString("table:display","true"),r.writeAttributeString("style:writing-mode","lr-tb"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","gr1"),r.writeAttributeString("style:family","graphic"),r.writeStartElement("style:graphic-properties"),r.writeAttributeString("draw:stroke","none"),r.writeAttributeString("draw:fill","none"),r.writeAttributeString("draw:textarea-horizontal-align","center"),r.writeAttributeString("draw:textarea-vertical-align","middle"),r.writeAttributeString("draw:color-mode","standard"),r.writeAttributeString("draw:luminance","0%"),r.writeAttributeString("draw:contrast","0%"),r.writeAttributeString("draw:gamma","100%"),r.writeAttributeString("draw:red","0%"),r.writeAttributeString("draw:green","0%"),r.writeAttributeString("draw:blue","0%"),r.writeAttributeString("fo:clip","rect(0cm 0cm 0cm 0cm)"),r.writeAttributeString("draw:image-opacity","100%"),r.writeAttributeString("style:mirror","none"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","P1"),r.writeAttributeString("style:family","paragraph"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:text-align","center"),r.writeEndElement(),r.writeEndElement();for(let e=0;e<this.dataStyleList.stimulsoft().countItems;e++){let t=this.dataStyleList.stimulsoft().getByIndex(e);t.isNumeric&&(r.writeStartElement("number:number-style"),t.NegativeBraces?(r.writeAttributeString("style:name",`N${e+1}P0`),r.writeAttributeString("style:volatile","true")):r.writeAttributeString("style:name",`N`+(e+1))," "!=t.DecimalComma&&(r.writeAttributeString("number:language",","==t.DecimalComma?"ru":"en"),r.writeAttributeString("number:country",","==t.DecimalComma?"RU":"US")),r.writeStartElement("number:number"),r.writeAttributeString("number:decimal-places",t.DecimalDigits.toString()),r.writeAttributeString("number:min-integer-digits","1"),r.writeAttributeString("number:grouping",3==t.GroupDigits?"true":"false"),r.writeEndElement(),r.writeEndElement(),t.NegativeBraces&&(r.writeStartElement("number:number-style"),r.writeAttributeString("style:name",`N`+(e+1))," "!=t.DecimalComma&&(r.writeAttributeString("number:language",","==t.DecimalComma?"ru":"en"),r.writeAttributeString("number:country",","==t.DecimalComma?"RU":"US")),r.writeElementString("number:text","("),r.writeStartElement("number:number"),r.writeAttributeString("number:decimal-places",t.DecimalDigits.toString()),r.writeAttributeString("number:min-integer-digits","1"),r.writeAttributeString("number:grouping",3==t.GroupDigits?"true":"false"),r.writeEndElement(),r.writeElementString("number:text",")"),r.writeStartElement("style:map"),r.writeAttributeString("style:condition","value()>=0"),r.writeAttributeString("style:apply-style-name",`N${e+1}P0`),r.writeEndElement(),r.writeEndElement())),t.isPercent&&(r.writeStartElement("number:percentage-style"),r.writeAttributeString("style:name",`N`+(e+1))," "!=t.DecimalComma&&(r.writeAttributeString("number:language",","==t.DecimalComma?"ru":"en"),r.writeAttributeString("number:country",","==t.DecimalComma?"RU":"US")),r.writeStartElement("number:number"),r.writeAttributeString("number:decimal-places",t.DecimalDigits.toString()),r.writeAttributeString("number:min-integer-digits","1"),3==t.GroupDigits&&r.writeAttributeString("number:grouping","true"),r.writeEndElement(),r.writeElementString("number:text","%"),r.writeEndElement()),t.isCurrency&&(r.writeStartElement("number:currency-style"),r.writeAttributeString("style:name",`N`+(e+1))," "!=t.DecimalComma&&(r.writeAttributeString("number:language",","==t.DecimalComma?"ru":"en"),r.writeAttributeString("number:country",","==t.DecimalComma?"RU":"US")),t.CurrencyPositionBefore&&r.writeElementString("number:currency-symbol",t.CurrencySymbol),r.writeStartElement("number:number"),r.writeAttributeString("number:decimal-places",t.DecimalDigits.toString()),r.writeAttributeString("number:min-integer-digits","1"),r.writeAttributeString("number:grouping",3==t.GroupDigits?"true":"false"),r.writeEndElement(),t.CurrencyPositionBefore||r.writeElementString("number:currency-symbol",t.CurrencySymbol),r.writeEndElement()),t.isDate&&(r.writeStartElement("number:date-style"),r.writeAttributeString("style:name",`N`+(e+1)),this.writeDateTimeFormatString(r,t.DateTimeFormatString,"d"),r.writeEndElement()),t.isTime&&(r.writeStartElement("number:time-style"),r.writeAttributeString("style:name",`N`+(e+1)),pt.isNullOrEmpty(t.DateTimeFormatString)||-1==t.DateTimeFormatString.indexOf("h")||(r.writeAttributeString("number:language","en"),r.writeAttributeString("number:country","US")),this.writeDateTimeFormatString(r,t.DateTimeFormatString,"t"),r.writeEndElement())}for(let e=0;e<this.cellStyleList.stimulsoft().countItems;e++){let t=this.cellStyleList.stimulsoft().getByIndex(e);r.writeStartElement("style:style"),r.writeAttributeString("style:name",`ce`+(e+1)),r.writeAttributeString("style:family","table-cell"),r.writeAttributeString("style:parent-style-name","Default"),-1!=t.DataStyle&&r.writeAttributeString("style:data-style-name",`N`+(t.DataStyle+1)),r.writeStartElement("style:table-cell-properties"),0<t.BackColor.a?r.writeAttributeString("fo:background-color",this.getColorString(t.BackColor)):r.writeAttributeString("fo:background-color","transparent"),t.VertAlign==dt.Center&&r.writeAttributeString("style:vertical-align","middle"),t.VertAlign==dt.Top&&r.writeAttributeString("style:vertical-align","top"),r.writeAttributeString("style:text-align-source","fix"),r.writeAttributeString("style:repeat-content","false"),t.Wordwrap&&r.writeAttributeString("fo:wrap-option","wrap"),r.writeAttributeString("fo:padding","0in"),r.writeAttributeString("fo:border-left",t.BorderLeft),r.writeAttributeString("fo:border-right",t.BorderRight),r.writeAttributeString("fo:border-top",t.BorderTop),r.writeAttributeString("fo:border-bottom",t.BorderBottom),0!=t.Angle&&(r.writeAttributeString("style:rotation-angle",t.Angle.toString()),r.writeAttributeString("style:rotation-align","none")),r.writeEndElement(),r.writeStartElement("style:paragraph-properties"),t.HorAlign==wt.Left&&r.writeAttributeString("fo:text-align","start"),t.HorAlign==wt.Center&&r.writeAttributeString("fo:text-align","center"),t.HorAlign==wt.Right&&r.writeAttributeString("fo:text-align","end"),t.HorAlign==wt.Width&&r.writeAttributeString("fo:text-align","justify"),r.writeAttributeString("fo:margin-left","0cm"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("fo:color",this.getColorString(t.FontColor)),r.writeAttributeString("style:font-name",t.FontName);var A=t.FontSize+`pt`;r.writeAttributeString("fo:font-size",A),r.writeAttributeString("fo:font-size-asian",A),r.writeAttributeString("fo:font-size-complex",A),t.Italic&&(r.writeAttributeString("fo:font-style","italic"),r.writeAttributeString("fo:font-style-asian","italic"),r.writeAttributeString("fo:font-style-complex","italic")),t.Underline&&(r.writeAttributeString("style:text-underline-style","solid"),r.writeAttributeString("style:text-underline-width","auto"),r.writeAttributeString("style:text-underline-color","font-color")),t.Bold&&(r.writeAttributeString("fo:font-weight","bold"),r.writeAttributeString("fo:font-weight-asian","bold"),r.writeAttributeString("fo:font-weight-complex","bold")),r.writeEndElement(),r.writeEndElement()}r.writeFullEndElement(),r.writeStartElement("office:body"),r.writeStartElement("office:spreadsheet"),r.writeStartElement("table:calculation-settings"),r.writeAttributeString("table:use-regular-expressions","false"),r.writeEndElement(),this.currentPassNumber=rt["StiOptions"].Export.OpenDocumentCalc.divideSegmentPages?3:2;for(let t=0;t<this.matrixList.stimulsoft().countItems;t++)this.writeTableFromMatrix(r,t,c,h);return r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),t}writeDateTimeFormatString(e,i,t){if(1==(i=pt.isNullOrEmpty(i)?t:i).length){var r=this.currentCulture.dateTimeFormat;switch(i){case"d":i=r.shortDatePattern;break;case"D":i=r.longDatePattern;break;case"f":i=r.shortDatePattern+" "+r.shortTimePattern;break;case"F":i=r.fullDateTimePattern;break;case"g":i=r.shortDatePattern+" "+r.shortTimePattern;break;case"G":i=r.shortDatePattern+" "+r.longTimePattern;break;case"m":case"M":i=S.currentCulture.name.stimulsoft().contains("en")||S.currentCulture.name.stimulsoft().contains("us")?"MMMM d":"d MMMM";break;case"r":case"R":i="ddd, dd MMM yyyy HH\\:mm\\:ss \\G\\M\\T";break;case"s":i="yyyy\\-MM\\-dd\\THH\\:mm\\:ss";break;case"t":i=r.shortTimePattern;break;case"T":i=r.longTimePattern;break;case"u":i="yyyy\\-MM\\-dd HH\\:mm\\:ss\\Z";break;case"U":i=r.fullDateTimePattern;break;case"y":case"Y":i=r.yearMonthPattern;break}i=i.stimulsoft().replaceAll('"',"").stimulsoft().replaceAll("'","")}let n=0;while(n<i.length){var a=i.charAt(n);let t=1;while(n+1<i.length&&i.charAt(n+1)==a)n++,t++;switch(n++,a){case"d":1==t&&(e.writeStartElement("number:day"),e.writeEndElement()),2==t&&(e.writeStartElement("number:day"),e.writeAttributeString("number:style","long"),e.writeEndElement()),3==t&&(e.writeStartElement("number:day-of-week"),e.writeEndElement()),4==t&&(e.writeStartElement("number:day-of-week"),e.writeAttributeString("number:style","long"),e.writeEndElement());break;case"M":1==t&&(e.writeStartElement("number:month"),e.writeEndElement()),2==t&&(e.writeStartElement("number:month"),e.writeAttributeString("number:style","long"),e.writeEndElement()),3==t&&(e.writeStartElement("number:month"),e.writeAttributeString("number:textual","true"),e.writeEndElement()),4==t&&(e.writeStartElement("number:month"),e.writeAttributeString("number:style","long"),e.writeAttributeString("number:textual","true"),e.writeEndElement());break;case"y":1!=t&&2!=t||(e.writeStartElement("number:year"),e.writeEndElement()),3!=t&&4!=t||(e.writeStartElement("number:year"),e.writeAttributeString("number:style","long"),e.writeEndElement());break;case"s":1==t&&(e.writeStartElement("number:seconds"),e.writeEndElement()),2==t&&(e.writeStartElement("number:seconds"),e.writeAttributeString("number:style","long"),e.writeEndElement());break;case"m":1==t&&(e.writeStartElement("number:minutes"),e.writeEndElement()),2==t&&(e.writeStartElement("number:minutes"),e.writeAttributeString("number:style","long"),e.writeEndElement());break;case"h":case"H":1==t&&(e.writeStartElement("number:hours"),e.writeEndElement()),2==t&&(e.writeStartElement("number:hours"),e.writeAttributeString("number:style","long"),e.writeEndElement());break;default:e.writeElementString("number:text",a);break}}}writeTableFromMatrix(s,t,e,i){let o=this.matrixList[t];var r=this.minRowList[t],a=this.maxRowList[t],l=this.cellStyleTableList[t],m=this.sheetNameList[t];let c=mt.create2(Boolean,o.coordY.countItems,o.coordX.countItems);s.writeStartElement("table:table"),s.writeAttributeString("table:name",m),s.writeAttributeString("table:style-name","ta1"),s.writeAttributeString("table:print","false");for(let t=0;t<o.coordX.countItems-1;t++){var n=o.coordX.getByIndex(t+1)-o.coordX.getByIndex(t),n=i.get(n);s.writeStartElement("table:table-column"),s.writeAttributeString("table:style-name",`co`+(n+1)),s.writeAttributeString("table:default-cell-style-name","Default"),s.writeEndElement()}var g=Math.max(o.coordY.countItems/200,1);let h=0;for(let n=r+1;n<a+1;n++){var p=n/g|0,p=(p>h&&(h=p,this.invokeExporting2(n,o.coordY.countItems,this.currentPassNumber,this.maximumPassNumber)),o.coordY.getByIndex(n)-o.coordY.getByIndex(n-1)),p=e.get(p);s.writeStartElement("table:table-row"),s.writeAttributeString("table:style-name",`ro`+(p+1));for(let r=1;r<o.coordX.countItems;r++){let i=o.cells[n-1][r-1];if(c[n][r])s.writeStartElement("table:covered-table-cell"),s.writeEndElement();else if(null!=i){for(let e=0;e<=i.height;e++)for(let t=0;t<=i.width;t++)c[n+e][r+t]=!0;var w=l[n-1][r-1],d=this.cellStyleList[w].DataStyle,w=(s.writeStartElement("table:table-cell"),s.writeAttributeString("table:style-name",`ce`+(w+1)),(0<i.width||0<i.height)&&(s.writeAttributeString("table:number-columns-spanned",(i.width+1).toString()),s.writeAttributeString("table:number-rows-spanned",(i.height+1).toString())),i.component.stimulsoft().as(lt));let a=i.text;var S=i.component.stimulsoft().as(nt);if(null==S||pt.isNullOrEmpty(S.excelDataValue)||(a=S.excelDataValue),!i.component.isExportAsImage(at.a.StiExportFormat.Ods)&&(!pt.isNullOrEmpty(a)||null!=w&&null!=w.excelDataValue)){let e=!1,i=0,r=gt.now,n=null;if(-1!=d&&null!=w&&null!=w.excelDataValue&&"-"!=w.excelDataValue){let t=w.excelDataValue;var S=t.replace(/[^\d.,-]/g,"").stimulsoft().replaceAll(",","."),u;n=this.dataStyleList[d],e=!0;try{n.isDate||n.isTime?(u=gt.tryParseExact(t,[null])).successfully?r=u.result:e=!1:(i=parseFloat(S),isNaN(i)&&(e=!1,i=0))}catch(t){e=!1}e||null!=a||(a=t)}var w,f=(e?n.isDate?(s.writeAttributeString("office:value-type","date"),s.writeAttributeString("office:date-value",r.toString("yyyy-MM-dd"))):n.isTime?(s.writeAttributeString("office:value-type","time"),s.writeAttributeString("office:time-value",r.toString("PTHH\\Hmm\\Mss\\S"))):(w=i.toString().stimulsoft().replaceAll(",","."),n.isNumeric&&s.writeAttributeString("office:value-type","float"),n.isPercent&&s.writeAttributeString("office:value-type","percentage"),n.isCurrency&&s.writeAttributeString("office:value-type","currency"),s.writeAttributeString("office:value",w)):s.writeAttributeString("office:value-type","string"),at.c.StiExportUtils.splitString(a,!0));for(let t=0;t<f.length;t++){var v=f[t];s.writeStartElement("text:p"),s.writeString(v),s.writeEndElement()}}if(i.component.isExportAsImage(at.a.StiExportFormat.Ods)){s.writeAttributeString("office:value-type","string");let e=i.component.stimulsoft().as(Lt);if(null!=e){let t=null;var d={ref:this.imageResolution},S,w,d,S,E;null!=(t=e.getImage(d,at.a.StiExportFormat.Ods))&&(null!=(S=o.getRealImageData(i,t))&&(t=S),w=this.imageCache.addImageInt(t),d=o.coordX.getByIndex(r+i.width)-o.coordX.getByIndex(r-1),S=o.coordY.getByIndex(n+i.height)-o.coordY.getByIndex(n-1),E=`'${m}'.`+this.getColumnName(i.left+i.width+1)+(i.top+i.height+1+1),s.writeStartElement("draw:frame"),s.writeAttributeString("table:end-cell-address",E),s.writeAttributeString("table:end-x","0in"),s.writeAttributeString("table:end-y","0in"),s.writeAttributeString("draw:z-index","0"),s.writeAttributeString("draw:name",`Picture`+(w+1)),s.writeAttributeString("draw:style-name","gr1"),s.writeAttributeString("draw:text-style-name","P1"),s.writeAttributeString("text:anchor-type","paragraph"),s.writeAttributeString("svg:x",this.doubleToString(0)),s.writeAttributeString("svg:y",this.doubleToString(0)),s.writeAttributeString("svg:width",this.doubleToString(d)),s.writeAttributeString("svg:height",this.doubleToString(S)),s.writeStartElement("draw:image"),s.writeAttributeString("xlink:href",pt.format("Pictures/{0:D5}.jpg",w+1)),s.writeAttributeString("xlink:type","simple"),s.writeAttributeString("xlink:show","embed"),s.writeAttributeString("xlink:actuate","onLoad"),s.writeStartElement("text:p"),s.writeEndElement(),s.writeEndElement(),s.writeEndElement())}}s.writeEndElement()}else{var E=l[n-1][r-1];s.writeStartElement("table:table-cell"),s.writeAttributeString("table:style-name",`ce`+(E+1)),s.writeEndElement()}}s.writeEndElement()}s.writeEndElement()}exportOds(i,r,t){if(at.a.StiLogService.write(this.stimulsoft().getType(),"Export report to ODT format"),null==t)throw new Error("The 'settings' argument cannot be equal in null.");let n=t.pageRange;this.imageResolution=t.imageResolution,this.imageQuality=t.imageQuality,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.currentCulture=S.currentCulture;try{S.currentCulture=S.cultures["en-US"],this.imageCache=new at.a.StiImageCache(rt["StiOptions"].Export.OpenDocumentCalc.allowImageComparer,!0,v.Jpeg,this.imageQuality,!1),this.cellStyleList=[],this.dataStyleList=[],this.sheetNameList=[],this.matrixList=[],this.firstPageIndexList=[],this.minRowList=[],this.maxRowList=[],this.cellStyleTableList=[],this.currentPassNumber=0,this.maximumPassNumber=rt["StiOptions"].Export.OpenDocumentCalc.divideSegmentPages?4:3;let t=n.getSelectedPages(i.renderedPages);if(rt["StiOptions"].Export.OpenDocumentCalc.divideSegmentPages&&(t=at.c.StiSegmentPagesDivider.divide(t,this),this.currentPassNumber=1),this.isStopped)return;let e=new u;if(e.begin(r,!0),e.addFile("content.xml",this.writeContent(i,t)),e.addFile("mimetype",this.writeMimetype()),e.addFile("meta.xml",this.writeMeta()),e.addFile("META-INF/manifest.xml",this.writeManifest()),e.addFile("settings.xml",this.writeSettings()),e.addFile("styles.xml",this.writeStyles(t)),0<this.imageCache.imagePackedStore.stimulsoft().countItems)for(let t=0;t<this.imageCache.imagePackedStore.stimulsoft().countItems;t++)e.addFile(pt.format("Pictures/{0:D5}.jpg",t+1),this.writeImage(t));e.end()}finally{S.currentCulture=this.currentCulture,this.sheetNameList.stimulsoft().clear(),this.sheetNameList=null,this.firstPageIndexList.stimulsoft().clear(),this.firstPageIndexList=null,this.minRowList.stimulsoft().clear(),this.minRowList=null,this.maxRowList.stimulsoft().clear(),this.maxRowList=null;for(var e of this.matrixList)null!=e&&e.clear();this.matrixList.stimulsoft().clear(),this.matrixList=null,this.cellStyleTableList.stimulsoft().clear(),this.cellStyleTableList=null,this.dataStyleList.stimulsoft().clear(),this.dataStyleList=null,this.cellStyleList.stimulsoft().clear(),this.cellStyleList=null,this.imageCache.clear(),this.imageCache=null,i.renderedPages.cacheMode&&at.c.StiMatrix.GCCollect()}}}}{class mi{constructor(){this.BorderLeft="none",this.BorderRight="none",this.BorderTop="none",this.BorderBottom="none",this.BackColor=ht.transparent,this.VertAlign=dt.Bottom}}class ci{constructor(){this.FontName="Arial",this.FontSize=6,this.Bold=!1,this.Italic=!1,this.Underline=!1,this.FontColor=ht.black,this.HorAlign=wt.Left,this.Angle=0}}at.c.StiOdtExportService=class extends at.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1,this.matrix=null,this.removeEmptySpaceAtBottom=rt["StiOptions"].Export.OpenDocumentWriter.removeEmptySpaceAtBottom,this.imageCache=null,this.cellStyleList=null,this.paragraphStyleList=null,this.xmlIndentation=1,this.imageQuality=.75,this.imageResolution=96,this.usePageHeadersAndFooters=!1}implements(){return[at.c.IStiOdtExportService]}get defaultExtension(){return"odt"}get exportFormat(){return at.a.StiExportFormat.Odt}get groupCategory(){return"Word"}get position(){return at.c.StiExportPosition.Odt}get exportNameInMenu(){return t.get("Export","ExportTypeWriterFile")}getFilter(){return t.get("FileFilters","WriterFiles")}exportTo(t,e,i){this.exportOdt(t,e,i)}exportToAsync(t,e,i,r){setTimeout(async()=>{await at.c.StiExportImageHelper.convertAllImages(e,rt.System.Drawing.Imaging.ImageFormat.Jpeg,!1,this.exportFormat),this.exportTo(e,i,r),null!=e&&null!=e.preparedExportImages&&(e.preparedExportImages.clear(),e.preparedExportImages=null),t()},0)}doubleToString(t){return st.round2(t/100,4).toString().stimulsoft().replaceAll(",",".")+"in"}getColumnName(t){var e=t/26|0,t=t%26;let i="";return 0<e&&(i+=String.fromCharCode(65+e-1)),i+=String.fromCharCode(65+t)}getColorString(t){return"#"+pt.format("{0:X8}",t.toArgb()).substr(2)}getCellStyleNumber(e,i,r,n){let a=new mi,s=!0,o=!0;for(let t=0;t<r;t++)null==this.matrix.bordersY[e+t][i]&&(s=!1),null==this.matrix.bordersY[e+t][i+n]&&(o=!1);let l=!0,m=!0;for(let t=0;t<n;t++)null==this.matrix.bordersX[e][i+t]&&(l=!1),null==this.matrix.bordersX[e+r][i+t]&&(m=!1);var t,c,g;if(l&&(a.BorderTop=this.getStringFromBorder(this.matrix.bordersX[e][i])),s&&(a.BorderLeft=this.getStringFromBorder(this.matrix.bordersY[e][i])),m&&(a.BorderBottom=this.getStringFromBorder(this.matrix.bordersX[e+r][i])),o&&(a.BorderRight=this.getStringFromBorder(this.matrix.bordersY[e][i+n])),null!=this.matrix.cells[e][i]&&(t=this.matrix.cells[e][i],a.BackColor=t.cellStyle.color,a.VertAlign=t.cellStyle.vertAlignment,null!=t.cellStyle.textOptions&&(45<(c=t.cellStyle.textOptions.angle)&&c<135||225<c&&c<315)&&(t.cellStyle.horAlignment==wt.Left&&(a.VertAlign=dt.Bottom),t.cellStyle.horAlignment==wt.Center&&(a.VertAlign=dt.Center),t.cellStyle.horAlignment==wt.Right&&(a.VertAlign=dt.Top),t.cellStyle.horAlignment==wt.Width&&(a.VertAlign=dt.Bottom))),0<this.cellStyleList.length)for(let e=0;e<this.cellStyleList.length;e++){let t=this.cellStyleList[e];if(t.BorderLeft==a.BorderLeft&&t.BorderRight==a.BorderRight&&t.BorderTop==a.BorderTop&&t.BorderBottom==a.BorderBottom&&t.BackColor.equals(a.BackColor)&&t.VertAlign==a.VertAlign)return e}return this.cellStyleList.push(a),this.cellStyleList.length-1}getStringFromBorder(t){return pt.format("{0} solid {1}",this.doubleToString(t.size),this.getColorString(t.color))}getParagraphStyleNumber(t,e){var t=this.matrix.cells[t][e].cellStyle,i;let r=new ci,n=(r.FontName=t.font.name,r.FontSize=t.font.sizeInPoints,r.Bold=t.font.bold,r.Italic=t.font.italic,r.Underline=t.font.underline,r.FontColor=t.textColor,r.HorAlign=t.horAlignment,0);if(45<(n=null!=t.textOptions?t.textOptions.angle:n)&&n<135&&(r.Angle=90),225<n&&n<315&&(r.Angle=270),0!=r.Angle&&(t.vertAlignment==dt.Top&&(r.HorAlign=wt.Left),t.vertAlignment==dt.Center&&(r.HorAlign=wt.Center),t.vertAlignment==dt.Bottom&&(r.HorAlign=wt.Right)),0<this.paragraphStyleList.length)for(let e=0;e<this.paragraphStyleList.length;e++){let t=this.paragraphStyleList[e];if(t.FontName==r.FontName&&t.FontSize==r.FontSize&&t.Bold==r.Bold&&t.Italic==r.Italic&&t.Underline==r.Underline&&t.FontColor.equals(r.FontColor)&&t.HorAlign==r.HorAlign&&t.Angle==r.Angle)return e}return this.paragraphStyleList.push(r),this.paragraphStyleList.length-1}writeMimetype(){var t=new tt;let e=new et(t,V.ASCII);return e.write("application/vnd.oasis.opendocument.text"),e.flush(),t}writeMeta(){var t=new tt;let e=new F(V.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("office:document-meta"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:meta");var i=pt.format("{0}",gt.now.toString("yyyy-MM-ddTHH:mm:ss"));return e.writeElementString("meta:generator","Stimulsoft Reports"),e.writeElementString("meta:creation-date",i),e.writeElementString("dc:date",i),e.writeElementString("meta:editing-cycles","1"),e.writeElementString("meta:editing-duration","PT0M01S"),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 1"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 2"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 3"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 4"),e.writeEndElement(),e.writeStartElement("meta:document-statistic"),e.writeAttributeString("meta:table-count","1"),e.writeAttributeString("meta:image-count","0"),e.writeAttributeString("meta:object-count","0"),e.writeAttributeString("meta:page-count","1"),e.writeAttributeString("meta:paragraph-count","1"),e.writeAttributeString("meta:word-count","1"),e.writeAttributeString("meta:character-count","1"),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeManifest(){var t=new tt;let e=new F(V.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("manifest:manifest"),e.writeAttributeString("xmlns:manifest","urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","application/vnd.oasis.opendocument.text"),e.writeAttributeString("manifest:full-path","/"),e.writeEndElement();for(let t=0;t<this.imageCache.imagePackedStore.stimulsoft().countItems;t++)e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","image/jpeg"),e.writeAttributeString("manifest:full-path",pt.format("Pictures/{0:D5}.jpg",t+1)),e.writeEndElement();return e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","content.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","styles.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","meta.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","settings.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeImage(t){let e=new tt;var t=this.imageCache.imagePackedStore[t];return e.write(t,0,t.length),e}writeSettings(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("office:document-settings"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:config","urn:oasis:names:tc:opendocument:xmlns:config:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:settings"),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:view-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaWidth"),e.writeAttributeString("config:type","int"),e.writeString("43208"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaHeight"),e.writeAttributeString("config:type","int"),e.writeString("22174"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowRedlineChanges"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","InBrowseMode"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item-map-indexed"),e.writeAttributeString("config:name","Views"),e.writeStartElement("config:config-item-map-entry"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewId"),e.writeAttributeString("config:type","string"),e.writeString("view2"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewLeft"),e.writeAttributeString("config:type","int"),e.writeString("3002"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewTop"),e.writeAttributeString("config:type","int"),e.writeString("10435"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleRight"),e.writeAttributeString("config:type","int"),e.writeString("33099"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleBottom"),e.writeAttributeString("config:type","int"),e.writeString("22172"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomFactor"),e.writeAttributeString("config:type","short"),e.writeString("100"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSelectedFrame"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:configuration-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaTableSpacing"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintReversed"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","OutlineLevelYieldsNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LinkUpdateMode"),e.writeAttributeString("config:type","short"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintEmptyPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IgnoreFirstLineIndentInNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CharacterCompressionType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintSingleJobs"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UpdateFromTemplate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintPaperFromSetup"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddFrameOffsets"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintLeftPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RedlineProtectionKey"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintTables"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ChartAutoUpdate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintControls"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterSetup"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IgnoreTabsAndBlanksForLineCalculation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintAnnotationMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LoadReadonly"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaSpacingToTableCells"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddExternalLeading"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ApplyUserData"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","FieldAutoUpdate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveVersionOnClose"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveGlobalDocumentLinks"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsKernAsianPunctuation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AlignTabStopPosition"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ClipAsCharacterAnchoredWriterFlyFrames"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseDataSource"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotCaptureDrawObjsOnPage"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","TableRowKeep"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintFaxName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ConsiderTextWrapOnObjPos"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseOldPrinterMetrics"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintRightPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsLabelDocument"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerLineSpacing"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaTableSpacingAtStart"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerTextWrapping"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotResetParaAttrsForNumFont"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintProspect"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintGraphics"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AllowPrintJobCancel"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseCommandType"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotJustifyLinesWithManualBreak"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerObjectPositioning"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterIndependentLayout"),e.writeAttributeString("config:type","string"),e.writeString("high-resolution"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseOldNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintPageBackground"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseCommand"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintDrawings"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintBlackFonts"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UnxForceZeroExtLeading"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeStyles(t){var e=new tt;let i=new F(V.UTF8,e),r=(i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?C.None:C.Indented,i.writeStartDocument(),i.writeStartElement("office:document-styles"),i.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),i.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),i.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),i.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),i.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),i.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),i.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),i.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),i.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),i.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),i.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),i.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),i.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),i.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),i.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),i.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),i.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),i.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),i.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),i.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),i.writeAttributeString("office:version","1.1"),i.writeStartElement("office:font-face-decls"),i.writeStartElement("style:font-face"),i.writeAttributeString("style:name","Arial"),i.writeAttributeString("svg:font-family","Arial"),i.writeEndElement(),i.writeStartElement("style:font-face"),i.writeAttributeString("style:name","Tahoma"),i.writeAttributeString("svg:font-family","Tahoma"),i.writeAttributeString("style:font-family-generic","system"),i.writeAttributeString("style:font-pitch","variable"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("office:styles"),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","graphic"),i.writeStartElement("style:graphic-properties"),i.writeAttributeString("draw:shadow-offset-x","0.3cm"),i.writeAttributeString("draw:shadow-offset-y","0.3cm"),i.writeAttributeString("draw:start-line-spacing-horizontal","0.283cm"),i.writeAttributeString("draw:start-line-spacing-vertical","0.283cm"),i.writeAttributeString("draw:end-line-spacing-horizontal","0.283cm"),i.writeAttributeString("draw:end-line-spacing-vertical","0.283cm"),i.writeAttributeString("style:flow-with-text","false"),i.writeEndElement(),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("style:text-autospace","ideograph-alpha"),i.writeAttributeString("style:line-break","strict"),i.writeAttributeString("style:writing-mode","lr-tb"),i.writeAttributeString("style:font-independent-line-spacing","false"),i.writeStartElement("style:tab-stops"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:use-window-font-color","true"),i.writeAttributeString("fo:font-size","10pt"),i.writeAttributeString("style:letter-kerning","true"),i.writeAttributeString("style:font-size-asian","12pt"),i.writeAttributeString("style:language-asian","zxx"),i.writeAttributeString("style:country-asian","none"),i.writeAttributeString("style:font-size-complex","12pt"),i.writeAttributeString("style:language-complex","zxx"),i.writeAttributeString("style:country-complex","none"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","paragraph"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:hyphenation-ladder-count","no-limit"),i.writeAttributeString("style:text-autospace","ideograph-alpha"),i.writeAttributeString("style:punctuation-wrap","hanging"),i.writeAttributeString("style:line-break","strict"),i.writeAttributeString("style:tab-stop-distance","1.251cm"),i.writeAttributeString("style:writing-mode","page"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:use-window-font-color","true"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("fo:font-size","10pt"),i.writeAttributeString("style:letter-kerning","true"),i.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),i.writeAttributeString("style:font-size-asian","12pt"),i.writeAttributeString("style:language-asian","zxx"),i.writeAttributeString("style:country-asian","none"),i.writeAttributeString("style:font-name-complex","Tahoma"),i.writeAttributeString("style:font-size-complex","12pt"),i.writeAttributeString("style:language-complex","zxx"),i.writeAttributeString("style:country-complex","none"),i.writeAttributeString("fo:hyphenate","false"),i.writeAttributeString("fo:hyphenation-remain-char-count","2"),i.writeAttributeString("fo:hyphenation-push-char-count","2"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","table"),i.writeStartElement("style:table-properties"),i.writeAttributeString("table:border-model","collapsing"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","table-row"),i.writeStartElement("style:table-row-properties"),i.writeAttributeString("fo:keep-together","auto"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Standard"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:class","text"),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Title"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:next-style-name","Text_20_body"),i.writeAttributeString("style:class","text"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:margin-top","0.423cm"),i.writeAttributeString("fo:margin-bottom","0.212cm"),i.writeAttributeString("fo:keep-with-next","always"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial1"),i.writeAttributeString("fo:font-size","14pt"),i.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),i.writeAttributeString("style:font-size-asian","14pt"),i.writeAttributeString("style:font-name-complex","Tahoma"),i.writeAttributeString("style:font-size-complex","14pt"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Text_20_body"),i.writeAttributeString("style:display-name","Text body"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:class","text"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:margin-top","0cm"),i.writeAttributeString("fo:margin-bottom","0.212cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Subtitle"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Title"),i.writeAttributeString("style:next-style-name","Text_20_body"),i.writeAttributeString("style:class","chapter"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:text-align","center"),i.writeAttributeString("style:justify-single-word","false"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("fo:font-size","14pt"),i.writeAttributeString("fo:font-style","italic"),i.writeAttributeString("style:font-size-asian","14pt"),i.writeAttributeString("style:font-style-asian","italic"),i.writeAttributeString("style:font-size-complex","14pt"),i.writeAttributeString("style:font-style-complex","italic"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","List"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Text_20_body"),i.writeAttributeString("style:class","list"),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("style:font-name-complex","Tahoma1"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Caption"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:class","extra"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:margin-top","0.212cm"),i.writeAttributeString("fo:margin-bottom","0.212cm"),i.writeAttributeString("text:number-lines","false"),i.writeAttributeString("text:line-number","0"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("fo:font-size","10pt"),i.writeAttributeString("fo:font-style","italic"),i.writeAttributeString("style:font-size-asian","12pt"),i.writeAttributeString("style:font-style-asian","italic"),i.writeAttributeString("style:font-name-complex","Tahoma1"),i.writeAttributeString("style:font-size-complex","12pt"),i.writeAttributeString("style:font-style-complex","italic"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Index"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:class","index"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("text:number-lines","false"),i.writeAttributeString("text:line-number","0"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("style:font-name-complex","Tahoma1"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Table_20_Contents"),i.writeAttributeString("style:display-name","Table Contents"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:class","extra"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("text:number-lines","false"),i.writeAttributeString("text:line-number","0"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Graphics"),i.writeAttributeString("style:family","graphic"),i.writeStartElement("style:graphic-properties"),i.writeAttributeString("text:anchor-type","paragraph"),i.writeAttributeString("svg:x","0cm"),i.writeAttributeString("svg:y","0cm"),i.writeAttributeString("style:wrap","dynamic"),i.writeAttributeString("style:number-wrapped-paragraphs","no-limit"),i.writeAttributeString("style:wrap-contour","false"),i.writeAttributeString("style:vertical-pos","top"),i.writeAttributeString("style:vertical-rel","paragraph"),i.writeAttributeString("style:horizontal-pos","center"),i.writeAttributeString("style:horizontal-rel","paragraph"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-style"),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","1"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","2"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","3"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","4"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","5"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","6"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","7"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","8"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","9"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","10"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("text:notes-configuration"),i.writeAttributeString("text:note-class","footnote"),i.writeAttributeString("style:num-format","1"),i.writeAttributeString("text:start-value","0"),i.writeAttributeString("text:footnotes-position","page"),i.writeAttributeString("text:start-numbering-at","document"),i.writeEndElement(),i.writeStartElement("text:notes-configuration"),i.writeAttributeString("text:note-class","endnote"),i.writeAttributeString("style:num-format","i"),i.writeAttributeString("text:start-value","0"),i.writeEndElement(),i.writeStartElement("text:linenumbering-configuration"),i.writeAttributeString("text:number-lines","false"),i.writeAttributeString("text:offset","0.499cm"),i.writeAttributeString("style:num-format","1"),i.writeAttributeString("text:number-position","left"),i.writeAttributeString("text:increment","5"),i.writeEndElement(),i.writeEndElement(),t.getByIndex(0));var t=r.unit.convertToHInches(r.pageHeight*r.segmentPerHeight),n=r.unit.convertToHInches(r.pageWidth*r.segmentPerWidth),a=r.unit.convertToHInches(r.margins.left),s=r.unit.convertToHInches(r.margins.right),o=r.unit.convertToHInches(r.margins.top);let l=r.unit.convertToHInches(r.margins.bottom)-4;return l<0&&(l=0),i.writeStartElement("office:automatic-styles"),i.writeStartElement("style:page-layout"),i.writeAttributeString("style:name","pm1"),i.writeStartElement("style:page-layout-properties"),i.writeAttributeString("fo:page-width",this.doubleToString(n)),i.writeAttributeString("fo:page-height",this.doubleToString(t)),i.writeAttributeString("style:num-format","1"),i.writeAttributeString("style:print-orientation",r.orientation==G.Portrait?"portrait":"landscape"),i.writeAttributeString("fo:margin-top",this.doubleToString(o)),i.writeAttributeString("fo:margin-bottom",this.doubleToString(l)),i.writeAttributeString("fo:margin-left",this.doubleToString(a)),i.writeAttributeString("fo:margin-right",this.doubleToString(s)),i.writeAttributeString("style:writing-mode","lr-tb"),i.writeAttributeString("style:footnote-max-height","0cm"),i.writeStartElement("style:footnote-sep"),i.writeAttributeString("style:width","0.018cm"),i.writeAttributeString("style:distance-before-sep","0.101cm"),i.writeAttributeString("style:distance-after-sep","0.101cm"),i.writeAttributeString("style:adjustment","left"),i.writeAttributeString("style:rel-width","25%"),i.writeAttributeString("style:color","#000000"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:header-style"),i.writeEndElement(),i.writeStartElement("style:footer-style"),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("office:master-styles"),i.writeStartElement("style:master-page"),i.writeAttributeString("style:name","Standard"),i.writeAttributeString("style:page-layout-name","pm1"),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeContent(){var t=new tt,e,i;let a=new F(V.UTF8,t),s=(a.indentation=this.xmlIndentation<0?0:this.xmlIndentation,a.formatting=this.xmlIndentation<0?C.None:C.Indented,a.writeStartDocument(),a.writeStartElement("office:document-content"),a.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),a.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),a.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),a.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),a.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),a.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),a.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),a.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),a.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),a.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),a.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),a.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),a.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),a.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),a.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),a.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),a.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),a.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),a.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),a.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),a.writeAttributeString("xmlns:xforms","http://www.w3.org/2002/xforms"),a.writeAttributeString("xmlns:xsd","http://www.w3.org/2001/XMLSchema"),a.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),a.writeAttributeString("office:version","1.1"),mt.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems)),o=mt.create2(Number,this.matrix.coordY.countItems,this.matrix.coordX.countItems),n=new ct,l=new ct,m=[];for(let r=1;r<this.matrix.coordY.countItems;r++){var c=this.matrix.coordY.getByIndex(r)-this.matrix.coordY.getByIndex(r-1),g;n.containsKey(c)||(g=n.count,n.set(c,g),l.set(g,c)),m[r-1]=0|n.get(c);for(let i=1;i<this.matrix.coordX.countItems;i++){var h=this.matrix.cells[r-1][i-1];if(!s[r][i])if(null!=h){for(let e=0;e<=h.height;e++)for(let t=0;t<=h.width;t++)s[r+e][i+t]=!0;o[r-1][i-1]=this.getCellStyleNumber(r-1,i-1,h.height+1,h.width+1)}else o[r-1][i-1]=this.getCellStyleNumber(r-1,i-1,1,1)}}a.writeStartElement("office:scripts"),a.writeEndElement();let r=new ct;for(e of this.paragraphStyleList)r.set(e.FontName,e.FontName);a.writeStartElement("office:font-face-decls");for(i of r.keys){var p=r.get(i);a.writeStartElement("style:font-face"),a.writeAttributeString("style:name",p),a.writeAttributeString("svg:font-family",p),a.writeEndElement()}a.writeEndElement(),a.writeStartElement("office:automatic-styles"),a.writeStartElement("style:style"),a.writeAttributeString("style:name","Table1"),a.writeAttributeString("style:family","table"),a.writeStartElement("style:table-properties");var w=this.matrix.coordX.getByIndex(this.matrix.coordX.countItems-1)-this.matrix.coordX.getByIndex(0);a.writeAttributeString("style:width",this.doubleToString(w)),a.writeAttributeString("table:align","left"),a.writeEndElement(),a.writeEndElement();for(let t=0;t<this.matrix.coordX.countItems-1;t++){a.writeStartElement("style:style"),a.writeAttributeString("style:name",pt.format("Table1.{0}",this.getColumnName(t))),a.writeAttributeString("style:family","table-column"),a.writeStartElement("style:table-column-properties");var d=this.matrix.coordX.getByIndex(t+1)-this.matrix.coordX.getByIndex(t);a.writeAttributeString("style:column-width",this.doubleToString(d)),a.writeEndElement(),a.writeEndElement()}for(let t=0;t<n.count;t++){a.writeStartElement("style:style"),a.writeAttributeString("style:name",pt.format("Table1.{0}",t+1)),a.writeAttributeString("style:family","table-row"),a.writeStartElement("style:table-row-properties");var S=l.get(t);a.writeAttributeString("style:row-height",this.doubleToString(S)),a.writeEndElement(),a.writeEndElement()}for(let t=0;t<this.cellStyleList.stimulsoft().countItems;t++){var u=this.cellStyleList[t];a.writeStartElement("style:style"),a.writeAttributeString("style:name",pt.format("cell{0}",t+1)),a.writeAttributeString("style:family","table-cell"),a.writeStartElement("style:table-cell-properties"),u.VertAlign==dt.Center&&a.writeAttributeString("style:vertical-align","middle"),u.VertAlign==dt.Bottom&&a.writeAttributeString("style:vertical-align","bottom"),0<u.BackColor.a?a.writeAttributeString("fo:background-color",this.getColorString(u.BackColor)):a.writeAttributeString("fo:background-color","transparent"),a.writeAttributeString("fo:padding","0in"),a.writeAttributeString("fo:border-left",u.BorderLeft),a.writeAttributeString("fo:border-right",u.BorderRight),a.writeAttributeString("fo:border-top",u.BorderTop),a.writeAttributeString("fo:border-bottom",u.BorderBottom),a.writeEndElement(),a.writeEndElement()}for(let e=0;e<this.paragraphStyleList.stimulsoft().countItems;e++){let t=this.paragraphStyleList[e];a.writeStartElement("style:style"),a.writeAttributeString("style:name",pt.format("par{0}",e+1)),a.writeAttributeString("style:family","paragraph"),a.writeAttributeString("style:parent-style-name","Table_20_Contents"),t.HorAlign!=wt.Left&&(a.writeStartElement("style:paragraph-properties"),t.HorAlign==wt.Center&&a.writeAttributeString("fo:text-align","center"),t.HorAlign==wt.Right&&a.writeAttributeString("fo:text-align","right"),t.HorAlign==wt.Width&&a.writeAttributeString("fo:text-align","justify"),a.writeEndElement()),a.writeStartElement("style:text-properties"),a.writeAttributeString("fo:color",this.getColorString(t.FontColor)),a.writeAttributeString("style:font-name",t.FontName);var f=t.FontSize+`pt`;a.writeAttributeString("fo:font-size",f),a.writeAttributeString("fo:font-size-asian",f),a.writeAttributeString("fo:font-size-complex",f),t.Italic&&(a.writeAttributeString("fo:font-style","italic"),a.writeAttributeString("fo:font-style-asian","italic"),a.writeAttributeString("fo:font-style-complex","italic")),t.Underline&&(a.writeAttributeString("style:text-underline-style","solid"),a.writeAttributeString("style:text-underline-width","auto"),a.writeAttributeString("style:text-underline-color","font-color")),t.Bold&&(a.writeAttributeString("fo:font-weight","bold"),a.writeAttributeString("fo:font-weight-asian","bold"),a.writeAttributeString("fo:font-weight-complex","bold")),0!=t.Angle&&a.writeAttributeString("style:text-rotation-angle",t.Angle.toString()),a.writeEndElement(),a.writeEndElement()}a.writeStartElement("style:style"),a.writeAttributeString("style:name","parEnd"),a.writeAttributeString("style:family","paragraph"),a.writeAttributeString("style:parent-style-name","Table_20_Contents"),a.writeStartElement("style:text-properties");var w="1pt";a.writeAttributeString("fo:font-size",w),a.writeAttributeString("fo:font-size-asian",w),a.writeAttributeString("fo:font-size-complex",w),a.writeEndElement(),a.writeEndElement(),a.writeStartElement("style:style"),a.writeAttributeString("style:name","fr1"),a.writeAttributeString("style:family","graphic"),a.writeAttributeString("style:parent-style-name","Graphics"),a.writeStartElement("style:graphic-properties"),a.writeAttributeString("style:vertical-pos","middle"),a.writeAttributeString("style:vertical-rel","paragraph"),a.writeAttributeString("style:horizontal-pos","center"),a.writeAttributeString("style:horizontal-rel","paragraph"),a.writeAttributeString("fo:background-color","transparent"),a.writeAttributeString("style:background-transparency","100%"),a.writeAttributeString("style:shadow","none"),a.writeAttributeString("style:mirror","none"),a.writeAttributeString("fo:clip","rect(0cm 0cm 0cm 0cm)"),a.writeAttributeString("draw:luminance","0%"),a.writeAttributeString("draw:contrast","0%"),a.writeAttributeString("draw:red","0%"),a.writeAttributeString("draw:green","0%"),a.writeAttributeString("draw:blue","0%"),a.writeAttributeString("draw:gamma","100%"),a.writeAttributeString("draw:color-inversion","false"),a.writeAttributeString("draw:image-opacity","100%"),a.writeAttributeString("draw:color-mode","standard"),a.writeEndElement(),a.writeEndElement(),a.writeEndElement(),a.writeStartElement("office:body"),a.writeStartElement("office:text"),a.writeStartElement("office:forms"),a.writeAttributeString("form:automatic-focus","false"),a.writeAttributeString("form:apply-design-mode","false"),a.writeEndElement(),a.writeStartElement("text:sequence-decls"),a.writeStartElement("text:sequence-decl"),a.writeAttributeString("text:display-outline-level","0"),a.writeAttributeString("text:name","Illustration"),a.writeEndElement(),a.writeStartElement("text:sequence-decl"),a.writeAttributeString("text:display-outline-level","0"),a.writeAttributeString("text:name","Table"),a.writeEndElement(),a.writeStartElement("text:sequence-decl"),a.writeAttributeString("text:display-outline-level","0"),a.writeAttributeString("text:name","Text"),a.writeEndElement(),a.writeStartElement("text:sequence-decl"),a.writeAttributeString("text:display-outline-level","0"),a.writeAttributeString("text:name","Drawing"),a.writeEndElement(),a.writeEndElement(),s=mt.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems),a.writeStartElement("table:table"),a.writeAttributeString("table:name","Table1"),a.writeAttributeString("table:style-name","Table1");for(let t=0;t<this.matrix.coordX.countItems-1;t++)a.writeStartElement("table:table-column"),a.writeAttributeString("table:style-name",pt.format("Table1.{0}",this.getColumnName(t))),a.writeEndElement();var v=Math.max(this.matrix.coordY.countItems/200,1);let E=0;for(let n=1;n<this.matrix.coordY.countItems;n++){var b=n/v|0;b>E&&(E=b,this.invokeExporting2(n,this.matrix.coordY.countItems,this.currentPassNumber,this.maximumPassNumber)),a.writeStartElement("table:table-row"),a.writeAttributeString("table:style-name",`Table1.`+(m[n-1]+1));for(let r=1;r<this.matrix.coordX.countItems;r++){let i=this.matrix.cells[n-1][r-1];if(s[n][r])a.writeStartElement("table:covered-table-cell"),a.writeEndElement();else if(null!=i){for(let e=0;e<=i.height;e++)for(let t=0;t<=i.width;t++)s[n+e][r+t]=!0;var x=o[n-1][r-1],y=this.getParagraphStyleNumber(n-1,r-1),A,x,T,x,T,P,A;if(a.writeStartElement("table:table-cell"),a.writeAttributeString("table:style-name",`cell`+(x+1)),0<i.width&&a.writeAttributeString("table:number-columns-spanned",(i.width+1).toString()),0<i.height&&a.writeAttributeString("table:number-rows-spanned",(i.height+1).toString()),a.writeAttributeString("office:value-type","string"),i.component.is(lt)&&!i.component.isExportAsImage(at.a.StiExportFormat.Odt)&&null!=i.text){let t=i.text,e=(0!=this.paragraphStyleList[y].stimulsoft().as(ci).Angle&&(t=t.stimulsoft().replaceAll("\n"," ")),at.c.StiExportUtils.splitString(t,!0));for(let t=0;t<e.stimulsoft().countItems;t++){var L=e[t];a.writeStartElement("text:p"),a.writeAttributeString("text:style-name",`par`+(y+1)),a.writeString(L),a.writeEndElement()}}if(i.component.isExportAsImage(at.a.StiExportFormat.Odt)){let t=i.component.stimulsoft().as(Lt);null!=t&&(x={ref:this.imageResolution},T=t.getImage(x),A=x.ref,null!=T&&(x=this.imageCache.addImageIntRaw(T,T.imageFormat),T=this.matrix.coordX.getByIndex(r+i.width)-this.matrix.coordX.getByIndex(r-1),P=this.matrix.coordY.getByIndex(n+i.height)-this.matrix.coordY.getByIndex(n-1),a.writeStartElement("text:p"),a.writeAttributeString("text:style-name","Table_20_Contents"),a.writeStartElement("draw:frame"),a.writeAttributeString("draw:style-name","fr1"),a.writeAttributeString("draw:name",`Picture`+(x+1)),a.writeAttributeString("text:anchor-type","paragraph"),a.writeAttributeString("svg:width",this.doubleToString(T)),a.writeAttributeString("svg:height",this.doubleToString(P)),a.writeAttributeString("draw:z-index","0"),a.writeStartElement("draw:image"),a.writeAttributeString("xlink:href",pt.format("Pictures/{0:D5}.jpg",x+1)),a.writeAttributeString("xlink:type","simple"),a.writeAttributeString("xlink:show","embed"),a.writeAttributeString("xlink:actuate","onLoad"),a.writeEndElement(),a.writeEndElement(),a.writeEndElement()))}a.writeEndElement()}else{var T=o[n-1][r-1];a.writeStartElement("table:table-cell"),a.writeAttributeString("table:style-name",`cell`+(T+1)),a.writeEndElement()}}a.writeEndElement()}return a.writeEndElement(),a.writeStartElement("text:p"),a.writeAttributeString("text:style-name","parEnd"),a.writeEndElement(),a.writeEndElement(),a.writeEndElement(),a.writeFullEndElement(),a.writeEndDocument(),a.flush(),t}exportOdt(i,r,t){if(at.a.StiLogService.write(this.stimulsoft().getType(),"Export report to ODT format"),null==t)throw new Error("The 'settings' argument cannot be equal in null.");let n=t.pageRange;this.usePageHeadersAndFooters=t.usePageHeadersAndFooters,this.removeEmptySpaceAtBottom=t.removeEmptySpaceAtBottom,this.imageResolution=t.imageResolution,this.imageQuality=t.imageQuality,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100;try{this.imageCache=new at.a.StiImageCache(rt["StiOptions"].Export.OpenDocumentWriter.allowImageComparer,!0,v.Jpeg,this.imageQuality,!1),this.cellStyleList=[],this.paragraphStyleList=[],this.currentPassNumber=0,this.maximumPassNumber=3+(rt["StiOptions"].Export.OpenDocumentWriter.divideSegmentPages?1:0);let t=n.getSelectedPages(i.renderedPages);if(rt["StiOptions"].Export.OpenDocumentWriter.divideSegmentPages&&(t=at.c.StiSegmentPagesDivider.divide(t,this),this.currentPassNumber++),this.isStopped)return;let e=new u;if(e.begin(r,!0),this.matrix=new at.c.StiMatrix(t,!0,this),this.currentPassNumber=2+(rt["StiOptions"].Export.OpenDocumentWriter.divideSegmentPages?1:0),e.addFile("content.xml",this.writeContent()),e.addFile("mimetype",this.writeMimetype()),e.addFile("meta.xml",this.writeMeta()),e.addFile("META-INF/manifest.xml",this.writeManifest()),e.addFile("settings.xml",this.writeSettings()),e.addFile("styles.xml",this.writeStyles(t)),0<this.imageCache.imagePackedStore.stimulsoft().countItems)for(let t=0;t<this.imageCache.imagePackedStore.stimulsoft().countItems;t++)e.addFile(pt.format("Pictures/{0:D5}.jpg",t+1),this.writeImage(t));e.end()}finally{null!=this.matrix&&(this.matrix.clear(),this.matrix=null),this.cellStyleList.stimulsoft().clear(),this.cellStyleList=null,this.paragraphStyleList.stimulsoft().clear(),this.paragraphStyleList=null,this.imageCache.clear(),this.imageCache=null,i.renderedPages.cacheMode&&at.c.StiMatrix.GCCollect()}}}}{class gi{}at.c.StiRtfExportService=class extends at.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1,this.colorList=null,this.fontList=null,this.styleList=null,this.unicodeMapArray=null,this.codePageToFont=null,this.charsetCount=0,this.fontToCodePages=null,this.baseFontNumber=0,this.usePageHeadersAndFooters=!1,this.imageResolution=.96,this.imageQuality=.75,this.imageFormat=at.a.StiExportFormat.Rtf,this.useStyles=!1,this.bookmarkList=null,this.usedBookmarks=null}get defaultExtension(){return"rtf"}get exportFormat(){return at.a.StiExportFormat.Rtf}get groupCategory(){return"Word"}get position(){return at.c.StiExportPosition.Rtf}get exportNameInMenu(){return t.get("Export","ExportTypeRtfFile")}getFilter(){return t.get("FileFilters","RtfFiles")}exportTo(t,e,i){}getColorNumberInt(e,i){if(0<e.length)for(let t=0;t<e.length;t++)if(e[t].equals(i))return t;var t;return e.push(i),e.length-1}getColorNumber(t,e){return this.getColorNumberInt(t,e).toString()}getFontNumber2(e,i){if(0<e.length)for(let t=0;t<e.length;t++){var r;if(e[t].name==i.name)return t*(0==this.charsetCount?1:this.charsetCount)}var t;return e.push(i),(e.length-1)*(0==this.charsetCount?1:this.charsetCount)}getFontNumber3(e,i,r){if(0<e.length)for(let t=0;t<e.length;t++){var n;if(e[t].name==i.name)return t*(0==this.charsetCount?1:this.charsetCount)+this.getCharsetIndex(r)}var t;return e.push(i),(e.length-1)*(0==this.charsetCount?1:this.charsetCount)+this.getCharsetIndex(r)}getCharsetIndex(t){var e=0;if(0==this.charsetCount)return this.codePageToFont[e]=1,0;return this.codePageToFont[e]}}}let a=at.c.StiTxtBorderType,Ct=at.a.Components.IStiTextHorAlignment,Ft=at.a.Components.IStiVertAlignment,it=rt.Base.Drawing.StiTextRenderer,kt=rt.Base.Drawing.StiHtmlState,St=at.a.Components.IStiTextOptions,ut=rt.System.Text.StringBuilder;{class hi extends at.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1,this.borderCodes=[6,9,12,10,5,3,13,11,14,7,15,1,2,4,8],this.firstEscapeCodeIndex=63742,this.ltrMark=" 0E",this.useFullVerticalBorder=!0,this.useFullHorizontalBorder=!0}implements(){return[at.c.IStiTxtExportService]}get defaultExtension(){return"txt"}exportTo(t,e,i){this.exportTxt(t,e,i)}get exportFormat(){return at.a.StiExportFormat.Text}get groupCategory(){return"Word"}get position(){return at.c.StiExportPosition.Txt}get exportNameInMenu(){return t.get("Export","ExportTypeTxtFile")}getFilter(){return t.get("FileFilters","TxtFiles")}getBorderChar(t,e){if(this.useFullVerticalBorder)switch(e){case a.UnicodeSingle:return"─│┌┐└┘├┤┬┴┼ ─  ".charCodeAt(t);case a.UnicodeDouble:return"═║╔╗╚╝╠╣╦╩╬ ═  ".charCodeAt(t);default:return"-|+++++++++ -  ".charCodeAt(t)}else switch(e){case a.UnicodeSingle:return"─│┌┐└┘├┤┬┴┼    ".charCodeAt(t);case a.UnicodeDouble:return"═║╔╗╚╝╠╣╦╩╬    ".charCodeAt(t);default:return"-|+++++++++    ".charCodeAt(t)}}lineFill(e,t,i,r){var n=this.borderCodes[t-1];for(let t=0;t<r;t++)-1==this.borderCodes.indexOf(e[i+t])?32==e[i+t]&&(e[i+t]=n):e[i+t]|=n}lineFillChar(e,i,r,n){for(let t=0;t<n;t++)e[r+t]=i}checkWordWrap(t,e,i,r){let n=e.ref;if(this.useEscapeCodes)for(let t=0;t<n.length;t++){var a=n[t];let i=new ut(a);if(at.c.StiBidirectionalConvert.stringContainArabicOrHebrew(a)){let t=a.length;while(ot.isWhitespace(a,t-1))t--;i.insert(t,"<#ltrMark>")}let r=0;while(r<i.length){if("<"==i.charAt(r)&&r<i.length+1&&"#"==i.charAt(r+1)){let t=r,e=new ut;while("<"==i.charAt(t)&&t<i.length+1&&"#"==i.charAt(t+1)){while(t<i.length&&">"!=i.charAt(t))e.append(i.charAt(t)),t++;if(e.append(">"),++t>i.length-1)break}t>i.length-1?0<r?(r--,e.insert(0,i[r])):e.append(String.fromCharCode(65535)):(e.append(i.charAt(t)),t++);var s=this.getEscapeNumber(this.escapeCodesList,e.toString());i.remove(r,t-r),i.insert(r,String.fromCharCode(this.firstEscapeCodeIndex-s))}r++}i.length!=n[t].length&&(n[t]=i.toString())}else for(let i=0;i<n.length;i++)if(at.c.StiBidirectionalConvert.stringContainArabicOrHebrew(n[i])){let t=n[i],e=t.length-1;while(ot.isWhitespace(t,e))e--;var o=t.charAt(e)+this.ltrMark,o=this.getEscapeNumber(this.escapeCodesList,o);e==t.length-1?n[i]=t.substring(0,e)+String.fromCharCode(this.firstEscapeCodeIndex-o):n[i]=t.substring(0,e)+String.fromCharCode(this.firstEscapeCodeIndex-o)+t.substring(e+1)}let l=i,m=(this.useFullVerticalBorder?this.needVerticalBorders[t.left+t.width]&&l--:!this.useFullTextBoxWidth&&1<l&&l--,!1);var i=t.component.stimulsoft().as(St);if(m=null!=i?i.textOptions.wordWrap:m){let o=n.stimulsoft().clone();for(let s=0;s<o.length;s++){let a=o[s];if(a.length>l-1&&1<l){let e=mt.create(Number,a.length),i=0,r=0;while(" "==a.charAt(r))e[r]=i,r++;for(let t=r;t<a.length;t++)" "==a.charAt(t)&&i++,e[t]=i;let t=l-1-1,n=t;if(0<e[t])if(e[t]!=e[t+1]){n=t++;while(" "==a.charAt(t))t++}else{while(" "!=a.charAt(t))t--;n=t++;while(" "==a.charAt(n))n--}else t++;o[s]=a.substring(0,n+1),o.stimulsoft().insert(s+1,a.substr(t,a.length-t))}}o.length>n.length&&(n=o)}if(r)for(let t=0;t<n.length;t++)n[t].length>l&&(n[t]=n[t].substring(0,l));e.ref=n}checkGrow(t,e,i){while(t.length<=i)t.push([]),e.push(!1)}addCharsToLine(e,i,r,n){for(let t=0;t<r;t++)e[i].push(n)}getStyleNumber(e,i){if(0<e.length)for(let t=0;t<e.length;t++){var r=e[t];if(r.Bold==i.Bold&&r.Italic==i.Italic&&r.Underline==i.Underline&&r.Codes==i.Codes)return t}var t;return e.push(i),e.length-1}getEscapeNumber(e,i){if(0<e.length)for(let t=0;t<e.length;t++)if(e[t]==i)return t+1;var t;return e.push(i),e.length}getEscapeNames(t,e){var t=this.styleList[t],e=this.styleList[e];let i=new ut;return!t.Bold&&e.Bold&&i.append("<#b>"),t.Bold&&!e.Bold&&i.append("<#/b>"),!t.Italic&&e.Italic&&i.append("<#i>"),t.Italic&&!e.Italic&&i.append("<#/i>"),!t.Underline&&e.Underline&&i.append("<#u>"),t.Underline&&!e.Underline&&i.append("<#/u>"),i}exportTxt(t,M,e){if(at.a.StiLogService.write(this.stimulsoft().getType(),"Export report to Text format"),this.report=t,null==e)throw new Error("The 'settings' argument cannot be equal in null.");let H=e.pageRange;var i=e.encoding,n=e.drawBorder,a=e.borderType,s=e.killSpaceLines;let o=e.killSpaceGraphLines;var l=e.putFeedPageCode,h=e.cutLongLines,r=e.zoomX,O=e.zoomY,m=(this.useEscapeCodes=e.useEscapeCodes,this.useFullTextBoxWidth=rt["StiOptions"].Export.Text.useFullTextBoxWidth,this.useFullVerticalBorder=rt["StiOptions"].Export.Text.useFullVerticalBorder,this.useFullHorizontalBorder=rt["StiOptions"].Export.Text.useFullHorizontalBorder,9.7),U=18;0==s&&(o=!1),0==n&&(o=!1),this.useFullVerticalBorder&&(this.useFullTextBoxWidth=!1);let c=new tt,g=null!=i?new et(c,i):new et(c);var e=H.getSelectedPages(t.renderedPages);let p=0;this.styleList=[];var i=new pi,w,t,i;this.getStyleNumber(this.styleList,i),this.escapeCodesList=[],this.currentPassNumber=0,this.maximumPassNumber=3;let d=new at.c.StiMatrix(e,!1,this);if(this.isStopped)return;this.needVerticalBorders=mt.create(Boolean,d.coordX.countItems);for(let i=1;i<d.coordX.countItems;i++){let e=!1;for(let t=1;t<d.coordY.countItems;t++)if(null!=d.bordersY[t-1][i]){e=!0;break}this.needVerticalBorders[i-1]=e}this.needHorizontalBorders=mt.create(Boolean,d.coordY.countItems);for(let i=1;i<d.coordY.countItems;i++){let e=!1;for(let t=1;t<d.coordX.countItems;t++)if(null!=d.bordersX[i][t-1]){e=!0;break}this.needHorizontalBorders[i-1]=e}let S=mt.create(Number,d.coordX.countItems);for(let t=1;t<d.coordX.countItems;t++){var W=d.coordX.getByIndex(t),X=d.coordX.getByIndex(t-1);S[t-1]=Math.round((W-X)/(m/r)),this.useFullVerticalBorder&&this.needVerticalBorders[t-1]&&S[t-1]++}let u=mt.create2(Boolean,d.coordY.countItems,d.coordX.countItems),f=mt.create2(Number,d.coordY.countItems,d.coordX.countItems),v=mt.create2(Number,d.coordY.countItems,d.coordX.countItems);for(let a=1;a<d.coordY.countItems;a++)for(let n=1;n<d.coordX.countItems;n++)if(!u[a-1][n-1]){let r=d.cells[a-1][n-1];if(f[a-1][n-1]=S[n-1],null!=r){if(0<r.width)for(let t=0;t<r.width;t++)f[a-1][n-1]+=S[n-1+1+t];if(null!=r.component){if(null!=r.component){let t=r.component.tagValue;pt.isNullOrWhiteSpace(t)||(t=t.trim(),w=parseInt(t),!isNaN(w)&&0<w&&(f[a-1][n-1]=w,this.useFullVerticalBorder&&this.needVerticalBorders[n-1+r.width]&&f[a-1][n-1]++))}let i=r.text;var w=r.component.stimulsoft().as(nt);if(null!=w&&null!=w.checkedValue){let t=!1,e=!1;"boolean"==typeof w.checkedValue&&(w.checkedValue?t=!0:e=!0),"string"==typeof w.checkedValue&&("True"==w.checkedValue?t=!0:e=!0),t&&(i=rt["StiOptions"].Export.Text.checkBoxTextForTrue),e&&(i=rt["StiOptions"].Export.Text.checkBoxTextForFalse)}if(!r.component.isExportAsImage(at.a.StiExportFormat.Text)&&!pt.isNullOrEmpty(i)){if(r.component.is(lt)&&r.component.checkAllowHtmlTags()){var E=new kt(""),E=it.parseHtmlToStates(i,E),b;let t=new ut;for(b of E)t.append(it.prepareStateText(b.text));i=t.toString()}var z,E={ref:z=at.c.StiExportUtils.splitString(i.stimulsoft().replaceAll("\r",""),!1)},V=(this.checkWordWrap(r,E,f[a-1][n-1],h),(z=E.ref).length);v[a-1][n-1]=V}}for(let e=0;e<=r.height;e++){for(let t=0;t<=r.width;t++)u[a-1+e][n-1+t]=!0;f[a-1+e][n-1]=f[a-1][n-1]}}}let x=mt.create(Number,d.coordY.countItems);for(let i=p=1;i<d.coordY.countItems;i++){var G=d.coordY.getByIndex(i),Y=d.coordY.getByIndex(i-1);let e=Math.round((G-Y)/(U/O));e<1&&(e=1);for(let t=1;t<d.coordX.countItems;t++){var j=d.cells[i-1][t-1];null!=j&&j.height<1&&v[i-1][t-1]>e&&(e=v[i-1][t-1])}this.useFullHorizontalBorder&&this.needHorizontalBorders[i-1]&&e++,x[i-1]=e,p+=e}p++;let y=[],A=[],T=[];for(let t=0;t<p;t++)y.push([]),A.push([]),T.push(!1);u=mt.create2(Boolean,d.coordY.countItems,d.coordX.countItems);let P=n?1:0,L=new lt;L.vertAlignment=dt.Center,L.horAlignment=wt.Center,this.currentPassNumber=2;for(let g=1;g<d.coordY.countItems;g++){this.invokeExporting2(g,d.coordY.countItems,this.currentPassNumber,this.maximumPassNumber);for(let t=0;t<d.horizontalPageBreaks.length;t++)d.horizontalPageBreaks[t]==g-1&&(T[P-(n&&1<g&&this.needHorizontalBorders[g-1-1]?1:0)]=!0);let c=n?1:0;for(let m=1;m<d.coordX.countItems;m++){let o=d.cells[g-1][m-1];var C=f[g-1][m-1];let l=x[g-1];if(!u[g-1][m-1]){let a=0,s=0,r=0;if(null!=o){a=o.width,s=o.height;for(let e=0;e<=o.width;e++)for(let t=0;t<=o.height;t++)u[g-1+t][m-1+e]=!0;if(0<o.height)for(let t=0;t<o.height;t++)l+=x[g-1+1+t];if(this.useFullHorizontalBorder&&this.needHorizontalBorders[g-1+s]&&l--,null!=o.component){var F=o.component.stimulsoft().as(lt);if(null!=F){let t=new pi;t.Bold=F.font.bold,t.Italic=F.font.italic,t.Underline=F.font.underline,t.Codes=null,r=this.getStyleNumber(this.styleList,t)}let i=o.text;var k=o.component.stimulsoft().as(nt);if(null!=k&&null!=k.checkedValue){let t=!1,e=!1;"boolean"==typeof k.checkedValue&&(k.checkedValue?t=!0:e=!0),"string"==typeof k.checkedValue&&("True"==k.checkedValue?t=!0:e=!0),t&&(i=rt["StiOptions"].Export.Text.checkBoxTextForTrue),e&&(i=rt["StiOptions"].Export.Text.checkBoxTextForFalse)}if(!o.component.isExportAsImage(at.a.StiExportFormat.Text)&&!pt.isNullOrEmpty(i)){if(o.component.is(lt)&&o.component.checkAllowHtmlTags()){var F=new kt(""),F=it.parseHtmlToStates(i,F),_;let t=new ut;for(_ of F)t.append(it.prepareStateText(_.text));i=t.toString()}let a=at.c.StiExportUtils.splitString(i.stimulsoft().replaceAll("\r",""),!1);var F={ref:a};this.checkWordWrap(o,F,f[g-1][m-1],h),a=F.ref;let s=0,t=o.component.stimulsoft().as(Ft);null!=(t=null!=k?L:t)&&a.length<l&&(0<(t.vertAlignment&dt.Center)&&(s=st.trunc((l-a.length)/2)),0<(t.vertAlignment&dt.Bottom)&&(s=l-a.length));for(let n=0;n<a.length;n++){let t=0,e=C,i=(this.useFullVerticalBorder?this.needVerticalBorders[o.left+o.width]&&e--:!this.useFullTextBoxWidth&&1<e&&e--,o.component.stimulsoft().as(Ct)),r=(null!=(i=null!=k?L:i)&&(i.horAlignment==wt.Center&&(t=st.trunc((e-a[n].length)/2)),i.horAlignment==wt.Right&&(t=e-a[n].length)),c+t);var I=P+s+n,q=(r=r<0?0:r)+a[n].length;this.checkGrow(y,T,I),y[I].length<q&&this.addCharsToLine(y,I,q-y[I].length,32);for(let e=0;e<a[n].length;e++){let t=a[n].charCodeAt(e);t<32&&(t+=65280),y[I][r+e]=t}}}}}else this.useFullHorizontalBorder&&this.needHorizontalBorders[g-1]&&l--;this.useFullHorizontalBorder||l--;for(let e=0;e<l;e++){A[P+e].length<c+C&&this.addCharsToLine(A,P+e,c+C-A[P+e].length,0);let t=C;this.useFullVerticalBorder?null!=o&&this.needVerticalBorders[o.left+o.width]&&t--:!this.useFullTextBoxWidth&&1<t&&t--,this.lineFillChar(A[P+e],r,c,t)}if(n){var K=c+C-1;for(let t=-1;t<=l;t++)this.checkGrow(y,T,P+t),y[P+t].length<K+1&&this.addCharsToLine(y,P+t,K+1-y[P+t].length,32);let e=!0,i=!0;for(let t=0;t<s+1;t++)null==d.bordersY[g-1+t][m-1]&&(e=!1),null==d.bordersY[g-1+t][m-1+a+1]&&(i=!1);let r=!0,n=!0;for(let t=0;t<a+1;t++)null==d.bordersX[g-1][m-1+t]&&(r=!1),null==d.bordersX[g-1+s+1][m-1+t]&&(n=!1);if(r&&(this.lineFill(y[P-1],14,c-1,1),this.lineFill(y[P-1],1,c,C-1),this.lineFill(y[P-1],13,c+C-1,1)),e){this.lineFill(y[P-1],15,c-1,1);for(let t=0;t<l;t++)this.lineFill(y[P+t],2,c-1,1);this.lineFill(y[P+l],12,c-1,1)}if(i){this.lineFill(y[P-1],15,c+C-1,1);for(let t=0;t<l;t++)this.lineFill(y[P+t],2,c+C-1,1);this.lineFill(y[P+l],12,c+C-1,1)}n&&(this.lineFill(y[P+l],14,c-1,1),this.lineFill(y[P+l],1,c,C-1),this.lineFill(y[P+l],13,c+C-1,1))}}c+=C}P+=x[g-1]}if(n){let e=!0;for(let t=0;t<y.length;t++)if(0<y[t].length&&32!=y[t][0]){e=!1;break}if(e)for(let t=0;t<y.length;t++)0<y[t].length&&y[t].stimulsoft().removeRange(0,1),0<A[t].length&&A[t].stimulsoft().removeRange(0,1)}rt.Base.gVpwr.mgdPW.olcUT()||rt.Base.gVpwr.mgdPW.HdOnK()||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud()||rt.Base.gVpwr.mgdPW.DnFeB())&&rt.System.NodeJs.isStandaloneVersion||(t=(d.coordX.getByIndex(d.coordX.countItems-1)-d.coordX.getByIndex(0))/(m/r),i=Math.max(1,st.trunc(t/2-10)),g.writeLine(pt.fill(" ",i)+"---=== TRIAL ===---\r\n"));let B=y.length-1;while(0<B&&0==y[B].length)B--;let D=0;for(let r=0;r<y.length;r++){if(0<y[r].length){for(let t=0;t<this.borderCodes.length;t++){var Q=this.borderCodes[t],Z=this.getBorderChar(t,a);for(let t=0;t<y[r].length;t++)y[r][t]==Q&&(y[r][t]=Z)}if(rt["StiOptions"].Export.Text.trimTrailingSpaces,o){var J=this.getBorderChar(1,a);let e=!0;for(let t=0;t<y[r].length;t++){var $=y[r][t];$!=J&&32!=$&&(e=!1)}e&&(y[r]=[])}l&&T[r]&&(this.useEscapeCodes&&g.write(this.getEscapeNames(D,0).toString()),D=0,g.write("\f")),this.useEscapeCodes}var R=y[r];if(!s&&r<=B||0<R.length){let t=R.length;if(rt["StiOptions"].Export.Text.trimTrailingSpaces)while(0<t&&32==R[t-1])t--;let i="";for(let e=0;e<t;e++){let t=R[e];65280<=t&&(t-=65280),i+=String.fromCharCode(t)}rt["StiOptions"].Export.Text.removeLastNewLineMarker&&r==B?g.write(i):g.writeLine(i)}}let N=new ut;this.useEscapeCodes&&N.append(this.getEscapeNames(D,0)),l&&N.append("\f"),0<N.length&&g.write(N.toString()),g.flush(),this.useEscapeCodes,c.writeTo(M),c.close(),this.needVerticalBorders=null,this.needHorizontalBorders=null,this.styleList=null,this.escapeCodesList=null}}at.c.StiTxtExportService=hi;class pi{}}let It=at.a.Components.StiRectanglePrimitive,s=rt.System.Globalization.UnicodeCategory,o=rt.Base.Drawing.StiTextOptions,Bt=at.a.Components.IStiTextBrush,Dt=at.a.Components.IStiFont,Rt=at.a.Components.IStiText,Nt=at.a.Components.StiShape,m=rt.Base.Drawing.RectangleD,_=rt.Base.Drawing.StiTextDrawing,w=rt.Base.Drawing.StiBorderSide,ft=rt.Base.Drawing.StiBorderSides,Mt=rt.Base.Drawing.StiAdvancedBorder,Ht=at.a.Components.IStiBorder,vt=rt.Base.Drawing.StiGradientBrush,D=at.a.Components.StiRichText,Ot=at.a.Components.IStiBrush,E=at.a.Components.StiImage,Et=rt.Base.Drawing.StiBrush,Ut=at.a.Components.StiContainer,bt=rt.Base.Drawing.StiPenStyle;{class wi{get right(){return this.x+this.width}get bottom(){return this.y+this.height}}class di extends at.c.StiExportService{constructor(){super(...arguments),this.defaultExtension="xps",this.groupCategory="Document",this.position=at.c.StiExportPosition.Xps,this.exportNameInMenu=t.get("Export","ExportTypeXpsFile"),this.multipleFiles=!1,this.hiToDpi=96/100,this.xmlIndentation=1,this.precision_digits=3,this.reduceFontSize=!0,this.useImageComparer=!0,this.imageQuality=.75,this.imageResolution=96,this.fontCorrectValue=1.333333*this.hiToDpi,this.exportRtfTextAsImage=!0}get exportFormat(){return at.a.StiExportFormat.Xps}exportTo(t,e,i){this.exportXps(t,e,i),this.invokeExporting2(100,100,1,1)}exportToAsync(t,e,i,r){setTimeout(async()=>{await at.c.StiExportImageHelper.convertAllImages(e,rt.System.Drawing.Imaging.ImageFormat.Jpeg,!1,this.exportFormat),this.exportTo(e,i,r),null!=e&&null!=e.preparedExportImages&&(e.preparedExportImages.clear(),e.preparedExportImages=null),t()},0)}getFilter(){return t.get("FileFilters","XpsFiles")}isWordWrapSymbol(t,e){let i=" ";return e<t.length-1&&(i=t[e+1]),this.isWordWrapSymbol2(t[e],i)}isWordWrapSymbol2(t,e){var t=ot.getUnicodeCategory(t),e=ot.getUnicodeCategory(e);return t==s.OpenPunctuation||t==s.ClosePunctuation&&e!=s.OtherPunctuation||t==s.DashPunctuation||t==s.InitialQuotePunctuation||t==s.FinalQuotePunctuation||t==s.SpaceSeparator}floatToString(t){let e=this.precision_digits;Math.abs(t)<1&&(e=this.precision_digits+2);var t=st.round2(t,e);return rt.System.Internals.formatNumber(t,"G")}prepareData(){this.pdfFont=new at.c.PdfFonts,this.pdfFont.standardPdfFonts=!1,this.pdfFont.maxSymbols=32767,this.pdfFont.fontList=[],this.imageCache=new at.a.StiImageCache(this.useImageComparer,!0,v.Jpeg,this.imageQuality)}getTabsSize(t,e,i){if(null==t||null==t.textOptions)return 0;let r=i;var e=750/e,n=e*t.textOptions.distanceBetweenTabs,e=e*t.textOptions.firstTabOffset+n,t;return i<e?r=e:0<t.textOptions.distanceBetweenTabs&&(t=Math.trunc((i-e)/n),t++,r=e+t*n),r-i}static convertToEscapeSequence(i){var r=""+String.fromCharCode(13)+String.fromCharCode(10)+String.fromCharCode(8)+String.fromCharCode(12),n="rnbf";let a,s;if(null==i)return"";s="";for(let e=0;e<i.length;e++){a=!1;for(let t=0;t<r.length;t++)if(i[e]==r[t]){s+="\\"+n[t],a=!0;break}a||(s+=i[e])}return s}getLineStyleDash(t){switch(t){case bt.Dot:return"1.1 1.1";case bt.Dash:return"3 1";case bt.DashDot:return"3 1 1 1";case bt.DashDotDot:return"3 1 1 1 1 1";default:return""}}checkGraphicsForTextRenderer(){}writeContentTypes(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("Types"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types"),e.writeStartElement("Default"),e.writeAttributeString("Extension","jpg"),e.writeAttributeString("ContentType","image/jpeg"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","png"),e.writeAttributeString("ContentType","image/png"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","rels"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","xml"),e.writeAttributeString("ContentType","application/xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","fdseq"),e.writeAttributeString("ContentType","application/vnd.ms-package.xps-fixeddocumentsequence+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","fpage"),e.writeAttributeString("ContentType","application/vnd.ms-package.xps-fixedpage+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","ttf"),e.writeAttributeString("ContentType","application/vnd.ms-opentype"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","fdoc"),e.writeAttributeString("ContentType","application/vnd.ms-package.xps-fixeddocument+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/core.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeMainRels(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.microsoft.com/xps/2005/06/fixedrepresentation"),e.writeAttributeString("Target","FixedDocSeq.fdseq"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsCore(t){var e=new tt;let i=new F(V.UTF8,e);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?C.None:C.Indented,i.writeStartDocument(),i.writeStartElement("cp:coreProperties"),i.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),i.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),i.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),i.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),i.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");var r=gt.now.toString("yyyy-MM-ddTHH:mm:ssZ");return i.writeStartElement("dcterms:created"),i.writeAttributeString("xsi:type","dcterms:W3CDTF"),i.writeString(r),i.writeEndElement(),i.writeStartElement("dcterms:modified"),i.writeAttributeString("xsi:type","dcterms:W3CDTF"),i.writeString(r),i.writeEndElement(),pt.isNullOrEmpty(t.reportName)||i.writeElementString("dc:title",t.reportName),pt.isNullOrEmpty(t.reportAlias)||i.writeElementString("dc:subject",t.reportAlias),pt.isNullOrEmpty(t.reportDescription)||i.writeElementString("dc:description",t.reportDescription),i.writeElementString("dc:creator",at.c.StiExportUtils.getReportVersion(t)),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeFixedDocSeq(){var t=new tt;let e=new F(V.Unicode,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartElement("FixedDocumentSequence"),e.writeAttributeString("xmlns","http://schemas.microsoft.com/xps/2005/06"),e.writeStartElement("DocumentReference"),e.writeAttributeString("Source","/Documents/1/FixedDoc.fdoc"),e.writeEndElement(),e.writeFullEndElement(),e.flush(),t}writeFixedDoc(t){var e=new tt;let i=new F(V.Unicode,e);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?C.None:C.Indented,i.writeStartElement("FixedDocument"),i.writeAttributeString("xmlns","http://schemas.microsoft.com/xps/2005/06");for(let e=0;e<t.length;e++){i.writeStartElement("PageContent"),i.writeAttributeString("Source",`Pages/${e+1}.fpage`);let t=[];for(var r of this.pageBookmarks.keys)this.pageBookmarks.get(r).value==e&&t.push(r);if(0<t.length){i.writeStartElement("PageContent.LinkTargets");for(var n of t)i.writeStartElement("LinkTarget"),i.writeAttributeString("Name",n),i.writeEndElement();i.writeFullEndElement()}i.writeFullEndElement()}return i.writeFullEndElement(),i.flush(),e}writePage(e,i){var t=new tt;let r=new F(V.Unicode,t);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?C.None:C.Indented;var n=this.hiToDpi*i.unit.convertToHInches(e.pageHeight*e.segmentPerHeight),a=this.hiToDpi*i.unit.convertToHInches(e.pageWidth*e.segmentPerWidth),s=this.hiToDpi*i.unit.convertToHInches(e.margins.left),o=this.hiToDpi*i.unit.convertToHInches(e.margins.right),l=this.hiToDpi*i.unit.convertToHInches(e.margins.top),m=this.hiToDpi*i.unit.convertToHInches(e.margins.bottom),c;if(r.writeStartElement("FixedPage"),r.writeAttributeString("xmlns","http://schemas.microsoft.com/xps/2005/06"),r.writeAttributeString("Width",this.floatToString(a)),r.writeAttributeString("Height",this.floatToString(n)),r.writeAttributeString("xml:lang","en-EN"),r.writeStartElement("Canvas"),this.writeHyperlinksData(r,e,!1),null!=e.brush){let t=new wi;t.x=0,t.y=0,t.width=a,t.height=n,t.component=new Ut,t.component.brush=e.brush,t.component.border=null,this.writeBorderFill(r,t)}this.writeWatermark(r,e.watermark,!0,a,n);for(c of e.components.list){var g=0<c.width&&0<c.height;if(c.enabled&&g){var g=this.hiToDpi*i.unit.convertToHInches(c.left),h=this.hiToDpi*i.unit.convertToHInches(c.top),p=this.hiToDpi*i.unit.convertToHInches(c.right),w=this.hiToDpi*i.unit.convertToHInches(c.bottom);let t=new wi;t.x=g,t.y=h,t.width=p-g,t.height=w-h,t.y+=l,t.x+=s,(t.component=c).is(Nt)||this.writeBorderFill(r,t),c.is(lt)&&!c.isExportAsImage(at.a.StiExportFormat.Xps)&&this.writeText(r,t),c.isExportAsImage(at.a.StiExportFormat.Xps)&&this.writeImage(r,t),this.writeBorderStroke(r,t)}}if(null!=e.border){let t=new wi;t.x=s,t.y=l,t.width=a-s-o,t.height=n-l-m,t.component=new Ut,t.component.border=e.border,this.writeBorderStroke(r,t)}if(this.writeWatermark(r,e.watermark,!1,a,n),!(rt.Base.gVpwr.mgdPW.olcUT()||rt.Base.gVpwr.mgdPW.HdOnK()||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud()||rt.Base.gVpwr.mgdPW.DnFeB())&&rt.System.NodeJs.isStandaloneVersion)){let t=a/794*1.75,e=n/1123*1.75;t>e?t=e:e=t,r.writeStartElement("Canvas"),r.writeAttributeString("RenderTransform",pt.format("{0},0,0,{1},{2},{3}",this.floatToString(t),this.floatToString(e),this.floatToString(a/2),this.floatToString(n/2))),r.writeStartElement("Canvas"),r.writeAttributeString("RenderTransform","0.707,-0.707,0.707,0.707,0,0"),r.writeStartElement("Path"),r.writeAttributeString("Stroke",pt.format("#{0:X8}",1080321124)),r.writeAttributeString("StrokeThickness",this.floatToString(15)),r.writeAttributeString("StrokeStartLineCap","Round"),r.writeAttributeString("StrokeEndLineCap","Round"),r.writeAttributeString("StrokeLineJoin","Round");var o="",o=(o=(o+="M 40,0 L 40,100 M 0,100 L 80,100 ")+"M 100,0 L 100,70 M 100,45 L 120,65 L 130,72 L 140,68 "+"M 170,0 L 170,70 M 169,100 L 171,100 ")+"M 215,60 L 222,69 L 232,71 L 255,70 L 265,60 L 265,5 L 270,0 M 265,44 L 220,31 L 212,20 L 212,10 L 225,0 L 235,0 L 250,5 L 265,18 "+"M 310,0 L 310,100 ";r.writeAttributeString("Data",o),r.writeAttributeString("RenderTransform","1,0,0,-1,-155,50"),r.writeFullEndElement(),r.writeFullEndElement(),r.writeFullEndElement()}return r.writeEndElement(),r.writeFullEndElement(),r.flush(),t}writeBorderFill(n,a){let t=ht.transparent,s=a.component.as(Ot);null!=s&&null!=s.brush&&(t=Et.toColor(s.brush));var o=a.component.as(D);if(0!=(t=null!=o?o.backColor:t).a){if(n.writeStartElement("Path"),n.writeAttributeString("Data",pt.format("M {0},{1} L {0},{3} L {2},{3} L {2},{1} Z ",this.floatToString(a.x),this.floatToString(a.y),this.floatToString(a.x+a.width),this.floatToString(a.y+a.height))),a.component.is(lt)||a.component.is(E)||this.writeHyperlinksData(n,a.component,!1),n.writeStartElement("Path.Fill"),null!=s&&null!=s.brush&&s.brush.is(vt)){let t=s.brush,e=1,i=1,r=t.angle;r<0&&(r+=360),270<=r&&r<360&&(r=360-r,i=-1),180<=r&&r<270&&(r-=180,i=-1,e=-1),90<=r&&r<180&&(r=180-r,e=-1),r=r*Math.PI/180;var o=a.x+a.width/2,l=a.y+a.height/2,m=Math.sqrt(a.width*a.width+a.height*a.height)/2,c=Math.atan2(a.height,a.width),c=Math.PI/2-r+c,m=m*Math.sin(c),c=m*Math.cos(r)*e,m=m*Math.sin(r)*i,g=o-c,o=o+c,c=l-m,l=l+m;n.writeStartElement("LinearGradientBrush"),n.writeAttributeString("MappingMode","Absolute"),n.writeAttributeString("StartPoint",this.floatToString(g)+`,`+this.floatToString(c)),n.writeAttributeString("EndPoint",this.floatToString(o)+`,`+this.floatToString(l)),n.writeStartElement("LinearGradientBrush.GradientStops"),n.writeStartElement("GradientStop"),n.writeAttributeString("Color",pt.format("#{0:X8}",t.startColor.toArgb())),n.writeAttributeString("Offset","0"),n.writeEndElement(),n.writeStartElement("GradientStop"),n.writeAttributeString("Color",pt.format("#{0:X8}",t.endColor.toArgb())),n.writeAttributeString("Offset","1"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement()}else n.writeStartElement("SolidColorBrush"),n.writeAttributeString("Color",pt.format("#{0:X8}",t.toArgb())),n.writeEndElement();n.writeEndElement(),n.writeFullEndElement()}else!this.writeHyperlinksData(n,a.component,!0)||a.component.is(lt)||a.component.is(E)||(n.writeStartElement("Path"),n.writeAttributeString("Data",pt.format("M {0},{1} L {0},{3} L {2},{3} L {2},{1} Z ",this.floatToString(a.x),this.floatToString(a.y),this.floatToString(a.x+a.width),this.floatToString(a.y+a.height))),this.writeHyperlinksData(n,a.component,!1),n.writeEndElement())}writeBorderStroke(i,r){let n=r.component.as(Ht);if(null==n)return;if(n.border.dropShadow&&null!=n.border.shadowBrush){let t=Et.toColor(n.border.shadowBrush);var a;0!=t.a&&(a=n.border.shadowSize,i.writeStartElement("Path"),i.writeAttributeString("Data",pt.format("M {0},{4} L {1},{4} L {1},{3} L {2},{3} L {2},{5} L {0},{5} Z ",this.floatToString(r.x+a),this.floatToString(r.x+r.width),this.floatToString(r.x+r.width+a),this.floatToString(r.y+a),this.floatToString(r.y+r.height),this.floatToString(r.y+r.height+a))),i.writeStartElement("Path.Fill"),i.writeStartElement("SolidColorBrush"),i.writeAttributeString("Color",pt.format("#{0:X8}",t.toArgb())),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement())}var a=n.border.as(Mt),s=null!=a;let t=new It;r.component.is(It)&&(t=r.component);var o=n.border.isLeftBorderSidePresent&&t.leftSide,l=n.border.isRightBorderSidePresent&&t.rightSide,m=n.border.isTopBorderSidePresent&&t.topSide,c=n.border.isBottomBorderSidePresent&&t.bottomSide;let e=n.border.side!=ft.None&&n.border.style!=bt.None;s&&(e=a.side!=ft.None);var g=.9;let h=new w(n.border.color,n.border.size,n.border.style),p=0;if(h.style==bt.Double&&(p=g),e){let e="";if(o){s&&(h=a.leftSide,p=h.style==bt.Double?g:0);let t=pt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x-p),this.floatToString(r.y-p),this.floatToString(r.x-p),this.floatToString(r.y+p+r.height));h.style==bt.Double&&(t+=pt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x+p),this.floatToString(r.y+(m?p:-p)),this.floatToString(r.x+p),this.floatToString(r.y+(c?-p:p)+r.height))),s?this.writeBorderSide(i,h,t):e+=t}if(l){s&&(h=a.rightSide,p=h.style==bt.Double?g:0);let t=pt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x+p+r.width),this.floatToString(r.y-p),this.floatToString(r.x+p+r.width),this.floatToString(r.y+p+r.height));h.style==bt.Double&&(t+=pt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x-p+r.width),this.floatToString(r.y+(m?p:-p)),this.floatToString(r.x-p+r.width),this.floatToString(r.y+(c?-p:p)+r.height))),s?this.writeBorderSide(i,h,t):e+=t}if(m){s&&(h=a.topSide,p=h.style==bt.Double?g:0);let t=pt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x-p),this.floatToString(r.y-p),this.floatToString(r.x+p+r.width),this.floatToString(r.y-p));h.style==bt.Double&&(t+=pt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x+(o?p:-p)),this.floatToString(r.y+p),this.floatToString(r.x+(l?-p:p)+r.width),this.floatToString(r.y+p))),s?this.writeBorderSide(i,h,t):e+=t}if(c){s&&(h=a.bottomSide,p=h.style==bt.Double?g:0);let t=pt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x-p),this.floatToString(r.y+p+r.height),this.floatToString(r.x+p+r.width),this.floatToString(r.y+p+r.height));h.style==bt.Double&&(t+=pt.format("M {0},{1} L {2},{3} ",this.floatToString(r.x+(o?p:-p)),this.floatToString(r.y-p+r.height),this.floatToString(r.x+(l?-p:p)+r.width),this.floatToString(r.y-p+r.height))),s?this.writeBorderSide(i,h,t):e+=t}s||this.writeBorderSide(i,new w(n.border.color,n.border.size,n.border.style),e)}}writeBorderSide(t,e,i){let r=e.size,n=.9*(r=e.style==bt.Double?1:r),a=e.color;var e=this.getLineStyleDash(e.style);t.writeStartElement("Path"),t.writeAttributeString("Stroke",pt.format("#{0:X8}",a.toArgb())),t.writeAttributeString("StrokeThickness",n.toString()),t.writeAttributeString("StrokeStartLineCap","Square"),t.writeAttributeString("StrokeEndLineCap","Square"),""!=e&&(t.writeAttributeString("StrokeDashArray",e),t.writeAttributeString("StrokeDashCap","Flat")),t.writeAttributeString("Data",i),t.writeFullEndElement()}writeHyperlinksData(e,i,r){let n=!1;var t;if(null!=i.bookmarkValue&&""!=i.bookmarkValue&&(t=at.a.StiNameValidator.correctName(i.bookmarkValue.toString(),null,this.report),r||this.pageBookmarks.containsKey(t)||(e.writeAttributeString("Name",t),this.pageBookmarks.set(t,this.indexPage)),n=!0),null!=i.hyperlinkValue&&0<i.hyperlinkValue.toString().trim().length&&!i.hyperlinkValue.toString().trim().startsWith("javascript:")){let t=i.hyperlinkValue.toString().trim();r||(t.StartsWith("#")?(t=at.a.StiNameValidator.correctName(t.substr(1),null,this.report),e.writeAttributeString("FixedPage.NavigateUri",`../FixedDoc.fdoc#`+t)):e.writeAttributeString("FixedPage.NavigateUri",t)),n=!0}return n}writeText(S,o){var l=o.component.as(Rt);let r=o.component.as(lt);var t=o.component.as(Dt),n=o.component.as(Bt),u=o.component.as(St),f=o.component.as(Ct),v=o.component.as(Ft);let a=null!=u&&u.textOptions.wordWrap;var E=null!=f&&f.horAlignment==wt.Width,s=null!=u&&null!=u.textOptions&&u.textOptions.rightToLeft;let b=0,x=0,y=0,A=0;if(null!=t&&(y=this.pdfFont.getFontNumber(t.font),A=t.font.sizeInPoints*this.fontCorrectValue,this.pageFonts.set(y,y)),null!=l){let g=ht.transparent,h=(null!=n&&(g=Et.toColor(n.textBrush)),1);null!=t&&(h=t.font.sizeInPoints);var n=at.a.StiDpiHelper.graphicsScale,m=h*this.fontCorrectValue*this.pdfFont.tmASC/1e3*n,T=h*this.fontCorrectValue*this.pdfFont.tmDESC/1e3*-1*n,P=h*this.fontCorrectValue*this.pdfFont.tmExternal/1e3*n,L=h*this.fontCorrectValue*this.pdfFont.UnderscoreSize/1e3*n,C=h*this.fontCorrectValue*this.pdfFont.UnderscorePosition/1e3*n,F=h*this.fontCorrectValue*this.pdfFont.StrikeoutSize/1e3*n,n=h*this.fontCorrectValue*this.pdfFont.StrikeoutPosition/1e3*n,k=(m-T+P)*r.lineSpacing,P=m,m=T,T=r.margins.left,c=r.margins.right,I=r.margins.top,B=r.margins.bottom;let p=o.x+T,w=o.y+B,d=o.width-T-c,e=o.height-I-B;var T=2,c=1;p+=T,d-=2*T,w+=c,e-=2*c;let i=l.text;if(i=i.stimulsoft().replaceAll("\r",""),0<d&&0<i.length){S.writeStartElement("Canvas"),S.writeAttributeString("Clip",pt.format("M {0},{1} L {0},{3} L {2},{3} L {2},{1} Z ",this.floatToString(o.x),this.floatToString(o.y),this.floatToString(o.x+o.width),this.floatToString(o.y+o.height))),this.writeHyperlinksData(S,o.component,!1);let c=null;if(E){let t=r.page.unit.convertRectangleToHInches(o.component.componentToPage(o.component.clientRectangle));t=r.convertTextMargins(t,!1),(t=r.convertTextBorders(t,!1)).width/=at.a.StiDpiHelper.deviceCapsScale,t.height/=at.a.StiDpiHelper.deviceCapsScale,this.checkGraphicsForTextRenderer(),c=_.splitTextWordwrapWidth(i,null,r.font,t),a=!1}else c=at.c.StiExportUtils.splitString(i,!0);b=c.length;var T=p,D=w,R=d,N=e,M,M,V;if(null!=u&&0!=(x=u.textOptions.angle)&&((45<x&&x<135||225<x&&x<315)&&(M=d,d=e,e=M),p=-d/2,w=-e/2),S.writeStartElement("Canvas"),0!=x&&(M=-x*Math.PI/180,S.writeAttributeString("RenderTransform",pt.format("{0},{1},{2},{3},{4},{5}",this.floatToString(Math.cos(M)),this.floatToString(Math.sin(M)),this.floatToString(-Math.sin(M)),this.floatToString(Math.cos(M)),this.floatToString(T+R/2),this.floatToString(D+N/2)))),a)for(let m=0;m<c.length;m++){let i=c[m],r="",e=0;while(e<i.length)if(ot.isWhitespace(i[e]))r+=i[e],e++;else{let t="";while(e<i.length&&!ot.isWhitespace(i[e]))t+=i[e],e++;var H=at.c.StiBidirectionalConvert2.convertString(t,!1),H=(r+=H,t.length-H.length);0<H&&(r+=pt.fill(String.fromCharCode(0),H))}let n=mt.create(Number,i.length);for(let t=0;t<i.length;t++)n[t]=this.pdfFont.UnicodeMap[r.charCodeAt(t)];let a=mt.create(Number,i.length),s=mt.create(Number,i.length),o=0,l=0;for(let t=0;t<n.length;t++)32<=n[t]&&(l+=this.pdfFont.Widths[n[t]-32]),"\t"==String.fromCharCode(n[t])&&(l+=this.getTabsSize(u,h,l)),a[t]=l,this.isWordWrapSymbol(r,t)&&0<t&&o++,s[t]=o;if(l*(h*this.fontCorrectValue)/1e3>d){let t=i.length-1;var G=Math.trunc(1e3*d/(h*this.fontCorrectValue));while(a[t]>G&&0<t)t--;let e=t;if(0<s[t])if(s[t]!=s[t+1]){e=t++;while(ot.isWhitespace(r[t]))t++}else{while(!this.isWordWrapSymbol(r,t))t--;e=t-1;while(ot.isWhitespace(r[e])&&0<e)e--;while(ot.isWhitespace(r[t]))t++}else t++;c[m]=E?i.substr(0,e+1)+"a":i.substr(0,e+1),c.stimulsoft().insert(m+1,i.substr(t,i.length-t).stimulsoft().trimStart(" "))}}for(let t=0;t<c.length;t++){var O=c[t],O=at.c.StiBidirectionalConvert2.convertString(O,s);c[t]=O}if(null!=v){var Y,M=c.length*k;let t=v.vertAlignment;(t=0!=x&&90!=x&&180!=x&&270!=x?dt.Center:t)==dt.Top&&(w+=P),t==dt.Center&&(w+=(e-M)/2+P),t==dt.Bottom&&(w+=e-M+P)}let m=mt.create2(Number,c.length,3);for(let l=0;l<c.length;l++){let o=c[l];if(0<o.length){let i=mt.create(Number,o.length),r=0;for(let t=0;t<o.length;t++){var U=o.charCodeAt(t),U;32<=U&&(r+=this.pdfFont.Widths[this.pdfFont.UnicodeMap[U]-32]),"\t"==String.fromCharCode(U)&&(U=this.getTabsSize(u,h,r),r+=U,i[t]=U/10)}r=r*(h*this.fontCorrectValue)/1e3,"{"==(o=di.convertToEscapeSequence(o))[0]&&(o="{}"+o);let e=p;var W=w+k*l;if(null!=f){let t=f.horAlignment;if(E&&(0<o.length&&"a"==o[o.length-1]?o=o.substr(0,o.length-1):t=wt.Left),null!=u&&null!=u.textOptions&&u.textOptions.rightToLeft&&(t==wt.Left?t=wt.Right:t==wt.Right&&(t=wt.Left)),t==wt.Center&&(e+=(d-r)/2),t==wt.Right&&(e+=d-r),t==wt.Width){let e=0;for(let t=0;t<o.length;t++)" "==o[t]&&e++;if(0<e&&(l!=c.length-1||E)){var X=(d-r)/e*100/(h*this.fontCorrectValue);if(0<X){X+=this.pdfFont.Widths[0]/10;for(let t=0;t<o.length;t++)" "==o[t]&&(i[t]=X)}}}}m[l][0]=e,m[l][1]=W,m[l][2]=r;var z=this.pdfFont.fontList[y];let t=z.Name,n=t=rt["StiOptions"].Export.useAlternativeFontNames&&rt["StiOptions"].Export.alternativeFontNames.containsKey(t)?rt["StiOptions"].Export.alternativeFontNames.get(t):t,a=(n=n.stimulsoft().replaceAll(" ","_"),(z.Bold||z.Italic)&&(z.Bold&&(n+="_Bold"),z.Italic&&(n+="_Italic")),!1),s="";for(let t=0;t<i.length-1;t++)0!=i[t]&&(s=(s+=",")+this.floatToString(i[t]),a=!0),t!=i.length-1-1&&(s+=";");S.writeStartElement("Glyphs"),S.writeAttributeString("BidiLevel","0"),S.writeAttributeString("Fill",pt.format("#{0:X8}",g.toArgb())),S.writeAttributeString("FontUri",pt.format("/Resources/{0}.ttf",n)),S.writeAttributeString("FontRenderingEmSize",this.floatToString(A)),S.writeAttributeString("StyleSimulations","None"),S.writeAttributeString("OriginX",this.floatToString(e)),S.writeAttributeString("OriginY",this.floatToString(W)),S.writeAttributeString("UnicodeString",o),S.writeAttributeString("Indices",a?s:""),S.writeFullEndElement()}}if(null!=t&&t.font.underline){let e=.09*h,i=.115*-h;0!=this.pdfFont.UnderscoreSize&&(e=L,i=C),e<.1&&(e=.1);for(let t=0;t<c.length;t++)0!=m[t][2]&&(S.writeStartElement("Path"),S.writeAttributeString("Stroke",pt.format("#{0:X8}",g.toArgb())),S.writeAttributeString("StrokeThickness",pt.format("{0}",this.floatToString(e))),S.writeAttributeString("Data",pt.format("M {0},{2} L {1},{2}",this.floatToString(m[t][0]),this.floatToString(m[t][0]+m[t][2]),this.floatToString(m[t][1]-i))),S.writeFullEndElement())}if(null!=t&&t.font.strikeout){let e=.09*h,i=.4*h;0!=this.pdfFont.StrikeoutSize&&(e=F,i=n),e<.1&&(e=.1);for(let t=0;t<c.length;t++)0!=m[t][2]&&(S.writeStartElement("Path"),S.writeAttributeString("Stroke",pt.format("#{0:X8}",g.toArgb())),S.writeAttributeString("StrokeThickness",pt.format("{0}",this.floatToString(e))),S.writeAttributeString("Data",pt.format("M {0},{2} L {1},{2}",this.floatToString(m[t][0]),this.floatToString(m[t][0]+m[t][2]),this.floatToString(m[t][1]-i))),S.writeFullEndElement())}S.writeFullEndElement(),S.writeFullEndElement()}if(l.linesOfUnderline!=bt.None){let n=o.y+B+c,a=!0,s=!0;if(null!=v){var T=k*(b=0==b?1:b);let t=v.vertAlignment;(t=0!=x&&90!=x&&180!=x&&270!=x?dt.Center:t)==dt.Top&&(n+=P,a=!1),t==dt.Center&&(n+=(e-T)/2+P),t==dt.Bottom&&(n+=e-k+P,s=!1)}n+=-m;var R=o.component.as(Ht),j;if(null!=R){let t=.9*R.border.size,e=R.border.color;var D=this.getLineStyleDash(l.linesOfUnderline);let i="",r=n;if(a)while(r-k>o.y+I)r-=k;while(r<o.y+o.height-B-(s?0:k))i+=pt.format("M {0},{1} L {2},{3} ",this.floatToString(o.x),this.floatToString(r),this.floatToString(o.x+o.width),this.floatToString(r)),r+=k;S.writeStartElement("Path"),S.writeAttributeString("Stroke",pt.format("#{0:X8}",e.toArgb())),S.writeAttributeString("StrokeThickness",t.toString()),S.writeAttributeString("StrokeStartLineCap","Square"),S.writeAttributeString("StrokeEndLineCap","Square"),""!=D&&(S.writeAttributeString("StrokeDashArray",D),S.writeAttributeString("StrokeDashCap","Flat")),S.writeAttributeString("Data",i),S.writeFullEndElement()}}}}writeImage(t,e){let i=e.component.as(Lt);if(null==i||!e.component.isExportAsImage(at.a.StiExportFormat.Xps))return;var r={ref:this.imageResolution/100},r=i.getImage(r,at.a.StiExportFormat.Xps);if(null==r)return;var n=this.imageCache.addImageInt(r),a=-1;this.pageImages.set(n,n),-1!=a&&this.pageImages.set(a,a),t.writeStartElement("Path"),this.writeHyperlinksData(t,e.component,!1),t.writeAttributeString("Data",pt.format("M {0},{1} L {0},{3} L {2},{3} L {2},{1} Z ",this.floatToString(e.x),this.floatToString(e.y),this.floatToString(e.x+e.width),this.floatToString(e.y+e.height))),-1!=a&&(t.writeStartElement("Path.OpacityMask"),t.writeStartElement("ImageBrush"),t.writeAttributeString("ImageSource",pt.format("/Resources/Images/image_{0}.png",a)),t.writeAttributeString("Viewbox",pt.format("{0},{1},{2},{3}",0,0,r.width,r.height)),t.writeAttributeString("TileMode","None"),t.writeAttributeString("ViewboxUnits","Absolute"),t.writeAttributeString("ViewportUnits","Absolute"),t.writeAttributeString("Viewport",pt.format("0,0,{0},{0}",1)),t.writeStartElement("ImageBrush.Transform"),t.writeStartElement("MatrixTransform"),t.writeAttributeString("Matrix",pt.format("{0},{1},{2},{3},{4},{5}",this.floatToString(e.width),0,0,this.floatToString(e.height),this.floatToString(e.x),this.floatToString(e.y))),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement()),t.writeStartElement("Path.Fill"),t.writeStartElement("ImageBrush"),t.writeAttributeString("ImageSource",pt.format("/Resources/Images/image_{0}.jpg",n)),t.writeAttributeString("Viewbox",pt.format("{0},{1},{2},{3}",0,0,r.width,r.height)),t.writeAttributeString("TileMode","None"),t.writeAttributeString("ViewboxUnits","Absolute"),t.writeAttributeString("ViewportUnits","Absolute"),t.writeAttributeString("Viewport",pt.format("0,0,{0},{0}",1)),t.writeStartElement("ImageBrush.Transform"),t.writeStartElement("MatrixTransform"),t.writeAttributeString("Matrix",pt.format("{0},{1},{2},{3},{4},{5}",this.floatToString(e.width),0,0,this.floatToString(e.height),this.floatToString(e.x),this.floatToString(e.y))),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeFullEndElement()}writeWatermark(t,e,i,r,n){if(null==e||pt.isNullOrEmpty(e.text)||e.showBehind!=i)return;let a=new wi;a.x=0,a.y=0,a.width=r,a.height=n,a.component=new lt(new m(a.x,a.y,a.width,a.height)),a.component.text=e.text,a.component.textBrush=e.textBrush,a.component.font=e.font,a.component.textOptions=new o,a.component.textOptions.angle=e.angle,a.component.horAlignment=wt.Center,a.component.vertAlignment=dt.Center,this.writeText(t,a)}writePageRels(){var t=new tt;let r=new F(V.UTF8,t);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?C.None:C.Indented,r.writeStartDocument(),r.writeStartElement("Relationships"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");var n=[];this.pageFonts.values.copyTo(n,0);for(let i=0;i<n.length;i++){var a=this.pdfFont.fontList[n[i]];let t=a.Name,e=t=rt["StiOptions"].Export.useAlternativeFontNames&&rt["StiOptions"].Export.alternativeFontNames.containsKey(t)?rt["StiOptions"].Export.alternativeFontNames.get(t):t;e=e.stimulsoft().replaceAll(" ","_"),(a.Bold||a.Italic)&&(a.Bold&&(e+="_Bold"),a.Italic&&(e+="_Italic")),r.writeStartElement("Relationship"),r.writeAttributeString("Id",`rId`+(i+1)),r.writeAttributeString("Type","http://schemas.microsoft.com/xps/2005/06/required-resource"),r.writeAttributeString("Target",`../../../Resources/${e}.ttf`),r.writeEndElement()}var i=mt.create(Number,this.pageImages.count);this.pageImages.values.copyTo(i,0);for(let e=0;e<i.length;e++){r.writeStartElement("Relationship"),r.writeAttributeString("Id",`rId`+(this.pageFonts.count+e+1)),r.writeAttributeString("Type","http://schemas.microsoft.com/xps/2005/06/required-resource");let t="jpg";this.imageCache.imageFormatStore[i[e]]==v.Png&&(t="png"),r.writeAttributeString("Target",`../../../Resources/Images/image_${i[e]}.`+t),r.writeEndElement()}return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),t}writeResourceImage(t){let e=new tt;var t=this.imageCache.imagePackedStore[t];return e.write(t,0,t.length),e}writeRecourceFont(t){let e=new tt;this.pdfFont.currentFont=t;var t=this.pdfFont.fontList[t],t;let i=this.pdfFont.getFontDataBuf(t.Font,this.report);return 0<(null===i||void 0===i?void 0:i.length)&&this.reduceFontSize&&(null!=(t=this.pdfFont.reduceFontSize(i,t.Name,!0))&&(i=t)),0<(null===i||void 0===i?void 0:i.length)&&e.write(i,0,i.length),e}exportXps(e,i,t){if(null==t)throw"ArgumentNullException";this.report=e;let n=t.pageRange;this.imageResolution=t.imageResolution,this.imageQuality=t.imageQuality,this.exportRtfTextAsImage=t.exportRtfTextAsImage,this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.xmlIndentation=1,this.useImageComparer=rt["StiOptions"].Export.Xps.allowImageComparer,this.reduceFontSize=rt["StiOptions"].Export.Xps.reduceFontFileSize;var t=S.currentCulture,a,s,o,l,m,c,g;try{S.currentCulture=JSON.parse(JSON.stringify(S.cultures["en-US"])),S.currentCulture.numberFormat.numberDecimalSeparator=".";let t=n.getSelectedPages(e.renderedPages);if(this.isStopped)return;this.prepareData();for(var h of t.list){t.getPage(h),t.cacheMode&&this.invokeExporting(h,t,0,2),null==h.watermark||pt.isNullOrEmpty(h.watermark.text)||(null!=h.watermark.font&&this.pdfFont.getFontNumber(h.watermark.font),a=at.c.StiBidirectionalConvert2.convertString(h.watermark.text,!1),this.pdfFont.storeUnicodeSymbolsInMap(a));for(s of h.components.list){s.enabled&&(null!=(o=s.as(Dt))&&this.pdfFont.getFontNumber(o.font),l=s.as(St),s.is(lt)&&!s.isExportAsImage(at.a.StiExportFormat.Xps)&&(m=s,c=null!=l.textOptions&&l.textOptions.rightToLeft,g=at.c.StiBidirectionalConvert2.convertString(m.text,c),this.pdfFont.storeUnicodeSymbolsInMap(g)))}}this.pdfFont.InitFontsData(e);let r=new u;r.begin(i,!0),r.addFile("[Content_Types].xml",this.writeContentTypes()),r.addFile("_rels/.rels",this.writeMainRels()),r.addFile("docProps/core.xml",this.writeDocPropsCore(e)),r.addFile("FixedDocSeq.fdseq",this.writeFixedDocSeq()),this.pageFonts=new ct,this.pageImages=new ct,this.pageBookmarks=new ct,this.indexPage=0;for(var p of t.list){if(t.getPage(p),this.invokeExporting(p,t,1,2),this.isStopped)return;if(r.addFile(`Documents/1/Pages/${this.indexPage+1}.fpage`,this.writePage(p,e)),(0<this.pageFonts.count||0<this.pageImages.count)&&r.addFile(`Documents/1/Pages/_rels/${this.indexPage+1}.fpage.rels`,this.writePageRels()),this.pageFonts.clear(),this.pageImages.clear(),this.isStopped)return;this.indexPage++}if(r.addFile("Documents/1/FixedDoc.fdoc",this.writeFixedDoc(t)),0<this.pdfFont.fontList.length)for(let i=0;i<this.pdfFont.fontList.length;i++){var w=this.pdfFont.fontList[i];let t=w.Name,e=t=rt["StiOptions"].Export.useAlternativeFontNames&&rt["StiOptions"].Export.alternativeFontNames.containsKey(t)?rt["StiOptions"].Export.alternativeFontNames.get(t):t;e=e.stimulsoft().replaceAll(" ","_"),(w.Bold||w.Italic)&&(w.Bold&&(e+="_Bold"),w.Italic&&(e+="_Italic"));var d=this.writeRecourceFont(i);0<d.length&&r.addFile(`Resources/${e}.ttf`,d)}if(0<this.imageCache.imagePackedStore.length)for(let e=0;e<this.imageCache.imagePackedStore.length;e++){let t="jpg";this.imageCache.imageFormatStore[e]==v.Png&&(t="png"),r.addFile(`Resources/Images/image_${e}.`+t,this.writeResourceImage(e))}r.end()}finally{S.currentCulture=t,this.pdfFont.clear(),this.pdfFont=null,this.pageFonts=null,this.pageImages=null,this.imageCache.clear(),this.pageBookmarks.clear(),this.pageBookmarks=null}}}at.c.StiXpsExportService=di}var e=at.c.StiExportService;at.c.StiCsvExportService=class extends e{constructor(){super(...arguments),this.multipleFiles=!1}implements(){return[at.c.IStiCsvExportService]}get defaultExtension(){return"csv"}get exportFormat(){return at.a.StiExportFormat.Csv}get groupCategory(){return"Data"}get position(){return at.c.StiExportPosition.Data}get exportNameInMenu(){return t.get("Export","ExportTypeCsvFile")}exportTo(t,e,i){this.exportCsv(t,e,i.stimulsoft().as(at.c.StiDataExportSettings))}get getFilter(){return t.get("FileFilters","CsvFiles")}exportCsv(t,e,i){if(at.a.StiLogService.write(this.stimulsoft().getType(),"Export report to Csv format"),null==i)throw new Error("The 'settings' argument cannot be equal in null.");let r=i.pageRange,n=i.separator;var a=i.encoding,s=i.skipColumnHeaders,i=i.dataExportMode,t=("\\t"==n&&(n="\t"),r.getSelectedPages(t.renderedPages));this.currentPassNumber=0,this.maximumPassNumber=3;let o=new at.c.StiMatrix(t,!1,this,null,i);if(o.scanComponentsPlacement(!1),this.isStopped)return;if(o.prepareDocument(this,i),this.writer=new et(e,a),!s){for(let e=0;e<o.fields.length;e++){let t=o.fields[e].name.stimulsoft().replaceAll('"','""');-1==t.indexOf(n)&&-1==t.indexOf('"')&&-1==t.indexOf("\n")||(t='"'+t+'"'),this.writer.write(t),e<o.fields.length-1&&this.writer.write(n)}this.writer.writeLine("")}this.currentPassNumber=2;for(let i=0;i<o.dataArrayLength;i++){if(this.invokeExporting2(i,o.dataArrayLength-1,this.currentPassNumber,this.maximumPassNumber),this.isStopped)return;for(let e=0;e<o.fields.length;e++){let t=o.fields[e].dataArray[i];""!=(t=null==t?"":t)&&(-1==t.indexOf(n)&&-1==t.indexOf('"')&&-1==t.indexOf("\n")||(t='"'+(t=t.stimulsoft().replaceAll('"','""'))+'"'),this.writer.write(t)),e<o.fields.length-1&&this.writer.write(n)}this.writer.writeLine("")}this.writer.flush(),null!=o&&(o.clear(),o=null)}},at.c.StiDataExportService=class extends at.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1}implements(){return[at.c.IStiDataExportService]}get defaultExtension(){if(this.exportSettings.is(at.c.StiDataExportSettings)){var t=this.exportSettings.dataType;if(t==at.c.StiDataType.Dbf)return"dbf";if(t==at.c.StiDataType.Dif)return"dif";if(t==at.c.StiDataType.Sylk)return"slk";if(t==at.c.StiDataType.Xml)return"xml";if(t==at.c.StiDataType.Json)return"json"}return"csv"}get exportFormat(){if(this.exportSettings.is(at.c.StiCsvExportSettings))return at.a.StiExportFormat.Csv;if(this.exportSettings.is(at.c.StiDataExportSettings)){var t=this.exportSettings.dataType;if(t==at.c.StiDataType.Csv)return at.a.StiExportFormat.Csv;if(t==at.c.StiDataType.Dbf)return at.a.StiExportFormat.Dbf;if(t==at.c.StiDataType.Dif)return at.a.StiExportFormat.Dif;if(t==at.c.StiDataType.Sylk)return at.a.StiExportFormat.Sylk;if(t==at.c.StiDataType.Xml)return at.a.StiExportFormat.Xml;if(t==at.c.StiDataType.Json)return at.a.StiExportFormat.Json}return at.a.StiExportFormat.Data}get groupCategory(){return"Data"}get position(){return at.c.StiExportPosition.Data}get exportNameInMenu(){return t.get("Export","ExportTypeDataFile")}exportTo(t,e,i){this.exportData(t,e,i)}getFilter(){return t.get("FileFilters","CsvFiles")}exportData(t,e,i){this.exportSettings=i;let r=new at.c.StiCsvExportService;r.exportCsv(t,e,i)}};let c=rt.System.Drawing.ColorTranslator,g=rt.System.IO.TextWriter,Wt=(at.c.StiHtml5ExportService=class extends at.c.StiExportService{constructor(){super(),this.renderAsDocument=!0,this.multipleFiles=!1,this.fileName="",this.htmlWriter=null,this.imageQuality=.75,this.imageResolution=96,this.compressToArchive=!1}implements(){return[at.c.IStiHtml5ExportService]}get defaultExtension(){if(this.compressToArchive)return"zip";return"html"}get exportFormat(){return at.a.StiExportFormat.Html5}get groupCategory(){return"Web"}get position(){return at.c.StiExportPosition.Html5}get exportNameInMenu(){return t.get("Export","ExportTypeHtml5File")}exportTo(t,e,i){let r=new g;var n=new at.c.StiHtmlTextWriter(r);this.exportHtml(t,n,i),e.write(V.UTF8.getBytes(r.getStringBuilder().toString()))}getFilter(){if(this.compressToArchive)return t.get("FileFilters","ZipArchives");return t.get("FileFilters","HtmlFiles")}renderPage(t,e,i){var t=at.c.StiSvgHelper.saveToString(t,e,!1,!1,i,this.imageFormat,this.imageQuality,this.imageResolution);this.htmlWriter.write(t),this.htmlWriter.flush()}renderStartDoc(t,e){this.htmlWriter.write("<!DOCTYPE html>"),this.htmlWriter.writeLine(),this.htmlWriter.indent++,this.htmlWriter.writeFullBeginTag("head"),this.htmlWriter.writeLine(),this.htmlWriter.indent++,this.htmlWriter.writeFullBeginTag("title"),this.htmlWriter.write(this.report.reportAlias),this.htmlWriter.writeEndTag("title"),this.htmlWriter.writeLine(),this.htmlWriter.writeBeginTag("meta"),this.htmlWriter.writeAttribute("charset",e.webName),this.htmlWriter.writeEndTag("meta"),this.htmlWriter.writeLine(),this.htmlWriter.indent--,this.htmlWriter.writeEndTag("head"),this.htmlWriter.writeLine(),this.htmlWriter.writeBeginTag("body"),this.htmlWriter.writeAttribute("bgcolor",c.toHtml(ht.lightBlue)),this.htmlWriter.writeAttribute("style","text-align:center;"),this.htmlWriter.write(">"),this.htmlWriter.indent++,this.htmlWriter.writeLine()}renderEndDoc(){this.htmlWriter.indent--,this.htmlWriter.writeEndTag("body"),this.htmlWriter.indent--,this.htmlWriter.writeLine(),this.htmlWriter.writeEndTag("html")}exportHtml(e,i,r){if(at.a.StiLogService.write(this.stimulsoft().getType(),"Export report to Html format"),null==r)throw new Error("The 'settings' argument cannot be equal in null.");this.imageFormat=r.imageFormat,this.imageResolution=r.imageResolution,this.imageQuality=r.imageQuality,this.compressToArchive=r.compressToArchive;var n=r.continuousPages,a=(this.htmlWriter=i,r.pageRange.getSelectedPages(e.renderedPages)),s,o;try{this.report=e,1==this.renderAsDocument&&this.renderStartDoc(a,r.encoding),rt.Base.gVpwr.mgdPW.olcUT()||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud())&&rt.System.NodeJs.isStandaloneVersion||(s=pt.format("{3}{0}{2}{4}{1}",String.fromCharCode(114),String.fromCharCode(108),String.fromCharCode(105),String.fromCharCode(84),String.fromCharCode(97)),i.write('<div style="FONT-SIZE: 10px; COLOR: red; FONT-FAMILY: Arial"'+">"+"Stimulsoft Reports - "+s+" Version</div>")),this.htmlWriter.indent=0;let t=1;for(o of a.list){this.invokeExporting(o,a,0,1);var l={ref:t};this.renderPage(e,o,l),t=l.ref,n&&this.htmlWriter.write("<br/>"),this.htmlWriter.writeLine()}1==this.renderAsDocument&&this.renderEndDoc(),this.htmlWriter.flush()}finally{e=null}}},rt.System.Collections.List),h=at.a.Dashboard.StiDashboardExport,p=at.a.Dashboard.IStiDashboard,Y=rt.System.Drawing.Size,d=rt.Base.Drawing.StiHtmlTagsState;{class Si extends at.c.StiExportService{constructor(){super(...arguments),this.matrix=null,this.fontList=null,this.fillList=null,this.borderList=null,this.xfList=null,this.sstList=null,this.sstHash=null,this.sstHashIsTags=null,this.imageList=null,this.formatList=null,this.sstCount=0,this.sheetNameList=null,this.imageListOffset=0,this.printAreasList=null,this.matrixList=null,this.firstPageIndexList=null,this.hyperlinkList=null,this.minRowList=null,this.maxRowList=null,this.useOnePageHeaderAndFooter=!1,this.dataExportMode=at.c.StiDataExportMode.AllBands,this.exportObjectFormatting=!0,this.exportEachPageToSheet=!1,this.exportHorizontalPageBreaks=!1,this.imageResolution=1,this.imageQuality=.75,this.imageCache=null,this.restrictEditing=at.c.StiExcel2007RestrictEditing.No,this.reportCulture=null,this.docCompanyString=null,this.docLastModifiedString=null,this.xmlIndentation=1,this.wrongUrlSymbols=" \"#'*,;<>[^`{|}",this.refChars="ABCDEFGHIJKLMNOPQRSTUVWXYZ",this.HiToTwips=14.4/20*1.01,this.TwipsToColinfo=2.438*.976*.075}implements(){return[at.c.IStiExcel2007ExportService]}get exportFormat(){return at.a.StiExportFormat.Excel2007}exportTo(t,e,i){this.exportExcel(t,e,i)}exportToAsync(t,e,i,r){setTimeout(async()=>{if(await at.c.StiExportImageHelper.convertAllImages(e,rt.System.Drawing.Imaging.ImageFormat.Jpeg,!1,this.exportFormat),!e.isDocument&&e.getCurrentPage().is(p))return await h.export(e,i,r),void t();this.exportTo(e,i,r),null!=e&&null!=e.preparedExportImages&&(e.preparedExportImages.clear(),e.preparedExportImages=null),t()},0)}getLineStyle(t){let e=bt.None,i=0;var r=1.5,n=3;switch(null!=t&&(e=t.style,i=t.size),e){case bt.Solid:if(i>n)return"thick";if(i>r)return"medium";return"thin";case bt.Dot:if(i>r)return"dotted";return"hair";case bt.Dash:if(i>r)return"mediumDashed";return"dashed";case bt.DashDot:if(i>r)return"mediumDashDot";return"dashDot";case bt.DashDotDot:if(i>r)return"mediumDashDotDot";return"dashDotDot";case bt.Double:return"double";default:return null}}getRefString(t,e){var i=st.trunc(t/26),t=st.trunc(t%26);let r=new ut;return 0<i&&r.append(this.refChars.charAt(i-1)),r.append(this.refChars.charAt(t)),r.append((e+1).toString()),r.toString()}getRefAbsoluteString(t,e){var i=st.trunc(t/26),t=st.trunc(t%26);let r=new ut;return r.append("$"),0<i&&r.append(this.refChars.charAt(i-1)),r.append(this.refChars.charAt(t)),r.append("$"),r.append((e+1).toString()),r.toString()}floatToString(t){var e;return t.toString().stimulsoft().replaceAll(",",".")}stringToUrl(i){let r=new ut;for(let e=0;e<i.length;e++){let t=i.charAt(e);if("'"==t)continue;t.charCodeAt(0)<32||-1!=this.wrongUrlSymbols.indexOf(t)?r.append(pt.format("%{0:x2}",t.charCodeAt(0))):r.append(t)}return r.toString()}getFontNumber(e){if(0<this.fontList.length)for(let t=0;t<this.fontList.length;t++)if(this.fontList[t].stimulsoft().equals(e))return t;var t;return this.fontList.push(e),this.fontList.length-1}getFillNumber(e){if(0<this.fillList.length)for(let t=0;t<this.fillList.length;t++)if(this.fillList[t].stimulsoft().equals(e))return t;var t;return this.fillList.push(e),this.fillList.length-1}getBorderNumber(e){if(0<this.borderList.length)for(let t=0;t<this.borderList.length;t++)if(this.borderList[t].stimulsoft().equals(e))return t;var t;return this.borderList.push(e),this.borderList.length-1}getXFNumber(e){if(0<this.xfList.length)for(let t=0;t<this.xfList.length;t++)if(this.xfList[t].equalDataXF(e))return t;var t;return this.xfList.push(e),this.xfList.length-1}getSSTNumber(t){if(this.sstCount++,0<this.sstList.length&&this.sstHash.containsKey(t))return this.sstHash.get(t);this.sstList.push(t);var e=this.sstList.length-1;return this.sstHash.add(t,e),e}getFormatNumber(e){if(0<this.formatList.length)for(let t=0;t<this.formatList.length;t++)if(this.formatList[t]==e)return t+164;var t;return this.formatList.push(e),this.formatList.length-1+164}convert(t){return t*this.HiToTwips}compareExcellSheetNames(t,e){let i=t,r=(null!=i&&0!=i.length||(i=""),e);return null!=r&&0!=r.length||(r=""),i==r}prepareData(){this.fontList=new Array,this.fillList=new Array,this.borderList=new Array,this.xfList=new Array,this.sstList=[],this.sstHash=new ct,this.sstHashIsTags=new ct,this.imageList=[],this.formatList=[],this.sheetNameList=[],this.sstCount=0,this.printAreasList=[],this.matrixList=[],this.firstPageIndexList=[],this.minRowList=[],this.maxRowList=[],this.imageCache=new at.a.StiImageCache(rt["StiOptions"].Export.Excel.AllowImageComparer,!0,at.a.ImageFormat.Jpeg,this.imageQuality,!1);var t=new ui("Arial",!1,!1,!1,!1,10,ht.black,1,0),t=(this.getFontNumber(t),new fi("none",ht.transparent,ht.black)),t=(this.getFillNumber(t),t=new fi("gray125",ht.transparent,ht.black),this.getFillNumber(t),new vi(null,null,null,null)),t=(this.getBorderNumber(t),new Ei(0,0,0,0,0,wt.Left,dt.Bottom,0,!1,!1,!1));this.getXFNumber(t)}writeContentTypes(){var t=new tt;let e=new F(V.UTF8,t);e.writeStartDocument(),e.writeStartElement("Types"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types"),e.writeStartElement("Default"),e.writeAttributeString("Extension","rels"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","xml"),e.writeAttributeString("ContentType","application/xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","jpeg"),e.writeAttributeString("ContentType","image/jpeg"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","png"),e.writeAttributeString("ContentType","image/png"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","vml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.vmlDrawing"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/app.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/core.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/workbook.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"),e.writeEndElement();for(let t=0;t<this.sheetNameList.length;t++)e.writeStartElement("Override"),e.writeAttributeString("PartName",pt.format("/xl/worksheets/sheet{0}.xml",t+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"),e.writeEndElement();e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/styles.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"),e.writeEndElement();for(let t=0;t<this.sheetNameList.length;t++)e.writeStartElement("Override"),e.writeAttributeString("PartName",pt.format("/xl/drawings/drawing{0}.xml",t+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"),e.writeEndElement();return 0<this.sstList.length&&(e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/sharedStrings.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"),e.writeEndElement()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeMainRels(){var t=new tt;let e=new F(V.UTF8,t);return e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","xl/workbook.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsApp(){var t=new tt;let e=new F(V.UTF8,t);e.writeStartDocument(),e.writeStartElement("Properties"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),e.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),e.writeElementString("Application","Microsoft Excel"),e.writeElementString("DocSecurity","0"),e.writeElementString("ScaleCrop","false"),e.writeElementString("Company",null==this.docCompanyString?"":this.docCompanyString),e.writeElementString("LinksUpToDate","false"),e.writeElementString("SharedDoc","false"),e.writeElementString("HyperlinksChanged","false"),e.writeElementString("AppVersion","12.0000"),e.writeStartElement("HeadingPairs"),e.writeStartElement("vt:vector"),e.writeAttributeString("size","4"),e.writeAttributeString("baseType","variant"),e.writeStartElement("vt:variant"),e.writeElementString("vt:lpstr","Worksheets"),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:i4",this.sheetNameList.length.toString()),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:lpstr","Named Ranges"),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:i4",this.sheetNameList.length.toString()),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("TitlesOfParts"),e.writeStartElement("vt:vector"),e.writeAttributeString("size",(2*this.sheetNameList.length).toString()),e.writeAttributeString("baseType","lpstr");for(let t=0;t<this.sheetNameList.length;t++)e.writeElementString("vt:lpstr",this.sheetNameList[t]);for(let t=0;t<this.sheetNameList.length;t++)e.writeElementString("vt:lpstr",pt.format("'{0}'!Print_Area",this.sheetNameList[t]));return e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsCore(){var t=new tt;let e=new F(V.UTF8,t);e.writeStartDocument(),e.writeStartElement("cp:coreProperties"),e.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),e.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),e.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");var i=pt.format("{0}{1}",gt.now.toString("yyyy-MM-dd"),gt.now.toString("THH:mm:ssZ"));return e.writeElementString("dc:title",null==this.report.reportName?"":this.report.reportName),e.writeElementString("dc:subject",null==this.report.reportAlias?"":this.report.reportAlias),e.writeElementString("dc:creator",null==this.report.reportAuthor?"":this.report.reportAuthor),e.writeElementString("dc:description",null==this.report.reportDescription?"":this.report.reportDescription),e.writeElementString("cp:lastModifiedBy",null==this.docLastModifiedString?"":this.docLastModifiedString),e.writeStartElement("dcterms:created"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(i),e.writeEndElement(),e.writeStartElement("dcterms:modified"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(i),e.writeEndElement(),e.writeElementString("cp:contentStatus",rt.StiVersion.platform()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeWorkbookRels(){var t=new tt;let e=new F(V.UTF8,t);e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(let t=0;t<this.sheetNameList.length;t++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",pt.format("rId{0}",t+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet"),e.writeAttributeString("Target",pt.format("worksheets/sheet{0}.xml",t+1)),e.writeEndElement();return e.writeStartElement("Relationship"),e.writeAttributeString("Id",pt.format("rId{0}",this.sheetNameList.length+2)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles"),e.writeAttributeString("Target","styles.xml"),e.writeEndElement(),0<this.sstCount&&(e.writeStartElement("Relationship"),e.writeAttributeString("Id",pt.format("rId{0}",this.sheetNameList.length+3)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings"),e.writeAttributeString("Target","sharedStrings.xml"),e.writeEndElement()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeWorkbook(){var t=new tt;let i=new F(V.UTF8,t);i.writeStartDocument(),i.writeStartElement("workbook"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeStartElement("fileVersion"),i.writeAttributeString("appName","xl"),i.writeAttributeString("lastEdited","4"),i.writeAttributeString("lowestEdited","4"),i.writeAttributeString("rupBuild","4505"),i.writeEndElement(),i.writeStartElement("workbookPr"),i.writeAttributeString("defaultThemeVersion","124226"),i.writeEndElement(),i.writeStartElement("bookViews"),i.writeStartElement("workbookView"),i.writeAttributeString("xWindow","120"),i.writeAttributeString("yWindow","15"),i.writeAttributeString("windowWidth","18975"),i.writeAttributeString("windowHeight","11955"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("sheets");for(let t=0;t<this.sheetNameList.length;t++)i.writeStartElement("sheet"),i.writeAttributeString("name",this.sheetNameList[t]),i.writeAttributeString("sheetId",pt.format("{0}",t+1)),i.writeAttributeString("r:id",pt.format("rId{0}",t+1)),i.writeEndElement();i.writeEndElement(),i.writeStartElement("definedNames");for(let e=0;e<this.sheetNameList.length;e++){let t=this.printAreasList[e];1048575<t.height&&(t.height=1048575),16383<t.width&&(t.width=16383);var r=this.getRefAbsoluteString(t.width,t.height);i.writeStartElement("definedName"),i.writeAttributeString("name","_xlnm.Print_Area"),i.writeAttributeString("localSheetId",e.toString()),i.writeString(pt.format("'{0}'!$A$1:{1}",this.sheetNameList[e],r)),i.writeEndElement()}return i.writeEndElement(),i.writeStartElement("calcPr"),i.writeAttributeString("calcId","124519"),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),t}writeSheetRels(t){var e=new tt;let i=new F(V.UTF8,e);if(i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),0<this.imageList.length-this.imageListOffset&&(i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId1"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing"),i.writeAttributeString("Target",`../drawings/drawing${t+1}.xml`),i.writeEndElement()),0<this.hyperlinkList.length)for(let t=0;t<this.hyperlinkList.length;t++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",pt.format("rId{0}",2+t)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),i.writeAttributeString("Target",this.hyperlinkList[t]),i.writeAttributeString("TargetMode","External"),i.writeEndElement();return rt.Base.gVpwr.mgdPW.olcUT()||rt.Base.gVpwr.mgdPW.HdOnK()||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud()||rt.Base.gVpwr.mgdPW.DnFeB())&&rt.System.NodeJs.isStandaloneVersion||(i.writeStartElement("Relationship"),i.writeAttributeString("Id","dId1"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing"),i.writeAttributeString("Target","../drawings/vmlDrawingAdditional.vml"),i.writeEndElement()),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeSheet(t,e){var i=new tt;let k=new F(V.UTF8,i);k.writeStartDocument(),k.writeStartElement("worksheet"),k.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),k.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),rt["StiOptions"].Export.Excel.FitToOnePageWide&&(k.writeStartElement("sheetPr"),k.writeStartElement("pageSetUpPr"),k.writeAttributeString("fitToPage","1"),k.writeEndElement(),k.writeEndElement()),this.matrix=this.matrixList[t];var I=this.minRowList[t],r=this.maxRowList[t],t,t,t;let n=this.matrix.coordX.countItems,a=new Y(n-2,r-I-1),B=(a.width<0&&(a.width=0),a.height<0&&(a.height=0),this.printAreasList.push(a),[]),s=(k.writeStartElement("dimension"),k.writeAttributeString("ref",pt.format("{0}:{1}",this.getRefString(0,0),this.getRefString(a.width,a.height))),k.writeEndElement(),0),o=0;if(rt["StiOptions"].Export.Excel.AllowFreezePanes)for(let i=I;i<r;i++)for(let t=0;t<n-1;t++){let e=this.matrix.cells[i][t];if(null!=e&&null!=e.component&&(e.component.locked||null!=e.component.tagValue&&e.component.tagValue.toString().contains("excelfreezepanes"))){let t=e.component.componentPlacement;if(null!=t&&0<t.length&&(t.stimulsoft().startsWith("rt")||t.stimulsoft().startsWith("ph")||t.stimulsoft().startsWith("h"))){s=e.left,o=e.top+e.height+1;break}}}k.writeStartElement("sheetViews"),k.writeStartElement("sheetView"),rt["StiOptions"].Export.Excel.ColumnsRightToLeft&&k.writeAttributeString("rightToLeft","1"),rt["StiOptions"].Export.Excel.ShowGridLines||k.writeAttributeString("showGridLines","0"),k.writeAttributeString("tabSelected","1"),k.writeAttributeString("workbookViewId","0"),0==s&&0==o?(k.writeStartElement("selection"),k.writeAttributeString("activeCell","A1"),k.writeAttributeString("sqref","A1")):0==s?(k.writeStartElement("pane"),k.writeAttributeString("ySplit",o.toString()),k.writeAttributeString("topLeftCell",this.getRefString(s,o)),k.writeAttributeString("activePane","bottomLeft"),k.writeAttributeString("state","frozen"),k.writeEndElement(),k.writeStartElement("selection"),k.writeAttributeString("pane","bottomLeft"),k.writeAttributeString("activeCell",this.getRefString(0,o)),k.writeAttributeString("sqref",this.getRefString(0,o))):(k.writeStartElement("pane"),k.writeAttributeString("xSplit",s.toString()),k.writeAttributeString("ySplit",o.toString()),k.writeAttributeString("topLeftCell",this.getRefString(s,o)),k.writeAttributeString("activePane","bottomRight"),k.writeAttributeString("state","frozen"),k.writeEndElement(),k.writeStartElement("selection"),k.writeAttributeString("pane","topRight"),k.writeAttributeString("activeCell",this.getRefString(s,0)),k.writeAttributeString("sqref",this.getRefString(s,0)),k.writeEndElement(),k.writeStartElement("selection"),k.writeAttributeString("pane","bottomLeft"),k.writeAttributeString("activeCell",this.getRefString(0,o)),k.writeAttributeString("sqref",this.getRefString(0,o)),k.writeEndElement(),k.writeStartElement("selection"),k.writeAttributeString("pane","bottomRight"),k.writeAttributeString("activeCell",this.getRefString(s,o)),k.writeAttributeString("sqref",this.getRefString(s,o))),k.writeEndElement(),k.writeEndElement(),k.writeEndElement(),k.writeStartElement("sheetFormatPr"),k.writeAttributeString("defaultRowHeight","15"),k.writeEndElement();let D=0,l=Et.toColor(e.brush);l.equals(ht.white)||0==l.a||(t=new fi("solid",l,ht.transparent),t=this.getFillNumber(t),t=new Ei(0,0,t,0,0,wt.Left,dt.Bottom,0,!1,!1,!1),D=this.getXFNumber(t));var m=this.matrix.coordX.getKeys(),c=this.matrix.coordY.getKeys(),A;if(this.exportObjectFormatting&&1<n){k.writeStartElement("cols");for(let e=0;e<n-1;e++){var g=this.matrix.coordX.getByIndex(e+1,m),h=this.matrix.coordX.getByIndex(e,m);let t=this.convert(g-h)*this.TwipsToColinfo;k.writeStartElement("col"),k.writeAttributeString("min",(e+1).toString()),k.writeAttributeString("max",(e+1).toString()),k.writeAttributeString("width",t.toString()),k.writeAttributeString("customWidth","1"),0<D&&k.writeAttributeString("style",D.toString()),k.writeEndElement()}0<D&&(k.writeStartElement("col"),k.writeAttributeString("min",n.toString()),k.writeAttributeString("max","16384"),k.writeAttributeString("width","8.7265625"),k.writeAttributeString("style",D.toString()),k.writeEndElement()),k.writeEndElement()}let R=mt.create2(Boolean,r+1,n),N=mt.create2(Number,r+1,n),M=[],H=[];k.writeStartElement("sheetData");for(let F=I;F<r;F++){var p=this.matrix.coordY.getByIndex(F+1,c)-this.matrix.coordY.getByIndex(F,c);k.writeStartElement("row"),k.writeAttributeString("r",(F+1-I).toString()),k.writeAttributeString("spans",`1:`+(n-1)),this.exportObjectFormatting&&(k.writeAttributeString("ht",this.convert(p).toString()),k.writeAttributeString("customHeight","1"));for(let C=0;C<n-1;C++){let L=this.matrix.cells[F][C];if(R[F]&&0==R[F][C]&&null!=L){R[F][C]=!0;let m=L.component.stimulsoft().as(lt),c=L.text;var O=L.component.stimulsoft().as(nt);let g=!1;var U=!1,z,O,U,O,U;null!=O&&null!=O.excelDataValue&&0<O.excelDataValue.length&&(g=!0,c=O.excelDataValue);let e=null;if(null!=L.component.hyperlinkValue&&0<(e=L.component.hyperlinkValue.toString().trim()).length&&!e.stimulsoft().startsWith("javascript:")){let t=c;null!=t&&0!=t.length||(t=e);var O=new xi(F-I,F-I+L.height,C,C+L.width),O=new yi(O,t,e);H.push(O)}let i=!1,h=(!1&&(i=!0),!1),r=L.component.stimulsoft().as(Lt);if(!i&&!U&&null!=r){let t=null;L.component.isExportAsImage(at.a.StiExportFormat.Excel2007)&&(O={ref:this.imageResolution},t=r.getImage(O,at.a.StiExportFormat.Excel)),null!=t&&(null!=(U=this.matrix.getRealImageData(L,t))&&(t=U),O=this.imageCache.addImageIntRaw(t,t.imageFormat),U=new bi(F-I,0,C,0,F-I+1+L.height,0,C+1+L.width,0,O,e),this.imageList.push(U),h=!0,i=!0)}let n=!1;if(null!=L.component&&null!=L.component.tagValue){let t=L.component.tagValue.toString().toLowerCase();-1!=t.indexOf("exceltext")&&(n=!0,B.push(this.getRefString(C,F)))}let a="",s=(null!=m&&(a=m.format),!1),t=!1,o=!1,l=!1,p=!1,w=!1,d=!1,S="",u=2,f=0,v=this.reportCulture.numberFormat.currencySymbol,E=0==this.reportCulture.numberFormat.currencyPositivePattern||2==this.reportCulture.numberFormat.currencyPositivePattern,b=!1;var O=null!=m&&m.hideZeros;let x=null,y=null;var U=a.indexOf("|"),U;if(-1!=U&&(x=at.c.StiExportUtils.getPositivePattern(a.charCodeAt(U+1)-65),y=at.c.StiExportUtils.getNegativePattern(a.charCodeAt(U+2)-65),a=a.substr(0,U)),null!=a&&0<a.length)if("C"==a[0]?s=!0:"N"==a[0]?t=!0:"P"==a[0]?o=!0:"D"==a[0]?l=!0:"T"==a[0]?p=!0:"U"==a[0]&&(w=!0),1==a.length)d=!0;else if(s||t||o){let e=1;if(ot.isDigit(a[e])){let t=new ut;while(e<a.length&&ot.isDigit(a[e]))t.append(a[e]),e++;u=parseInt(t.toString())}e<a.length&&"G"==a[e]&&(e++,f=3),e<a.length&&"("==a[e]&&(e++,b=!0),e<a.length&&("."==a[e]||","==a[e])&&e++,e<a.length&&("+"==a[e]||"-"==a[e])&&("+"==a[e]&&(E=!0),e++,v=e<a.length?a.substring(e):"")}if(s||t||o||l||p||(d=!0),s&&d&&(d=!1),O&&!pt.isNullOrEmpty(a)&&(d&&t&&(f=3),d=!1),!(d=n?!0:d))if(-1!=U){let t=new ut;1<f&&(t.append("#,"),t.appendCount("#",f-1)),t.append("0"),0<u&&(t.append("."),t.appendCount("0",u));var U=t.toString(),W=x.stimulsoft().replaceAll("n",U).stimulsoft().replaceAll("$",'"'+v+'"'),U=y.stimulsoft().replaceAll("n",U).stimulsoft().replaceAll("$",'"'+v+'"');S=W+";"+U+(O?";":"")}else{let t=new ut;s&&1==E&&(t.append('"'),t.append(v),t.append('"')),1<f&&(t.append("#,"),t.appendCount("#",f-1)),t.append("0"),0<u&&(t.append("."),t.appendCount("0",u)),s&&0==E&&(t.append('"'),t.append(v),t.append('"')),o&&t.append("%"),S=t.toString();var W=(b?"(":"-")+S+(b?")":"");O?S=S+";"+W+";":b&&(S=S+";"+W)}let A=0,T=(d?(t&&(A=4),o&&(A=10),l&&(A=14),p&&(A=21),n&&(A=49)):A=this.getFormatNumber(S),D);if(this.exportObjectFormatting){var U=L.cellStyle;let t=new ui(U.font.name,U.font.bold,U.font.italic,U.font.underline,U.font.strikeout,Math.round(U.font.sizeInPoints),U.textColor,1,0),e=(g&&(t=new ui(rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.name,rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.bold,rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.italic,rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.underline,rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.strikeout,Math.round(rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.sizeInPoints),U.textColor,1,0)),new fi("solid",U.color,U.color)),i=(h&&(e=new fi("solid",ht.transparent,ht.transparent)),!0),r=!0;for(let t=0;t<L.height+1;t++)null==this.matrix.bordersY[L.top+t][L.left]&&(i=!1),null==this.matrix.bordersY[L.top+t][L.left+L.width+1]&&(r=!1);let n=!0,a=!0;for(let t=0;t<L.width+1;t++)null==this.matrix.bordersX[L.top][L.left+t]&&(n=!1),null==this.matrix.bordersX[L.top+L.height+1][L.left+t]&&(a=!1);var O=new vi(i?this.matrix.bordersY[L.top][L.left]:null,r?this.matrix.bordersY[L.top][L.left+L.width+1]:null,n?this.matrix.bordersX[L.top][L.left]:null,a?this.matrix.bordersX[L.top+L.height+1][L.left]:null),X;let s=!1,o=(null!=U.textOptions&&(s=U.textOptions.rightToLeft),!1),l=(null!=U.textOptions&&(o=U.textOptions.wordWrap),pt.isNullOrEmpty(c)||(-1==c.indexOf("\r")&&-1==c.indexOf("\n")||(o=!0),null==m||!m.checkAllowHtmlTags()||-1==c.indexOf("<br")&&-1==c.indexOf("<ul")&&-1==c.indexOf("<ol")&&-1==c.indexOf("<p")||(o=!0)),0);null!=U.textOptions&&(0<=(X=Math.ceil(U.textOptions.angle))&&X<=90&&(l=X),270<=X&&X<360&&(l=360-X+90));var X=this.restrictEditing==at.c.StiExcel2007RestrictEditing.ExceptEditableFields&&null!=L.component&&L.component.is(lt)&&L.component.as(lt).editable,O=new Ei(A,this.getFontNumber(t),this.getFillNumber(e),this.getBorderNumber(O),0,g?rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.HorAlignment:U.horAlignment,g?rt["StiOptions"].Export.CheckBoxReplacementForExcelValue.VertAlignment:U.vertAlignment,l,o,s,X);T=this.getXFNumber(O)}if(k.writeStartElement("c"),k.writeAttributeString("r",this.getRefString(C,F-I)),k.writeAttributeString("s",T.toString()),this.exportObjectFormatting){for(let e=0;e<=L.width;e++)for(let t=0;t<=L.height;t++)R[F+t][C+e]=!0,N[F+t][C+e]=T;(0<L.width||0<L.height)&&(U=new xi(F-I,F-I+L.height,C,C+L.width),M.push(U))}else R[F][C]=!0,N[F][C]=T;let P=null;if(null!=m&&(P=m.excelDataValue,t&&""==P&&" "==c&&(c="")),!(i||pt.isNullOrEmpty(c)&&pt.isNullOrEmpty(P))){let i=!1,r=!1,n=0;if(!pt.isNullOrEmpty(P)&&"-"!=P){let t=m.excelDataValue,e=t;var O=e.indexOf("."),U=e.indexOf(",");if(e=(e=-1!=O&&-1!=U?e.stimulsoft().replaceAll(U<O?",":".",""):e).trim().stimulsoft().replaceAll(",","."),!pt.isNullOrEmpty(e)&&this.checkForNumber(e)){r=!0;try{l||p?r=!1:(n=parseFloat(e),isNaN(n)&&(r=!1,n=0))}catch(t){rt.System.StiError.showError(t,!1),r=!1}}w&&(r=!1),t!=c&&t.stimulsoft().startsWith("=")&&(i=!0),r||null!=c||(c=t)}if(i){let t=m.excelDataValue.stimulsoft().replaceAll("\r","").stimulsoft().replaceAll("\t"," ").substring(1);rt["StiOptions"].Export.Excel.TrimTrailingSpaces&&(t=at.c.StiExportUtils.trimEndWhiteSpace(t)),k.writeElementString("f",t)}else if(1==r)k.writeElementString("v",n.toString().stimulsoft().replaceAll(",","."));else{let t=c.stimulsoft().replaceAll("\r","").stimulsoft().replaceAll("\t"," "),e=(rt["StiOptions"].Export.Excel.TrimTrailingSpaces&&(t=at.c.StiExportUtils.trimEndWhiteSpace(t)),0);null!=m&&m.checkAllowHtmlTags()?(t=this.convertAllowHtmlTagsToExcelString(m,t),e=this.getSSTNumber(t),this.sstHashIsTags.add(e,null)):e=this.getSSTNumber(t),k.writeAttributeString("t","s"),k.writeElementString("v",e.toString())}}k.writeEndElement()}else{let e=0;R[F][C]&&(e=N[F][C]);var U=null!=this.matrix.bordersY[F+0][C+0],O=null!=this.matrix.bordersY[F+0][C+1],w=null!=this.matrix.bordersX[F+0][C+0];let i;try{i=null!=this.matrix.bordersX[F+1][C+0]}catch(t){rt.System.StiError.showError(t,!1)}if(U||O||w||i||0!=e){var w=new vi(U?this.matrix.bordersY[F+0][C+0]:null,O?this.matrix.bordersY[F+0][C+1]:null,w?this.matrix.bordersX[F+0][C+0]:null,i?this.matrix.bordersX[F+1][C+0]:null),d=this.xfList[e],w=new Ei(d.FormatIndex,d.FontIndex,d.FillIndex,this.getBorderNumber(w),d.XFId,d.HorAlign,d.VertAlign,d.TextRotationAngle,d.TextWrapped,d.RightToLeft,d.Editable);let t=this.getXFNumber(w);this.exportObjectFormatting||(t=0),k.writeStartElement("c"),k.writeAttributeString("r",this.getRefString(C,F-I)),k.writeAttributeString("s",t.toString()),k.writeEndElement()}}}k.writeEndElement()}if(k.writeEndElement(),this.restrictEditing!=at.c.StiExcel2007RestrictEditing.No&&(k.writeStartElement("sheetProtection"),k.writeAttributeString("password","F05F"),k.writeAttributeString("sheet","1"),k.writeAttributeString("objects","1"),k.writeAttributeString("scenarios","1"),k.writeEndElement()),0<M.length&&(this.dataExportMode==at.c.StiDataExportMode.AllBands||this.exportObjectFormatting)){k.writeStartElement("mergeCells"),k.writeAttributeString("count",M.length.toString());for(let t=0;t<M.length;t++){var S=M[t];k.writeStartElement("mergeCell"),k.writeAttributeString("ref",pt.format("{0}:{1}",this.getRefString(S.FirstColumn,S.FirstRow),this.getRefString(S.LastColumn,S.LastRow))),k.writeEndElement()}k.writeEndElement()}if(0<H.length){let n=!1;for(let t=0;t<H.length;t++){let r=H[t].Bookmark;if(r.stimulsoft().startsWith("#")){r=r.substring(1);for(let i=0;i<this.matrixList.length;i++){let e=this.matrixList[i].bookmarksTable;if(null!=e){let t=e.get(r);if(null!=t){var u=this.minRowList[i],f=this.maxRowList[i],v=t.stimulsoft().as(Y);if(v.height>=u&&v.height<f){n=!0;break}}}}}else n=!0;if(n)break}if(n){k.writeStartElement("hyperlinks");for(let t=0;t<H.length;t++){var E=H[t];let n=E.Bookmark;if(n.stimulsoft().startsWith("#")){n=n.substring(1);let r=!1;for(let i=0;i<this.matrixList.length;i++){let e=this.matrixList[i].bookmarksTable;if(null!=e){let t=e.get(n);if(null!=t){var b=this.minRowList[i],T=this.maxRowList[i],x=t.stimulsoft().as(Y);if(x.height>=b&&x.height<T){n=pt.format("'{0}'!{1}",this.sheetNameList[i],this.getRefString(x.width,x.height-b)),r=!0;break}}}}r&&(k.writeStartElement("hyperlink"),k.writeAttributeString("ref",this.getRefString(E.Range.FirstColumn,E.Range.FirstRow)),k.writeAttributeString("location",n),k.writeAttributeString("display",E.Description),k.writeEndElement())}else{let t=n;n.stimulsoft().startsWith("file:\\\\\\")&&(t=n.substring(8),n="file:///"+t),n.stimulsoft().startsWith("http:")&&(n=n.stimulsoft().replaceAll(" ","")),k.writeStartElement("hyperlink"),k.writeAttributeString("ref",this.getRefString(E.Range.FirstColumn,E.Range.FirstRow)),k.writeAttributeString("r:id",pt.format("rId{0}",2+this.hyperlinkList.length)),k.writeAttributeString("display",t),k.writeEndElement(),this.hyperlinkList.push(this.stringToUrl(n))}}k.writeEndElement()}}k.writeStartElement("pageMargins"),k.writeAttributeString("left",this.floatToString(e.convertToHInches(e.unit,e.margins.left)/100)),k.writeAttributeString("right",this.floatToString(e.convertToHInches(e.unit,e.margins.right)/100)),k.writeAttributeString("top",this.floatToString(e.convertToHInches(e.unit,e.margins.top)/100)),k.writeAttributeString("bottom",this.floatToString(e.convertToHInches(e.unit,e.margins.bottom)/100)),k.writeAttributeString("header",this.floatToString(0)),k.writeAttributeString("footer",this.floatToString(0)),k.writeEndElement(),k.writeStartElement("pageSetup"),k.writeAttributeString("paperSize",pt.format("{0}",e.paperSize)),k.writeAttributeString("orientation",e.orientation==G.Portrait?"portrait":"landscape"),rt["StiOptions"].Export.Excel.FitToOnePageWide&&k.writeAttributeString("fitToHeight","0"),k.writeEndElement(),rt.Base.gVpwr.mgdPW.olcUT()||rt.Base.gVpwr.mgdPW.HdOnK()||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud()||rt.Base.gVpwr.mgdPW.DnFeB())&&rt.System.NodeJs.isStandaloneVersion||(k.writeStartElement("headerFooter"),k.writeStartElement("oddHeader"),k.writeRaw("&amp;C\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n&amp;G"),k.writeEndElement(),k.writeEndElement());let y=this.matrix.horizontalPageBreaks.length;if(this.exportHorizontalPageBreaks&&0<y){k.writeStartElement("rowBreaks"),k.writeAttributeString("count",y.toString()),k.writeAttributeString("manualBreakCount",y.toString());for(let t=0;t<y;t++)k.writeStartElement("brk"),k.writeAttributeString("id",pt.format("{0}",this.matrix.horizontalPageBreaks[t])),k.writeAttributeString("max",0==t?"16383":"8"),k.writeAttributeString("man","1"),k.writeEndElement();k.writeEndElement()}if(this.imageList.length>this.imageListOffset&&(k.writeStartElement("drawing"),k.writeAttributeString("r:id","rId1"),k.writeEndElement()),0<B.length){for(var P in k.writeStartElement("ignoredErrors"),B)k.writeStartElement("ignoredError"),k.writeAttributeString("sqref",B[P]),k.writeAttributeString("numberStoredAsText","1"),k.writeEndElement();k.writeEndElement()}return rt.Base.gVpwr.mgdPW.olcUT()||rt.Base.gVpwr.mgdPW.HdOnK()||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud()||rt.Base.gVpwr.mgdPW.DnFeB())&&rt.System.NodeJs.isStandaloneVersion||(k.writeStartElement("legacyDrawingHF"),k.writeAttributeString("r:id","dId1"),k.writeEndElement()),k.writeFullEndElement(),k.writeEndDocument(),k.flush(),i}checkForNumber(t){var e;if(null!=(e=t.match(Si.regexCheckInteger1)))return!0;if(null!=(e=t.match(Si.regexCheckFloat1)))return!0;return!1}prepareMatrix(t){let e=this.dataExportMode;if(rt["StiOptions"].Export.Excel.AllowExportFootersInDataOnlyMode&&(e|=at.c.StiDataExportMode.Footers),this.matrix=new at.c.StiMatrix(t,rt["StiOptions"].Export.Excel.DivideBigCells,this,null,e),this.useOnePageHeaderAndFooter){this.matrix.scanComponentsPlacement(!0,this.exportObjectFormatting);var a=this.matrix.coordX.countItems,s=this.matrix.coordY.countItems,i;let r=this.matrix.coordY.getKeys(),t=0;while(this.matrix.linePlacement[t]!=at.c.StiTableLineInfo.PageHeader&&t<s-1)t++;if(this.matrix.linePlacement[t]==at.c.StiTableLineInfo.PageHeader){while(this.matrix.linePlacement[t]==at.c.StiTableLineInfo.PageHeader&&t<s-1)t++;while(t<s-1)this.matrix.linePlacement[t]==at.c.StiTableLineInfo.PageHeader&&(this.matrix.linePlacement[t]=at.c.StiTableLineInfo.Trash),t++}t=s-1;while(this.matrix.linePlacement[t]!=at.c.StiTableLineInfo.PageFooter&&0<t)t--;if(this.matrix.linePlacement[t]==at.c.StiTableLineInfo.PageFooter){while(this.matrix.linePlacement[t]==at.c.StiTableLineInfo.PageFooter&&0<t)t--;while(0<t)this.matrix.linePlacement[t]==at.c.StiTableLineInfo.PageFooter&&(this.matrix.linePlacement[t]=at.c.StiTableLineInfo.Trash),t--}let n=0,e=0;for(let i=0;i<s-1;i++){if(this.matrix.linePlacement[i]!=at.c.StiTableLineInfo.Trash){for(let e=0;e<a-1;e++){this.matrix.cells[n][e]=this.matrix.cells[i][e];let t=this.matrix.cells[n][e];null!=t&&(t.top=n,t.exportImage),this.matrix.bordersX[n][e]=this.matrix.bordersX[i][e],this.matrix.bordersY[n][e]=this.matrix.bordersY[i][e],this.matrix.bookmarks[n][e]=this.matrix.bookmarks[i][e]}this.matrix.bordersY[n][a-1]=this.matrix.bordersY[i][a-1];var o=this.matrix.coordY.getByIndex(i+1,r)-this.matrix.coordY.getByIndex(i,r);this.matrix.coordY.setByIndex(n+1,this.matrix.coordY.getByIndex(n,r)+o,r),n++}else e++;if(this.exportHorizontalPageBreaks)for(let t=0;t<this.matrix.horizontalPageBreaks.length;t++)this.matrix.horizontalPageBreaks[t]==i&&(this.matrix.horizontalPageBreaks[t]=this.matrix.horizontalPageBreaks[t]-(e-1))}for(let t=0;t<a-1;t++)this.matrix.bordersX[n][t]=this.matrix.bordersX[s-1][t];if(r=this.matrix.coordY.getKeys(),0<s-1-n){let e=new Wt;for(let t=0;t<n+1;t++){var l=this.matrix.coordY.getByIndex(t,r);e.add(l)}this.matrix.coordY=e}}if(this.dataExportMode!=at.c.StiDataExportMode.AllBands){this.matrix.scanComponentsPlacement(!0,this.exportObjectFormatting);var m=this.matrix.coordX.countItems,c=this.matrix.coordY.countItems,g=this.matrix.coordY.getKeys(),h,h,p;let r=0,n=new ct,a=null,s=!1;for(let i=0;i<c-1;i++){let e=!1;if(this.matrix.linePlacement[i]==at.c.StiTableLineInfo.HeaderD||this.matrix.linePlacement[i]==at.c.StiTableLineInfo.HeaderAP){let t=this.matrix.parentBandName[i];s&&this.getParentBandName(i)==this.getParentBandName(i-1)?e=!0:(-1!=(h=t.indexOf(""))&&(h=t.substring(0,h))!=a&&(a=h,n.clear()),n.containsKey(t)||(e=!0,n.add(t,t)))}if(s=e,this.matrix.linePlacement[i]==at.c.StiTableLineInfo.Data||this.matrix.linePlacement[i]==at.c.StiTableLineInfo.FooterD||e){for(let e=0;e<m-1;e++){this.matrix.cells[r][e]=this.matrix.cells[i][e];let t=this.matrix.cells[r][e];null!=t&&(t.top=r,t.exportImage),0!=r&&null==this.matrix.bordersX[i][e]||(this.matrix.bordersX[r][e]=this.matrix.bordersX[i][e]),this.matrix.bordersX[r+1][e]=this.matrix.bordersX[i+1][e],this.matrix.bordersY[r][e]=this.matrix.bordersY[i][e],this.matrix.bookmarks[r][e]=this.matrix.bookmarks[i][e]}this.matrix.bordersY[r][m-1]=this.matrix.bordersY[i][m-1];var h=this.matrix.coordY.getByIndex(i+1,g)-this.matrix.coordY.getByIndex(i,g);this.matrix.coordY.setByIndex(r+1,this.matrix.coordY.getByIndex(r,g)+h,g),r++}}if(0<c-1-r){let e=new Wt;for(let t=0;t<r+1;t++){var w=this.matrix.coordY.getByIndex(t,g);e.add(w)}this.matrix.coordY=e}}}getParentBandName(t){let e=this.matrix.parentBandName[t];var t=e.indexOf("");if(-1==t)return e;return e.substr(0,t)}convertAllowHtmlTagsToExcelString(t,e){let r=new F(V.UTF8);var i=new d(t.font.bold,t.font.italic,t.font.underline,t.font.strikeout,t.font.sizeInPoints,t.font.name,Et.toColor(t.textBrush),Et.toColor(t.brush),!1,!1,0,0,1,t.horAlignment),i=new kt(i,0),n=it.parseHtmlToStates(t.text,i);for(let i=0;i<n.length;i++){let t=n[i],e=(r.writeStartElement("r"),r.writeStartElement("rPr"),t.ts.bold&&r.writeElementString("b",null),t.ts.italic&&r.writeElementString("i",null),t.ts.underline&&r.writeElementString("u",null),t.ts.strikeout&&r.writeElementString("strike",null),t.ts.superscript&&(r.writeStartElement("vertAlign"),r.writeAttributeString("val","superscript"),r.writeEndElement()),t.ts.subsript&&(r.writeStartElement("vertAlign"),r.writeAttributeString("val","subscript"),r.writeEndElement()),r.writeStartElement("sz"),r.writeAttributeString("val",t.ts.fontSize.toString()),r.writeEndElement(),r.writeStartElement("color"),r.writeAttributeString("rgb",pt.format("{0:X8}",t.ts.fontColor.toArgb())),r.writeEndElement(),r.writeStartElement("rFont"),r.writeAttributeString("val",t.ts.fontName),r.writeEndElement(),r.writeEndElement(),it.prepareStateText(t.text).toString());pt.isNullOrEmpty(e)&&(e=" "),this.convertTextToExcelString(r,e),r.writeEndElement()}return r.flush(),r.close(),r.textWriter.getStringBuilder().toString()}convertTextToExcelString(t,e){t.writeStartElement("t"),0<e.length&&(ot.isWhitespace(e,e.length-1)||ot.isWhitespace(e,0)||-1!=e.indexOf("\n"))&&t.writeAttributeString("xml:space","preserve"),t.writeString(e),t.writeFullEndElement()}writeDrawingRels(t){var e=new tt;let i=new F(V.UTF8,e);i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(let t=this.imageListOffset;t<this.imageList.length;t++){var r=this.imageList[t];i.writeStartElement("Relationship"),i.writeAttributeString("Id",pt.format("rId{0}",t-this.imageListOffset+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),i.writeAttributeString("Target",pt.format("../media/image{0:D5}.jpeg",r.ImageIndex+1)),i.writeEndElement(),pt.isNullOrWhiteSpace(r.Hyperlink)||(i.writeStartElement("Relationship"),i.writeAttributeString("Id",pt.format("hId{0}",t-this.imageListOffset+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),i.writeAttributeString("Target",r.Hyperlink),i.writeAttributeString("TargetMode","External"),i.writeEndElement())}return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeDrawing(t){var e=new tt;let i=new F(V.UTF8,e);i.writeStartDocument(),i.writeStartElement("xdr:wsDr"),i.writeAttributeString("xmlns:xdr","http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"),i.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main");for(let t=this.imageListOffset;t<this.imageList.length;t++){var r=this.imageList[t];i.writeStartElement("xdr:twoCellAnchor"),i.writeAttributeString("editAs","oneCell"),i.writeStartElement("xdr:from"),i.writeElementString("xdr:col",pt.format("{0}",r.FirstColumnIndex)),i.writeElementString("xdr:colOff",pt.format("{0}",r.FirstColumnOffset)),i.writeElementString("xdr:row",pt.format("{0}",r.FirstRowIndex)),i.writeElementString("xdr:rowOff",pt.format("{0}",r.FirstRowOffset)),i.writeEndElement(),i.writeStartElement("xdr:to"),i.writeElementString("xdr:col",pt.format("{0}",r.LastColumnIndex)),i.writeElementString("xdr:colOff",pt.format("{0}",r.LastColumnOffset)),i.writeElementString("xdr:row",pt.format("{0}",r.LastRowIndex)),i.writeElementString("xdr:rowOff",pt.format("{0}",r.LastRowOffset)),i.writeEndElement(),i.writeStartElement("xdr:pic"),i.writeStartElement("xdr:nvPicPr"),i.writeStartElement("xdr:cNvPr"),i.writeAttributeString("id",pt.format("{0}",t-this.imageListOffset+2)),i.writeAttributeString("name",pt.format("Picture {0}",t-this.imageListOffset+1)),i.writeAttributeString("descr",pt.format("image{0:D5}",t+1)),pt.isNullOrWhiteSpace(r.Hyperlink)||(i.writeStartElement("a:hlinkClick"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("r:id",pt.format("hId{0}",t-this.imageListOffset+1)),i.writeEndElement()),i.writeEndElement(),i.writeStartElement("xdr:cNvPicPr"),i.writeStartElement("a:picLocks"),i.writeAttributeString("noChangeAspect","1"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("xdr:blipFill"),i.writeStartElement("a:blip"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("r:embed",pt.format("rId{0}",t-this.imageListOffset+1)),i.writeEndElement(),i.writeStartElement("a:stretch"),i.writeStartElement("a:fillRect"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("xdr:spPr"),i.writeStartElement("a:xfrm"),i.writeStartElement("a:off"),i.writeAttributeString("x","1"),i.writeAttributeString("y","1"),i.writeEndElement(),i.writeStartElement("a:ext"),i.writeAttributeString("cx","2"),i.writeAttributeString("cy","2"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("a:prstGeom"),i.writeAttributeString("prst","rect"),i.writeStartElement("a:avLst"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("xdr:clientData"),i.writeEndElement(),i.writeEndElement()}return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeStyles(){var t=new tt;let s=new F(V.UTF8,t);if(s.writeStartDocument(),s.writeStartElement("styleSheet"),s.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),0<this.formatList.length){s.writeStartElement("numFmts"),s.writeAttributeString("count",pt.format("{0}",this.formatList.length));for(let t=0;t<this.formatList.length;t++)s.writeStartElement("numFmt"),s.writeAttributeString("numFmtId",pt.format("{0}",164+t)),s.writeAttributeString("formatCode",this.formatList[t]),s.writeEndElement();s.writeEndElement()}s.writeStartElement("fonts"),s.writeAttributeString("count",pt.format("{0}",this.fontList.length));for(let e=0;e<this.fontList.length;e++){let t=this.fontList[e];s.writeStartElement("font"),t.Bold&&s.writeElementString("b",""),t.Italic&&s.writeElementString("i",""),t.Underlined&&s.writeElementString("u",""),t.Strikeout&&s.writeElementString("strike",""),s.writeStartElement("sz"),s.writeAttributeString("val",pt.format("{0}",t.Height)),s.writeEndElement(),s.writeStartElement("color"),s.writeAttributeString("rgb",pt.format("{0:X8}",t.Color.toArgb())),s.writeEndElement(),s.writeStartElement("name"),s.writeAttributeString("val",t.Name),s.writeEndElement(),s.writeStartElement("charset"),s.writeAttributeString("val",pt.format("{0}",t.Charset)),s.writeEndElement(),s.writeEndElement()}s.writeEndElement(),s.writeStartElement("fills"),s.writeAttributeString("count",pt.format("{0}",this.fillList.length));for(let e=0;e<this.fillList.length;e++){let t=this.fillList[e];s.writeStartElement("fill"),s.writeStartElement("patternFill"),s.writeAttributeString("patternType",t.Type),"solid"==t.Type&&(s.writeStartElement("fgColor"),s.writeAttributeString("rgb",pt.format("{0:X8}",t.FgColor.toArgb())),s.writeEndElement(),s.writeStartElement("bgColor"),s.writeAttributeString("indexed","64"),s.writeEndElement()),s.writeEndElement(),s.writeEndElement()}s.writeEndElement(),s.writeStartElement("borders"),s.writeAttributeString("count",pt.format("{0}",this.borderList.length));for(let t=0;t<this.borderList.length;t++){var e=this.borderList[t];s.writeStartElement("border"),this.writeBorderData(s,"left",e.BorderLeft),this.writeBorderData(s,"right",e.BorderRight),this.writeBorderData(s,"top",e.BorderTop),this.writeBorderData(s,"bottom",e.BorderBottom),this.writeBorderData(s,"diagonal",null),s.writeEndElement()}s.writeEndElement(),s.writeStartElement("cellStyleXfs"),s.writeAttributeString("count","1"),s.writeStartElement("xf"),s.writeAttributeString("numFmtId","0"),s.writeAttributeString("fontId","0"),s.writeAttributeString("fillId","0"),s.writeAttributeString("borderId","0"),s.writeEndElement(),s.writeEndElement(),s.writeStartElement("cellXfs"),s.writeAttributeString("count",pt.format("{0}",this.xfList.length));for(let a=0;a<this.xfList.length;a++){let t=this.xfList[a];var o=this.fillList[t.FillIndex];let e=t.FillIndex,i=(0==o.FgColor.a&&(e=0),s.writeStartElement("xf"),s.writeAttributeString("numFmtId",pt.format("{0}",t.FormatIndex)),s.writeAttributeString("fontId",pt.format("{0}",t.FontIndex)),s.writeAttributeString("fillId",pt.format("{0}",e)),s.writeAttributeString("borderId",pt.format("{0}",t.BorderIndex)),s.writeAttributeString("xfId",pt.format("{0}",t.XFId)),0!=t.FormatIndex&&s.writeAttributeString("applyNumberFormat","1"),0!=t.FontIndex&&s.writeAttributeString("applyFont","1"),0!=t.FillIndex&&s.writeAttributeString("applyFill","1"),0!=t.BorderIndex&&s.writeAttributeString("applyBorder","1"),s.writeAttributeString("applyAlignment","1"),t.Editable&&s.writeAttributeString("applyProtection","1"),t.HorAlign),r=t.VertAlign;if(0!=t.TextRotationAngle){var o=t.HorAlign,l=t.VertAlign;if(i=wt.Center,r=dt.Center,90==t.TextRotationAngle){switch(o){case wt.Left:r=dt.Bottom;break;case wt.Right:r=dt.Top;break}switch(l){case dt.Top:i=wt.Left;break;case dt.Bottom:i=wt.Right;break}}if(180==t.TextRotationAngle){switch(o){case wt.Left:r=dt.Top;break;case wt.Right:r=dt.Bottom;break}switch(l){case dt.Top:i=wt.Right;break;case dt.Bottom:i=wt.Left;break}}}s.writeStartElement("alignment");let n="left";switch(i){case wt.Right:n="right";break;case wt.Center:n="center";break;case wt.Width:n="justify";break}if(s.writeAttributeString("horizontal",n),r!=dt.Bottom){let t="";switch(r){case dt.Top:t="top";break;case dt.Center:t="center";break}s.writeAttributeString("vertical",t)}0!=t.TextRotationAngle&&s.writeAttributeString("textRotation",t.TextRotationAngle.toString()),t.TextWrapped&&s.writeAttributeString("wrapText","1"),t.RightToLeft&&s.writeAttributeString("readingOrder","2"),s.writeEndElement(),t.Editable&&(s.writeStartElement("protection"),s.writeAttributeString("locked","0"),s.writeEndElement()),s.writeEndElement()}return s.writeEndElement(),s.writeStartElement("cellStyles"),s.writeAttributeString("count","1"),s.writeStartElement("cellStyle"),s.writeAttributeString("name","Normal"),s.writeAttributeString("xfId","0"),s.writeAttributeString("builtinId","0"),s.writeEndElement(),s.writeEndElement(),s.writeStartElement("dxfs"),s.writeAttributeString("count","0"),s.writeEndElement(),s.writeStartElement("tableStyles"),s.writeAttributeString("count","0"),s.writeAttributeString("defaultTableStyle","TableStyleMedium9"),s.writeAttributeString("defaultPivotStyle","PivotStyleLight16"),s.writeEndElement(),s.writeFullEndElement(),s.writeEndDocument(),s.flush(),t}writeBorderData(e,i,r){if(e.writeStartElement(i),null!=r){var i=this.getLineStyle(r);let t=r.color;""!=i&&(e.writeAttributeString("style",i),e.writeStartElement("color"),e.writeAttributeString("rgb",pt.format("{0:X8}",t.toArgb())),e.writeEndElement())}e.writeEndElement()}writeSST(){var t=new tt;let r=new F(V.UTF8,t);r.writeStartDocument(),r.writeStartElement("sst"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),r.writeAttributeString("count",pt.format("{0}",this.sstCount)),r.writeAttributeString("uniqueCount",pt.format("{0}",this.sstList.length));for(let t=0;t<this.sstList.length;t++){r.writeStartElement("si");let e=this.sstList[t],i=new ut;for(let t=0;t<e.length;t++)(32<=e.charCodeAt(t)||"\n"==e.charAt(t))&&i.append(e.charAt(t));e=i.toString(),this.sstHashIsTags.containsKey(t)?r.writeRaw(e):this.convertTextToExcelString(r,e),r.writeEndElement()}return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),t}writeAdditionalData(t,e){let i=new tt,r=null;return r=e?rt.System.Convert.fromBase64String(t):V.ASCII.getBytes(t),i.write(r,0,r.length),i}writeImage(t){let e=new tt;var t=this.imageCache.imagePackedStore[t];return null!=t&&e.write(t,0,t.length),e}exportExcel(o,t,e){at.a.StiLogService.write(this.stimulsoft().getType(),"Export report to Excel 2007 format");let r=e.pageRange;this.useOnePageHeaderAndFooter=e.useOnePageHeaderAndFooter,this.dataExportMode=e.dataExportMode,this.exportObjectFormatting=e.exportObjectFormatting,this.exportEachPageToSheet=e.exportEachPageToSheet,this.exportHorizontalPageBreaks=e.exportPageBreaks,this.imageResolution=e.imageResolution,this.imageQuality=e.imageQuality,this.docCompanyString=e.companyString,this.docLastModifiedString=e.lastModifiedString,this.restrictEditing=e.restrictEditing,this.xmlIndentation=-1,this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.dataExportMode!=at.c.StiDataExportMode.AllBands?this.useOnePageHeaderAndFooter=!1:this.exportObjectFormatting=!0,rt["StiOptions"].Export.Excel.RestrictEditing>this.restrictEditing&&(this.restrictEditing=rt["StiOptions"].Export.Excel.RestrictEditing),this.report=o;try{this.reportCulture=S.currentCulture;let a=r.getSelectedPages(o.renderedPages),s=(this.currentPassNumber=0,this.maximumPassNumber=3,this.prepareData(),0);while(s<a.length){let t=new T(o,o.renderedPages);t.cacheMode=o.renderedPages.cacheMode,t.addV2Internal(a.getPageWithoutCache(s));var l=s;if(!this.exportEachPageToSheet){var m=a.getPageWithoutCache(s).excelSheetValue;while(s<a.length-1&&this.compareExcellSheetNames(a.getPageWithoutCache(s+1).excelSheetValue,m))s++,t.addV2Internal(a.getPageWithoutCache(s))}let e=t.getByIndex(0).excelSheetValue,i=(null!=e&&""!=e||(e=pt.format("Page {0}",this.sheetNameList.length+1)),""),r=1,n=(this.prepareMatrix(t),0);do{this.firstPageIndexList.push(l),this.matrixList.push(this.matrix);let t=this.matrix.coordY.countItems-1;t-n>rt["StiOptions"].Export.Excel.MaximumSheetHeight?t=n+rt["StiOptions"].Export.Excel.MaximumSheetHeight:this.matrix=null,this.minRowList.push(n),this.maxRowList.push(t),n=t,null!=this.matrix||0<i.length?(i=pt.format(" part{0}",r++),24<e.length&&(e=e.substr(0,24))):30<e.length&&(e=e.substr(0,30)),this.sheetNameList.push(e+i)}while(null!=this.matrix);s++}let i=new ct;for(let t=0;t<this.sheetNameList.length;t++){let e=this.sheetNameList[t];if(e=e.stimulsoft().replaceAll("*","_").stimulsoft().replaceAll("\\","_").stimulsoft().replaceAll("/","_").stimulsoft().replaceAll("[","_").stimulsoft().replaceAll("]","_").stimulsoft().replaceAll(":","_").stimulsoft().replaceAll("?","_"),i.contains(e)){let t=1;while(i.contains(e+"-"+t.toString()))t++;e=e+"-"+t.toString()}i.add(e,e),this.sheetNameList[t]=e}let e=new u;e.begin(t,!0),this.currentPassNumber=2,this.imageListOffset=0;for(let t=0;t<this.matrixList.length;t++)this.hyperlinkList=[],e.addFile(pt.format("xl/worksheets/sheet{0}.xml",t+1),this.writeSheet(t,a.getByIndex(this.firstPageIndexList[t]))),e.addFile(pt.format("xl/worksheets/_rels/sheet{0}.xml.rels",t+1),this.writeSheetRels(t)),0<this.imageList.length-this.imageListOffset&&(e.addFile(pt.format("xl/drawings/_rels/drawing{0}.xml.rels",t+1),this.writeDrawingRels(t)),e.addFile(pt.format("xl/drawings/drawing{0}.xml",t+1),this.writeDrawing(t))),this.imageListOffset=this.imageList.length;if(e.addFile("[Content_Types].xml",this.writeContentTypes()),e.addFile("_rels/.rels",this.writeMainRels()),e.addFile("docProps/app.xml",this.writeDocPropsApp()),e.addFile("docProps/core.xml",this.writeDocPropsCore()),e.addFile("xl/_rels/workbook.xml.rels",this.writeWorkbookRels()),e.addFile("xl/workbook.xml",this.writeWorkbook()),e.addFile("xl/styles.xml",this.writeStyles()),0<this.sstList.length&&e.addFile("xl/sharedStrings.xml",this.writeSST()),0<this.imageCache.imagePackedStore.length)for(let t=0;t<this.imageCache.imagePackedStore.length;t++)e.addFile(pt.format("xl/media/image{0:D5}.jpeg",t+1),this.writeImage(t));rt.Base.gVpwr.mgdPW.olcUT()||rt.Base.gVpwr.mgdPW.HdOnK()||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud()||rt.Base.gVpwr.mgdPW.DnFeB())&&rt.System.NodeJs.isStandaloneVersion||(e.addFile("xl/media/imageAdditional.png",this.writeAdditionalData(at.c.StiExportUtils.additionalData,!0)),e.addFile("xl/drawings/_rels/vmlDrawingAdditional.vml.rels",this.writeAdditionalData('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="dId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="../media/imageAdditional.png"/></Relationships>',!1)),e.addFile("xl/drawings/vmlDrawingAdditional.vml",this.writeAdditionalData('<xml xmlns:v="urn:schemas-microsoft-com:vml"\r\n xmlns:o="urn:schemas-microsoft-com:office:office"\r\n xmlns:x="urn:schemas-microsoft-com:office:excel">\r\n <o:shapelayout v:ext="edit">\r\n  <o:idmap v:ext="edit" data="1"/>\r\n'+' </o:shapelayout><v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75"\r\n  o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">\r\n  <v:stroke joinstyle="miter"/>\r\n  <v:formulas>'+'\r\n   <v:f eqn="if lineDrawn pixelLineWidth 0"/>\r\n   <v:f eqn="sum @0 1 0"/>\r\n   <v:f eqn="sum 0 0 @1"/>\r\n   <v:f eqn="prod @2 1 2"/>\r\n   <v:f eqn="prod @3 21600 pixelWidth"/>\r\n   <v:f eqn="prod @3 21600 pixelHeight"/>\r\n   <v:f eqn="sum @0 0 1"/>'+'\r\n   <v:f eqn="prod @6 1 2"/>\r\n   <v:f eqn="prod @7 21600 pixelWidth"/>\r\n   <v:f eqn="sum @8 21600 0"/>\r\n   <v:f eqn="prod @7 21600 pixelHeight"/>\r\n   <v:f eqn="sum @10 21600 0"/>\r\n  </v:formulas>\r\n  <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>'+'\r\n  <o:lock v:ext="edit" aspectratio="t"/>\r\n </v:shapetype><v:shape id="CH" o:spid="_x0000_s1027" type="#_x0000_t75"\r\n  style=\'position:absolute;margin-left:0;margin-top:0;width:365pt;height:298pt;\r\n  z-index:1\'>'+'\r\n  <v:imagedata o:relid="dId1" o:title="additional"/>\r\n  <o:lock v:ext="edit" rotation="t"/>\r\n </v:shape></xml>',!1))),e.end()}catch(t){rt.System.StiError.showError(t,!1)}finally{null!=this.matrix&&(this.matrix.clear(),this.matrix=null),this.fontList=null,this.fillList=null,this.borderList=null,this.xfList=null,this.sstList=null,this.sstHash=null,this.sstHashIsTags=null,this.formatList=null,this.sheetNameList=null,this.imageList.stimulsoft().clear(),this.imageList=null,this.imageCache.clear(),this.printAreasList=null,this.matrixList=null,this.firstPageIndexList=null,this.hyperlinkList=null,this.minRowList=null,this.maxRowList=null}}}Si.regexCheckInteger1=new RegExp("^[+-]?d+$"),Si.regexCheckFloat1=new RegExp("^[+-]?([0-9]+([.][0-9]*)?|[.][0-9]+)$"),at.c.StiExcel2007ExportService=Si;class ui{constructor(t,e,i,r,n,a,s,o,l){this.Name=t,this.Bold=e,this.Italic=i,this.Underlined=r,this.Strikeout=n,this.Height=a,this.Color=s,this.Charset=o,this.Family=l}equals(t){return this.Name==t.Name&&this.Bold==t.Bold&&this.Italic==t.Italic&&this.Underlined==t.Underlined&&this.Strikeout==t.Strikeout&&this.Height==t.Height&&this.Color.equals(t.Color)&&this.Charset==t.Charset&&this.Family==t.Family}}at.c.DataFont=ui;class fi{constructor(t,e,i){this.Type=t,this.FgColor=e,this.BgColor=i}equals(t){return this.Type==t.Type&&this.FgColor.equals(t.FgColor)&&this.BgColor.equals(t.BgColor)}}at.c.DataFill=fi;class vi{constructor(t,e,i,r){this.BorderLeft=t,this.BorderRight=e,this.BorderTop=i,this.BorderBottom=r}equals(t){return this.eq(this.BorderLeft,t.BorderLeft)&&this.eq(this.BorderRight,t.BorderRight)&&this.eq(this.BorderTop,t.BorderTop)&&this.eq(this.BorderBottom,t.BorderBottom)}eq(t,e){return null==t&&null==e||null!=t&&null!=e&&t.stimulsoft().equals(e)}}at.c.DataBorder=vi;class Ei{constructor(t,e,i,r,n,a,s,o,l,m,c){this.FormatIndex=t,this.FontIndex=e,this.FillIndex=i,this.BorderIndex=r,this.XFId=n,this.HorAlign=a,this.VertAlign=s,this.TextRotationAngle=o,this.TextWrapped=l,this.RightToLeft=m,this.Editable=c}equalDataXF(t){if(this.FormatIndex!=t.FormatIndex||this.FontIndex!=t.FontIndex||this.FillIndex!=t.FillIndex||this.BorderIndex!=t.BorderIndex||this.XFId!=t.XFId||this.HorAlign!=t.HorAlign||this.VertAlign!=t.VertAlign||this.TextRotationAngle!=t.TextRotationAngle||this.TextWrapped!=t.TextWrapped||this.RightToLeft!=t.RightToLeft||this.Editable!=t.Editable)return!1;return!0}}at.c.DataXF=Ei;class bi{constructor(t,e,i,r,n,a,s,o,l,m){this.FirstRowIndex=t,this.FirstRowOffset=e,this.FirstColumnIndex=i,this.FirstColumnOffset=r,this.LastRowIndex=n,this.LastRowOffset=a,this.LastColumnIndex=s,this.LastColumnOffset=o,this.ImageIndex=l,this.Hyperlink=m}}at.c.ExcelImageData=bi;class xi{constructor(t,e,i,r){this.FirstRow=t,this.LastRow=e,this.FirstColumn=i,this.LastColumn=r}}at.c.CellRangeAddress=xi;class yi{constructor(t,e,i){this.Range=t,this.Description=e,this.Bookmark=i}}at.c.HlinkData=yi}at.c.StiExcelXmlExportService=class extends at.c.StiExportService{implements(){return[at.c.IStiExcelXmlExportService]}exportTo(t,e,i){}};let xt=rt.System.Drawing.Rectangle,x=rt.Base.Drawing.StiHorAlignment,y=rt.Base.Drawing.StiCapStyle,A=at.a.Components.StiVerticalLinePrimitive,P=at.a.Components.StiHorizontalLinePrimitive,k=at.a.Components.StiLinePrimitive,I=at.a.Components.StiTextQuality;at.c.StiPpt2007ExportService=class extends at.c.StiExportService{constructor(){super(...arguments),this.imageListOffset=0,this.imageResolution=1,this.imageQuality=.75,this.imageCache=null,this.idCounter=2,this.hyperlinkList=null,this.xmlIndentation=1,this.currentCulture=null,this.newCulture=null,this.wrongUrlSymbols=" \"#'*,;<>[^`{|}",this.HiToTwips=14.4*.995}implements(){return[at.c.IStiPpt2007ExportService]}get exportFormat(){return at.a.StiExportFormat.Ppt2007}exportTo(t,e,i){this.exportPowerPoint(t,e,i)}exportToAsync(t,e,i,r){setTimeout(async()=>{if(await at.c.StiExportImageHelper.convertAllImages(e,rt["StiOptions"].Export.PowerPoint.StoreImagesAsPng?rt.System.Drawing.Imaging.ImageFormat.Png:rt.System.Drawing.Imaging.ImageFormat.Jpeg,!1,this.exportFormat),!e.isDocument&&e.getCurrentPage().is(p))return await h.export(e,i,r),void t();this.exportTo(e,i,r),null!=e&&null!=e.preparedExportImages&&(e.preparedExportImages.clear(),e.preparedExportImages=null),t()},0)}getLineStyle(t){switch(t){case bt.Solid:return"solid";case bt.Dot:return"sysDot";case bt.Dash:return"sysDash";case bt.DashDot:return"sysDashDot";case bt.DashDotDot:return"sysDashDotDot";case bt.Double:return"solid";default:return"solid"}}stringToUrl(t){var t=V.UTF8.getBytes(t),e;let i=new ut;for(e of t){var r=String.fromCharCode(e);e<32||127<e||-1!=this.wrongUrlSymbols.indexOf(r)?i.append(pt.format("%{0:x2}",e)):i.append(r)}return i.toString()}convert(t){return 0|Math.round(t*this.HiToTwips)}convertTwipsToEmu(t){return 0|Math.round(t/this.HiToTwips/100*914400)}convertToEmu(t){return 0|Math.round(t/100*914400)}writeColor(e,i){if(e.writeStartElement("a:srgbClr"),e.writeAttributeString("val",pt.format("{0:X6}",16777215&i.toArgb())),255!=i.a){let t=i.a/256*1e5|0;e.writeStartElement("a:alpha"),e.writeAttributeString("val",t.toString()),e.writeEndElement()}e.writeEndElement()}writeContentTypes(e){var t=new tt;let i=new F(V.UTF8,t);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?C.None:C.Indented,i.writeStartDocument(),i.writeStartElement("Types"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types");for(let t=0;t<11;t++)i.writeStartElement("Override"),i.writeAttributeString("PartName",`/ppt/slideLayouts/slideLayout${t+1}.xml`),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml"),i.writeEndElement();i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/slideMasters/slideMaster1.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/presProps.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.presProps+xml"),i.writeEndElement();for(let t=0;t<e;t++)i.writeStartElement("Override"),i.writeAttributeString("PartName",`/ppt/slides/slide${t+1}.xml`),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slide+xml"),i.writeEndElement();return i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/theme/theme1.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.theme+xml"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","jpeg"),i.writeAttributeString("ContentType","image/jpeg"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","png"),i.writeAttributeString("ContentType","image/png"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","rels"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","xml"),i.writeAttributeString("ContentType","application/xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/presentation.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/docProps/app.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/tableStyles.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/viewProps.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/docProps/core.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),t}writeMainRels(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","ppt/presentation.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsApp(e){var t=new tt;let i=new F(V.UTF8,t);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?C.None:C.Indented,i.writeStartDocument(),i.writeStartElement("Properties"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),i.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),i.writeElementString("Application","Microsoft Office PowerPoint"),i.writeElementString("Slides",e.toString()),i.writeElementString("PresentationFormat","On-screen Show (4:3)"),i.writeElementString("TotalTime","0"),i.writeElementString("Words","0"),i.writeElementString("Paragraphs","0"),i.writeElementString("Notes","0"),i.writeElementString("HiddenSlides","0"),i.writeElementString("MMClips","0"),i.writeElementString("ScaleCrop","false"),i.writeStartElement("HeadingPairs"),i.writeStartElement("vt:vector"),i.writeAttributeString("size","4"),i.writeAttributeString("baseType","variant"),i.writeStartElement("vt:variant"),i.writeElementString("vt:lpstr","Theme"),i.writeEndElement(),i.writeStartElement("vt:variant"),i.writeElementString("vt:i4",e.toString()),i.writeEndElement(),i.writeStartElement("vt:variant"),i.writeElementString("vt:lpstr","Slide Titles"),i.writeEndElement(),i.writeStartElement("vt:variant"),i.writeElementString("vt:i4",e.toString()),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("TitlesOfParts"),i.writeStartElement("vt:vector"),i.writeAttributeString("size",(1+e).toString()),i.writeAttributeString("baseType","lpstr"),i.writeElementString("vt:lpstr","Office Theme");for(let t=0;t<e;t++)i.writeElementString("vt:lpstr",`Slide `+(t+1));return i.writeEndElement(),i.writeEndElement(),i.writeElementString("Company","Stimulsoft"),i.writeElementString("LinksUpToDate","false"),i.writeElementString("SharedDoc","false"),i.writeElementString("HyperlinksChanged","false"),i.writeElementString("AppVersion","12.0000"),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),t}writeDocPropsCore(){var t=new tt;let e=new F(V.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("cp:coreProperties"),e.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),e.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),e.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");var i=gt.now.toString("yyyy-MM-ddTHH:mm:ssZ");return e.writeElementString("dc:title",""),e.writeElementString("dc:subject",""),e.writeElementString("dc:creator","Stimulsoft Reports"),e.writeElementString("cp:keywords",""),e.writeElementString("dc:description",""),e.writeElementString("cp:lastModifiedBy","Stimulsoft Reports"),e.writeElementString("cp:revision","1"),e.writeStartElement("dcterms:created"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(i),e.writeEndElement(),e.writeStartElement("dcterms:modified"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(i),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeTableStyles(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("a:tblStyleLst"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("def","{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}"),e.writeEndElement(),e.writeEndDocument(),e.flush(),t}writePresProps(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("p:presentationPr"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeViewProps(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("p:viewPr"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),e.writeStartElement("p:normalViewPr"),e.writeAttributeString("showOutlineIcons","0"),e.writeStartElement("p:restoredLeft"),e.writeAttributeString("sz","15591"),e.writeAttributeString("autoAdjust","0"),e.writeEndElement(),e.writeStartElement("p:restoredTop"),e.writeAttributeString("sz","94675"),e.writeAttributeString("autoAdjust","0"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:slideViewPr"),e.writeStartElement("p:cSldViewPr"),e.writeStartElement("p:cViewPr"),e.writeAttributeString("varScale","1"),e.writeStartElement("p:scale"),e.writeStartElement("a:sx"),e.writeAttributeString("n","107"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeStartElement("a:sy"),e.writeAttributeString("n","107"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:origin"),e.writeAttributeString("x","-1098"),e.writeAttributeString("y","-84"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:guideLst"),e.writeStartElement("p:guide"),e.writeAttributeString("orient","horz"),e.writeAttributeString("pos","2160"),e.writeEndElement(),e.writeStartElement("p:guide"),e.writeAttributeString("pos","2880"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:notesTextViewPr"),e.writeStartElement("p:cViewPr"),e.writeStartElement("p:scale"),e.writeStartElement("a:sx"),e.writeAttributeString("n","100"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeStartElement("a:sy"),e.writeAttributeString("n","100"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:origin"),e.writeAttributeString("x","0"),e.writeAttributeString("y","0"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:gridSpacing"),e.writeAttributeString("cx","73736200"),e.writeAttributeString("cy","73736200"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeTheme(){var t=new tt,e;let i=new F(V.UTF8,t);return i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?C.None:C.Indented,i.writeStartDocument(),i.writeRaw('<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000" /></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF" /></a:lt1><a:dk2><a:srgbClr val="1F497D" /></a:dk2><a:lt2><a:srgbClr val="EEECE1" /></a:lt2><a:accent1><a:srgbClr val="4F81BD" /></a:accent1><a:accent2><a:srgbClr val="C0504D" /></a:accent2><a:accent3><a:srgbClr val="9BBB59" /></a:accent3><a:accent4>'+'<a:srgbClr val="8064A2" /></a:accent4><a:accent5><a:srgbClr val="4BACC6" /></a:accent5><a:accent6><a:srgbClr val="F79646" /></a:accent6><a:hlink><a:srgbClr val="0000FF" /></a:hlink><a:folHlink><a:srgbClr val="800080" /></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Calibri" /><a:ea typeface="" /><a:cs typeface="" /><a:font script="Jpan" typeface="ＭＳ Ｐゴシック" /><a:font script="Hang" typeface="맑은 고딕" /><a:font script="Hans" typeface="宋体" /><a:font script="Hant" typeface="新細明體" />'+'<a:font script="Arab" typeface="Times New Roman" /><a:font script="Hebr" typeface="Times New Roman" /><a:font script="Thai" typeface="Angsana New" /><a:font script="Ethi" typeface="Nyala" /><a:font script="Beng" typeface="Vrinda" /><a:font script="Gujr" typeface="Shruti" /><a:font script="Khmr" typeface="MoolBoran" /><a:font script="Knda" typeface="Tunga" /><a:font script="Guru" typeface="Raavi" /><a:font script="Cans" typeface="Euphemia" /><a:font script="Cher" typeface="Plantagenet Cherokee" /><a:font script="Yiii" typeface="Microsoft Yi Baiti" />'+'<a:font script="Tibt" typeface="Microsoft Himalaya" /><a:font script="Thaa" typeface="MV Boli" /><a:font script="Deva" typeface="Mangal" /><a:font script="Telu" typeface="Gautami" /><a:font script="Taml" typeface="Latha" /><a:font script="Syrc" typeface="Estrangelo Edessa" /><a:font script="Orya" typeface="Kalinga" /><a:font script="Mlym" typeface="Kartika" /><a:font script="Laoo" typeface="DokChampa" /><a:font script="Sinh" typeface="Iskoola Pota" /><a:font script="Mong" typeface="Mongolian Baiti" /><a:font script="Viet" typeface="Times New Roman" />'+'<a:font script="Uigh" typeface="Microsoft Uighur" /></a:majorFont><a:minorFont><a:latin typeface="Calibri" /><a:ea typeface="" /><a:cs typeface="" /><a:font script="Jpan" typeface="ＭＳ Ｐゴシック" /><a:font script="Hang" typeface="맑은 고딕" /><a:font script="Hans" typeface="宋体" /><a:font script="Hant" typeface="新細明體" /><a:font script="Arab" typeface="Arial" /><a:font script="Hebr" typeface="Arial" /><a:font script="Thai" typeface="Cordia New" /><a:font script="Ethi" typeface="Nyala" /><a:font script="Beng" typeface="Vrinda" />'+'<a:font script="Gujr" typeface="Shruti" /><a:font script="Khmr" typeface="DaunPenh" /><a:font script="Knda" typeface="Tunga" /><a:font script="Guru" typeface="Raavi" /><a:font script="Cans" typeface="Euphemia" /><a:font script="Cher" typeface="Plantagenet Cherokee" /><a:font script="Yiii" typeface="Microsoft Yi Baiti" /><a:font script="Tibt" typeface="Microsoft Himalaya" /><a:font script="Thaa" typeface="MV Boli" /><a:font script="Deva" typeface="Mangal" /><a:font script="Telu" typeface="Gautami" /><a:font script="Taml" typeface="Latha" />'+'<a:font script="Syrc" typeface="Estrangelo Edessa" /><a:font script="Orya" typeface="Kalinga" /><a:font script="Mlym" typeface="Kartika" /><a:font script="Laoo" typeface="DokChampa" /><a:font script="Sinh" typeface="Iskoola Pota" /><a:font script="Mong" typeface="Mongolian Baiti" /><a:font script="Viet" typeface="Arial" /><a:font script="Uigh" typeface="Microsoft Uighur" /></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0">'+'<a:schemeClr val="phClr"><a:tint val="50000" /><a:satMod val="300000" /></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000" /><a:satMod val="300000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000" /><a:satMod val="350000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1" /></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000" /><a:satMod val="130000" /></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr">'+'<a:shade val="93000" /><a:satMod val="130000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000" /><a:satMod val="135000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0" /></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000" /><a:satMod val="105000" /></a:schemeClr></a:solidFill><a:prstDash val="solid" /></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill>'+'<a:prstDash val="solid" /></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000" /></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000" /></a:srgbClr></a:outerShdw></a:effectLst>'+'</a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000" /></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0" /></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000" /></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400" /></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1">'+'<a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000" /><a:satMod val="350000" /></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000" /><a:shade val="99000" /><a:satMod val="350000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000" /><a:satMod val="255000" /></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000" /></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000" /><a:satMod val="300000" /></a:schemeClr>'+'</a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000" /><a:satMod val="200000" /></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000" /></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults /><a:extraClrSchemeLst /></a:theme>'),i.writeEndDocument(),i.flush(),t}writeSlideMasterRels(){var t=new tt;let e=new F(V.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(let t=0;t<11;t++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",`rId`+(t+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout"),e.writeAttributeString("Target",`../slideLayouts/slideLayout${t+1}.xml`),e.writeEndElement();return e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId12"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme"),e.writeAttributeString("Target","../theme/theme1.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeSlideMaster(){var t=new tt,e;let i=new F(V.UTF8,t);return i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?C.None:C.Indented,i.writeStartDocument(),i.writeRaw('<p:sldMaster xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:p="http://schemas.openxmlformats.org/presentationml/2006/main"><p:cSld><p:bg><p:bgRef idx="1001"><a:schemeClr val="bg1" /></p:bgRef></p:bg><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" />'+'<a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title Placeholder 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="274638" /><a:ext cx="8229600" cy="1143000" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr">'+'<a:normAutofit /></a:bodyPr><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1600200" /><a:ext cx="8229600" cy="4525963" /></a:xfrm><a:prstGeom prst="rect">'+'<a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0"><a:normAutofit /></a:bodyPr><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm>'+'<a:off x="457200" y="6356350" /><a:ext cx="2133600" cy="365125" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p>'+'<a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="3" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="3124200" y="6356350" /><a:ext cx="2895600" cy="365125" /></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="ctr"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="4" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="6553200" y="6356350" /><a:ext cx="2133600" cy="365125" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="r"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1">'+'<a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld><p:clrMap bg1="lt1" tx1="dk1" bg2="lt2" tx2="dk2" accent1="accent1" accent2="accent2" accent3="accent3" accent4="accent4" accent5="accent5" accent6="accent6" hlink="hlink" folHlink="folHlink" />'+'<p:sldLayoutIdLst><p:sldLayoutId id="2147483649" r:id="rId1" /><p:sldLayoutId id="2147483650" r:id="rId2" /><p:sldLayoutId id="2147483651" r:id="rId3" /><p:sldLayoutId id="2147483652" r:id="rId4" /><p:sldLayoutId id="2147483653" r:id="rId5" /><p:sldLayoutId id="2147483654" r:id="rId6" /><p:sldLayoutId id="2147483655" r:id="rId7" /><p:sldLayoutId id="2147483656" r:id="rId8" /><p:sldLayoutId id="2147483657" r:id="rId9" /><p:sldLayoutId id="2147483658" r:id="rId10" />'+'<p:sldLayoutId id="2147483659" r:id="rId11" /></p:sldLayoutIdLst><p:txStyles><p:titleStyle><a:lvl1pPr algn="ctr" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="0" /></a:spcBef><a:buNone /><a:defRPr sz="4400" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mj-lt" /><a:ea typeface="+mj-ea" /><a:cs typeface="+mj-cs" /></a:defRPr></a:lvl1pPr></p:titleStyle><p:bodyStyle>'+'<a:lvl1pPr marL="342900" indent="-342900" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="3200" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl1pPr>'+'<a:lvl2pPr marL="742950" indent="-285750" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="–" /><a:defRPr sz="2800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl2pPr>'+'<a:lvl3pPr marL="1143000" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2400" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl3pPr>'+'<a:lvl4pPr marL="1600200" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="–" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl4pPr>'+'<a:lvl5pPr marL="2057400" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="»" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl5pPr>'+'<a:lvl6pPr marL="2514600" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl6pPr>'+'<a:lvl7pPr marL="2971800" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl7pPr>'+'<a:lvl8pPr marL="3429000" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl8pPr>'+'<a:lvl9pPr marL="3886200" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl9pPr>'+'</p:bodyStyle><p:otherStyle><a:defPPr><a:defRPr lang="ru-RU" /></a:defPPr><a:lvl1pPr marL="0" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">'+'<a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl3pPr>'+'<a:lvl4pPr marL="1371600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill>'+'<a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl5pPr><a:lvl6pPr marL="2286000" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl6pPr>'+'<a:lvl7pPr marL="2743200" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill>'+'<a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl9pPr></p:otherStyle></p:txStyles></p:sldMaster>'),i.writeEndDocument(),i.flush(),t}writeSlideLayoutRels(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster"),e.writeAttributeString("Target","../slideMasters/slideMaster1.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeSlideLayout(t,e){var i=new tt,r,n,a,s,o,l,m,c,g,e,h,p,w,d;let S=new F(V.UTF8,i);return S.indentation=this.xmlIndentation<0?0:this.xmlIndentation,S.formatting=this.xmlIndentation<0?C.None:C.Indented,S.writeStartDocument(),S.writeStartElement("p:sldLayout"),S.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),S.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),S.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),1==t&&(S.writeAttributeString("type","title"),S.writeAttributeString("preserve","1"),S.writeRaw('<p:cSld name="Title Slide"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ctrTitle" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="685800" y="2130425" /><a:ext cx="7772400" cy="1470025" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Subtitle 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="subTitle" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1371600" y="3886200" /><a:ext cx="6400800" cy="1752600" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" />'+'</a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" />'+'</a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master subtitle style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>')),2==t&&(S.writeAttributeString("type","obj"),S.writeAttributeString("preserve","1"),S.writeRaw('<p:cSld name="Title and Content"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph idx="1" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r>'+'<a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>')),3==t&&(S.writeAttributeString("type","secHead"),S.writeAttributeString("preserve","1"),S.writeRaw('<p:cSld name="Section Header"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="722313" y="4406900" /><a:ext cx="7772400" cy="1362075" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="t" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="4000" b="1" cap="all" /></a:lvl1pPr></a:lstStyle><a:p><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="722313" y="2906713" /><a:ext cx="7772400" cy="1500187" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2000"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone />'+'<a:defRPr sz="1800"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1600"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr>'+'<a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle>'+'<a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr>'+'<p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>')),4==t&&(S.writeAttributeString("type","twoObj"),S.writeAttributeString("preserve","1"),S.writeRaw('<p:cSld name="Two Content"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph sz="half" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1600200" /><a:ext cx="4038600" cy="4525963" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2800" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2400" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2000" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1800" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1800" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1800" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1800" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1800" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1800" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Content Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4648200" y="1600200" />'+'<a:ext cx="4038600" cy="4525963" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2800" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2400" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2000" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1800" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1800" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1800" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1800" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1800" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1800" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" />'+'<a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>')),5==t&&(S.writeAttributeString("type","twoTxTwoObj"),S.writeAttributeString("preserve","1"),S.writeRaw('<p:cSld name="Comparison"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1535113" /><a:ext cx="4040188" cy="639762" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2400" b="1" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2000" b="1" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1800" b="1" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl5pPr>'+'<a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Content Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="2174875" />'+'<a:ext cx="4040188" cy="3951288" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2400" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2000" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="1800" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1600" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1600" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1600" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1600" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1600" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1600" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Text Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" sz="quarter" idx="3" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4645025" y="1535113" /><a:ext cx="4041775" cy="639762" /></a:xfrm></p:spPr>'+'<p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2400" b="1" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2000" b="1" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1800" b="1" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0">'+'<a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Content Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="quarter" idx="4" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4645025" y="2174875" /><a:ext cx="4041775" cy="3951288" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2400" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2000" /></a:lvl2pPr>'+'<a:lvl3pPr><a:defRPr sz="1800" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1600" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1600" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1600" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1600" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1600" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1600" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Date Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="8" name="Footer Placeholder 7" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="9" name="Slide Number Placeholder 8" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>')),6==t&&(S.writeAttributeString("type","titleOnly"),S.writeAttributeString("preserve","1"),S.writeRaw('<p:cSld name="Title Only"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Date Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Footer Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Slide Number Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>')),7==t&&(S.writeAttributeString("type","blank"),S.writeAttributeString("preserve","1"),S.writeStartElement("p:cSld"),S.writeAttributeString("name","Blank"),S.writeStartElement("p:spTree"),S.writeStartElement("p:nvGrpSpPr"),S.writeStartElement("p:cNvPr"),S.writeAttributeString("id","1"),S.writeAttributeString("name",""),S.writeEndElement(),S.writeStartElement("p:cNvGrpSpPr"),S.writeEndElement(),S.writeStartElement("p:nvPr"),S.writeEndElement(),S.writeFullEndElement(),S.writeStartElement("p:grpSpPr"),S.writeStartElement("a:xfrm"),S.writeStartElement("a:off"),S.writeAttributeString("x","0"),S.writeAttributeString("y","0"),S.writeEndElement(),S.writeStartElement("a:ext"),S.writeAttributeString("cx","0"),S.writeAttributeString("cy","0"),S.writeEndElement(),S.writeStartElement("a:chOff"),S.writeAttributeString("x","0"),S.writeAttributeString("y","0"),S.writeEndElement(),S.writeStartElement("a:chExt"),S.writeAttributeString("cx","0"),S.writeAttributeString("cy","0"),S.writeEndElement(),S.writeFullEndElement(),S.writeFullEndElement(),S.writeStartElement("p:sp"),S.writeStartElement("p:nvSpPr"),S.writeStartElement("p:cNvPr"),S.writeAttributeString("id","2"),S.writeAttributeString("name","Date Placeholder 1"),S.writeEndElement(),S.writeStartElement("p:cNvSpPr"),S.writeStartElement("a:spLocks"),S.writeAttributeString("noGrp","1"),S.writeEndElement(),S.writeFullEndElement(),S.writeStartElement("p:nvPr"),S.writeStartElement("p:ph"),S.writeAttributeString("type","dt"),S.writeAttributeString("sz","half"),S.writeAttributeString("idx","10"),S.writeEndElement(),S.writeFullEndElement(),S.writeFullEndElement(),S.writeStartElement("p:spPr"),S.writeEndElement(),S.writeStartElement("p:txBody"),S.writeStartElement("a:bodyPr"),S.writeEndElement(),S.writeStartElement("a:lstStyle"),S.writeEndElement(),S.writeStartElement("a:p"),S.writeStartElement("a:fld"),S.writeAttributeString("id","{BBCD0B08-7874-4091-A11F-B0CCB138CA98}"),S.writeAttributeString("type","datetimeFigureOut"),S.writeStartElement("a:rPr"),S.writeAttributeString("lang","ru-RU"),S.writeAttributeString("smtClean","0"),S.writeEndElement(),S.writeStartElement("a:t"),S.writeString("15.04.2009"),S.writeFullEndElement(),S.writeFullEndElement(),S.writeStartElement("a:endParaRPr"),S.writeAttributeString("lang","ru-RU"),S.writeEndElement(),S.writeFullEndElement(),S.writeFullEndElement(),S.writeFullEndElement(),S.writeStartElement("p:sp"),S.writeStartElement("p:nvSpPr"),S.writeStartElement("p:cNvPr"),S.writeAttributeString("id","3"),S.writeAttributeString("name","Footer Placeholder 2"),S.writeEndElement(),S.writeStartElement("p:cNvSpPr"),S.writeStartElement("a:spLocks"),S.writeAttributeString("noGrp","1"),S.writeEndElement(),S.writeFullEndElement(),S.writeStartElement("p:nvPr"),S.writeStartElement("p:ph"),S.writeAttributeString("type","ftr"),S.writeAttributeString("sz","quarter"),S.writeAttributeString("idx","11"),S.writeEndElement(),S.writeFullEndElement(),S.writeFullEndElement(),S.writeStartElement("p:spPr"),S.writeEndElement(),S.writeStartElement("p:txBody"),S.writeStartElement("a:bodyPr"),S.writeEndElement(),S.writeStartElement("a:lstStyle"),S.writeEndElement(),S.writeStartElement("a:p"),S.writeStartElement("a:endParaRPr"),S.writeAttributeString("lang","ru-RU"),S.writeEndElement(),S.writeFullEndElement(),S.writeFullEndElement(),S.writeFullEndElement(),S.writeStartElement("p:sp"),S.writeStartElement("p:nvSpPr"),S.writeStartElement("p:cNvPr"),S.writeAttributeString("id","4"),S.writeAttributeString("name","Slide Number Placeholder 3"),S.writeEndElement(),S.writeStartElement("p:cNvSpPr"),S.writeStartElement("a:spLocks"),S.writeAttributeString("noGrp","1"),S.writeEndElement(),S.writeFullEndElement(),S.writeStartElement("p:nvPr"),S.writeStartElement("p:ph"),S.writeAttributeString("type","sldNum"),S.writeAttributeString("sz","quarter"),S.writeAttributeString("idx","12"),S.writeEndElement(),S.writeFullEndElement(),S.writeFullEndElement(),S.writeStartElement("p:spPr"),S.writeEndElement(),S.writeStartElement("p:txBody"),S.writeStartElement("a:bodyPr"),S.writeEndElement(),S.writeStartElement("a:lstStyle"),S.writeEndElement(),S.writeStartElement("a:p"),S.writeStartElement("a:fld"),S.writeAttributeString("id","{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}"),S.writeAttributeString("type","slidenum"),S.writeStartElement("a:rPr"),S.writeAttributeString("lang","ru-RU"),S.writeAttributeString("smtClean","0"),S.writeEndElement(),S.writeStartElement("a:t"),S.writeString("‹#›"),S.writeFullEndElement(),S.writeFullEndElement(),S.writeStartElement("a:endParaRPr"),S.writeAttributeString("lang","ru-RU"),S.writeEndElement(),S.writeFullEndElement(),S.writeFullEndElement(),S.writeFullEndElement(),rt.Base.gVpwr.mgdPW.olcUT()||rt.Base.gVpwr.mgdPW.HdOnK()||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud()||rt.Base.gVpwr.mgdPW.DnFeB())&&rt.System.NodeJs.isStandaloneVersion||(m=e.unit.convertToHInches(e.pageWidth-e.margins.left-e.margins.right),c=e.unit.convertToHInches(e.pageHeight-e.margins.top-e.margins.bottom),g=e.unit.convertToHInches(e.margins.left),e=e.unit.convertToHInches(e.margins.top),S.writeRaw('<p:sp><p:nvSpPr><p:cNvPr id="67" name="TextBox Additional"/><p:cNvSpPr txBox="1"/><p:nvPr userDrawn="1"/></p:nvSpPr>'+'<p:spPr><a:xfrm rot="-2700000"><a:off x="'+this.convertToEmu(g)+'" y="'+this.convertToEmu(e+.45*c)+'"/><a:ext cx="'+this.convertToEmu(m)+'" cy="'+this.convertToEmu(.1*c)+'"/></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></p:spPr>'+'<p:txBody><a:bodyPr wrap="square" rtlCol="0" anchor="ctr" anchorCtr="0"><a:spAutoFit/></a:bodyPr><a:lstStyle/><a:p><a:pPr algn="ctr"/><a:r><a:rPr lang="en-US" sz="9600" b="1" dirty="0" smtClean="0">'+'<a:solidFill><a:schemeClr val="tx1"><a:alpha val="12000"/></a:schemeClr></a:solidFill>'+'<a:latin typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/><a:cs typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/>'+"</a:rPr><a:t>Trial</a:t></a:r></a:p></p:txBody></p:sp>")),S.writeFullEndElement(),S.writeFullEndElement()),8==t&&(S.writeAttributeString("type","objTx"),S.writeAttributeString("preserve","1"),S.writeRaw('<p:cSld name="Content with Caption"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="273050" /><a:ext cx="3008313" cy="1162050" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="2000" b="1" /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="3575050" y="273050" /><a:ext cx="5111750" cy="5853113" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="3200" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2800" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2400" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="2000" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="2000" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="2000" /></a:lvl6pPr><a:lvl7pPr>'+'<a:defRPr sz="2000" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="2000" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="2000" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp>'+'<p:sp><p:nvSpPr><p:cNvPr id="4" name="Text Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1435100" /><a:ext cx="3008313" cy="4691063" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="1400" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="1200" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1000" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0">'+'<a:buNone /><a:defRPr sz="900" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr />'+'<p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr />'+'<p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>')),9==t&&(S.writeAttributeString("type","picTx"),S.writeAttributeString("preserve","1"),S.writeRaw('<p:cSld name="Picture with Caption"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="4800600" /><a:ext cx="5486400" cy="566738" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="2000" b="1" /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Picture Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="pic" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="612775" /><a:ext cx="5486400" cy="4114800" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="3200" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2800" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="2400" /></a:lvl3pPr>'+'<a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl9pPr></a:lstStyle><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Text Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="body" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="5367338" /><a:ext cx="5486400" cy="804862" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="1400" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="1200" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1000" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl6pPr>'+'<a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut">'+'<a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle />'+'<a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>')),10==t&&(S.writeAttributeString("type","vertTx"),S.writeAttributeString("preserve","1"),S.writeRaw(
'<p:cSld name="Title and Vertical Text"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr>'+'<p:cNvPr id="3" name="Vertical Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" orient="vert" idx="1" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" />'+'<a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr>'+'<a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>')),11==t&&(S.writeAttributeString("type","vertTitleAndTx"),S.writeAttributeString("preserve","1"),S.writeRaw('<p:cSld name="Vertical Title and Text"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Vertical Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" orient="vert" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="6629400" y="274638" /><a:ext cx="2057400" cy="5851525" /></a:xfrm></p:spPr><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Vertical Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" orient="vert" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="274638" /><a:ext cx="6019800" cy="5851525" /></a:xfrm></p:spPr><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p>'+'<a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" />'+'<a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle />'+'<a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>')),S.writeStartElement("p:clrMapOvr"),S.writeStartElement("a:masterClrMapping"),S.writeEndElement(),S.writeFullEndElement(),S.writeFullEndElement(),S.writeEndDocument(),S.flush(),i}writePresentationRels(e){var t=new tt;let i=new F(V.UTF8,t);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?C.None:C.Indented,i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId1"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles"),i.writeAttributeString("Target","tableStyles.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId2"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/viewProps"),i.writeAttributeString("Target","viewProps.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId3"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/presProps"),i.writeAttributeString("Target","presProps.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId4"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme"),i.writeAttributeString("Target","theme/theme1.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId5"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster"),i.writeAttributeString("Target","slideMasters/slideMaster1.xml"),i.writeEndElement();for(let t=0;t<e.count;t++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",`rId`+(6+t)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide"),i.writeAttributeString("Target",`slides/slide${t+1}.xml`),i.writeEndElement();return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),t}writePresentation(e){var t=new tt;let i=new F(V.UTF8,t);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?C.None:C.Indented,i.writeStartDocument(),i.writeStartElement("p:presentation"),i.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),i.writeAttributeString("saveSubsetFonts","1"),i.writeStartElement("p:sldMasterIdLst"),i.writeStartElement("p:sldMasterId"),i.writeAttributeString("id","2147483648"),i.writeAttributeString("r:id","rId5"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("p:sldIdLst");for(let t=0;t<e.count;t++)i.writeStartElement("p:sldId"),i.writeAttributeString("id",(256+t).toString()),i.writeAttributeString("r:id",`rId`+(6+t)),i.writeEndElement();i.writeEndElement();let r=e.getByIndex(0);return i.writeStartElement("p:sldSz"),i.writeAttributeString("cx",this.convertToEmu(r.unit.convertToHInches(r.width+r.margins.left+r.margins.right)).toString()),i.writeAttributeString("cy",this.convertToEmu(r.unit.convertToHInches(r.height+r.margins.top+r.margins.bottom)).toString()),i.writeEndElement(),i.writeStartElement("p:notesSz"),i.writeAttributeString("cx","6858000"),i.writeAttributeString("cy","9144000"),i.writeEndElement(),i.writeStartElement("p:defaultTextStyle"),i.writeStartElement("a:defPPr"),i.writeStartElement("a:defRPr"),i.writeAttributeString("lang","ru-RU"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl1pPr"),i.writeAttributeString("marL","0"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl2pPr"),i.writeAttributeString("marL","457200"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl3pPr"),i.writeAttributeString("marL","914400"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl4pPr"),i.writeAttributeString("marL","1371600"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl5pPr"),i.writeAttributeString("marL","1828800"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl6pPr"),i.writeAttributeString("marL","2286000"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl7pPr"),i.writeAttributeString("marL","2743200"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl8pPr"),i.writeAttributeString("marL","3200400"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl9pPr"),i.writeAttributeString("marL","3657600"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),t}writeSlideRels(t){var e=new tt;let i=new F(V.UTF8,e);if(i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?C.None:C.Indented,i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId1"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout"),i.writeAttributeString("Target","../slideLayouts/slideLayout7.xml"),i.writeEndElement(),this.imageCache.imageIndex.stimulsoft().countItems>this.imageListOffset)for(let t=0;t<this.imageCache.imageIndex.stimulsoft().countItems-this.imageListOffset;t++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",`rId`+(2+t)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),i.writeAttributeString("Target",pt.format("../media/image{0:D5}.{1}",this.imageCache.imageIndex[this.imageListOffset+t]+1,rt["StiOptions"].Export.PowerPoint.StoreImagesAsPng?"png":"jpeg")),i.writeEndElement();if(0<this.hyperlinkList.stimulsoft().countItems)for(let t=0;t<this.hyperlinkList.stimulsoft().countItems;t++){i.writeStartElement("Relationship"),i.writeAttributeString("Id",`hId`+(t+1));var r=this.hyperlinkList.stimulsoft().getByIndex(t);"string"==typeof r&&(i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),i.writeAttributeString("Target",r),i.writeAttributeString("TargetMode","External")),"number"==typeof r&&(i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide"),i.writeAttributeString("Target",`slide${r}.xml`)),i.writeEndElement()}return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeSlide(t,e){var i=new tt,r,t,e,n,a;let s=new F(V.UTF8,i),o=(s.indentation=this.xmlIndentation<0?0:this.xmlIndentation,s.formatting=this.xmlIndentation<0?C.None:C.Indented,s.writeStartDocument(),s.writeStartElement("p:sld"),s.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),s.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),s.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),s.writeStartElement("p:cSld"),s.writeStartElement("p:spTree"),s.writeStartElement("p:nvGrpSpPr"),s.writeStartElement("p:cNvPr"),s.writeAttributeString("id","1"),s.writeAttributeString("name",""),s.writeEndElement(),s.writeStartElement("p:cNvGrpSpPr"),s.writeEndElement(),s.writeStartElement("p:nvPr"),s.writeEndElement(),s.writeEndElement(),s.writeStartElement("p:grpSpPr"),s.writeStartElement("a:xfrm"),s.writeStartElement("a:off"),s.writeAttributeString("x","0"),s.writeAttributeString("y","0"),s.writeEndElement(),s.writeStartElement("a:ext"),s.writeAttributeString("cx","0"),s.writeAttributeString("cy","0"),s.writeEndElement(),s.writeStartElement("a:chOff"),s.writeAttributeString("x","0"),s.writeAttributeString("y","0"),s.writeEndElement(),s.writeStartElement("a:chExt"),s.writeAttributeString("cx","0"),s.writeAttributeString("cy","0"),s.writeEndElement(),s.writeEndElement(),s.writeEndElement(),this.idCounter=2,e.getByIndex(t));e.getPage(o),this.writeWatermark(s,o,!0);for(r of o.components.list)if(r.enabled&&0<r.width&&0<r.height){let e=r.stimulsoft().as(lt);if(null==e||e.checkAllowHtmlTags())if(r.is(Ut)){let t=new lt(r.clientRectangle);t.page=r.page,t.border=r.stimulsoft().as(Ut).border,t.brush=r.stimulsoft().as(Ut).brush,t.hyperlinkValue=r.hyperlinkValue,this.writeStiTextbox(s,t)}else this.writeStiImage(s,r);else{let t=e.angle%360;if(0==(t=t<0?360+t:t)||90==t||270==t)this.writeStiTextbox(s,r);else{let t=e.clone(!0);t.text=null,t.angle=0,this.writeStiTextbox(s,t),(t=e.clone(!0)).border=null,t.brush=null,t.horAlignment=wt.Center,t.vertAlignment=dt.Center,this.writeStiTextbox(s,t)}}this.idCounter++}return this.writeWatermark(s,o,!1),rt.Base.gVpwr.mgdPW.olcUT()||rt.Base.gVpwr.mgdPW.HdOnK()||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud()||rt.Base.gVpwr.mgdPW.DnFeB())&&rt.System.NodeJs.isStandaloneVersion||(t=o.unit.convertToHInches(o.pageWidth-o.margins.left-o.margins.right),e=o.unit.convertToHInches(o.pageHeight-o.margins.top-o.margins.bottom),n=o.unit.convertToHInches(o.margins.left),a=o.unit.convertToHInches(o.margins.top),s.writeRaw('<p:sp><p:nvSpPr><p:cNvPr id="67" name="TextBox Additional"/><p:cNvSpPr txBox="1"/><p:nvPr userDrawn="1"/></p:nvSpPr>'+'<p:spPr><a:xfrm rot="-2700000"><a:off x="'+this.convertToEmu(n)+'" y="'+this.convertToEmu(a+.45*e)+'"/><a:ext cx="'+this.convertToEmu(t)+'" cy="'+this.convertToEmu(.1*e)+'"/></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></p:spPr>'+'<p:txBody><a:bodyPr wrap="square" rtlCol="0" anchor="ctr" anchorCtr="0"><a:spAutoFit/></a:bodyPr><a:lstStyle/><a:p><a:pPr algn="ctr"/><a:r><a:rPr lang="en-US" sz="9600" b="1" dirty="0" smtClean="0">'+'<a:solidFill><a:schemeClr val="tx1"><a:alpha val="12000"/></a:schemeClr></a:solidFill>'+'<a:latin typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/><a:cs typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/>'+"</a:rPr><a:t>Trial</a:t></a:r></a:p></p:txBody></p:sp>")),s.writeFullEndElement(),s.writeEndElement(),s.writeStartElement("p:clrMapOvr"),s.writeStartElement("a:masterClrMapping"),s.writeEndElement(),s.writeFullEndElement(),s.writeFullEndElement(),s.writeEndDocument(),s.flush(),i}writeStiTextbox(t,e){let i=e;t.writeStartElement("p:sp"),t.writeStartElement("p:nvSpPr"),t.writeStartElement("p:cNvPr"),t.writeAttributeString("id",this.idCounter.toString()),t.writeAttributeString("name",`TextBox `+this.idCounter),this.writeHyperlinkInfo(t,e),t.writeEndElement(),t.writeStartElement("p:cNvSpPr"),t.writeAttributeString("txBox","1"),t.writeEndElement(),t.writeStartElement("p:nvPr"),t.writeEndElement(),t.writeEndElement();var r=this.writeSpPr(t,e);t.writeStartElement("p:txBody"),t.writeStartElement("a:bodyPr");let n=!1,a="";if(null!=i.textOptions){n=i.textOptions.wordWrap;let t=i.textOptions.angle%360;90==(t=t<0?360+t:t)&&(a="vert270"),270==t&&(a="vert")}0<a.length&&t.writeAttributeString("vert",a),t.writeAttributeString("horzOverflow","clip"),t.writeAttributeString("vertOverflow","clip");let s=this.convertToEmu(i.margins.left),o=this.convertToEmu(i.margins.right),l=this.convertToEmu(i.margins.top),m=this.convertToEmu(i.margins.bottom),c=(t.writeAttributeString("lIns",s.toString()),t.writeAttributeString("tIns",l.toString()),t.writeAttributeString("rIns",o.toString()),t.writeAttributeString("bIns",m.toString()),t.writeAttributeString("wrap",n?"square":"none"),t.writeAttributeString("rtlCol","0"),"t"),g=(i.vertAlignment==dt.Center&&(c="ctr"),i.vertAlignment==dt.Bottom&&(c="b"),t.writeAttributeString("anchor",c),t.writeAttributeString("anchorCtr","0"),t.writeStartElement("a:noAutofit"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:lstStyle"),t.writeEndElement(),t.writeStartElement("a:p"),!1),h=(null!=i.textOptions&&(g=i.textOptions.rightToLeft),t.writeStartElement("a:pPr"),""),p=(i.horAlignment==wt.Center&&(h="ctr"),(i.horAlignment==wt.Right&&!g||i.horAlignment==wt.Left&&g)&&(h="r"),0<(h=i.horAlignment==wt.Width?"just":h).length&&t.writeAttributeString("algn",h),g&&t.writeAttributeString("rtl","1"),t.writeStartElement("a:lnSpc"),t.writeStartElement("a:spcPct"),t.writeAttributeString("val",Math.round(.94*i.lineSpacing*1e5).toString()),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:r"),t.writeStartElement("a:rPr"),t.writeAttributeString("lang","en-US"),t.writeAttributeString("sz",(100*i.font.sizeInPoints*.984|0).toString()),i.font.bold&&t.writeAttributeString("b","1"),i.font.italic&&t.writeAttributeString("i","1"),i.font.underline&&t.writeAttributeString("u","sng"),i.font.strikeout&&t.writeAttributeString("strike","sngStrike"),t.writeAttributeString("dirty","0"),t.writeAttributeString("smtClean","0"),t.writeStartElement("a:solidFill"),this.writeColor(t,Et.toColor(i.textBrush)),t.writeFullEndElement(),"");null!=i.text&&(p=i.text.toString()),i.textQuality!=I.Wysiwyg&&i.horAlignment!=wt.Width||pt.isNullOrEmpty(p)||!p.stimulsoft().endsWith(it.StiForceWidthAlignTag)||(p=p.substr(0,p.length-it.StiForceWidthAlignTag.length)),t.writeStartElement("a:latin"),t.writeAttributeString("typeface",i.font.name),t.writeAttributeString("pitchFamily","18"),t.writeAttributeString("charset","0"),t.writeEndElement(),t.writeStartElement("a:cs"),t.writeAttributeString("typeface",i.font.name),t.writeAttributeString("pitchFamily","18"),t.writeAttributeString("charset","0"),t.writeEndElement(),t.writeEndElement(),t.writeElementString("a:t",p),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),r&&this.writeBorder(t,e)}writeStiImage(e,i){let r=!1,n=i.stimulsoft().as(Lt);if(null!=n){let t=null;if(i.isExportAsImage(at.a.StiExportFormat.Ppt2007))try{S.currentCulture=this.currentCulture;var a={ref:this.imageResolution};t=n.getImage(a,at.a.StiExportFormat.ImagePng)}finally{S.currentCulture=this.newCulture}null!=t&&(this.imageCache.addImageInt(t),e.writeStartElement("p:pic"),e.writeStartElement("p:nvPicPr"),e.writeStartElement("p:cNvPr"),e.writeAttributeString("id",this.idCounter.toString()),e.writeAttributeString("name",`Picture `+(this.idCounter+1)),e.writeAttributeString("descr",`Picture ${this.idCounter+1} description`),this.writeHyperlinkInfo(e,i),e.writeEndElement(),e.writeStartElement("p:cNvPicPr"),e.writeStartElement("a:picLocks"),e.writeAttributeString("noChangeAspect","1"),e.writeEndElement(),e.writeFullEndElement(),e.writeStartElement("p:nvPr"),e.writeEndElement(),e.writeFullEndElement(),e.writeStartElement("p:blipFill"),e.writeStartElement("a:blip"),e.writeAttributeString("r:embed",`rId`+(1+this.imageCache.imageIndex.stimulsoft().countItems-this.imageListOffset)),e.writeEndElement(),e.writeStartElement("a:stretch"),e.writeStartElement("a:fillRect"),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),r=this.writeSpPr(e,i),e.writeFullEndElement())}(r||i.is(k))&&this.writeBorder(e,i)}writeSpPr(t,e){let i=this.convertToEmu(e.report.unit.convertToHInches(e.left+e.page.margins.left)),r=this.convertToEmu(e.report.unit.convertToHInches(e.top+e.page.margins.top));var n=this.convertToEmu(e.report.unit.convertToHInches(e.right+e.page.margins.left)),a=this.convertToEmu(e.report.unit.convertToHInches(e.bottom+e.page.margins.top));let s=0;var o=e.stimulsoft().as(St),o=(null==o||null==o.textOptions||90!=(s=o.textOptions.angle%360)&&270!=s&&-90!=s&&-270!=s||(s=0),t.writeStartElement("p:spPr"),t.writeStartElement("a:xfrm"),0!=s&&t.writeAttributeString("rot",(0|Math.round(6e4*-s)).toString()),t.writeStartElement("a:off"),t.writeAttributeString("x",i.toString()),t.writeAttributeString("y",r.toString()),t.writeEndElement(),t.writeStartElement("a:ext"),t.writeAttributeString("cx",(n-i).toString()),t.writeAttributeString("cy",(a-r).toString()),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:prstGeom"),t.writeAttributeString("prst","rect"),t.writeStartElement("a:avLst"),t.writeEndElement(),t.writeEndElement(),e.is(Nt)||e.is(E));let l=ht.transparent,m=(0==(l=e.is(Ot)?Et.toColor(e.brush):l).a||o?(t.writeStartElement("a:noFill"),t.writeEndElement()):(t.writeStartElement("a:solidFill"),this.writeColor(t,l),t.writeFullEndElement()),!1),c=null;return null!=(c=e.is(Ht)?e.border:c)&&c.side!=ft.None&&c.style!=bt.None&&(c.side!=ft.All||c.is(Mt)?m=!0:(t.writeStartElement("a:ln"),t.writeAttributeString("w",this.convertToEmu(c.size).toString()),t.writeStartElement("a:solidFill"),this.writeColor(t,c.color),t.writeFullEndElement(),t.writeStartElement("a:prstDash"),t.writeAttributeString("val",this.getLineStyle(c.style)),t.writeEndElement(),t.writeStartElement("a:miter"),t.writeAttributeString("lim","800000"),t.writeEndElement(),t.writeFullEndElement())),t.writeEndElement(),m}writeBorder(t,e){let i=e.as(Ht).border;var r;i.is(Mt)?((r=i).isLeftBorderSidePresent&&this.writeLine(t,e,new xt(e.left,e.top,0,e.height),r.leftSide.size,r.leftSide.style,r.leftSide.color),r.isRightBorderSidePresent&&this.writeLine(t,e,new xt(e.right,e.top,0,e.height),r.rightSide.size,r.rightSide.style,r.rightSide.color),r.isTopBorderSidePresent&&this.writeLine(t,e,new xt(e.left,e.top,e.width,0),r.topSide.size,r.topSide.style,r.topSide.color),r.isBottomBorderSidePresent&&this.writeLine(t,e,new xt(e.left,e.bottom,e.width,0),r.bottomSide.size,r.bottomSide.style,r.bottomSide.color)):(i.isLeftBorderSidePresent&&this.writeLine(t,e,new xt(e.left,e.top,0,e.height),i.size,i.style,i.color),i.isRightBorderSidePresent&&this.writeLine(t,e,new xt(e.right,e.top,0,e.height),i.size,i.style,i.color),i.isTopBorderSidePresent&&this.writeLine(t,e,new xt(e.left,e.top,e.width,0),i.size,i.style,i.color),i.isBottomBorderSidePresent&&this.writeLine(t,e,new xt(e.left,e.bottom,e.width,0),i.size,i.style,i.color))}writeLine(i,t,r,e,n,a){if(n==bt.None||0==a.a)return;i.writeStartElement("p:cxnSp"),i.writeStartElement("p:nvCxnSpPr"),i.writeStartElement("p:cNvPr"),i.writeAttributeString("id",this.idCounter.toString()),i.writeAttributeString("name",`Line `+this.idCounter),i.writeEndElement(),i.writeStartElement("p:cNvCxnSpPr"),i.writeEndElement(),i.writeStartElement("p:nvPr"),i.writeEndElement(),i.writeEndElement();let s=this.convertToEmu(t.report.unit.convertToHInches(r.left+t.page.margins.left)),o=this.convertToEmu(t.report.unit.convertToHInches(r.top+t.page.margins.top));var l=this.convertToEmu(t.report.unit.convertToHInches(r.right+t.page.margins.left)),r=this.convertToEmu(t.report.unit.convertToHInches(r.bottom+t.page.margins.top)),l,r;i.writeStartElement("p:spPr"),i.writeStartElement("a:xfrm"),i.writeStartElement("a:off"),i.writeAttributeString("x",s.toString()),i.writeAttributeString("y",o.toString()),i.writeEndElement(),i.writeStartElement("a:ext"),i.writeAttributeString("cx",(l-s).toString()),i.writeAttributeString("cy",(r-o).toString()),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("a:prstGeom"),i.writeAttributeString("prst","line"),i.writeStartElement("a:avLst"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("a:ln"),i.writeAttributeString("w",this.convertToEmu(e).toString()),i.writeStartElement("a:solidFill"),this.writeColor(i,a),i.writeFullEndElement(),i.writeStartElement("a:prstDash"),i.writeAttributeString("val",this.getLineStyle(n)),i.writeEndElement();let m=t.as(k);if(null!=m){let t=null,e=null;m.is(P)&&(t=m.startCap,e=m.endCap),m.is(A)&&(t=m.startCap,e=m.endCap),null!=t&&(l=this.capStyleToPptStyle(t.style),pt.isNullOrEmpty(l)||(i.writeStartElement("a:headEnd"),i.writeAttributeString("type",l),i.writeEndElement())),null!=e&&(r=this.capStyleToPptStyle(e.style),pt.isNullOrEmpty(r)||(i.writeStartElement("a:tailEnd"),i.writeAttributeString("type",r),i.writeEndElement()))}i.writeFullEndElement(),i.writeEndElement(),i.writeEndElement()}capStyleToPptStyle(t){switch(t){case y.Arrow:return"triangle";case y.Diamond:return"diamond";case y.Square:return"diamond";case y.Open:return"arrow";case y.Oval:return"oval";case y.Stealth:return"stealth"}return null}writeWatermark(e,i,t){if(null!=i.watermark&&(null!=i.watermark.image||!pt.isNullOrWhiteSpace(i.watermark.imageHyperlink))&&i.watermark.showImageBehind==t){let t=new E;t.page=i,t.image=i.watermark.image,t.left=-i.margins.left,t.top=-i.margins.top,t.width=i.pageWidth,t.height=i.pageHeight,i.watermark.imageStretch&&(t.stretch=!0),t.vertAlignment=dt.Center,t.horAlignment=x.Center,this.writeStiImage(e,t)}}writeHyperlinkInfo(i,r){if(null!=r.hyperlinkValue){let t=r.hyperlinkValue.toString().trim(),e;var r;0<t.length&&!t.stimulsoft().startsWith("javascript:")&&(t.stimulsoft().startsWith("#")||(r=this.stringToUrl(t),-1==(e=this.hyperlinkList.indexOf(r))&&(this.hyperlinkList.push(r),e=this.hyperlinkList.stimulsoft().countItems),i.writeStartElement("a:hlinkClick"),i.writeAttributeString("r:id",`hId`+e),i.writeEndElement()))}}writeImage(t){let e=new tt;var t=this.imageCache.imagePackedStore.stimulsoft().getByIndex(t);return e.write(t,0,t.length),e}exportPowerPoint(t,r,e){at.a.StiLogService.write(this.stimulsoft().getType(),"Export report to PowerPoint 2007 format");let n=e.pageRange;this.imageResolution=e.imageResolution,this.imageQuality=e.imageQuality,this.xmlIndentation=-1,this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.currentCulture=S.currentCulture,this.newCulture=S.cultures["en-US"];try{S.currentCulture=this.newCulture;let e=n.getSelectedPages(t.renderedPages);if(this.isStopped)return;this.imageCache=new at.a.StiImageCache(rt["StiOptions"].Export.PowerPoint.AllowImageComparer,!0,rt["StiOptions"].Export.PowerPoint.StoreImagesAsPng?at.a.ImageFormat.Png:at.a.ImageFormat.Jpeg,this.imageQuality);let i=new u;i.begin(r,!0),i.addFile("[Content_Types].xml",this.writeContentTypes(e.count)),i.addFile("_rels/.rels",this.writeMainRels()),i.addFile("docProps/app.xml",this.writeDocPropsApp(e.count)),i.addFile("docProps/core.xml",this.writeDocPropsCore()),i.addFile("ppt/tableStyles.xml",this.writeTableStyles()),i.addFile("ppt/presProps.xml",this.writePresProps()),i.addFile("ppt/viewProps.xml",this.writeViewProps()),i.addFile("ppt/theme/theme1.xml",this.writeTheme()),i.addFile("ppt/slideMasters/slideMaster1.xml",this.writeSlideMaster()),i.addFile("ppt/slideMasters/_rels/slideMaster1.xml.rels",this.writeSlideMasterRels());for(let t=0;t<11;t++)i.addFile(`ppt/slideLayouts/slideLayout${t+1}.xml`,this.writeSlideLayout(t+1,e.getByIndex(0))),i.addFile(`ppt/slideLayouts/_rels/slideLayout${t+1}.xml.rels`,this.writeSlideLayoutRels());i.addFile("ppt/presentation.xml",this.writePresentation(e)),i.addFile("ppt/_rels/presentation.xml.rels",this.writePresentationRels(e)),this.imageListOffset=0,this.hyperlinkList=[];for(let t=0;t<e.count;t++){if(this.invokeExporting2(t,e.count,0,1),this.isStopped)return;var a=e.getByIndex(t);e.getPage(a),i.addFile(`ppt/slides/slide${t+1}.xml`,this.writeSlide(t,e)),i.addFile(`ppt/slides/_rels/slide${t+1}.xml.rels`,this.writeSlideRels(t)),this.imageListOffset=this.imageCache.imageIndex.stimulsoft().countItems,this.hyperlinkList.stimulsoft().clear()}if(0<this.imageCache.imagePackedStore.stimulsoft().countItems)for(let t=0;t<this.imageCache.imagePackedStore.stimulsoft().countItems;t++)i.addFile(pt.format("ppt/media/image{0:D5}.{1}",t+1,rt["StiOptions"].Export.PowerPoint.StoreImagesAsPng?"png":"jpeg"),this.writeImage(t));i.end()}finally{S.currentCulture=this.currentCulture,this.imageCache.clear(),this.hyperlinkList=null}}};{class Ai{}class Ti extends at.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1,this.matrix=null,this.removeEmptySpaceAtBottom=rt["StiOptions"].Export.Word.removeEmptySpaceAtBottom,this.fontList=null,this.styleList=null,this.imageCache=null,this.bookmarkList=null,this.hyperlinkList=null,this.embedsList=null,this.xmlIndentation=1,this.imageQuality=.75,this.imageResolution=96,this.lineSpace=null,this.lineSpace2=null,this.usePageHeadersAndFooters=!1,this.restrictEditing=at.c.StiWord2007RestrictEditing.No,this.headersData=null,this.headersRels=null,this.footersData=null,this.footersRels=null,this.docCompanyString=null,this.docLastModifiedString=null,this.wrongUrlSymbols=" \"#'*,;<>[^`{|}"}implements(){return[at.c.IStiWord2007ExportService]}get exportFormat(){return at.a.StiExportFormat.Word2007}exportTo(t,e,i){this.exportWord(t,e,i)}exportToAsync(t,e,i,r){setTimeout(async()=>{await at.c.StiExportImageHelper.convertAllImages(e,rt.System.Drawing.Imaging.ImageFormat.Jpeg,!1,this.exportFormat),this.exportTo(e,i,r),null!=e&&null!=e.preparedExportImages&&(e.preparedExportImages.clear(),e.preparedExportImages=null),t()},0)}getFilter(){return t.get("FileFilters","Word2007Files")}static checkFontsToCorrectHeight(t){return null==this.fontsToCorrectHeight&&(this.fontsToCorrectHeight=new ct,this.fontsToCorrectHeight.add("Arial Unicode MS",null),this.fontsToCorrectHeight.add("Cascadia Code ExtraLight",null),this.fontsToCorrectHeight.add("Cascadia Code SemiBold",null),this.fontsToCorrectHeight.add("Cascadia Code SemiLight",null),this.fontsToCorrectHeight.add("Cascadia Mono ExtraLight",null),this.fontsToCorrectHeight.add("Cascadia Mono Light",null),this.fontsToCorrectHeight.add("Cascadia Mono SemiBold",null),this.fontsToCorrectHeight.add("Cascadia Mono SemiLight",null),this.fontsToCorrectHeight.add("Malgun Gothic",null),this.fontsToCorrectHeight.add("Malgun Gothic Semilight",null),this.fontsToCorrectHeight.add("Microsoft JhengHei",null),this.fontsToCorrectHeight.add("Microsoft JhengHei Light",null),this.fontsToCorrectHeight.add("Microsoft JhengHei UI",null),this.fontsToCorrectHeight.add("Microsoft JhengHei UI Light",null),this.fontsToCorrectHeight.add("Microsoft YaHei",null),this.fontsToCorrectHeight.add("Microsoft YaHei Light",null),this.fontsToCorrectHeight.add("Microsoft YaHei UI",null),this.fontsToCorrectHeight.add("Microsoft YaHei UI Light",null),this.fontsToCorrectHeight.add("MingLiU_HKSCS-ExtB",null),this.fontsToCorrectHeight.add("MingLiU-ExtB",null),this.fontsToCorrectHeight.add("MS Gothic",null),this.fontsToCorrectHeight.add("MS PGothic",null),this.fontsToCorrectHeight.add("MS UI Gothic",null),this.fontsToCorrectHeight.add("NSimSun",null),this.fontsToCorrectHeight.add("PMingLiU-ExtB",null),this.fontsToCorrectHeight.add("Segoe MDL2 Assets",null),this.fontsToCorrectHeight.add("SimSun",null),this.fontsToCorrectHeight.add("SimSun-ExtB",null),this.fontsToCorrectHeight.add("Yu Gothic",null),this.fontsToCorrectHeight.add("Yu Gothic Light",null),this.fontsToCorrectHeight.add("Yu Gothic Medium",null),this.fontsToCorrectHeight.add("Yu Gothic UI",null),this.fontsToCorrectHeight.add("Yu Gothic UI Light",null),this.fontsToCorrectHeight.add("Yu Gothic UI Semibold",null),this.fontsToCorrectHeight.add("Yu Gothic UI Semilight",null),this.fontsToCorrectHeight.add("微软雅黑",null)),this.fontsToCorrectHeight.containsKey(t)}getLineStyle(t){switch(t){case bt.Solid:return"single";case bt.Dot:return"dotted";case bt.Dash:return"dashSmallGap";case bt.DashDot:return"dotDash";case bt.DashDotDot:return"dotDotDash";case bt.Double:return"double";default:return""}}getColorString(t){if(0==t.a)return"auto";if(t.a<32)return"FFFFFF";return pt.format("{0:X8}",t.toArgb()).substr(2)}getStyleNumber(i,r){if(0<i.length)for(let e=0;e<i.length;e++){let t=i[e];if(t.alignment==r.alignment&&t.name==r.name&&t.fontName==r.fontName&&t.fontSize==r.fontSize&&t.bold==r.bold&&t.italic==r.italic&&t.underline==r.underline&&t.textColor.equals(r.textColor)&&t.rightToLeft==r.rightToLeft)return e}var t;return i.push(r),i.length-1}getStyleFromComponent(e){if(null!=e&&!pt.isNullOrEmpty(e.componentStyle)){var i=e.stimulsoft().as(Dt),r=e.stimulsoft().as(Bt),n=e.stimulsoft().as(Ct),a=e.stimulsoft().as(St);let t=new Ai;return t.name=e.componentStyle,null!=i&&(t.fontName=i.font.name,t.fontSize=st.round2(2*i.font.sizeInPoints,0),t.bold=i.font.bold,t.italic=i.font.italic,t.underline=i.font.underline),null!=r&&(t.textColor=Et.toColor(r.textBrush)),null!=n&&(t.alignment=n.horAlignment),null!=a&&(t.rightToLeft=a.textOptions.rightToLeft),this.getStyleNumber(this.styleList,t)}return-1}stringToUrl(t){if(pt.isNullOrEmpty(t))return"";let e=new ut;if(t.stimulsoft().startsWith("file:"))for(var i of t.split(""))i.charCodeAt(0)<32||'"'==i?e.append(pt.format("%{0:x2}",i)):e.append(i);else for(var r of t.split(""))r.charCodeAt(0)<32||-1!=this.wrongUrlSymbols.indexOf(r)?e.append("_"):e.append(r);return e.toString()}static get hiToTwips(){return 14.4*.995}convert(t){return st.round2(t*Ti.hiToTwips)}convertHiToTwips(t){return st.round2(14.4*t)}convertTwipsToEmu(t){return st.round2(t/Ti.hiToTwips/100*914400)}convertStringToBookmark(t){let e=new ut;for(var i of t.split(""))ot.isLetterOrDigit(i)&&e.append(i);return 0<e.length&&null!=e.toString()[0]&&ot.isDigit(e.toString()[0])&&e.insert(0,"b"),e.toString()}writeFromMatrix(o,e,l,m){var c=this.matrix.coordX.countItems,g=this.matrix.coordY.countItems;let h=mt.create(Number,c);var i=this.matrix.coordX.getKeys();for(let t=0;t<c;t++){var r=this.matrix.coordX.getByIndex(t,i);h[t]=this.convert(r)}let p=mt.create(Number,g);var n=this.matrix.coordY.getKeys();for(let t=0;t<g;t++){var a=this.matrix.coordY.getByIndex(t,n);p[t]=this.convert(a)}let w=!1,d=0,S=mt.create2(Boolean,g,c),u=mt.create2(Boolean,g,c),f="";this.currentPassNumber=2+(rt["StiOptions"].Export.Word.divideSegmentPages?1:0);for(let s=1;s<g;s++){this.invokeExporting2(s,g,this.currentPassNumber,this.maximumPassNumber);let i=s-1>=e&&s-1<=l,r=(0!=m||this.matrix.linePlacement[s-1]!=at.c.StiTableLineInfo.PageHeader&&this.matrix.linePlacement[s-1]!=at.c.StiTableLineInfo.PageFooter&&this.matrix.linePlacement[s-1]!=at.c.StiTableLineInfo.Trash||(i=!1),0<d&&(d--,i=!1),100005),n=[],a=!1;if(i)for(let t=1;t<c;t++){let e=this.matrix.cells[s-1][t-1];if(0==S[s][t]&&null!=e&&null!=e.component){if(null!=e.component.tagValue){let t=e.component.tagValue.toString().toLowerCase();-1!=t.indexOf("rtfparagraph")&&(n.push(e),i=!1),-1!=t.indexOf("rtfnewpage")&&(a=!0)}let t=null;e.component.is(lt)&&(t=e.component.margins),null!=(t=e.component.is(D)?e.component.margins:t)&&(t.top<r&&(r=t.top),0<e.height&&(r=0))}}r*=Ti.hiToTwips;var v=st.round2(r),E;if(a&&(w&&(o.writeFullEndElement(),w=!1),o.writeStartElement("w:p"),o.writeStartElement("w:r"),o.writeStartElement("w:br"),o.writeAttributeString("w:type","page"),o.writeEndElement(),o.writeEndElement(),o.writeEndElement()),i){if(this.usePageHeadersAndFooters&&this.matrix.linePlacement[s-1]==at.c.StiTableLineInfo.HeaderAP){let t=this.matrix.parentBandName[s-1];var b=t.indexOf("");(t=-1!=b?t.substr(0,b):t)!=f&&(f=t,w&&o.writeFullEndElement(),o.writeStartElement("w:p"),o.writeEndElement(),o.writeStartElement("w:tbl"),this.writeTableInfo(o,h,c),w=!0)}w||(o.writeStartElement("w:tbl"),this.writeTableInfo(o,h,c),w=!0),o.writeStartElement("w:tr");let t=p[s]-p[s-1];o.writeStartElement("w:trPr"),this.usePageHeadersAndFooters&&!rt["StiOptions"].Export.Word.forceLineHeight||(o.writeStartElement("w:trHeight"),(!this.usePageHeadersAndFooters&&rt["StiOptions"].Export.Word.lineHeightExactly||this.usePageHeadersAndFooters&&rt["StiOptions"].Export.Word.lineHeightExactlyForPHFMode)&&o.writeAttributeString("w:hRule","exact"),o.writeAttributeString("w:val",t.toString()),o.writeEndElement()),this.usePageHeadersAndFooters&&this.matrix.linePlacement[s-1]==at.c.StiTableLineInfo.HeaderAP&&(o.writeStartElement("w:tblHeader"),o.writeEndElement()),o.writeEndElement()}let t=0;for(let a=1;a<c;a++){let n=this.matrix.cells[s-1][a-1];if(!S[s][a]||u[s][a]){t++;let r=!0;if(u[s][a]){let t=s;while(u[t][a])t--;n=this.matrix.cells[t-1][a-1],r=!1}if(null!=n&&r){for(let e=0;e<=n.height;e++)for(let t=0;t<=n.width;t++)S[s+e][a+t]=!0;if(0<n.height)for(let t=1;t<=n.height;t++)u[s+t][a]=!0}if(i){if(o.writeStartElement("w:tc"),null!=n){o.writeStartElement("w:tcPr");let e=0;for(let t=0;t<n.width+1;t++)e+=h[a+t]-h[a-1+t];if(o.writeStartElement("w:tcW"),o.writeAttributeString("w:w",e.toString()),o.writeAttributeString("w:type","dxa"),o.writeEndElement(),0<n.width&&(o.writeStartElement("w:gridSpan"),o.writeAttributeString("w:val",(n.width+1).toString()),o.writeEndElement()),0<n.height&&(u[s][a]?o.writeStartElement("w:vMerge"):(o.writeStartElement("w:vMerge"),o.writeAttributeString("w:val","restart")),o.writeEndElement()),null!=n.cellStyle.textOptions){var x=n.cellStyle.textOptions.angle;let t=225<x&&x<315?"tbRl":45<x&&x<135?"btLr":"";""!=t&&(o.writeStartElement("w:textDirection"),o.writeAttributeString("w:val",t),o.writeEndElement())}var x=n.component.is(lt)&&n.component.checkAllowHtmlTags()&&!rt["StiOptions"].Export.Word.renderHtmlTagsAsImage;if(r&&n.component.is(lt)&&(!n.component.isExportAsImage(this.exportFormat)||x)){var y=n.component;let t=this.convert(y.margins.left),e=this.convert(y.margins.right-rt["StiOptions"].Export.Word.rightMarginCorrection),i=this.convert(y.margins.top);i>v&&(i=v),(0<t||0<e||0<i)&&(o.writeStartElement("w:tcMar"),0<i&&(o.writeStartElement("w:top"),o.writeAttributeString("w:w",i.toString()),o.writeAttributeString("w:type","dxa"),o.writeEndElement()),0<t&&(o.writeStartElement("w:left"),o.writeAttributeString("w:w",t.toString()),o.writeAttributeString("w:type","dxa"),o.writeEndElement()),0<e&&(o.writeStartElement("w:right"),o.writeAttributeString("w:w",e.toString()),o.writeAttributeString("w:type","dxa"),o.writeEndElement()),o.writeEndElement())}let t="";switch(n.cellStyle.vertAlignment){case dt.Center:t="center";break;case dt.Bottom:t="bottom";break}""!=t&&(o.writeStartElement("w:vAlign"),o.writeAttributeString("w:val",t),o.writeEndElement()),this.writeBorders(o,n.top,n.left,n.height+1,n.width+1),n.component.isExportAsImage(this.exportFormat)||(o.writeStartElement("w:shd"),o.writeAttributeString("w:val","clear"),o.writeAttributeString("w:color","auto"),o.writeAttributeString("w:fill",this.getColorString(n.cellStyle.color)),o.writeEndElement()),o.writeEndElement();var y=this.restrictEditing==at.c.StiWord2007RestrictEditing.ExceptEditableFields&&null!=n.component&&n.component.is(lt)&&n.component.editable,A;y&&(o.writeStartElement("w:permStart"),o.writeAttributeString("w:id","0"),o.writeEndElement());let i=!0;r&&(A={ref:i},this.writeCellContent(o,n,A,s,a,h,p),i=A.ref),i&&(o.writeStartElement("w:p"),o.writeFullEndElement()),y&&(o.writeStartElement("w:permEnd"),o.writeAttributeString("w:id","0"),o.writeEndElement())}else{var T=null,P,L=this.renderBorder2TableGetValues(s,a,{ref:T});let e=0;if(0==(L&ft.Right)){while(a+e+1<c&&null==this.matrix.cells[s-1][a+e+1-1]&&0==S[s][a+e+1]&&0==u[s][a+e+1]){var C=null,F,k=this.renderBorder2TableGetValues(s,a+e+1,{ref:C});if(0<(k&ft.Left))break;if((k&(ft.Top|ft.Bottom))!=(L&(ft.Top|ft.Bottom)))break;if(T!=C)break;if(e++,0<(k&ft.Right))break}if(0<e)for(let t=1;t<=e;t++)S[s][a+t]=!0}o.writeStartElement("w:tcPr");let t=h[a+e]-h[a-1];o.writeStartElement("w:tcW"),o.writeAttributeString("w:w",t.toString()),o.writeAttributeString("w:type","dxa"),o.writeEndElement(),0<e&&(o.writeStartElement("w:gridSpan"),o.writeAttributeString("w:val",(e+1).toString()),o.writeEndElement()),this.writeBorders(o,s-1,a-1,1,e+1),o.writeEndElement(),o.writeStartElement("w:p"),o.writeFullEndElement()}o.writeFullEndElement()}}if(64<=t)break}i&&o.writeFullEndElement();for(E of n){w&&o.writeEndElement(),w=!1,d=E.height;var I,B={ref:I=!1};this.writeCellContent(o,E,B,E.top+1,E.left+1,h,p),I=B.ref}}w&&o.writeEndElement()}writeCellContent(a,s,t,o,l,m,c){let g=t.ref,h=null,p=-1;var w=this.matrix.bookmarks[o-1][l-1];null==w||this.bookmarkList.containsKey(w)||(p=this.bookmarkList.count,h=this.convertStringToBookmark(w),this.bookmarkList.set(w,p));let d=null,S=-1;if(null!=s.component&&null!=s.component.hyperlinkValue){let t=s.component.hyperlinkValue.toString().trim();0<t.length&&!t.stimulsoft().startsWith("javascript:")&&(t.stimulsoft().startsWith("#")?d=this.convertStringToBookmark(t.substr(1)):(d=this.stringToUrl(t),this.hyperlinkList.containsKey(d)?S=st.trunc(this.hyperlinkList.get(d)):(S=this.hyperlinkList.count,this.hyperlinkList.add(d,S))))}if(!s.component.is(lt)||s.component.isExportAsImage(this.exportFormat)||s.component.checkAllowHtmlTags()){if(!s.component.is(D)||rt["StiOptions"].Export.Word.renderRichTextAsImage)if(s.component.is(lt)&&s.component.checkAllowHtmlTags()&&!rt["StiOptions"].Export.Word.renderHtmlTagsAsImage)pt.isNullOrWhiteSpace(s.text)||this.writeHtmlTags(a,s);else if(s.component.isExportAsImage(this.exportFormat)){let t=s.component.stimulsoft().as(Lt);if(null!=t){var e,w={ref:this.imageResolution},u=t.getImage(w),e=w.ref;if(null!=u){var w=this.matrix.getRealImageData(s,u);g=!1;let t=0;t=null!=w?this.imageCache.addImageIntRaw(w,w.imageFormat):this.imageCache.addImageIntRaw(u,u.imageFormat);var w=-1,u=-1,f=(a.writeStartElement("w:p"),a.writeStartElement("w:pPr"),s.cellStyle.horAlignment);let e=!1,i=(null!=s.cellStyle.textOptions&&(e=s.cellStyle.textOptions.rightToLeft),s.component.stimulsoft().as(Ct),""),r=((f==wt.Left&&1==e||f==wt.Right&&0==e)&&(i="right"),f==wt.Center&&(i="center"),""!=(i=f==wt.Width?"both":i)&&(a.writeStartElement("w:jc"),a.writeAttributeString("w:val",i),a.writeEndElement()),a.writeEndElement(),-1!=p&&(a.writeStartElement("w:bookmarkStart"),a.writeAttributeString("w:id",p.toString()),a.writeAttributeString("w:name",h),a.writeEndElement()),a.writeStartElement("w:r"),a.writeStartElement("w:rPr"),a.writeElementString("w:noProof",""),a.writeEndElement(),a.writeStartElement("w:drawing"),a.writeStartElement("wp:inline"),a.writeAttributeString("distT","0"),a.writeAttributeString("distB","0"),a.writeAttributeString("distL","0"),a.writeAttributeString("distR","0"),c[o-1+s.height+1]-c[o-1]),n=m[l-1+s.width+1]-m[l-1];-1!=w&&(n=w,r=u),a.writeStartElement("wp:extent"),a.writeAttributeString("cx",this.convertTwipsToEmu(n).toString()),a.writeAttributeString("cy",this.convertTwipsToEmu(r).toString()),a.writeEndElement(),a.writeStartElement("wp:effectExtent"),a.writeAttributeString("l","0"),a.writeAttributeString("t","0"),a.writeAttributeString("r","0"),a.writeAttributeString("b","0"),a.writeEndElement(),a.writeStartElement("wp:docPr"),a.writeAttributeString("id",(t+2).toString()),a.writeAttributeString("name",`Picture `+(t+1)),a.writeAttributeString("descr",pt.format("Image{0:D5}.jpg",t+1)),null!=d&&(-1==S&&(d="#"+d,this.hyperlinkList.containsKey(d)?S=this.hyperlinkList.get(d):(S=this.hyperlinkList.count,this.hyperlinkList.add(d,S))),a.writeStartElement("a:hlinkClick"),a.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),a.writeAttributeString("r:id",`hId`+S),a.writeEndElement()),a.writeEndElement(),a.writeStartElement("wp:cNvGraphicFramePr"),a.writeStartElement("a:graphicFrameLocks"),a.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),a.writeAttributeString("noChangeAspect","1"),a.writeEndElement(),a.writeEndElement(),a.writeStartElement("a:graphic"),a.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),a.writeStartElement("a:graphicData"),a.writeAttributeString("uri","http://schemas.openxmlformats.org/drawingml/2006/picture"),a.writeStartElement("pic:pic"),a.writeAttributeString("xmlns:pic","http://schemas.openxmlformats.org/drawingml/2006/picture"),a.writeStartElement("pic:nvPicPr"),a.writeStartElement("pic:cNvPr"),a.writeAttributeString("id","0"),a.writeAttributeString("name",pt.format("Image{0:D5}.jpg",t+1)),a.writeEndElement(),a.writeStartElement("pic:cNvPicPr"),a.writeEndElement(),a.writeEndElement(),a.writeStartElement("pic:blipFill"),a.writeStartElement("a:blip"),a.writeAttributeString("r:embed",`rId`+(5+t)),a.writeAttributeString("cstate","print"),a.writeEndElement(),a.writeStartElement("a:stretch"),a.writeStartElement("a:fillRect"),a.writeEndElement(),a.writeEndElement(),a.writeEndElement(),a.writeStartElement("pic:spPr"),a.writeStartElement("a:xfrm"),a.writeStartElement("a:off"),a.writeAttributeString("x","0"),a.writeAttributeString("y","0"),a.writeEndElement(),a.writeStartElement("a:ext"),a.writeAttributeString("cx",this.convertTwipsToEmu(n).toString()),a.writeAttributeString("cy",this.convertTwipsToEmu(r).toString()),a.writeEndElement(),a.writeEndElement(),a.writeStartElement("a:prstGeom"),a.writeAttributeString("prst","rect"),a.writeStartElement("a:avLst"),a.writeEndElement(),a.writeEndElement(),a.writeEndElement(),a.writeEndElement(),a.writeEndElement(),a.writeEndElement(),a.writeEndElement(),a.writeEndElement(),a.writeEndElement(),-1!=p&&(a.writeStartElement("w:bookmarkEnd"),a.writeAttributeString("w:id",p.toString()),a.writeEndElement()),a.writeEndElement()}}}else-1!=p&&(a.writeStartElement("w:bookmarkStart"),a.writeAttributeString("w:id",p.toString()),a.writeAttributeString("w:name",h),a.writeEndElement(),a.writeStartElement("w:bookmarkEnd"),a.writeAttributeString("w:id",p.toString()),a.writeEndElement())}else{let e=new ut(s.text);if(this.usePageHeadersAndFooters){let t=s.component.tagValue;pt.isNullOrEmpty(t)||-1!=t.toLowerCase().indexOf("rtfnewpage")||-1==t.indexOf("#PageNumber#")&&-1==t.indexOf("#TotalPageCount#")&&-1==t.indexOf("#PageRef")||(e=new ut(t))}let n=[],t="";for(var i of e.toString().split(""))ot.isControl(i)&&"\t"!=i?"\n"==i&&(n.push(t),t=""):t+=i;""!=t&&n.push(t),0==n.length&&n.push(t),0<n.length&&(g=!1);var v=this.getStyleFromComponent(s.component);for(let r=0;r<n.length;r++){let e=n[r];a.writeStartElement("w:p"),a.writeStartElement("w:pPr");var E=s.component.stimulsoft().as(lt).lineSpacing;if(null!=this.lineSpace||1!=E){let t=this.lineSpace;1!=E&&(t=st.round2(240*rt["StiOptions"].Export.Word.lineSpacing*E).toString());var b=s.component.stimulsoft().as(Dt);null!=b&&null!=b.font&&Ti.checkFontsToCorrectHeight(b.font.name)&&(t=this.lineSpace2,1!=E&&(t=st.round2(240*rt["StiOptions"].Export.Word.lineSpacing*.772*E).toString())),a.writeStartElement("w:spacing"),a.writeAttributeString("w:line",t),a.writeEndElement()}-1!=v&&(a.writeStartElement("w:pStyle"),a.writeAttributeString("w:val",`Style`+v),a.writeEndElement());var b=s.cellStyle.horAlignment;let t=!1,i=(null!=s.cellStyle.textOptions&&(t=s.cellStyle.textOptions.rightToLeft),"");if((b==wt.Left&&1==t||b==wt.Right&&0==t)&&(i="right"),b==wt.Center&&(i="center"),""!=(i=b==wt.Width?"both":i)&&(a.writeStartElement("w:jc"),a.writeAttributeString("w:val",i),a.writeEndElement()),-1==v&&this.writeRunProperties(a,s),a.writeEndElement(),null!=d&&(a.writeStartElement("w:hyperlink"),-1==S?a.writeAttributeString("w:anchor",d):a.writeAttributeString("r:id",`hId`+S)),-1!=p&&(a.writeStartElement("w:bookmarkStart"),a.writeAttributeString("w:id",p.toString()),a.writeAttributeString("w:name",h),a.writeEndElement()),""!=e)if(this.usePageHeadersAndFooters){e=e.stimulsoft().replaceAll("#PageNumber#","").stimulsoft().replaceAll("#TotalPageCount#","");let i=[],t=new ut;for(var x of e.split(""))""==x||""==x?(0<t.length&&i.push(t.toString()),i.push(x.toString()),t=new ut):t.append(x);0<t.length&&i.push(t.toString()),0==i.length&&i.push(e);for(let e=0;e<i.length;e++){let t=i[e];if(0<t.length&&(""==t[0]||""==t[0])){switch(a.writeStartElement("w:r"),-1==v&&this.writeRunProperties(a,s),a.writeStartElement("w:fldChar"),a.writeAttributeString("w:fldCharType","begin"),a.writeEndElement(),a.writeEndElement(),a.writeStartElement("w:r"),this.writeRunProperties(a,s),a.writeStartElement("w:instrText"),t.charAt(0)){case"":a.writeString("PAGE");break;case"":a.writeString("NUMPAGES");break}a.writeEndElement(),a.writeEndElement(),a.writeStartElement("w:r"),this.writeRunProperties(a,s),a.writeStartElement("w:fldChar"),a.writeAttributeString("w:fldCharType","end"),a.writeEndElement(),a.writeEndElement()}else a.writeStartElement("w:r"),-1==v&&this.writeRunProperties(a,s),a.writeStartElement("w:t"),a.writeAttributeString("xml:space","preserve"),a.writeString(t),a.writeEndElement(),a.writeEndElement()}}else a.writeStartElement("w:r"),-1==v&&this.writeRunProperties(a,s),a.writeStartElement("w:t"),a.writeAttributeString("xml:space","preserve"),a.writeString(e),a.writeEndElement(),a.writeEndElement();-1!=p&&(a.writeStartElement("w:bookmarkEnd"),a.writeAttributeString("w:id",p.toString()),a.writeEndElement()),null!=d&&a.writeEndElement(),a.writeEndElement()}}t.ref=g}writeTableInfo(i,r,t){i.writeStartElement("w:tblPr"),i.writeStartElement("w:tblStyle"),i.writeAttributeString("w:val","a1"),i.writeEndElement(),i.writeStartElement("w:tblW"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:tblLayout"),i.writeAttributeString("w:type","fixed"),i.writeEndElement(),i.writeStartElement("w:tblCellMar"),i.writeStartElement("w:top"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:left"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:bottom"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:right"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:tblLook"),i.writeAttributeString("w:val","04A0"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:tblGrid");for(let e=1;e<t;e++){let t=r[e]-r[e-1];i.writeStartElement("w:gridCol"),i.writeAttributeString("w:w",t.toString()),i.writeEndElement()}i.writeFullEndElement()}writeHtmlTags(n,a){var t=a.component,e=a.text;let s=new d(t.font.bold,t.font.italic,t.font.underline,t.font.strikeout,t.font.sizeInPoints,t.font.name,Et.toColor(t.textBrush),Et.toColor(t.brush),!1,!1,0,0,t.lineSpacing,t.horAlignment);var t=new kt(s,0);let o=rt.Base.Drawing.StiTextRenderer.parseHtmlToStates(e,t);var l=this.getStyleFromComponent(a.component);this.writeParagraphBegin(n,a,l,o,0);for(let r=0;r<o.length;r++){let t=o[r],e=t.ts;if("\n"==t.text.toString()&&r<o.stimulsoft().countItems-1){n.writeEndElement(),this.writeParagraphBegin(n,a,l,o,r+1);continue}n.writeStartElement("w:r"),n.writeStartElement("w:rPr"),e.bold&&(n.writeStartElement("w:b"),n.writeEndElement()),e.italic&&(n.writeStartElement("w:i"),n.writeEndElement()),e.underline&&(n.writeStartElement("w:u"),n.writeAttributeString("w:val","single"),n.writeEndElement()),e.strikeout&&(n.writeStartElement("w:strike"),n.writeEndElement()),e.superscript&&(n.writeStartElement("w:vertAlign"),n.writeAttributeString("w:val","superscript"),n.writeEndElement()),e.subsript&&(n.writeStartElement("w:vertAlign"),n.writeAttributeString("w:val","subscript"),n.writeEndElement()),e.fontColor.toArgb()!=s.fontColor.toArgb()&&(n.writeStartElement("w:color"),n.writeAttributeString("w:val",this.getColorString(e.fontColor)),n.writeEndElement()),e.backColor.toArgb()!=s.backColor.toArgb()&&(n.writeStartElement("w:shd"),n.writeAttributeString("w:val","clear"),n.writeAttributeString("w:color","auto"),n.writeAttributeString("w:fill",this.getColorString(e.backColor)),n.writeEndElement()),n.writeStartElement("w:sz"),n.writeAttributeString("w:val",(2*e.fontSize).toString()),n.writeEndElement(),n.writeStartElement("w:szCs"),n.writeAttributeString("w:val",(2*e.fontSize).toString()),n.writeEndElement(),n.writeStartElement("w:rFonts");var m=e.fontName;this.fontList.set(m,m),n.writeAttributeString("w:ascii",m),n.writeAttributeString("w:hAnsi",m),n.writeAttributeString("w:eastAsia",m),n.writeAttributeString("w:cs",m),n.writeEndElement();let i=e.letterSpacing*e.fontSize*18.8+rt["StiOptions"].Export.Word.spaceBetweenCharacters;0!=i&&(n.writeStartElement("w:spacing"),n.writeAttributeString("w:val",i.toString()),n.writeEndElement()),null!=a.cellStyle.textOptions&&a.cellStyle.textOptions.rightToLeft&&(n.writeStartElement("w:rtl"),n.writeEndElement()),n.writeEndElement(),n.writeStartElement("w:t"),n.writeAttributeString("xml:space","preserve"),n.writeString(rt.Base.Drawing.StiTextRenderer.prepareStateText(t.text).toString()),n.writeEndElement(),n.writeEndElement()}n.writeEndElement()}writeParagraphBegin(t,e,i,r,n){t.writeStartElement("w:p"),t.writeStartElement("w:pPr"),-1!=i?(t.writeStartElement("w:pStyle"),t.writeAttributeString("w:val",`Style`+i),t.writeEndElement()):this.writeRunProperties(t,e);let a=r[n];if("\n"!=a.text.toString()){let t=n+1;while(t<r.length&&"\n"!=r[t].text.toString())a=r[t],t++}let s=rt["StiOptions"].Export.Word.lineSpacing*a.ts.lineHeight,o=(Ti.checkFontsToCorrectHeight(a.ts.fontName)&&(s*=.772),1!=s&&(t.writeStartElement("w:spacing"),t.writeAttributeString("w:line",st.round2(240*s).toString()),t.writeEndElement()),null);a.ts.textAlign==wt.Center&&(o="center"),a.ts.textAlign==wt.Right&&(o="right"),null!=(o=a.ts.textAlign==wt.Width?"both":o)&&(t.writeStartElement("w:jc"),t.writeAttributeString("w:val",o),t.writeEndElement()),t.writeEndElement()}writeRunProperties(t,e){t.writeStartElement("w:rPr"),t.writeStartElement("w:rFonts");var i=e.cellStyle.font.name;this.fontList.set(i,i),t.writeAttributeString("w:ascii",i),t.writeAttributeString("w:hAnsi",i),t.writeAttributeString("w:eastAsia",i),t.writeAttributeString("w:cs",i),t.writeEndElement(),e.cellStyle.font.bold&&(t.writeStartElement("w:b"),t.writeEndElement()),e.cellStyle.font.italic&&(t.writeStartElement("w:i"),t.writeEndElement()),e.cellStyle.font.underline&&(t.writeStartElement("w:u"),t.writeAttributeString("w:val","single"),t.writeEndElement()),t.writeStartElement("w:color"),t.writeAttributeString("w:val",this.getColorString(e.cellStyle.textColor)),t.writeEndElement(),t.writeStartElement("w:sz"),t.writeAttributeString("w:val",(2*e.cellStyle.font.sizeInPoints).toString()),t.writeEndElement(),0!=rt["StiOptions"].Export.Word.spaceBetweenCharacters&&(t.writeStartElement("w:spacing"),t.writeAttributeString("w:val",rt["StiOptions"].Export.Word.spaceBetweenCharacters.toString()),t.writeEndElement()),null!=e.cellStyle.textOptions&&e.cellStyle.textOptions.rightToLeft&&(e.cellStyle.font.bold&&(t.writeStartElement("w:bCs"),t.writeEndElement()),e.cellStyle.font.italic&&(t.writeStartElement("w:iCs"),t.writeEndElement()),t.writeStartElement("w:szCs"),t.writeAttributeString("w:val",(2*e.cellStyle.font.sizeInPoints).toString()),t.writeEndElement(),t.writeStartElement("w:rtl"),t.writeEndElement()),t.writeEndElement()}renderBorder2TableGetValues(t,e,i){var r=i.ref;let n=ft.None,a=new ut;return null!=this.matrix.bordersY[t-1][e-1]&&(n|=ft.Left),null!=this.matrix.bordersY[t-1][e-1+1]&&(n|=ft.Right),null!=this.matrix.bordersX[t-1][e-1]&&(a.append("\\t"+this.getLineStyle2TableGetValues(this.matrix.bordersX[t-1][e-1])),n|=ft.Top),null!=this.matrix.bordersX[t-1+1][e-1]&&(a.append("\\b"+this.getLineStyle2TableGetValues(this.matrix.bordersX[t-1+1][e-1])),n|=ft.Bottom),r=a.toString(),i.ref=r,n}getLineStyle2TableGetValues(t){let e=new ut;return e.append(this.getLineStyle(t.style)),e.append(st.trunc(15*t.size)),e.append(pt.format("c{0}",this.getColorString(t.color))),e.toString()}writeDocument(a,s,t){var e=new tt;let o=new F(V.UTF8,e),i=(o.indentation=this.xmlIndentation<0?0:this.xmlIndentation,o.formatting=this.xmlIndentation<0?C.None:C.Indented,o.writeStartDocument(),o.writeStartElement("w:document"),o.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),o.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),o.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),o.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),o.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),o.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),o.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),o.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),o.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),o.writeStartElement("w:body"),a),r=(a=null,0),n=0;while(r<i.count){(a=new T(s,i)).cacheMode=s.renderedPages.cacheMode,a.addV2Internal(i.getPageWithoutCache(r));while(r<i.count-1&&this.comparePages(i.getPageWithoutCache(r+1),i.getPageWithoutCache(r)))r++,a.addV2Internal(i.getPageWithoutCache(r));var l=a.getByIndex(0);if(null!=l){if(a.getPage(l),this.usePageHeadersAndFooters){let t=new T(s,s.renderedPages),e=(t.cacheMode=s.renderedPages.cacheMode,t.add(a.getByIndex(0)),this.matrix=new at.c.StiMatrix(t,rt["StiOptions"].Export.Word.divideBigCells,this),this.matrix.scanComponentsPlacement(!1),0),i=0,r=!1;i=this.matrix.coordY.countItems-1-1;while(0<i&&this.matrix.linePlacement[i]!=at.c.StiTableLineInfo.PageHeader)i--;if(0<=i&&this.matrix.linePlacement[i]==at.c.StiTableLineInfo.PageHeader){e=0;while(this.matrix.linePlacement[e]!=at.c.StiTableLineInfo.PageHeader)e++;r=!0}this.headersData.push(this.writeHeader(e,i,r)),0<this.imageCache.imagePackedStore.length?this.headersRels.push(this.writeHeaderFooterRels()):this.headersRels.push(null);let n=!1;e=0;while(this.matrix.linePlacement[e]!=at.c.StiTableLineInfo.PageFooter&&e<this.matrix.coordY.countItems-1-1)e++;if(this.matrix.linePlacement[e]==at.c.StiTableLineInfo.PageFooter){i=this.matrix.coordY.countItems-1-1;while(this.matrix.linePlacement[i]!=at.c.StiTableLineInfo.PageFooter)i--;n=!0}this.footersData.push(this.writeFooter(e,i,n)),0<this.imageCache.imagePackedStore.length?this.footersRels.push(this.writeHeaderFooterRels()):this.footersRels.push(null),this.matrix=new at.c.StiMatrix(a,rt["StiOptions"].Export.Word.divideBigCells,this),this.matrix.scanComponentsPlacement(!0),i=this.matrix.coordY.countItems-1-1,this.writeFromMatrix(o,0,i,!1)}else this.matrix=new at.c.StiMatrix(a,rt["StiOptions"].Export.Word.divideBigCells,this,null,at.c.StiDataExportMode.AllBands,t),this.writeFromMatrix(o,0,this.matrix.coordY.countItems-1-1,!0);r<i.count-1&&(o.writeStartElement("w:p"),o.writeStartElement("w:pPr"),this.writePageInfo(o,a.getByIndex(0),n),o.writeEndElement(),o.writeEndElement())}r++,n++}return 0<a.count&&this.writePageInfo(o,a.getByIndex(0),n-1),o.writeFullEndElement(),o.writeFullEndElement(),o.writeEndDocument(),o.flush(),e}comparePages(t,e){let i=t.excelSheetValue,r=(pt.isNullOrEmpty(i)&&(i=""),e.excelSheetValue);if(pt.isNullOrEmpty(r)&&(r=""),i!=r)return!1;if(t.orientation!=e.orientation)return!1;if(!t.margins.equals(e.margins))return!1;if(t.unlimitedHeight!=e.unlimitedHeight)return!1;return!0}writePageInfo(t,e,i){let r=this.convertHiToTwips(e.unit.convertToHInches(e.pageHeight*(this.usePageHeadersAndFooters?1:e.segmentPerHeight))),n=this.convertHiToTwips(e.unit.convertToHInches(e.pageWidth*(this.usePageHeadersAndFooters?1:e.segmentPerWidth))),a=this.convertHiToTwips(e.unit.convertToHInches(e.margins.left)),s=this.convertHiToTwips(e.unit.convertToHInches(e.margins.right)),o=this.convertHiToTwips(e.unit.convertToHInches(e.margins.top)),l=this.convertHiToTwips(e.unit.convertToHInches(e.margins.bottom))-rt["StiOptions"].Export.Word.bottomMarginCorrection;l<0&&(l=0),31500<n&&(n=31500),31500<r&&(r=31500),t.writeStartElement("w:sectPr"),this.usePageHeadersAndFooters?(t.writeStartElement("w:headerReference"),t.writeAttributeString("w:type","default"),t.writeAttributeString("r:id",`rIdh`+(i+1)),t.writeEndElement(),t.writeStartElement("w:footerReference"),t.writeAttributeString("w:type","default"),t.writeAttributeString("r:id",`rIdf`+(i+1)),t.writeEndElement()):rt.Base.gVpwr.mgdPW.olcUT()||rt.Base.gVpwr.mgdPW.HdOnK()||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud()||rt.Base.gVpwr.mgdPW.DnFeB())&&rt.System.NodeJs.isStandaloneVersion||(t.writeStartElement("w:headerReference"),t.writeAttributeString("w:type","default"),t.writeAttributeString("r:id","rIdh1"),t.writeEndElement()),t.writeStartElement("w:pgSz"),t.writeAttributeString("w:w",n.toString()),t.writeAttributeString("w:h",r.toString()),e.orientation==G.Landscape&&t.writeAttributeString("w:orient","landscape"),t.writeEndElement(),t.writeStartElement("w:pgMar"),t.writeAttributeString("w:top",o.toString()),t.writeAttributeString("w:right",s.toString()),t.writeAttributeString("w:bottom",l.toString()),t.writeAttributeString("w:left",a.toString()),t.writeAttributeString("w:header",o.toString()),t.writeAttributeString("w:footer",l.toString()),t.writeAttributeString("w:gutter","0"),t.writeEndElement(),t.writeEndElement()}writeBorders(t,e,i,r,n){let a=!0,s=!0;for(let t=0;t<r;t++)null==this.matrix.bordersY[e+t][i]&&(a=!1),null==this.matrix.bordersY[e+t][i+n]&&(s=!1);let o=!0,l=!0;for(let t=0;t<n;t++)null==this.matrix.bordersX[e][i+t]&&(o=!1),null==this.matrix.bordersX[e+r][i+t]&&(l=!1);(o||a||l||s)&&(t.writeStartElement("w:tcBorders"),o&&this.writeBorderData(t,"w:top",this.matrix.bordersX[e][i]),a&&this.writeBorderData(t,"w:left",this.matrix.bordersY[e][i]),l&&this.writeBorderData(t,"w:bottom",this.matrix.bordersX[e+r][i]),s&&this.writeBorderData(t,"w:right",this.matrix.bordersY[e][i+n]),t.writeEndElement())}writeBorderData(t,e,i){var r;null!=i&&""!=(r=this.getLineStyle(i.style))&&(t.writeStartElement(e),t.writeAttributeString("w:val",r),t.writeAttributeString("w:sz",st.trunc(5*i.size).toString()),t.writeAttributeString("w:space","0"),t.writeAttributeString("w:color",this.getColorString(i.color)),t.writeEndElement())}writeFootNotes(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("w:footnotes"),e.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),e.writeStartElement("w:footnote"),e.writeAttributeString("w:type","separator"),e.writeAttributeString("w:id","0"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:separator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeStartElement("w:footnote"),e.writeAttributeString("w:type","continuationSeparator"),e.writeAttributeString("w:id","1"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:continuationSeparator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeEndNotes(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("w:endnotes"),e.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),e.writeStartElement("w:endnote"),e.writeAttributeString("w:type","separator"),e.writeAttributeString("w:id","0"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:separator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeStartElement("w:endnote"),e.writeAttributeString("w:type","continuationSeparator"),e.writeAttributeString("w:id","1"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:continuationSeparator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeHeader(t,e,i){var r=new tt;let n=new F(V.UTF8,r);return n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?C.None:C.Indented,n.writeStartDocument(),n.writeStartElement("w:hdr"),n.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),n.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),n.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),n.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),n.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),n.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),n.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),n.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),n.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),i?this.writeFromMatrix(n,t,e,!0):(n.writeStartElement("w:p"),n.writeStartElement("w:r"),n.writeStartElement("w:cr"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement()),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),r}writeFooter(t,e,i){var r=new tt;let n=new F(V.UTF8,r);return n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?C.None:C.Indented,n.writeStartDocument(),n.writeStartElement("w:ftr"),n.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),n.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),n.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),n.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),n.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),n.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),n.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),n.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),n.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),i?this.writeFromMatrix(n,t,e,!0):(n.writeStartElement("w:p"),n.writeStartElement("w:r"),n.writeStartElement("w:cr"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement()),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),r}writeContentTypes(){var t=new tt;let e=new F(V.UTF8,t);if(e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("Types"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types"),e.writeStartElement("Default"),e.writeAttributeString("Extension","rels"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","xml"),e.writeAttributeString("ContentType","application/xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","jpeg"),e.writeAttributeString("ContentType","image/jpeg"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","emf"),e.writeAttributeString("ContentType","image/x-emf"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","rtf"),e.writeAttributeString("ContentType","application/rtf"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","png"),e.writeAttributeString("ContentType","image/png"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/app.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/core.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/document.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/styles.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/settings.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/webSettings.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/fontTable.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml"),e.writeEndElement(),this.usePageHeadersAndFooters){e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/footnotes.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/endnotes.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml"),e.writeEndElement();for(let t=0;t<this.headersData.length;t++)e.writeStartElement("Override"),e.writeAttributeString("PartName",`/word/footer${t+1}.xml`),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName",`/word/header${t+1}.xml`),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"),e.writeEndElement()}else rt.Base.gVpwr.mgdPW.olcUT()||rt.Base.gVpwr.mgdPW.HdOnK()||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud()||rt.Base.gVpwr.mgdPW.DnFeB())&&rt.System.NodeJs.isStandaloneVersion||(e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/footnotes.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/endnotes.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/word/headerAdditional.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"),e.writeEndElement());return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeMainRels(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","word/document.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsApp(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("Properties"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),e.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),e.writeElementString("Application","Microsoft Office Word"),e.writeElementString("Company",null==this.docCompanyString?"":this.docCompanyString),e.writeElementString("Template","Normal.dotm"),e.writeElementString("TotalTime","0"),e.writeElementString("Pages","1"),e.writeElementString("Words","1"),e.writeElementString("Characters","1"),e.writeElementString("DocSecurity",this.restrictEditing==at.c.StiWord2007RestrictEditing.No?"0":"8"),e.writeElementString("Lines","1"),e.writeElementString("Paragraphs","1"),e.writeElementString("ScaleCrop","false"),e.writeElementString("LinksUpToDate","false"),e.writeElementString("CharactersWithSpaces","1"),e.writeElementString("SharedDoc","false"),e.writeElementString("HyperlinksChanged","false"),e.writeElementString("AppVersion","12.0000"),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsCore(){var t=new tt;let e=new F(V.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("cp:coreProperties"),e.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),e.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),e.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");var i=pt.format("{0}{1}",gt.now.toString("yyyy-MM-dd"),gt.now.toString("THH:mm:ssZ"));return e.writeElementString("dc:title",null==this.report.reportName?"":this.report.reportName),e.writeElementString("dc:subject",null==this.report.reportAlias?"":this.report.reportAlias),e.writeElementString("dc:creator",null==this.report.reportAuthor?"":this.report.reportAuthor),e.writeElementString("cp:keywords",""),e.writeElementString("dc:description",null==this.report.reportDescription?"":this.report.reportDescription),e.writeElementString("cp:lastModifiedBy",null==this.docLastModifiedString?"":this.docLastModifiedString),e.writeElementString("cp:revision","1"),e.writeStartElement("dcterms:created"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(i),e.writeEndElement(),e.writeStartElement("dcterms:modified"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(i),e.writeEndElement(),e.writeElementString("cp:contentStatus",rt.StiVersion.platform()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeSettings(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("w:settings"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:sl","http://schemas.openxmlformats.org/schemaLibrary/2006/main"),this.restrictEditing!=at.c.StiWord2007RestrictEditing.No&&(e.writeStartElement("w:documentProtection"),e.writeAttributeString("w:edit","readOnly"),e.writeAttributeString("w:enforcement","1"),e.writeAttributeString("w:cryptProviderType","rsaFull"),e.writeAttributeString("w:cryptAlgorithmClass","hash"),e.writeAttributeString("w:cryptAlgorithmType","typeAny"),e.writeAttributeString("w:cryptAlgorithmSid","4"),e.writeAttributeString("w:cryptSpinCount","50000"),e.writeAttributeString("w:hash","aw5VYrxGrQVOl7/SJDI9GvbcwaE="),e.writeAttributeString("w:salt","974T1u8C/8p0OAB+3ev3nQ=="),e.writeEndElement()),e.writeStartElement("w:zoom"),e.writeAttributeString("w:percent","100"),e.writeEndElement(),e.writeStartElement("w:proofState"),e.writeAttributeString("w:spelling","clean"),e.writeAttributeString("w:grammar","clean"),e.writeEndElement(),e.writeStartElement("w:defaultTabStop"),e.writeAttributeString("w:val","708"),e.writeEndElement(),e.writeStartElement("w:characterSpacingControl"),e.writeAttributeString("w:val","doNotCompress"),e.writeEndElement(),this.usePageHeadersAndFooters&&(e.writeStartElement("w:footnotePr"),e.writeStartElement("w:footnote"),e.writeAttributeString("w:id","0"),e.writeEndElement(),e.writeStartElement("w:footnote"),e.writeAttributeString("w:id","1"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:endnotePr"),e.writeStartElement("w:endnote"),e.writeAttributeString("w:id","0"),e.writeEndElement(),e.writeStartElement("w:endnote"),e.writeAttributeString("w:id","1"),e.writeEndElement(),e.writeEndElement()),e.writeStartElement("w:compat"),e.writeEndElement(),e.writeStartElement("m:mathPr"),e.writeStartElement("m:mathFont"),e.writeAttributeString("m:val","Cambria Math"),e.writeEndElement(),e.writeStartElement("m:brkBin"),e.writeAttributeString("m:val","before"),e.writeEndElement(),e.writeStartElement("m:brkBinSub"),e.writeAttributeString("m:val","--"),e.writeEndElement(),e.writeStartElement("m:smallFrac"),e.writeAttributeString("m:val","off"),e.writeEndElement(),e.writeStartElement("m:dispDef"),e.writeEndElement(),e.writeStartElement("m:lMargin"),e.writeAttributeString("m:val","0"),e.writeEndElement(),e.writeStartElement("m:rMargin"),e.writeAttributeString("m:val","0"),e.writeEndElement(),e.writeStartElement("m:defJc"),e.writeAttributeString("m:val","centerGroup"),e.writeEndElement(),e.writeStartElement("m:wrapIndent"),e.writeAttributeString("m:val","1440"),e.writeEndElement(),e.writeStartElement("m:intLim"),e.writeAttributeString("m:val","subSup"),e.writeEndElement(),e.writeStartElement("m:naryLim"),e.writeAttributeString("m:val","undOvr"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:themeFontLang"),e.writeAttributeString("w:val","en-EN"),e.writeEndElement(),e.writeStartElement("w:clrSchemeMapping"),e.writeAttributeString("w:bg1","light1"),e.writeAttributeString("w:t1","dark1"),e.writeAttributeString("w:bg2","light2"),e.writeAttributeString("w:t2","dark2"),e.writeAttributeString("w:accent1","accent1"),e.writeAttributeString("w:accent2","accent2"),e.writeAttributeString("w:accent3","accent3"),e.writeAttributeString("w:accent4","accent4"),e.writeAttributeString("w:accent5","accent5"),e.writeAttributeString("w:accent6","accent6"),e.writeAttributeString("w:hyperlink","hyperlink"),e.writeAttributeString("w:followedHyperlink","followedHyperlink"),e.writeEndElement(),e.writeStartElement("w:shapeDefaults"),e.writeStartElement("o:shapedefaults"),e.writeAttributeString("v:ext","edit"),e.writeAttributeString("spidmax","2050"),e.writeEndElement(),e.writeStartElement("o:shapelayout"),e.writeAttributeString("v:ext","edit"),e.writeStartElement("o:idmap"),e.writeAttributeString("v:ext","edit"),e.writeAttributeString("data","1"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:decimalSymbol"),e.writeAttributeString("w:val",","),e.writeEndElement(),e.writeStartElement("w:listSeparator"),e.writeAttributeString("w:val",";"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeWebSettings(){var t=new tt;let e=new F(V.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("w:webSettings"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeStartElement("w:optimizeForBrowser"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeFontTable(){var t=new tt,e;let i=new F(V.UTF8,t);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?C.None:C.Indented,i.writeStartDocument(),i.writeStartElement("w:fonts"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),this.fontList.set("Calibri","Calibri"),this.fontList.set("Cambria","Cambria");for(e of this.fontList.values)i.writeStartElement("w:font"),i.writeAttributeString("w:name",e),i.writeFullEndElement();return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),t}writeDocumentRels(){var t=new tt;let e=new F(V.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles"),e.writeAttributeString("Target","styles.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings"),e.writeAttributeString("Target","settings.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings"),e.writeAttributeString("Target","webSettings.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId4"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable"),e.writeAttributeString("Target","fontTable.xml"),e.writeEndElement();for(let t=0;t<this.imageCache.imagePackedStore.length;t++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",`rId`+(5+t)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),e.writeAttributeString("Target",pt.format("media/image{0:D5}.jpeg",t+1)),e.writeEndElement();if(this.usePageHeadersAndFooters){e.writeStartElement("Relationship"),e.writeAttributeString("Id",`rId`+(5+this.imageCache.imagePackedStore.length+0)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes"),e.writeAttributeString("Target","footnotes.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id",`rId`+(5+this.imageCache.imagePackedStore.length+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes"),e.writeAttributeString("Target","endnotes.xml"),e.writeEndElement();for(let t=0;t<this.headersData.length;t++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",`rIdh`+(t+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/header"),e.writeAttributeString("Target",`header${t+1}.xml`),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id",`rIdf`+(t+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer"),e.writeAttributeString("Target",`footer${t+1}.xml`),e.writeEndElement()}else rt.Base.gVpwr.mgdPW.olcUT()||rt.Base.gVpwr.mgdPW.HdOnK()||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud()||rt.Base.gVpwr.mgdPW.DnFeB())&&rt.System.NodeJs.isStandaloneVersion||(e.writeStartElement("Relationship"),e.writeAttributeString("Id",`rId`+(5+this.imageCache.imagePackedStore.length+0)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes"),e.writeAttributeString("Target","footnotes.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id",`rId`+(5+this.imageCache.imagePackedStore.length+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes"),e.writeAttributeString("Target","endnotes.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rIdh1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/header"),e.writeAttributeString("Target","headerAdditional.xml"),e.writeEndElement());if(0<this.hyperlinkList.count)for(var i of this.hyperlinkList.keys)e.writeStartElement("Relationship"),e.writeAttributeString("Id",`hId`+st.trunc(this.hyperlinkList.get(i))),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),e.writeAttributeString("Target",i),e.writeAttributeString("TargetMode","External"),e.writeEndElement();if(0<this.embedsList.length)for(let t=0;t<this.embedsList.length;t++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",`reId`+(1+t)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk"),e.writeAttributeString("Target",pt.format("embeddings/richtext{0:D5}.rtf",t+1)),e.writeAttributeString("TargetMode","Internal"),e.writeEndElement();return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeHeaderFooterRels(){var t=new tt;let e=new F(V.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?C.None:C.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(let t=0;t<this.imageCache.imagePackedStore.length;t++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",`rId`+(5+t)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),e.writeAttributeString("Target",pt.format("media/image{0:D5}.jpeg",t+1)),e.writeEndElement();return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeStyles(){var t=new tt;let i=new F(V.UTF8,t);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?C.None:C.Indented,i.writeStartDocument(),i.writeStartElement("w:styles"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),i.writeStartElement("w:style"),i.writeAttributeString("w:type","paragraph"),i.writeAttributeString("w:default","1"),i.writeAttributeString("w:styleId","a"),i.writeStartElement("w:name"),i.writeAttributeString("w:val","Normal"),i.writeEndElement(),i.writeStartElement("w:qFormat"),i.writeEndElement(),i.writeStartElement("w:pPr"),i.writeStartElement("w:spacing"),i.writeAttributeString("w:after","0"),i.writeAttributeString("w:line","240"),i.writeAttributeString("w:lineRule","auto"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:rPr"),i.writeStartElement("w:sz"),i.writeAttributeString("w:val",st.round2(2*rt["StiOptions"].Export.Word.normalStyleDefaultFontSize).toString()),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:style"),i.writeAttributeString("w:type","character"),i.writeAttributeString("w:default","1"),i.writeAttributeString("w:styleId","a0"),i.writeStartElement("w:name"),i.writeAttributeString("w:val","Default Paragraph Font"),i.writeEndElement(),i.writeStartElement("w:uiPriority"),i.writeAttributeString("w:val","1"),i.writeEndElement(),i.writeStartElement("w:semiHidden"),i.writeEndElement(),i.writeStartElement("w:unhideWhenUsed"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:style"),i.writeAttributeString("w:type","table"),i.writeAttributeString("w:default","1"),i.writeAttributeString("w:styleId","a1"),i.writeStartElement("w:name"),i.writeAttributeString("w:val","Normal Table"),i.writeEndElement(),i.writeStartElement("w:uiPriority"),i.writeAttributeString("w:val","99"),i.writeEndElement(),i.writeStartElement("w:semiHidden"),i.writeEndElement(),i.writeStartElement("w:unhideWhenUsed"),i.writeEndElement(),i.writeStartElement("w:qFormat"),i.writeEndElement(),i.writeStartElement("w:tblPr"),i.writeStartElement("w:tblInd"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:tblCellMar"),i.writeStartElement("w:top"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:left"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:bottom"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:right"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:style"),i.writeAttributeString("w:type","numbering"),i.writeAttributeString("w:default","1"),i.writeAttributeString("w:styleId","a2"),i.writeStartElement("w:name"),i.writeAttributeString("w:val","No List"),i.writeEndElement(),i.writeStartElement("w:uiPriority"),i.writeAttributeString("w:val","99"),i.writeEndElement(),i.writeStartElement("w:semiHidden"),i.writeEndElement(),i.writeStartElement("w:unhideWhenUsed"),i.writeEndElement(),i.writeEndElement();for(let e=0;e<this.styleList.length;e++){let t=this.styleList[e];i.writeStartElement("w:style"),i.writeAttributeString("w:type","paragraph"),i.writeAttributeString("w:customStyle","1"),i.writeAttributeString("w:styleId",`Style`+e),i.writeStartElement("w:name"),i.writeAttributeString("w:val",t.name),i.writeEndElement(),i.writeStartElement("w:basedOn"),i.writeAttributeString("w:val","a"),i.writeEndElement(),i.writeStartElement("w:rPr"),i.writeStartElement("w:rFonts"),i.writeAttributeString("w:ascii",t.fontName),i.writeAttributeString("w:hAnsi",t.fontName),i.writeAttributeString("w:cs",t.fontName),i.writeEndElement(),t.bold&&(i.writeStartElement("w:b"),i.writeEndElement()),t.italic&&(i.writeStartElement("w:i"),i.writeEndElement()),t.underline&&(i.writeStartElement("w:u"),i.writeAttributeString("w:val","single"),i.writeEndElement()),i.writeStartElement("w:color"),i.writeAttributeString("w:val",this.getColorString(t.textColor)),i.writeEndElement(),i.writeStartElement("w:sz"),i.writeAttributeString("w:val",t.fontSize.toString()),i.writeEndElement(),0!=rt["StiOptions"].Export.Word.spaceBetweenCharacters&&(i.writeStartElement("w:spacing"),i.writeAttributeString("w:val",rt["StiOptions"].Export.Word.spaceBetweenCharacters.toString()),i.writeEndElement()),t.rightToLeft&&(t.bold&&(i.writeStartElement("w:bCs"),i.writeEndElement()),t.italic&&(i.writeStartElement("w:iCs"),i.writeEndElement()),i.writeStartElement("w:szCs"),i.writeAttributeString("w:val",t.fontSize.toString()),i.writeEndElement(),i.writeStartElement("w:rtl"),i.writeEndElement()),i.writeEndElement(),i.writeEndElement()}return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),t}writeImage(t){let e=new tt;var t=this.imageCache.imagePackedStore[t];return null!=t&&e.write(t,0,t.length),e}writeAdditionalData(t,e){let i=new tt,r=null;return r=e?rt.System.Convert.fromBase64String(t):V.ASCII.getBytes(t),i.write(r,0,r.length),i}exportWord(t,n,e){if(at.a.StiLogService.write(this.stimulsoft().getType(),"Export report to Word 2007 format"),null==e)throw new Error("The 'settings' argument cannot be equal in null.");let a=e.pageRange;this.usePageHeadersAndFooters=e.usePageHeadersAndFooters,this.removeEmptySpaceAtBottom=e.removeEmptySpaceAtBottom,this.imageResolution=e.imageResolution,this.imageQuality=e.imageQuality,this.docCompanyString=e.companyString,this.docLastModifiedString=e.lastModifiedString,this.restrictEditing=e.restrictEditing,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,1!=rt["StiOptions"].Export.Word.lineSpacing&&(this.lineSpace=st.round2(240*rt["StiOptions"].Export.Word.lineSpacing).toString(),this.lineSpace2=st.round2(.772*rt["StiOptions"].Export.Word.lineSpacing*240).toString()),rt["StiOptions"].Export.Word.restrictEditing>this.restrictEditing&&(this.restrictEditing=rt["StiOptions"].Export.Word.restrictEditing),this.report=t;try{this.styleList=[],this.fontList=new ct,this.imageCache=new at.a.StiImageCache(rt["StiOptions"].Export.Word.allowImageComparer,!0,at.a.ImageFormat.Jpeg,this.imageQuality,!1),this.bookmarkList=new ct,this.hyperlinkList=new ct,this.embedsList=[],this.currentPassNumber=0,this.maximumPassNumber=3+(rt["StiOptions"].Export.Word.divideSegmentPages?1:0);let e=!1,i=a.getSelectedPages(t.renderedPages);if(rt["StiOptions"].Export.Word.divideSegmentPages){let t=!0;var s;(t=this.usePageHeadersAndFooters&&0<i.count&&i.getByIndex(0).unlimitedHeight&&1==i.getByIndex(0).segmentPerWidth?!1:t)&&(s=at.c.StiSegmentPagesDivider.divide(i,this),i!=s&&(e=!0),i=s,this.currentPassNumber++)}let r=new u;if(r.begin(n,!0),this.usePageHeadersAndFooters&&(this.headersData=[],this.headersRels=[],this.footersData=[],this.footersRels=[]),r.addFile("word/document.xml",this.writeDocument(i,t,e),!0),this.usePageHeadersAndFooters)for(let t=0;t<this.headersData.length;t++)r.addFile(`word/header${t+1}.xml`,this.headersData[t]),null!=this.headersRels[t]&&r.addFile(`word/_rels/header${t+1}.xml.rels`,this.headersRels[t]),r.addFile(`word/footer${t+1}.xml`,this.footersData[t]),null!=this.footersRels[t]&&r.addFile(`word/_rels/footer${t+1}.xml.rels`,this.footersRels[t]);if(this.usePageHeadersAndFooters&&(r.addFile("word/footnotes.xml",this.writeFootNotes()),r.addFile("word/endnotes.xml",this.writeEndNotes())),r.addFile("[Content_Types].xml",this.writeContentTypes()),r.addFile("_rels/.rels",this.writeMainRels()),r.addFile("docProps/app.xml",this.writeDocPropsApp()),r.addFile("docProps/core.xml",this.writeDocPropsCore()),r.addFile("word/settings.xml",this.writeSettings()),r.addFile("word/webSettings.xml",this.writeWebSettings()),r.addFile("word/fontTable.xml",this.writeFontTable()),r.addFile("word/_rels/document.xml.rels",this.writeDocumentRels()),r.addFile("word/styles.xml",this.writeStyles()),0<this.imageCache.imagePackedStore.length)for(let t=0;t<this.imageCache.imagePackedStore.length;t++)r.addFile(pt.format("word/media/image{0:D5}.jpeg",t+1),this.writeImage(t));rt.Base.gVpwr.mgdPW.olcUT()||rt.Base.gVpwr.mgdPW.HdOnK()||this.usePageHeadersAndFooters||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud()||rt.Base.gVpwr.mgdPW.DnFeB())&&rt.System.NodeJs.isStandaloneVersion||(r.addFile("word/footnotes.xml",this.writeFootNotes()),r.addFile("word/endnotes.xml",this.writeEndNotes()),r.addFile("word/media/imageAdditional.png",this.writeAdditionalData(at.c.StiExportUtils.additionalData,!0)),r.addFile("word/headerAdditional.xml",this.writeAdditionalData('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<w:hdr xmlns:ve="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:o="urn:schemas-microsoft-com:office:office" '+'xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:v="urn:schemas-microsoft-com:vml" '+'xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" '+'xmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml"><w:p><w:pPr><w:pStyle w:val="a3"/></w:pPr><w:r><w:rPr><w:noProof/><w:lang w:eastAsia="ru-RU"/></w:rPr><w:pict>'+'<v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f"> <v:stroke joinstyle="miter"/> <v:formulas>'+'<v:f eqn="if lineDrawn pixelLineWidth 0"/><v:f eqn="sum @0 1 0"/><v:f eqn="sum 0 0 @1"/><v:f eqn="prod @2 1 2"/><v:f eqn="prod @3 21600 pixelWidth"/><v:f eqn="prod @3 21600 pixelHeight"/><v:f eqn="sum @0 0 1"/>'+'<v:f eqn="prod @6 1 2"/><v:f eqn="prod @7 21600 pixelWidth"/><v:f eqn="sum @8 21600 0"/><v:f eqn="prod @7 21600 pixelHeight"/><v:f eqn="sum @10 21600 0"/></v:formulas><v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>'+'<o:lock v:ext="edit" aspectratio="t"/></v:shapetype><v:shape id="WordPictureWatermark11777093" o:spid="_x0000_s2050" type="#_x0000_t75" '+'style="position:absolute;margin-left:0;margin-top:0;width:467.45pt;height:433.85pt;z-index:-251657216;mso-position-horizontal:center;mso-position-horizontal-relative:margin;mso-position-vertical:center;mso-position-vertical-relative:margin" '+'o:allowincell="f"><v:imagedata r:id="rId1" o:title="additional"/></v:shape></w:pict></w:r></w:p></w:hdr>',!1)),r.addFile("word/_rels/headerAdditional.xml.rels",this.writeAdditionalData('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="media/imageAdditional.png" /></Relationships>',!1))),r.end()}finally{null!=this.matrix&&(this.matrix.clear(),this.matrix=null),this.fontList.clear(),this.fontList=null,this.imageCache.clear(),this.imageCache=null,this.styleList.stimulsoft().clear(),this.styleList=null,this.bookmarkList.clear(),this.bookmarkList=null,this.hyperlinkList.clear(),this.hyperlinkList=null,this.embedsList.stimulsoft().clear(),this.embedsList=null,this.usePageHeadersAndFooters&&(this.headersData.stimulsoft().clear(),this.headersData=null,this.headersRels.stimulsoft().clear(),this.headersRels=null,this.footersData.stimulsoft().clear(),this.footersData=null,this.footersRels.stimulsoft().clear(),this.footersRels=null),t.renderedPages.cacheMode&&at.c.StiMatrix.GCCollect()}}}Ti.fontsToCorrectHeight=null,at.c.StiWord2007ExportService=Ti}let j=rt.System.Drawing.Font,q=at.a.Components.StiHtmlTextRender,Xt=at.c.StiPdfEmbeddedFileData,zt=at.a.Components.StiSparkline,Vt=rt.Base.Drawing.StiColorUtils,Gt=at.a.Components.StiDataBarIndicator,Yt=at.a.Components.StiIconSetHelper,jt=at.a.Components.StiIcon,_t=at.a.Components.StiIconSetIndicator,B=at.a.Components.StiBookmarksCollection,qt=at.a.Components.StiBookmark,Kt=rt.Base.Drawing.StiHtmlTag,f=at.a.Components.StiImageRotation,yt=rt.Base.Drawing.StiGlareBrush,At=rt.Base.Drawing.StiHatchBrush,R=rt.Base.Drawing.StiGlassBrush,Qt=at.a.Chart.IStiChart,Zt=at.a.BarCodes.StiBarCode,Tt=rt.System.Drawing.Drawing2D.Matrix,Jt=at.a.Dictionary.StiResourceType;{let u=rt.System.Drawing.Rectangle;class Pi{constructor(t){this.X=0,this.Y=0,this.Width=0,this.Height=0,this.Component=null,this.service=null,this.service=t}get Right(){return this.X+this.Width}get Top(){return this.Y+this.Height}clone(){let t=new Pi(this.service);return t.X=this.X,t.Y=this.Y,t.Width=this.Width,t.Height=this.Height,t.Component=this.Component,t}}at.c.StiPdfData=Pi;class Li{}at.c.StiImageData=Li;class Ci{}at.c.StiShadingData=Ci;class Fi{}at.c.StiShadingFunctionData=Fi;class ki{constructor(){this.FontColor=ht.black}}at.c.StiEditableObject=ki;class Pt{}at.c.StiLinkObject=Pt;class Ii{}class Bi extends at.c.StiExportService{constructor(){super(...arguments),this.multipleFiles=!1,this.imageQuality=.75,this.imageResolutionMain=1,this.imageResolutionMode=at.c.StiImageResolutionMode.Auto,this.sw=null,this.pageStream=null,this.imageList=null,this.imageCache=null,this.imageInterpolationTable=null,this.imageCacheIndexToList=null,this.imageInfoList=null,this.imageInfoCounter=0,this.colorTable=mt.create(String,256),this.alphaTable=mt.create(Boolean,256),this.pdfFont=null,this.bidi=null,this.standardPdfFonts=!0,this.embeddedFonts=!1,this.useUnicodeMode=!1,this.reduceFontSize=!0,this.compressed=!1,this.compressedFonts=!1,this.encrypted=!1,this.usePdfA=!1,this.pdfComplianceMode=at.c.StiPdfComplianceMode.None,this.exportRtfTextAsImage=!1,this.autoPrint=at.c.StiPdfAutoPrintMode.None,this.imageCompressionMethod=at.c.StiPdfImageCompressionMethod.Jpeg,this.imageFormat=at.c.StiImageFormat.Color,this.monochromeDitheringType=at.c.StiMonochromeDitheringType.FloydSteinberg,this.allowEditable=at.c.StiPdfAllowEditable.No,this.useTransparency=!0,this.embeddedFiles=null,this.zugferdComplianceMode=at.c.StiPdfZUGFeRDComplianceMode.None,this.zugferdConformanceLevel="BASIC",this.fontGlyphsReduceNotNeed=null,this.bookmarksTree=null,this.bookmarksTreeTemp=null,this.linksArray=null,this.tagsArray=null,this.tooltipsArray=null,this.shadingArray=null,this.hatchArray=null,this.shadingFunctionArray=null,this.haveBookmarks=!1,this.haveLinks=!1,this.haveAnnots=!1,this.haveTooltips=!1,this.CodePage1252part80AF=[8364,8226,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,8226,381,8226,8226,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,8226,382,376],this.CodePage1252=mt.create(Number,256),this.hiToTwips=.72,this.precision_digits_font=3,this.pdfCKT=.55228,this.IDValue=null,this.IDValueString="",this.IDValueStringMeta="",this.currentDateTime="",this.currentDateTimeMeta="",this.producerName="Stimulsoft Reports",this.creatorName="",this.keywords="",this.keyLength=at.c.StiPdfEncryptionKeyLength.Bit40,this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,this.colorStack=null,this.info=null,this.haveDigitalSignature=!1,this.pdfSecurity=null,this.printScaling=!0,this.colorHash1=new ct,this.colorHash2=new ct,this._gsTable=null}implements(){return[at.c.IStiPdfExportService]}get exportFormat(){return at.a.StiExportFormat.Pdf}exportTo(t,e,i){this.exportPdf1(t,e,i)}exportToAsync(t,e,i,r){let n=r.imageCompressionMethod==at.c.StiPdfImageCompressionMethod.Flate;setTimeout(async()=>{if(await at.c.StiExportImageHelper.convertAllImages(e,rt.System.Drawing.Imaging.ImageFormat.Jpeg,n,this.exportFormat),!e.isDocument&&e.getCurrentPage().is(p))return await h.export(e,i,r),void t();this.exportTo(e,i,r),null!=e&&null!=e.preparedExportImages&&(e.preparedExportImages.clear(),e.preparedExportImages=null),t()},0)}stringReplace(t,e,i){e=e.replace(Bi.regexEscape,"\\$1");var e=new RegExp(e,"g");return t.replace(e,i)}getHatchNumber(e){if(0<this.hatchArray.length)for(let t=0;t<this.hatchArray.length;t++){var i=this.hatchArray[t];if(e.style==i.style&&e.backColor.equals(i.backColor)&&e.foreColor.equals(i.foreColor))return t}return this.hatchArray.push(e),this.hatchArray.length-1}getShadingFunctionNumber(i,r,n){if(0<this.shadingFunctionArray.length)for(let e=0;e<this.shadingFunctionArray.length;e++){let t=this.shadingFunctionArray[e];if(t.Color1.equals(i)&&t.Color2.equals(r)&&t.IsGlare==n)return e}let t=new Fi;return t.Color1=i,t.Color2=r,t.IsGlare=n,this.shadingFunctionArray.push(t),this.shadingFunctionArray.length-1}addXref(t){let e=this.sw.position;this.xref[t]=e.toString().stimulsoft().padLeft(10,"0")+" 00000 n",this.currentObjectNumber=t,this.currentGenerationNumber=0}convertToString(t,e=2){let i=st.round2(t,e);return i.toString().split(",").join(rt.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator)}static convertToEscapeSequence(i){var r=[40,41,92,13,10,8,12],n="()\\rnbf";let a,s;if(null==i)return"";s=new ut;for(let e=0;e<i.length;e++){a=!1;for(let t=0;t<r.length;t++)if(i.charCodeAt(e)==r[t]){s.append("\\"+n[t]),a=!0;break}a||s.append(i.charAt(e))}return s.toString()}static convertToEscapeSequencePlusTabs(i){var r=[40,41,92,13,10,9,8,12],n="()\\rntbf";let a,s;if(null==i)return"";s="";for(let e=0;e<i.length;e++){a=!1;for(let t=0;t<r.length;t++)if(i.charCodeAt(e)==r[t]){s+="\\"+n[t],a=!0;break}a||(s+=i.charAt(e))}return s}setStrokeColor(t){let e=this.colorHash1.get(t);null==e&&(e=pt.format("{0} {1} {2} RG",this.colorTable[t.r],this.colorTable[t.g],this.colorTable[t.b]),this.colorHash1.set(t,e)),this.pageStream.writeLine(e);var t=t.a;t!=this.lastColorStrokeA&&rt["StiOptions"].Export.Pdf.allowExtGState&&!this.usePdfA&&(this.pageStream.writeLine(this.gsTable[t][0]),this.lastColorStrokeA=t,this.alphaTable[t]=!0)}setNonStrokeColor(t){let e=this.colorHash2.get(t);null==e&&(e=pt.format("{0} {1} {2} rg",this.colorTable[t.r],this.colorTable[t.g],this.colorTable[t.b]),this.colorHash2.set(t,e)),this.pageStream.writeLine(e);var t=t.a;t!=this.lastColorNonStrokeA&&rt["StiOptions"].Export.Pdf.allowExtGState&&!this.usePdfA&&(this.pageStream.writeLine(this.gsTable[t][1]),this.lastColorNonStrokeA=t,this.alphaTable[t]=!0)}get gsTable(){if(null==this._gsTable){this._gsTable=mt.create2(String,256,2);for(let t=0;t<256;t++)this._gsTable[t][0]=pt.format("/GS{0:X2}S gs",t),this._gsTable[t][1]=pt.format("/GS{0:X2}N gs",t)}return this._gsTable}pushColorToStack(){this.colorStack.push(this.lastColorStrokeA),this.colorStack.push(this.lastColorNonStrokeA)}popColorFromStack(){this.lastColorNonStrokeA=this.colorStack.pop(),this.lastColorStrokeA=this.colorStack.pop()}fillRectBrush(e,i){let r=Et.toColor(e);var t;if(this.setNonStrokeColor(r),this.storeShadingData2(i.x,i.y,i.width,i.height,e),(e.is(vt)||e.is(yt))&&this.pageStream.writeLine1("/Pattern cs /P{0} scn",1+this.shadingCurrent),e.is(At)&&this.pageStream.writeLine1("/Cs1 cs /PH{0} scn",this.getHatchNumber(e)+1),e.is(R)){let t=e;this.setNonStrokeColor(t.getTopColor()),this.pageStream.writeLine1("{0} {1} {2} {3} re f",this.convertToString(i.x),this.convertToString(i.y+i.height/2),this.convertToString(i.width),this.convertToString(i.height/2)),this.setNonStrokeColor(t.getBottomColor()),this.pageStream.writeLine1("{0} {1} {2} {3} re f",this.convertToString(i.x),this.convertToString(i.y),this.convertToString(i.width),this.convertToString(i.height/2)),r=ht.transparent}0!=r.a&&this.pageStream.writeLine1("{0} {1} {2} {3} re f",this.convertToString(i.x),this.convertToString(i.y),this.convertToString(i.width),this.convertToString(i.height))}storeStringLine(t,e,i=!1){var t=t+this.convertToHexString(e,i);this.storeString(t),this.sw.writeLine()}storeString(t){this.sw.writeString(t,!1)}convertToHexString(n,t,e=!1){let a="";if(pt.isNullOrEmpty(n))if(this.encrypted){var i=this.pdfSecurity.encryptData([],this.currentObjectNumber,this.currentGenerationNumber);let e="";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);a+="("+Bi.convertToEscapeSequencePlusTabs(e)+")"}else a+="()";else{let r=e;for(let t=0;t<n.length;t++)127<n.charCodeAt(t)&&(r=!0);if(this.encrypted){let e=null;if(1==r){e=[];for(let t=0;t<n.length;t++){var s=n.charCodeAt(t);e[2+2*t+0]=s>>8&255,e[2+2*t+1]=255&s}e[0]=254,e[1]=255}else{e=[];for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t)}var o=this.pdfSecurity.encryptData(e,this.currentObjectNumber,this.currentGenerationNumber);let i="";for(let t=0;t<o.length;t++)i+=String.fromCharCode(o[t]);a+="("+Bi.convertToEscapeSequencePlusTabs(i)+")"}else if(1==r){a+="<FEFF";for(let t=0;t<n.length;t++)a+=pt.format("{0:X4}",n.charCodeAt(t));a+=">"}else a+=t?"("+Bi.convertToEscapeSequencePlusTabs(n)+")":"("+n+")"}return a}storeMemoryStream2(t,e){var i;this.encrypted?(i=this.pdfSecurity.encryptData(t.toArray(),this.currentObjectNumber,this.currentGenerationNumber),this.sw.writeLine1(pt.format(e,i.length)),this.sw.writeLine(">>"),this.sw.writeLine("stream"),this.sw.write(i,0,i.length)):(this.sw.writeLine1(pt.format(e,t.length)),this.sw.writeLine(">>"),this.sw.writeLine("stream"),t.writeTo(this.sw)),t.close()}storeMemoryStream3(e,t){let i=new tt;for(let t=0;t<e.length;t++)i.writeByte(e[t]);this.storeMemoryStream2(i,t),i.close()}storeMemoryStream4(e,t){let i=new tt;for(let t=0;t<e.length;t++)i.writeByte(e[t]);this.storeMemoryStream2(i,t),i.close()}storeWysiwygSymbols(t,i=-1){var e=[],r=[],n=t.text,a;if(q.drawTextForOutput(t,e,r),this.pdfFont.storeUnicodeSymbolsInMap(n),rt["StiOptions"].Export.Pdf.useProperCaseFontNamesFromHtml)for(var s of r){var o=s.fontName,l,m;let e=!1;for(let t=0;t<o.length;t++)if(ot.isUpper(o,t)){e=!0;break}if(!e){let t=rt.System.Globalization.CultureInfo.InvariantCulture.textInfo.toTitleCase(o),e=null;if(-1!=t.indexOf(",")){for(m of t.split(","))if((e=new j(m,s.fontBase.size,s.fontBase.style)).name.toLowerCase()==m.toLowerCase())break}else e=new j(t,s.fontBase.size,s.fontBase.style);s.fontBase=e,s.fontName=e.name}}for(a of e){var c=r[a.fontIndex].fontBase,c=this.pdfFont.getFontNumber(c);this.pdfFont.currentFont=c;let e=new ut;if(0)for(let t=0;t<a.glyphIndexList.length;t++)e.append(String.fromCharCode(a.glyphIndexList[t]));else e.append(String.fromCharCode(65535));if(this.pdfFont.storeGlyphsInMap(e.toString()),this.pdfFont.storeUnicodeSymbolsInMap(a.text),-1!=i&&!pt.isNullOrWhiteSpace(a.href)&&!a.href.trim().startsWith("javascript:")&&!this.usePdfA){let t=new Pt;t.Link=a.href,t.Page=i,this.linksArray.push(t)}}}renderStartDoc(i,n){this.sw.writeLine(this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit256_r6?"%PDF-1.7":"%PDF-1.4"),this.sw.write([37,226,227,207,211],0,5),this.sw.writeLine(),this.addXref(1),this.sw.writeLine("1 0 obj"),this.sw.writeLine("<<"),this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit256_r5&&this.sw.writeLine("/Extensions<</ADBE<</BaseVersion/1.7/ExtensionLevel 3>>>>"),this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit256_r6&&this.sw.writeLine("/Extensions<</ADBE<</BaseVersion/1.7/ExtensionLevel 8>>>>"),this.sw.writeLine("/Type /Catalog"),this.sw.writeLine1("/Pages {0} 0 R",this.info.pages.ref),this.sw.writeLine("/MarkInfo<</Marked true>>"),this.sw.writeLine1("/Metadata {0} 0 R",this.info.metadata.ref),this.sw.writeLine1("/OutputIntents {0} 0 R",this.info.outputIntents.ref),this.sw.writeLine1("/StructTreeRoot {0} 0 R",this.info.structTreeRoot.ref),this.haveBookmarks?(this.sw.writeLine1("/Outlines {0} 0 R",this.info.outlines.ref),this.sw.writeLine("/PageMode /UseOutlines")):this.sw.writeLine("/PageMode /UseNone"),this.printScaling||(this.sw.writeLine("/ViewerPreferences"),this.sw.writeLine("<<"),this.sw.writeLine("/PrintScaling /None"),this.sw.writeLine(">>")),(this.haveAnnots||this.haveDigitalSignature)&&this.sw.writeLine1("/AcroForm {0} 0 R",this.info.acroForm.ref);var t=this.autoPrint!=at.c.StiPdfAutoPrintMode.None,e=0<this.info.embeddedFilesList.length,r;if(t||e){if(this.sw.writeLine("/Names <<"),t&&this.sw.writeLine1("/JavaScript {0} 0 R",this.info.embeddedJS.ref),e){this.sw.writeLine("/EmbeddedFiles <<"),this.sw.writeString("/Names [ ");for(let t=0;t<this.info.embeddedFilesList.length;t++){var a=this.embeddedFiles[t],a=pt.format("{0} {1} 0 R ",this.convertToHexString(a.name,!0,!0),this.info.embeddedFilesList[t].ref);this.sw.writeString(a)}this.sw.writeLine("]"),this.sw.writeLine(">>")}this.sw.writeLine(">>")}if(this.zugferdComplianceMode!=at.c.StiPdfZUGFeRDComplianceMode.None||this.pdfComplianceMode==at.c.StiPdfComplianceMode.A3){this.sw.writeString("/AF [ ");for(let t=0;t<this.info.embeddedFilesList.length;t++)this.sw.writeString(pt.format("{0} 0 R ",this.info.embeddedFilesList[t].ref));this.sw.writeLine("]")}this.usePdfA||this.sw.writeLine1("/OCProperties << /OCGs [{0} 0 R] /D << /ON [{0} 0 R] /AS [<</Event /Print /OCGs [{0} 0 R] /Category [/Print]>>] >> >>",this.info.optionalContentGroup.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(2),this.sw.writeLine("2 0 obj"),this.sw.writeLine("<<"),this.storeStringLine("/Producer ",this.producerName,!0),this.storeStringLine("/Creator ",this.creatorName,!0),pt.isNullOrEmpty(i.reportAuthor)||this.storeStringLine("/Author ",i.reportAuthor,!0),pt.isNullOrEmpty(i.reportAlias)||this.storeStringLine("/Subject ",i.reportAlias,!0),pt.isNullOrEmpty(i.reportName)||this.storeStringLine("/Title ",i.reportName,!0),pt.isNullOrEmpty(this.keywords)||this.storeStringLine("/Keywords ",this.keywords,!0),this.storeStringLine("/CreationDate ","D:"+this.currentDateTime),this.storeStringLine("/ModDate ","D:"+this.currentDateTime);for(r of i.metaTags.list)r.name.stimulsoft().startsWith("pdf:")&&this.storeStringLine(pt.format("/{0} ",at.a.StiNameValidator.correctName(r.name.substr(4),!1)),r.tag);this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(3),this.sw.writeLine("3 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Cs1 [/Pattern /DeviceRGB]"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.pages.ref),this.sw.writeLine1("{0} 0 obj",this.info.pages.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pages"),this.sw.writeString("/Kids [ ");for(let t=0;t<n.count;t++)this.sw.writeString(pt.format("{0} 0 R ",this.info.pageList[t].ref));if(this.sw.writeLine("]"),this.sw.writeLine1("/Count {0}",n.count),rt["StiOptions"].Export.Pdf.allowInheritedPageResources){let e=[];e.push("/Resources"),e.push("<<"),e.push("/ProcSet [/PDF /Text /ImageC]"),e.push("/Font"),e.push("<<");for(let t=0;t<this.fontsCounter;t++)e.push(pt.format("/F{0} {1} 0 R",t,this.info.fontList[t].ref));if(e.push(">>"),0<this.imageCache.imageStore.length){e.push("/XObject"),e.push("<<");for(let t=0;t<this.imageCache.imageStore.length;t++)e.push(pt.format("/Image{0} {1} 0 R",t,this.info.xObjectList[t].ref));e.push(">>")}e.push("/Pattern"),e.push("<<"),e.push(pt.format("/P1 {0} 0 R",this.info.patterns.first.ref));for(let t=0;t<this.hatchArray.length;t++)e.push(pt.format("/PH{0} {1} 0 R",1+t,this.info.patterns.hatchItems[t].ref));for(let t=0;t<this.shadingArray.length;t++)e.push(pt.format("/P{0} {1} 0 R",2+t,this.info.patterns.shadingItems[t].ref));e.push(">>"),e.push("/ColorSpace 3 0 R"),rt["StiOptions"].Export.Pdf.allowExtGState&&this.useTransparency&&e.push(pt.format("/ExtGState {0} 0 R",this.info.extGState.ref)),this.usePdfA||e.push(pt.format("/Properties << /oc1 {0} 0 R >>",this.info.optionalContentGroup.ref)),e.push(">>");for(let t=0;t<e.length;t++)this.sw.writeLine(e[t])}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(5),this.sw.writeLine("5 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /StructTreeRoot"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(6),this.sw.writeLine("6 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /OCG"),this.sw.writeLine("/Name (Printable off)"),this.sw.writeLine("/Usage <<"),this.sw.writeLine("/Print << /PrintState /OFF >>"),this.sw.writeLine("/View << /ViewState /ON >>"),this.sw.writeLine(">>"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("");for(let r=0;r<n.count;r++){this.addXref(this.info.pageList[r].ref),this.sw.writeLine1("{0} 0 obj",this.info.pageList[r].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Page"),this.sw.writeLine("/Parent 4 0 R");var s=n.getByIndex(r),o,l,m,c;let t=this.hiToTwips*i.unit.convertToHInches(s.pageHeight*s.segmentPerHeight),e=this.hiToTwips*i.unit.convertToHInches(s.pageWidth*s.segmentPerWidth);if(14400<t&&(t=14400),14400<e&&(e=14400),this.sw.writeLine1("/MediaBox [ 0 0 {0} {1} ]",this.convertToString(e),this.convertToString(t)),!rt["StiOptions"].Export.Pdf.allowInheritedPageResources){let e=[];e.push("/Resources"),e.push("<<"),e.push("/ProcSet [/PDF /Text /ImageC]"),e.push("/Font"),e.push("<<");for(let t=0;t<this.fontsCounter;t++)e.push(pt.format("/F{0} {1} 0 R",t,this.info.fontList[t].ref));if(e.push(">>"),0<this.imageCache.imageStore.length){e.push("/XObject"),e.push("<<");for(let t=0;t<this.imageCache.imageStore.length;t++)e.push(pt.format("/Image{0} {1} 0 R",t,this.info.xObjectList[t].ref));e.push(">>")}let i=new ut;i.append(pt.format("/P1 {0} 0 R",this.info.patterns.first.ref));for(let t=0;t<this.hatchArray.length;t++)i.append(pt.format("/PH{0} {1} 0 R",1+t,this.info.patterns.hatchItems[t].ref));for(let t=0;t<this.shadingArray.length;t++){this.shadingArray[t].Page==r&&i.append(pt.format("/P{0} {1} 0 R",2+t,this.info.patterns.shadingItems[t].ref))}e.push("/Pattern << "+i.toString()+" >>"),e.push("/ColorSpace 3 0 R"),rt["StiOptions"].Export.Pdf.allowExtGState&&this.useTransparency&&e.push(pt.format("/ExtGState {0} 0 R",this.info.extGState.ref)),this.usePdfA||e.push(pt.format("/Properties << /oc1 {0} 0 R >>",this.info.optionalContentGroup.ref)),e.push(">>");for(let t=0;t<e.length;t++)this.sw.writeLine(e[t])}if(this.sw.writeLine1("/Contents {0} 0 R",this.info.pageList[r].content.ref),this.usePdfA||(this.sw.writeLine("/Group"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Group"),this.sw.writeLine("/S /Transparency"),this.sw.writeLine("/CS /DeviceRGB"),this.sw.writeLine(">>")),this.haveLinks||this.haveAnnots||this.haveDigitalSignature||this.haveTooltips){if(this.sw.writeLine("/Annots ["),this.haveLinks)for(let t=0;t<this.linksCounter;t++){this.linksArray[t].Page==r&&this.sw.writeLine1("{0} 0 R ",this.info.linkList[t].ref)}if(this.haveAnnots){for(let t=0;t<this.annotsCounter;t++){this.annotsArray[t].Page==r&&this.sw.writeLine1("{0} 0 R ",this.info.acroForm.annots[t].ref)}for(let e=0;e<this.annots2Counter;e++){if(this.annots2Array[e].Page==r)for(let t=0;t<this.info.acroForm.checkBoxes[e].items.length;t++)this.sw.writeLine1("{0} 0 R ",this.info.acroForm.checkBoxes[e].items[t].ref)}}this.sw.writeLine("]")}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}renderEndDoc(){var t=this.sw.position;this.sw.writeLine("xref"),this.sw.writeLine1("0 {0}",this.xref.stimulsoft().countItems+1),this.sw.writeLine("0000000000 65535 f");for(let t=0;t<this.xref.stimulsoft().countItems;t++)this.sw.writeLine(this.xref[t+1]);this.sw.writeLine("trailer"),this.sw.writeLine("<<"),this.sw.writeLine1("/Size {0}",this.xref.stimulsoft().countItems+1),this.sw.writeLine("/Root 1 0 R"),this.sw.writeLine("/Info 2 0 R"),this.encrypted&&this.sw.writeLine1("/Encrypt {0} 0 R",this.info.encode.ref),this.sw.writeLine1("/ID[<{0}><{0}>]",this.IDValueString),this.sw.writeLine(">>"),this.sw.writeLine("%"+at.c.StiExportUtils.getReportVersion()),this.sw.writeLine("%"+rt.StiVersion.platform()),this.sw.writeLine("startxref"),this.sw.writeLine1("{0}",t),this.sw.writeLine("%%EOF")}renderPageHeader(t){this.addXref(this.info.pageList[t].content.ref),this.sw.writeLine1("{0} 0 obj",this.info.pageList[t].content.ref),this.sw.writeLine("<<"),this.pageStream=new tt,this.pageStream.writeLine("2 J")}renderPageFooter(i,r){if(!(rt.Base.gVpwr.mgdPW.olcUT()||rt.Base.gVpwr.mgdPW.HdOnK()||(rt.Base.gVpwr.mgdPW.osgOx()||rt.Base.gVpwr.mgdPW.DLpud()||rt.Base.gVpwr.mgdPW.DnFeB())&&rt.System.NodeJs.isStandaloneVersion)){let t=r/596*1.4,e=i/840*1.4;t>e?t=e:e=t,this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine("1 J 1 j 20 w"),this.setStrokeColor(ht.fromArgb(64,100,100,100)),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm 0.707 0.707 -0.707 0.707 0 0 cm 1 0 0 1 -155 -50 cm",this.convertToString(t),this.convertToString(e),this.convertToString(r/2),this.convertToString(i/2)),this.pageStream.writeLine("40 0 m 40 100 l 0 100 m 80 100 l S"),this.pageStream.writeLine("100 0 m 100 70 l 100 45 m 120 65 l 130 72 l 140 68 l S"),this.pageStream.writeLine("170 0 m 170 70 l 169 100 m 171 100 l S"),this.pageStream.writeLine("215 60 m 222 69 l 232 71 l 255 70 l 265 60 l 265 5 l 270 0 l 265 44 m 220 31 l 212 20 l 212 10 l 225 0 l 235 0 l 250 5 l 265 18 l S"),this.pageStream.writeLine("310 0 m 310 100 l S"),this.pageStream.writeLine("Q"),this.popColorFromStack()}var r,i;this.pageStream.position<this.pageStream.length&&this.pageStream.setLength(this.pageStream.position),1==this.compressed?(r=this.pageStream.toArray(),i=at.c.StiExportUtils.makePdfDeflateStream(r),this.storeMemoryStream2(i,"/Filter [/FlateDecode] /Length {0}")):this.storeMemoryStream2(this.pageStream,"/Filter [] /Length {0}"),this.sw.writeLine(),this.pageStream.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}renderFontTable(){for(let w=0;w<this.fontsCounter;w++){let h=new ut;this.pdfFont.currentFont=w;var d=this.pdfFont.fontList[w];let p=d.Name;rt["StiOptions"].Export.useAlternativeFontNames&&rt["StiOptions"].Export.alternativeFontNames.containsKey(p)&&(p=rt["StiOptions"].Export.alternativeFontNames.get(p));var S=this.embeddedFonts||at.c.PdfFonts.isFontStimulsoft(d.Name),u,S,d,S;if(this.pdfFont.UseUnicode){h=new ut(p.stimulsoft().replaceAll(" ","#20")),(d.Bold||d.Italic)&&(h.append(","),d.Bold&&h.append("Bold"),d.Italic&&h.append("Italic")),S&&h.insert(0,pt.format("SR{0}{1}{2}{3}+",String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65))),this.addXref(this.info.fontList[w].ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[w].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /Type0"),this.sw.writeLine1("/BaseFont /{0}",h),this.sw.writeLine1("/DescendantFonts [{0} 0 R]",this.info.fontList[w].descendantFont.ref),this.sw.writeLine("/Encoding /Identity-H"),this.sw.writeLine1("/ToUnicode {0} 0 R",this.info.fontList[w].toUnicode.ref),this.sw.writeLine1("/Name /F{0}",w),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[w].descendantFont.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[w].descendantFont.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /CIDFontType2"),this.sw.writeLine1("/BaseFont /{0}",h),this.sw.writeLine("/CIDSystemInfo"),this.sw.writeLine("<<"),this.storeStringLine("/Registry","Adobe"),this.storeStringLine("/Ordering","Identity"),this.sw.writeLine("/Supplement 0"),this.sw.writeLine(">>"),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.fontList[w].fontDescriptor.ref),this.usePdfA&&this.sw.writeLine("/CIDToGIDMap /Identity"),this.sw.writeLine("/W [0 [1000]");var f=this.pdfFont.GlyphList,v=f.length,E,E;let i=mt.create(Number,v),r=mt.create(Number,v);for(let t=32;t<v;t++)i[t]=f[t],r[t]=t;for(let e=32;e<i.length-1;e++)for(let t=e+1;t<i.length;t++){i[e]>i[t]&&(E=i[e],i[e]=i[t],i[t]=E,E=r[e],r[e]=r[t],r[t]=E)}let t=new ut,e=32;while(e<this.pdfFont.MappedSymbolsCount){t.append(i[e].toString()+" ["),t.append(this.pdfFont.Widths[r[e]-32].toString()),e++;while(e<this.pdfFont.MappedSymbolsCount&&i[e]-1==i[e-1])t.append(" "+this.pdfFont.Widths[r[e]-32].toString()),e++;while(e<this.pdfFont.MappedSymbolsCount&&i[e]==i[e-1])e++;t.append("]"),this.sw.writeLine1("{0}",t),t=new ut}null!=this.pdfFont.GlyphWidths&&this.pdfFont.GlyphWidths[65535],this.sw.writeLine("]"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[w].toUnicode.ref);var u="SR+F"+w.toString(),u;this.sw.writeLine1("{0} 0 obj",this.info.fontList[w].toUnicode.ref),this.sw.writeLine("<<");let n=new tt,a=(n.writeLine("/CIDInit /ProcSet findresource begin"),n.writeLine("12 dict begin"),n.writeLine("begincmap"),n.writeLine("/CIDSystemInfo"),n.writeLine("<<"),n.writeLine("/Registry (Adobe)"),n.writeLine1("/Ordering ({0})",u),n.writeLine("/Supplement 0"),n.writeLine(">> def"),n.writeLine1("/CMapName /{0} def",u),n.writeLine("/CMapType 2 def"),n.writeLine("1 begincodespacerange"),n.writeLine("<0000> <FFFF>"),n.writeLine("endcodespacerange"),this.pdfFont.MappedSymbolsCount-32),s=32;while(0<a){let e=a;100<e&&(e=100),n.writeLine1("{0} beginbfchar",e);for(let t=0;t<e;t++)n.writeLine1("<{0:X4}> <{1:X4}>",this.pdfFont.GlyphList[s],this.pdfFont.UnicodeMapBack[s]),s++;n.writeLine("endbfchar"),a-=e}n.writeLine("endcmap"),n.writeLine("CMapName currentdict /CMap defineresource pop"),n.writeLine("end"),n.writeLine("end"),n.flush();let o=n.toArray(),l=(n.close(),1==this.compressed?(u=at.c.StiExportUtils.makePdfDeflateStream(o),this.storeMemoryStream2(u,"/Length {0} /Filter [/FlateDecode] /Length1 "+o.length.toString())):this.storeMemoryStream4(o,"/Length {0} /Filter [] /Length1 {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[w].cIDSet.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[w].cIDSet.ref),this.sw.writeLine("<<"),mt.create(Boolean,65536+32)),m=0;for(let t=0;t<this.pdfFont.GlyphList.length;t++){var b=this.pdfFont.GlyphList[t];65535!=b&&(l[b]=!0,b>m&&(m=b))}if(null!=this.pdfFont.GlyphWidths&&0!=this.pdfFont.GlyphWidths[65535])for(let t=0;t<65535;t++)0<this.pdfFont.GlyphWidths[t]&&0==this.pdfFont.GlyphBackList[t]&&(l[t]=!0,t>m&&(m=t));var x=st.trunc(m/8)+1,u;let c=mt.create(Number,x+1),g=0;while(g<x){var y=8*g;let t=0;l[y]&&(t|=128),l[y+1]&&(t|=64),l[y+2]&&(t|=32),l[y+3]&&(t|=16),l[y+4]&&(t|=8),l[y+5]&&(t|=4),l[y+6]&&(t|=2),l[y+7]&&(t|=1),c[g]=t,g++}1==this.compressed?(u=at.c.StiExportUtils.makePdfDeflateStream(c),this.storeMemoryStream2(u,"/Length {0} /Filter [/FlateDecode] /Length1 "+c.length.toString())):this.storeMemoryStream4(c,"/Length {0} /Filter [] /Length1 "+c.length.toString()),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}else{this.addXref(this.info.fontList[w].ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[w].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),1==this.standardPdfFonts?(this.sw.writeLine("/Subtype /Type1"),this.sw.writeLine1("/BaseFont /{0}",d.PdfName)):(this.sw.writeLine("/Subtype /TrueType"),h=new ut(this.stringReplace(p," ","#20")),1!=d.Bold&&1!=d.Italic||(h.append(","),1==d.Bold&&h.append("Bold"),1==d.Italic&&h.append("Italic")),this.sw.writeLine1("/BaseFont /{0}",h),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.fontList[w].fontDescriptor.ref)),this.sw.writeLine1("/Encoding {0} 0 R",this.info.fontList[w].encoding.ref);let e=new ut(" ");for(let t=32;t<this.pdfFont.MappedSymbolsCount;t++)e.append(this.pdfFont.Widths[t-32].toString()+" ");if(this.sw.writeLine1("/FirstChar {0}",32),this.sw.writeLine1("/LastChar {0}",this.pdfFont.MappedSymbolsCount-1),this.sw.writeLine1("/Widths [{0}]",e),this.sw.writeLine1("/Name /F{0}",w),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[w].encoding.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[w].encoding.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Encoding"),this.sw.writeLine("/BaseEncoding /WinAnsiEncoding"),this.pdfFont.MappedSymbolsCount>this.pdfFont.firstMappedSymbol){let e=new ut(this.pdfFont.firstMappedSymbol.toString()+" ");for(let t=this.pdfFont.firstMappedSymbol;t<this.pdfFont.MappedSymbolsCount;t++)e.append("/"+this.pdfFont.CharPdfNames[t]);this.sw.writeLine1("/Differences [{0}]",e)}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}let e=null;if(S&&(e=this.pdfFont.getFontDataBuf(d.Font,this.report)),0==this.standardPdfFonts){this.addXref(this.info.fontList[w].fontDescriptor.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[w].fontDescriptor.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /FontDescriptor"),this.sw.writeLine1("/FontName /{0}",h),this.sw.writeLine("/Flags 32"),this.sw.writeLine1("/Ascent {0}",this.pdfFont.tmASC),this.sw.writeLine1("/CapHeight {0}",this.pdfFont.CH),this.sw.writeLine1("/Descent {0}",this.pdfFont.tmDESC),this.sw.writeLine1("/FontBBox [{0} {1} {2} {3}]",this.pdfFont.LLX,this.pdfFont.LLY,this.pdfFont.URX,this.pdfFont.URY),this.sw.writeLine1("/ItalicAngle {0}",this.pdfFont.ItalicAngle),this.sw.writeLine1("/StemV {0}",this.pdfFont.StemV),S&&null!=e&&this.sw.writeLine1("/FontFile2 {0} 0 R",this.info.fontList[-1==d.ParentFontNumber?w:d.ParentFontNumber].fontFile2.ref);let t=this.pdfFont.UseUnicode;(t=this.pdfComplianceMode!=at.c.StiPdfComplianceMode.A2&&this.pdfComplianceMode!=at.c.StiPdfComplianceMode.A3?t:!1)&&this.sw.writeLine1("/CIDSet {0} 0 R",this.info.fontList[w].cIDSet.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}S&&(null!=e&&0<e.length&&-1==d.ParentFontNumber?(this.reduceFontSize&&null!=(u=this.pdfFont.reduceFontSize(e,d.Name,!this.fontGlyphsReduceNotNeed[w]))&&(e=u),this.addXref(this.info.fontList[w].fontFile2.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[w].fontFile2.ref),this.sw.writeLine("<<"),1==this.compressedFonts?(e instanceof Uint8Array&&(S=at.c.StiExportUtils.makePdfDeflateStream(e),this.storeMemoryStream2(S,"/Length {0} /Filter [/FlateDecode] /Length1 "+e.length.toString())),e instanceof tt&&(d=e.toArray(),S=at.c.StiExportUtils.makePdfDeflateStream(d),this.storeMemoryStream2(S,"/Length {0} /Filter [/FlateDecode] /Length1 "+e.length.toString()))):(e instanceof Uint8Array&&this.storeMemoryStream3(e,"/Length {0} /Filter [] /Length1 "+e.length.toString()),e instanceof tt&&this.storeMemoryStream2(e,"/Length {0} /Filter [] /Length1 "+e.length.toString())),this.sw.writeLine(""),this.sw.writeLine("endstream")):(this.addXref(this.info.fontList[w].fontFile2.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[w].fontFile2.ref),this.sw.writeLine("<< >>")),this.sw.writeLine("endobj"),this.sw.writeLine(""))}}renderImageTable(){if(0<this.imageCache.imageStore.length)for(let r=0;r<this.imageCache.imageStore.length;r++){var n=this.imageCacheIndexToList.get(r);let t=this.imageCache.imagePackedStore[r];var a=this.imageCache.imageMaskStore[r],s=n.ImageFormat;this.addXref(this.info.xObjectList[r].ref),this.sw.writeLine1("{0} 0 obj",this.info.xObjectList[r].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Image"),this.sw.writeLine1("/ColorSpace /{0}",s==at.c.StiImageFormat.Monochrome?"DeviceGray":"DeviceRGB"),this.sw.writeLine1("/Width {0}",n.Width),this.sw.writeLine1("/Height {0}",n.Height),this.sw.writeLine1("/BitsPerComponent {0}",s==at.c.StiImageFormat.Monochrome?"1":"8"),!this.usePdfA&&this.imageInterpolationTable.containsKey(r)&&this.sw.writeLine("/Interpolate true"),null!=a&&this.sw.writeLine1("/SMask {0} 0 R",this.info.xObjectList[r].mask.ref),this.sw.writeLine1("/Name /{0}",n.Name);let e="DCTDecode";this.imageCompressionMethod==at.c.StiPdfImageCompressionMethod.Flate&&(e="FlateDecode"),null==t&&(t=[56,48,56,48,56,48],e="ASCIIHexDecode");var s="/Length {0} "+pt.format("/Filter [/{0}]",e);let i=new tt;if(i.write(t,0,t.length),this.storeMemoryStream2(i,s),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),null!=a){this.addXref(this.info.xObjectList[r].mask.ref),this.sw.writeLine1("{0} 0 obj",this.info.xObjectList[r].mask.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Image"),this.sw.writeLine("/ColorSpace /DeviceGray"),this.sw.writeLine("/Matte [ 0 0 0 ]"),this.sw.writeLine1("/Width {0}",n.Width),this.sw.writeLine1("/Height {0}",n.Height),this.sw.writeLine("/BitsPerComponent 8"),!this.usePdfA&&this.imageInterpolationTable.containsKey(r)&&this.sw.writeLine("/Interpolate true");var s="/Length {0} /Filter /FlateDecode";let t=new tt;t.write(a,0,a.length),this.storeMemoryStream2(t,s),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}}renderBookmarksTable(){if(this.haveBookmarks){this.addXref(this.info.outlines.ref),this.sw.writeLine1("{0} 0 obj",this.info.outlines.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Outlines"),this.sw.writeLine1("/First {0} 0 R",this.info.outlines.items[0].ref),this.sw.writeLine1("/Last {0} 0 R",this.info.outlines.items[0].ref),this.sw.writeLine1("/Count {0}",1),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("");for(let t=0;t<this.bookmarksCounter;t++){this.addXref(this.info.outlines.items[t].ref);var e=this.bookmarksTree[t];this.sw.writeLine1("{0} 0 obj",this.info.outlines.items[t].ref),this.sw.writeLine("<<"),this.storeStringLine("/Title ",e.Title,!0),-1!=e.Parent&&this.sw.writeLine1("/Parent {0} 0 R",this.info.outlines.items[e.Parent].ref),-1!=e.Prev&&this.sw.writeLine1("/Prev {0} 0 R",this.info.outlines.items[e.Prev].ref),-1!=e.Next&&this.sw.writeLine1("/Next {0} 0 R",this.info.outlines.items[e.Next].ref),-1!=e.First&&this.sw.writeLine1("/First {0} 0 R",this.info.outlines.items[e.First].ref),-1!=e.Last&&this.sw.writeLine1("/Last {0} 0 R",this.info.outlines.items[e.Last].ref),0<e.Count&&(0==t?this.sw.writeLine1("/Count {0}",e.Count):this.sw.writeLine1("/Count {0}",-e.Count)),-1<e.Y&&this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[e.Page].ref,this.convertToString(e.Y)),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}}renderPatternTable(){if(this.addXref(this.info.patterns.resources.ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.resources.ref),this.sw.writeLine("<< /ProcSet [/PDF] >>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.patterns.first.ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.first.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pattern"),this.sw.writeLine("/PatternType 1"),this.sw.writeLine("/PaintType 1"),this.sw.writeLine("/TilingType 1"),this.sw.writeLine("/BBox [0 0 2 2]"),this.sw.writeLine("/XStep 3"),this.sw.writeLine("/YStep 3"),this.sw.writeLine1("/Resources {0} 0 R",this.info.patterns.resources.ref),this.pageStream=new tt,this.pageStream.writeLine("1 J 1 j 1 w"),this.pageStream.writeLine("1 0 0 RG"),this.pageStream.writeString("1 1 m 1.1 1.1 l S"),this.storeMemoryStream2(this.pageStream,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),0<this.hatchArray.length)for(let t=0;t<this.hatchArray.length;t++)this.writeHatchPattern(t);if(0<this.shadingArray.length)for(let t=0;t<this.shadingArray.length;t++)this.writeShadingPattern(t);if(0<this.shadingFunctionArray.length){for(let t=0;t<this.shadingFunctionArray.length;t++)this.writeShadingFunction(t);this.sw.writeLine("")}this.pageStream.close()}writeHatchPattern(t){var e=this.hatchArray[t];let i=e.style,r=(53<i&&(i=53),this.addXref(this.info.patterns.hatchItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.hatchItems[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pattern"),this.sw.writeLine("/PatternType 1"),this.sw.writeLine("/PaintType 1"),this.sw.writeLine("/TilingType 1"),this.sw.writeLine("/BBox [0 0 1 1]"),this.sw.writeLine("/XStep 1"),this.sw.writeLine("/YStep 1"),this.sw.writeLine1("/Resources {0} 0 R",this.info.patterns.resources.ref),this.sw.writeLine("/Matrix [5.5 0 0 5.5 0 0]"),new tt);0!=e.backColor.a&&(r.writeLine1("{0} {1} {2} rg",this.colorTable[e.backColor.r],this.colorTable[e.backColor.g],this.colorTable[e.backColor.b]),r.writeLine("0 0 1 1 re f")),r.writeLine1("{0} {1} {2} rg",this.colorTable[e.foreColor.r],this.colorTable[e.foreColor.g],this.colorTable[e.foreColor.b]),r.writeLine("BI"),r.writeLine("/W 8"),r.writeLine("/H 8"),r.writeLine("/BPC 1"),r.writeLine("/IM true"),r.writeLine("/D [1 0]"),r.writeLine("/F [/AHx]"),r.writeLine("ID"),r.writeLine(at.c.StiPdfResources.hatchData[i]+">"),r.writeLine("EI"),r.flush(),this.storeMemoryStream2(r,"/Length {0}"),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}writeShadingPattern(t){var e=this.shadingArray[t];let i=1,r=1,n=e.Angle;n<0&&(n+=360),270<=n&&n<360&&(n=360-n,r=-1),180<=n&&n<270&&(n-=180,r=-1,i=-1),90<=n&&n<180&&(n=180-n,i=-1),n=n*Math.PI/180;var a=e.X+e.Width/2,s=e.Y+e.Height/2,o=Math.sqrt(e.Width*e.Width+e.Height*e.Height)/2,l=Math.atan2(e.Height,e.Width),l=Math.PI/2-n+l,o=o*Math.sin(l),l=o*Math.cos(n)*i,o=o*Math.sin(n)*r,m=a-l,a=a+l,l=s+o,s=s-o;this.addXref(this.info.patterns.shadingItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.shadingItems[t].ref),this.sw.writeString("<<"),this.sw.writeString("/PatternType 2"),this.sw.writeString("/Shading <<"),this.sw.writeString("/ColorSpace /DeviceRGB"),this.sw.writeString("/ShadingType 2"),this.sw.writeString(pt.format("/Coords [{0} {1} {2} {3}]",this.convertToString(m),this.convertToString(l),this.convertToString(a),this.convertToString(s))),this.sw.writeString("/Extend [true true]"),this.sw.writeString(pt.format("/Function {0} 0 R",this.info.patterns.shadingFunctionItems[e.FunctionIndex].ref)),this.sw.writeString(">> "),this.sw.writeLine(">>"),this.sw.writeLine("endobj")}writeShadingFunction(t){var e=this.shadingFunctionArray[t];this.addXref(this.info.patterns.shadingFunctionItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.shadingFunctionItems[t].ref),this.sw.writeString("<<"),this.sw.writeString("/FunctionType 0"),this.sw.writeString("/Size [3]"),this.sw.writeString("/Decode [0 1 0 1 0 1]"),this.sw.writeString("/Range [0 1 0 1 0 1]"),this.sw.writeString("/BitsPerSample 8"),this.sw.writeString("/Domain [0 1]"),this.sw.writeString(pt.format("/Encode [0 {0}]",e.IsGlare?2:1)),this.sw.writeString("/Order 1");let i=new tt;i.writeByte(e.Color1.r),i.writeByte(e.Color1.g),i.writeByte(e.Color1.b),i.writeByte(e.Color2.r),i.writeByte(e.Color2.g),i.writeByte(e.Color2.b),i.writeByte(e.Color1.r),i.writeByte(e.Color1.g),i.writeByte(e.Color1.b),this.storeMemoryStream2(i,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj")}renderLinkTable(){if(this.haveLinks)for(let t=0;t<this.linksCounter;t++){let i=this.linksArray[t];if(i.Link.stimulsoft().startsWith("##")&&0<this.tagsArray.stimulsoft().countItems){var e=i.Link.substr(2);for(let t=0;t<this.tagsArray.stimulsoft().countItems;t++){var r=this.tagsArray[t];if(r.Link==e){i.DestPage=r.Page,i.DestY=r.Y+r.Height;break}}}else if("#"==i.Link.charAt(0)&&this.haveBookmarks){let e=i.Link.substr(1);var n;"%"==e.charAt(0)&&2<e.length&&((n=e.lastIndexOf(e.charAt(1)))<e.length-1&&(e=e.substr(n+1)));for(let t=0;t<this.bookmarksCounter;t++){var a=this.bookmarksTree[t];if(a.Title==e){i.DestPage=a.Page,i.DestY=a.Y;break}}}if(this.linksArray[t]=i,this.addXref(this.info.linkList[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.linkList[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Link"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(i.X),this.convertToString(i.Y),this.convertToString(i.X+i.Width),this.convertToString(i.Y+i.Height)),this.sw.writeLine("/Border [0 0 0]"),"#"==i.Link.charAt(0))-1<i.DestY?this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[i.DestPage].ref,this.convertToString(i.DestY)):this.sw.writeLine1("/Dest [{0} 0 R /XYZ null null null]",this.info.pageList[0].ref);else{let t=this.stringReplace(i.Link,"\\","/");var n=6<t.length&&ot.isLetter(t,0)&&":"==t.charAt(1)&&"/"==t.charAt(2)||"/"==t.charAt(0)&&ot.isLetter(t,1)&&"/"==t.charAt(2);n&&":"==t.charAt(1)&&(t="/"+t.charAt(0)+t.substr(2)),this.sw.writeLine("/A <<"),this.sw.writeLine("/Type /Action"),n?(this.sw.writeLine("/S /Launch"),this.sw.writeLine("/F <<"),this.sw.writeLine("/Type /Filespec"),this.storeStringLine("/F ",t),this.storeStringLine("/UF ",t),this.sw.writeLine(">>")):(this.sw.writeLine("/S /URI"),this.storeStringLine("/URI ",at.c.StiExportUtils.stringToUrl(t))),this.sw.writeLine(">>")}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}renderAnnotTable(){if(this.haveAnnots||this.haveDigitalSignature||this.haveTooltips){this.addXref(this.info.acroForm.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Fields [");for(let t=0;t<this.annotsCounter;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.annots[t].ref);for(let e=0;e<this.annots2Counter;e++)for(let t=0;t<this.info.acroForm.checkBoxes[e].items.length;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.checkBoxes[e].items[t].ref);for(let t=0;t<this.unsignedSignaturesCounter;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.unsignedSignatures[t].ref);this.haveDigitalSignature&&this.sw.writeLine1("{0} 0 R",this.info.acroForm.signatures[0].ref);for(let t=0;t<this.tooltipsCounter;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.tooltips[t].ref);if(this.sw.writeLine("]"),this.sw.writeLine("/DR <<"),0<this.annotsCounter||0<this.annots2Counter){this.sw.writeLine("/Font <<");for(let t=0;t<this.fontsCounter;t++)this.sw.writeLine1("/FA{0} {1} 0 R",t,this.info.acroForm.annotFontItems[t].ref);this.sw.writeLine(">>")}if(this.sw.writeLine(">>"),this.haveAnnots&&0<this.fontsCounter&&this.storeStringLine("/DA ","/FA0 0 Tf 0 g"),this.haveDigitalSignature&&this.sw.writeLine("/SigFlags 3"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.haveAnnots){let a=new ct;for(let n=0;n<this.annotsCounter;n++){let t=this.annotsArray[n],i="";if(rt["StiOptions"].Export.Pdf.useEditableFieldName&&(i=t.Component.name),rt["StiOptions"].Export.Pdf.useEditableFieldAlias&&(i=t.Component.alias),rt["StiOptions"].Export.Pdf.useEditableFieldTag&&(i=t.Component.tagValue),pt.isNullOrEmpty(i)&&(i=`Field`+n),a.containsKey(i)){let t=2,e="";while(a.containsKey(i+e))e="_"+t.toString(),t++;i+=e}a.add(i,i),this.addXref(this.info.acroForm.annots[n].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annots[n].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(t.X),this.convertToString(t.Y),this.convertToString(t.X+t.Width),this.convertToString(t.Y+t.Height)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[t.Page].ref),this.sw.writeLine("/FT /Tx"),this.sw.writeLine("/BS << /W 0 >>"),this.storeStringLine("/T ",i),this.sw.writeLine("/MK << /TP 2 >>"),this.sw.writeLine("/H /P"),this.sw.writeLine1("/AP << /N {0} 0 R >>",this.info.acroForm.annots[n].aP.ref);let e=t.Multiline?4096:0;null!=t.Component.as(lt)&&null!=t.Component.as(lt).textOptions&&t.Component.as(lt).textOptions.lineLimit&&(e|=8388608),this.sw.writeLine1("/Ff {0}",e),this.storeStringLine("/DA ",pt.format("/FA{0} {1} Tf {2} {3} {4} rg",t.FontNumber,this.convertToString(t.FontSize,this.precision_digits_font),this.colorTable[t.FontColor.r],this.colorTable[t.FontColor.g],this.colorTable[t.FontColor.b])),this.storeStringLine("/V ",t.Text,!0),this.storeStringLine("/DV ",t.Text,!0),this.sw.writeLine1("/Q {0}",(t.Alignment==rt.Base.Drawing.StiTextHorAlignment.Center?1:0)+(t.Alignment==rt.Base.Drawing.StiTextHorAlignment.Right?2:0)),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.acroForm.annots[n].aP.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annots[n].aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(t.Width),this.convertToString(t.Height)),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF /Text ]"),this.sw.writeString("/Font << ");for(let t=0;t<this.fontsCounter;t++)this.sw.writeString(pt.format("/F{0} {1} 0 R ",t,this.info.fontList[t].ref));this.sw.writeLine(">> >>");let r=new tt;r.writeLine("/Tx BMC"),r.writeLine("q");var s=1;r.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(s),this.convertToString(s),this.convertToString(t.Width-s),this.convertToString(t.Height-s)),r.flush(),r.write(t.Content,0,t.Content.length),r.writeLine("Q"),r.writeLine("EMC"),r.flush(),this.storeMemoryStream2(r,"/Filter [] /Length {0}"),this.sw.writeLine(""),r.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}for(let r=0;r<this.fontsCounter;r++){this.pdfFont.currentFont=r;var n=this.pdfFont.fontList[r];let t=n.Name,e=(rt["StiOptions"].Export.useAlternativeFontNames&&rt["StiOptions"].Export.alternativeFontNames.containsKey(t)&&(t=rt["StiOptions"].Export.alternativeFontNames.get(t)),new ut(this.stringReplace(t," ","#20")));if((n.Bold||n.Italic)&&(e.append(","),n.Bold&&e.append("Bold"),n.Italic&&e.append("Italic")),this.addXref(this.info.acroForm.annotFontItems[r].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annotFontItems[r].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /TrueType"),this.sw.writeLine1("/Name /FA{0}",r),this.sw.writeLine1("/BaseFont /{0}",e),this.sw.writeLine("/Encoding /WinAnsiEncoding"),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.acroForm.annotFontItems[r].fontDescriptor.ref),this.fontGlyphsReduceNotNeed[r]){let e=new ut(" ");for(let t=32;t<256;t++)e.append(this.pdfFont.Widths[this.pdfFont.UnicodeMap[this.CodePage1252[t]]-32].toString()+" ");this.sw.writeLine("/FirstChar 32"),this.sw.writeLine("/LastChar 255"),this.sw.writeLine1("/Widths [{0}]",e)}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("");let i=null;var o=this.embeddedFonts||at.c.PdfFonts.isFontStimulsoft(n.Name);o&&(i=this.pdfFont.getFontDataBuf(n.Font,this.report)),this.addXref(this.info.acroForm.annotFontItems[r].fontDescriptor.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annotFontItems[r].fontDescriptor.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /FontDescriptor"),this.sw.writeLine1("/FontName /{0}",e),this.sw.writeLine("/Flags 32"),this.sw.writeLine1("/Ascent {0}",this.pdfFont.tmASC),this.sw.writeLine1("/CapHeight {0}",this.pdfFont.CH),this.sw.writeLine1("/Descent {0}",-this.pdfFont.tmDESC),this.sw.writeLine1("/FontBBox [{0} {1} {2} {3}]",-500,-200,1500,1e3),this.sw.writeLine1("/ItalicAngle {0}",this.pdfFont.ItalicAngle),this.sw.writeLine1("/StemV {0}",this.pdfFont.StemV),o&&null!=i&&this.sw.writeLine1("/FontFile2 {0} 0 R",this.info.fontList[r].fontFile2.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}for(let n=0;n<this.annots2Counter;n++){let e=this.annots2Array[n],i="";if(rt["StiOptions"].Export.Pdf.useEditableFieldName&&(i=e.Component.name),rt["StiOptions"].Export.Pdf.useEditableFieldAlias&&(i=e.Component.alias),rt["StiOptions"].Export.Pdf.useEditableFieldTag&&(i=e.Component.tagValue),pt.isNullOrEmpty(i)&&(i=`Checkbox`+(n+1)),a.containsKey(i)){let t=2,e="";while(a.containsKey(i+e))e="_"+t.toString(),t++;i+=e}a.add(i,i);var l=.01,t=e.Component.as(nt),m;let r=at.c.StiPdfRenderPrimitives.getCheckBoxValue(t);if(null==r&&(r=!1),1<this.info.acroForm.checkBoxes[n].items.length){var c=this.info.acroForm.checkBoxes[n].items[0];this.addXref(c.ref),this.sw.writeLine1("{0} 0 obj",c.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(e.X),this.convertToString(e.Y),this.convertToString(e.X+e.Width-l),this.convertToString(e.Y+e.Height-l)),this.sw.writeLine1("/F {0}",4+(3==this.info.acroForm.checkBoxes[n].items.length||0==r?2:0)),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[e.Page].ref),this.storeStringLine("/T ",i+"Yes"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",c.aA[0].ref),this.sw.writeLine1("/AP << /N {0} 0 R >>",c.aP.ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(c.aP.ref),this.sw.writeLine1("{0} 0 obj",c.aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine("/FormType 1"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(e.Width),this.convertToString(e.Height)),this.sw.writeLine("/Matrix [ 1 0 0 1 0 0 ]"),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF ]"),this.sw.writeLine("/Pattern"),this.sw.writeLine("<<");for(let t=0;t<this.hatchArray.length;t++)this.sw.writeLine1(pt.format("/PH{0} {1} 0 R",1+t,this.info.patterns.hatchItems[t].ref));for(let t=0;t<this.shadingArray.length;t++)this.sw.writeLine1(pt.format("/P{0} {1} 0 R",2+t,this.info.patterns.shadingItems[t].ref));this.sw.writeLine(">>"),this.sw.writeLine("/ColorSpace 3 0 R"),this.sw.writeLine(">>");let t=new tt;t.writeLine("/Tx BMC"),t.writeLine("q");var m=1;t.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(m),this.convertToString(m),this.convertToString(e.Width-m),this.convertToString(e.Height-m)),t.flush(),t.write(e.Content,0,e.Content.length),t.writeLine("Q"),t.writeLine("EMC"),t.flush(),this.storeMemoryStream2(t,"/Filter [] /Length {0}"),this.sw.writeLine(""),t.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(c.aA[0].ref),this.sw.writeLine1("{0} 0 obj",c.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Next {0} 0 R",c.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",i+"Yes"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(c.aA[1].ref),this.sw.writeLine1("{0} 0 obj",c.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",i+"No"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),c=this.info.acroForm.checkBoxes[n].items[1],this.addXref(c.ref),this.sw.writeLine1("{0} 0 obj",c.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(e.X),this.convertToString(e.Y),this.convertToString(e.X+e.Width-l),this.convertToString(e.Y+e.Height-l)),this.sw.writeLine1("/F {0}",4+(3==this.info.acroForm.checkBoxes[n].items.length||1==r?2:0)),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[e.Page].ref),this.storeStringLine("/T ",i+"No"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",c.aA[0].ref),this.sw.writeLine1("/AP << /N {0} 0 R >>",c.aP.ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(c.aP.ref),this.sw.writeLine1("{0} 0 obj",c.aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine("/FormType 1"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(e.Width),this.convertToString(e.Height)),this.sw.writeLine("/Matrix [ 1 0 0 1 0 0 ]"),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF ]"),this.sw.writeLine("/Pattern"),this.sw.writeLine("<<");for(let t=0;t<this.hatchArray.length;t++)this.sw.writeLine1(pt.format("/PH{0} {1} 0 R",1+t,this.info.patterns.hatchItems[t].ref));for(let t=0;t<this.shadingArray.length;t++)this.sw.writeLine1(pt.format("/P{0} {1} 0 R",2+t,this.info.patterns.shadingItems[t].ref));this.sw.writeLine(">>"),this.sw.writeLine("/ColorSpace 3 0 R"),this.sw.writeLine(">>"),(t=new tt).writeLine("/Tx BMC"),t.writeLine("q"),m=1,t.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(m),this.convertToString(m),this.convertToString(e.Width-m),this.convertToString(e.Height-m)),t.flush(),t.write(e.Content2,0,e.Content2.length),t.writeLine("Q"),t.writeLine("EMC"),t.flush(),this.storeMemoryStream2(t,"/Filter [] /Length {0}"),this.sw.writeLine(""),t.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(c.aA[0].ref),this.sw.writeLine1("{0} 0 obj",c.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine1("/Next {0} 0 R",c.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",i+"Yes"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(c.aA[1].ref),this.sw.writeLine1("{0} 0 obj",c.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",i+"No"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}3==this.info.acroForm.checkBoxes[n].items.length&&(m=this.info.acroForm.checkBoxes[n].items[2],this.addXref(m.ref),this.sw.writeLine1("{0} 0 obj",m.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(e.X),this.convertToString(e.Y),this.convertToString(e.X+e.Width-l),this.convertToString(e.Y+e.Height-l)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[e.Page].ref),this.storeStringLine("/T ",i+"None"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",m.aA[0].ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(m.aA[0].ref),this.sw.writeLine1("{0} 0 obj",m.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Next {0} 0 R",m.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",i+"None"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(m.aA[1].ref),this.sw.writeLine1("{0} 0 obj",m.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",i+(t.checkStyleForTrue==at.a.Components.StiCheckStyle.None?"No":"Yes")),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""))}for(let t=0;t<this.unsignedSignaturesCounter;t++){var e=this.unsignedSignaturesArray[t];let i="";if(rt["StiOptions"].Export.Pdf.useEditableFieldName&&(i=e.Component.name),rt["StiOptions"].Export.Pdf.useEditableFieldAlias&&(i=e.Component.alias),rt["StiOptions"].Export.Pdf.useEditableFieldTag&&(i=e.Component.tagValue),pt.isNullOrEmpty(i)&&(i=`UnsignedSignature`+t),a.containsKey(i)){let t=2,e="";while(a.containsKey(i+e))e="_"+t.toString(),t++;i+=e}a.add(i,i);var r=this.info.acroForm.unsignedSignatures[t].ref;this.addXref(r),this.sw.writeLine1("{0} 0 obj",r),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(e.X),this.convertToString(e.Y),this.convertToString(e.X+e.Width),this.convertToString(e.Y+e.Height)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[e.Page].ref),this.sw.writeLine("/FT /Sig"),this.storeStringLine("/T ",i),this.sw.writeLine("/MK << >>"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}}}renderTooltipTable(){if(this.haveTooltips)for(let t=0;t<this.tooltipsCounter;t++){var r=this.tooltipsArray[t];let e=!1,i=new Pt;for(let t=0;t<this.linksCounter;t++)if((i=this.linksArray[t]).X==r.X&&i.Y==r.Y&&i.Width==r.Width&&i.Height==r.Height&&i.Page-1==r.Page){e=!0;break}this.addXref(this.info.acroForm.tooltips[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.tooltips[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(r.X),this.convertToString(r.Y),this.convertToString(r.X+r.Width),this.convertToString(r.Y+r.Height)),this.storeStringLine("/TU ",r.Link,!0),this.sw.writeLine("/F 0"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[r.Page].ref),this.storeStringLine("/T ",`Tooltip`+t),this.sw.writeLine("/FT /Btn"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine("/H /N"),this.sw.writeLine("/AP <<"),this.sw.writeLine(">>"),e&&("#"==i.Link.charAt(0)?-1<i.DestY?this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[i.DestPage].ref,this.convertToString(i.DestY)):this.sw.writeLine1("/Dest [{0} 0 R /XYZ null null null]",this.info.pageList[0].ref):(this.sw.writeLine("/A <<"),this.sw.writeLine("/Type /Action"),this.sw.writeLine("/S /URI"),this.storeStringLine("/URI ",at.c.StiExportUtils.stringToUrl(this.stringReplace(i.Link,"\\","/"))),this.sw.writeLine(">>"))),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}renderEncodeRecord(){this.encrypted&&(this.addXref(this.info.encode.ref),this.sw.writeLine1("{0} 0 obj",this.info.encode.ref),this.sw.writeLine("<<"),this.pdfSecurity.renderEncodeRecord(this.sw),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""))}renderExtGStateRecord(){this.addXref(this.info.extGState.ref),this.sw.writeLine1("{0} 0 obj",this.info.extGState.ref),this.sw.writeLine("<<");for(let t=0;t<256;t++){var e;this.alphaTable[t]&&(e=pt.format("{0:X2}",t).toUpperCase(),this.sw.writeLine1("/GS{0}S <</Type /ExtGState /BM /Normal /CA {1}>>",e,this.colorTable[t]),this.sw.writeLine1("/GS{0}N <</Type /ExtGState /BM /Normal /ca {1}>>",e,this.colorTable[t]))}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}storeImageData(t,e,i,r,n=!1){null!=t&&t.tryConvertSync(rt.System.Drawing.Imaging.ImageFormat.Jpeg);var a=this.imageCache.addImageInt(t);let s=new Li;return null!=t&&null!=t.bytes?(s.Width=t.width,s.Height=t.height):(s.Width=1,s.Height=1),s.Name=pt.format("Image{0}",a),s.ImageFormat=this.imageFormat,this.imageList.push(s),this.imageCacheIndexToList.set(a,s),r&&this.imageInterpolationTable.set(a,!0),e}storeImageDataForGeom(t){let e=t.imageToDraw.horizontalResolution/100;this.imageResolutionMode==at.c.StiImageResolutionMode.NoMoreThan&&(e=t.stretch?t.imageToDraw.width/this.report.unit.convertToHInches(t.width):1/t.multipleFactor),e=this.storeImageData(t.imageToDraw,e,!0,t.smoothing),this.imageInfoList.set(this.imageInfoCounter,e)}writeImageInfo(r,t){var e=this.imageList[this.imagesCurrent],n,a,i,s;this.imagesCurrent++;let o=r.Component.as(E),l=(this.imageResolutionMode==at.c.StiImageResolutionMode.Exactly||null==o||o.margins.isEmpty||(n=this.hiToTwips*o.margins.left,a=this.hiToTwips*o.margins.right,i=this.hiToTwips*o.margins.top,s=this.hiToTwips*o.margins.bottom,0!=n&&(r.X+=n,r.Width-=n),0!=s&&(r.Y+=s,r.Height-=s),0!=a&&(r.Width-=a),0!=i&&(r.Height-=i)),f.None),m=(null!=o&&(l=o.imageRotation),e.Width),c=e.Height,g=(l!=f.Rotate90CCW&&l!=f.Rotate90CW||(m=e.Height,c=e.Width),r.X),h=r.Y,p=this.hiToTwips*(m-1)/t,w=this.hiToTwips*(c-1)/t,d=!1;if(this.imageResolutionMode!=at.c.StiImageResolutionMode.Exactly&&null!=o&&null!=o.imageToDraw){var n=o.imageToDraw,S=o.getPaintRectangle(!0,!1),S=o.convertImageMargins(S,!1);let i=new u(0,0,S.width,S.height);if(o.stretch){let t=m,e=c;if(null==n&&(t=1,e=1),o.aspectRatio){var s=i.width/t,a=i.height/e;switch(a<s?i.width=t*a:i.height=e*s,o.vertAlignment){case dt.Center:i.y=(S.height-i.height)/2;break;case dt.Top:i.y=S.height-i.height;break}switch(o.horAlignment){case x.Center:i.x=(S.width-i.width)/2;break;case x.Right:i.x=S.width-i.width;break}g+=i.x*this.hiToTwips,h+=i.y*this.hiToTwips,p=i.width*this.hiToTwips,w=i.height*this.hiToTwips}else p=r.Width,w=r.Height}else{let t=m*o.multipleFactor,e=c*o.multipleFactor;switch(null!=n&&null!=n.bytes||(t=1,e=1),i.width=t,i.height=e,o.horAlignment){case x.Center:i.x=(S.width-t)/2;break;case x.Right:i.x=S.width-t;break}switch(o.vertAlignment){case dt.Center:i.y=(S.height-e)/2;break;case dt.Top:i.y=S.height-e;break}g+=i.x*this.hiToTwips,h+=i.y*this.hiToTwips,p=i.width*this.hiToTwips,w=i.height*this.hiToTwips,d=!0}}this.pageStream.writeLine("q"),this.pushColorToStack(),this.setNonStrokeColor(ht.black),d&&this.pageStream.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(r.X),this.convertToString(r.Y),this.convertToString(r.Width),this.convertToString(r.Height)),l==f.None?this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(p),this.convertToString(w),this.convertToString(g),this.convertToString(h)):(this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(g+p/2),this.convertToString(h+w/2)),l==f.Rotate90CCW&&this.pageStream.writeLine("0 1 -1 0 0 0 cm"),l==f.Rotate90CW&&this.pageStream.writeLine("0 -1 1 0 0 0 cm"),l==f.Rotate180&&this.pageStream.writeLine("-1 0 0 -1 0 0 cm"),l==f.FlipHorizontal&&this.pageStream.writeLine("-1 0 0 1 0 0 cm"),l==f.FlipVertical&&this.pageStream.writeLine("1 0 0 -1 0 0 cm"),l==f.Rotate90CCW||l==f.Rotate90CW?this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(w),this.convertToString(p),this.convertToString(-w/2),this.convertToString(-p/2)):this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(p),this.convertToString(w),this.convertToString(-p/2),this.convertToString(-w/2))),this.pageStream.writeLine1("/{0} Do",e.Name),this.pageStream.writeLine("Q"),this.popColorFromStack()}writeImageInfo2(t,e,i){var r=this.imageList[this.imagesCurrent];this.imagesCurrent++,this.pageStream.writeLine("q"),this.pushColorToStack(),this.setNonStrokeColor(ht.black),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(this.hiToTwips*r.Width/e),this.convertToString(this.hiToTwips*r.Height/i),this.convertToString(t.X),this.convertToString(t.Y)),this.pageStream.writeLine1("/{0} Do",r.Name),this.pageStream.writeLine("Q"),this.popColorFromStack()}renderImage(e,i){if(this.imageInfoList.containsKey(this.imageInfoCounter)){var r=this.imageInfoList.get(this.imageInfoCounter);this.writeImageInfo(e,r)}else{let t=e.Component.as(Lt);var n,r,i,n;null!=t&&e.Component.isExportAsImage(at.a.StiExportFormat.Pdf)&&(r={ref:n=i},null!=(i=t.getImage(r,at.a.StiExportFormat.Pdf))&&null!=i.bytes&&this.writeImageInfo(e,r.ref))}}renderWatermark(i,t,l,m,e){var c=i.watermark;if(null!=c&&c.enabled){if(null!=c.image&&c.showImageBehind==t){var g=this.imageList[this.imagesCurrent],h;let i=g.Width*this.hiToTwips*c.imageMultipleFactor,r=g.Height*this.hiToTwips*c.imageMultipleFactor,n=0,a=0,s=1,t=1,e=c.imageAlignment,o=c.imageTiling;switch(c.imageStretch&&(h=r/i,i=l,r=m,o=!1,c.aspectRatio&&(h<m/l?r=i*h:i=r/h)),(c.imageStretch||1<c.imageMultipleFactor)&&this.imageInterpolationTable.set(this.imageCache.imageIndex[this.imagesCurrent],!0),o&&(e=rt.System.Drawing.ContentAlignment.TopLeft,s=st.round2(l/i)+1,t=st.round2(m/r)+1),e){case rt.System.Drawing.ContentAlignment.TopCenter:case rt.System.Drawing.ContentAlignment.MiddleCenter:case rt.System.Drawing.ContentAlignment.BottomCenter:n=(l-i)/2;break;case rt.System.Drawing.ContentAlignment.TopRight:case rt.System.Drawing.ContentAlignment.MiddleRight:case rt.System.Drawing.ContentAlignment.BottomRight:n=l-i;break}switch(e){case rt.System.Drawing.ContentAlignment.TopLeft:case rt.System.Drawing.ContentAlignment.TopCenter:case rt.System.Drawing.ContentAlignment.TopRight:a=m-r;break;case rt.System.Drawing.ContentAlignment.MiddleLeft:case rt.System.Drawing.ContentAlignment.MiddleCenter:case rt.System.Drawing.ContentAlignment.MiddleRight:a=(m-r)/2;break}this.setNonStrokeColor(ht.fromArgb(255-c.imageTransparency,ht.black));for(let e=0;e<t;e++)for(let t=0;t<s;t++)this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(i),this.convertToString(r),this.convertToString(n+i*t),this.convertToString(a-r*e)),this.pageStream.writeLine1("/{0} Do",g.Name),this.pageStream.writeLine("Q"),this.popColorFromStack();this.imagesCurrent++}if(!pt.isNullOrEmpty(c.text)&&c.showBehind==t){let t=new Pi(this),e=(t.X=0,t.Y=0,t.Width=l,t.Height=m,new lt(new u(t.X,t.Y,t.Width,t.Height)));e.text=c.text,e.textBrush=c.textBrush,e.font=c.font,e.textOptions=new rt.Base.Drawing.StiTextOptions,e.textOptions.angle=c.angle,e.horAlignment=rt.Base.Drawing.StiTextHorAlignment.Center,e.vertAlignment=dt.Center,e.page=i,e.textQuality=at.a.Components.StiTextQuality.Standard,t.Component=e,at.c.StiPdfRenderText.renderTextFont(t),at.c.StiPdfRenderText.renderText(t)}}}storeShadingData1(e,i){if(null!=e){if(e.is(vt)){var r=e;let t=new Ci;t.Angle=r.angle,t.Page=i,t.FunctionIndex=this.getShadingFunctionNumber(r.startColor,r.endColor,!1),this.shadingArray.push(t)}if(e.is(yt)){var r=e;let t=new Ci;t.Angle=r.angle,t.FunctionIndex=this.getShadingFunctionNumber(r.startColor,r.endColor,!0),t.Page=i,this.shadingArray.push(t)}}}storeShadingData2(e,i,r,n,t,a=0){if(null!=t&&(t.is(vt)||t.is(yt))){let t=this.shadingArray[this.shadingCurrent];t.X=e,t.Y=i,t.Width=r,t.Height=n,0==t.Angle&&0<r&&0<n&&(t.Angle=180*Math.atan2(n,r)/Math.PI),t.Angle+=a,this.shadingArray[this.shadingCurrent]=t,this.shadingCurrent++}return this.shadingCurrent}storeHatchData(t){var e;null!=t&&(t.is(At)&&this.getHatchNumber(t),t.is(R)&&t.as(R).drawHatch)}renderMetadata(t){let e=new tt;var i,r,n,a;e.writeString('<?xpacket begin="ï»¿" id="W5M0MpCehiHzreSzNTczkc9d"?>\r\n');let s=new tt,o=new F(rt.System.Text.Encoding.UTF8,s);if(o.formatting=rt.System.Xml.Formatting.Indented,o.writeStartElement("x:xmpmeta"),o.writeAttributeString("xmlns:x","adobe:ns:meta/"),o.writeAttributeString("x:xmptk","Adobe XMP Core 4.0-c316 44.253921, Sun Oct 01 2006 17:14:39"),o.writeStartElement("rdf:RDF"),o.writeAttributeString("xmlns:rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),o.writeStartElement("rdf:Description"),o.writeAttributeString("rdf:about",""),o.writeAttributeString("xmlns:xap","http://ns.adobe.com/xap/1.0/"),o.writeElementString("xap:ModifyDate",this.currentDateTimeMeta),o.writeElementString("xap:CreateDate",this.currentDateTimeMeta),o.writeElementString("xap:MetadataDate",this.currentDateTimeMeta),o.writeElementString("xap:CreatorTool",rt["StiOptions"].Export.Pdf.creatorString),o.writeFullEndElement(),o.writeStartElement("rdf:Description"),o.writeAttributeString("rdf:about",""),o.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),o.writeElementString("dc:format","application/pdf"),o.writeStartElement("dc:title"),o.writeStartElement("rdf:Alt"),pt.isNullOrEmpty(t.reportName)||(o.writeStartElement("rdf:li"),o.writeAttributeString("xml:lang","x-default"),o.writeString(t.reportName),o.writeFullEndElement()),o.writeEndElement(),o.writeFullEndElement(),o.writeStartElement("dc:description"),o.writeStartElement("rdf:Alt"),pt.isNullOrEmpty(t.reportAlias)||(o.writeStartElement("rdf:li"),o.writeAttributeString("xml:lang","x-default"),o.writeString(t.reportAlias),o.writeFullEndElement()),o.writeEndElement(),o.writeFullEndElement(),o.writeStartElement("dc:creator"),o.writeStartElement("rdf:Seq"),pt.isNullOrEmpty(t.reportAuthor)||(o.writeStartElement("rdf:li"),o.writeAttributeString("xml:lang","x-default"),o.writeString(t.reportAuthor),o.writeFullEndElement()),o.writeEndElement(),o.writeFullEndElement(),o.writeStartElement("dc:subject"),o.writeStartElement("rdf:Bag"),!pt.isNullOrEmpty(this.keywords))for(n of this.keywords.split(";"))o.writeStartElement("rdf:li"),o.writeString(n.trim()),o.writeFullEndElement();o.writeEndElement(),o.writeFullEndElement(),o.writeFullEndElement(),o.writeStartElement("rdf:Description"),o.writeAttributeString("rdf:about",""),o.writeAttributeString("xmlns:xapMM","http://ns.adobe.com/xap/1.0/mm/"),o.writeElementString("xapMM:DocumentID",this.IDValueStringMeta),o.writeElementString("xapMM:InstanceID",this.IDValueStringMeta),o.writeFullEndElement(),o.writeStartElement("rdf:Description"),o.writeAttributeString("rdf:about",""),o.writeAttributeString("xmlns:pdf","http://ns.adobe.com/pdf/1.3/"),o.writeAttributeString("xmlns:pdfx","http://ns.adobe.com/pdf/1.3/"),o.writeElementString("pdf:Producer",this.producerName),o.writeElementString("pdf:Keywords",this.keywords);for(a of t.metaTags.list)a.name.stimulsoft().startsWith("pdf:")&&o.writeElementString("pdfx:"+a.name.substr(4),a.tag);if(o.writeFullEndElement(),this.zugferdComplianceMode!=at.c.StiPdfZUGFeRDComplianceMode.None&&(o.writeStartElement("rdf:Description"),o.writeAttributeString("xmlns:pdfaExtension","http://www.aiim.org/pdfa/ns/extension/"),o.writeAttributeString("xmlns:pdfaField","http://www.aiim.org/pdfa/ns/field#"),o.writeAttributeString("xmlns:pdfaProperty","http://www.aiim.org/pdfa/ns/property#"),o.writeAttributeString("xmlns:pdfaSchema","http://www.aiim.org/pdfa/ns/schema#"),o.writeAttributeString("xmlns:pdfaType","http://www.aiim.org/pdfa/ns/type#"),o.writeAttributeString("rdf:about",""),o.writeStartElement("pdfaExtension:schemas"),o.writeStartElement("rdf:Bag"),o.writeStartElement("rdf:li"),o.writeAttributeString("rdf:parseType","Resource"),this.zugferdComplianceMode==at.c.StiPdfZUGFeRDComplianceMode.V1&&(o.writeElementString("pdfaSchema:schema","ZUGFeRD PDFA Extension Schema"),o.writeElementString("pdfaSchema:namespaceURI","urn:ferd:pdfa:CrossIndustryDocument:invoice:1p0#"),o.writeElementString("pdfaSchema:prefix","zf")),this.zugferdComplianceMode==at.c.StiPdfZUGFeRDComplianceMode.V2&&(o.writeElementString("pdfaSchema:schema","ZUGFeRD PDFA Extension Schema"),o.writeElementString("pdfaSchema:namespaceURI","urn:zugferd:pdfa:CrossIndustryDocument:invoice:2p0#"),o.writeElementString("pdfaSchema:prefix","zf")),this.zugferdComplianceMode==at.c.StiPdfZUGFeRDComplianceMode.V2_1&&(o.writeElementString("pdfaSchema:schema","Factur-X/ZUGFeRD PDF/A Extension Schema"),o.writeElementString("pdfaSchema:namespaceURI","urn:factur-x:pdfa:CrossIndustryDocument:invoice:1p0#"),o.writeElementString("pdfaSchema:prefix","fx")),o.writeStartElement("pdfaSchema:property"),o.writeStartElement("rdf:Seq"),o.writeStartElement("rdf:li"),o.writeAttributeString("rdf:parseType","Resource"),o.writeElementString("pdfaProperty:name","DocumentFileName"),o.writeElementString("pdfaProperty:valueType","Text"),o.writeElementString("pdfaProperty:category","external"),o.writeElementString("pdfaProperty:description","Name of the embedded XML invoice file"),o.writeFullEndElement(),o.writeStartElement("rdf:li"),o.writeAttributeString("rdf:parseType","Resource"),o.writeElementString("pdfaProperty:name","DocumentType"),o.writeElementString("pdfaProperty:valueType","Text"),o.writeElementString("pdfaProperty:category","external"),o.writeElementString("pdfaProperty:description","INVOICE"),o.writeFullEndElement(),o.writeStartElement("rdf:li"),o.writeAttributeString("rdf:parseType","Resource"),o.writeElementString("pdfaProperty:name","Version"),o.writeElementString("pdfaProperty:valueType","Text"),o.writeElementString("pdfaProperty:category","external"),this.zugferdComplianceMode==at.c.StiPdfZUGFeRDComplianceMode.V2_1?o.writeElementString("pdfaProperty:description","Version of the Factur-X/ZUGFeRD XML schema"):o.writeElementString("pdfaProperty:description","The actual version of the ZUGFeRD data"),o.writeFullEndElement(),o.writeStartElement("rdf:li"),o.writeAttributeString("rdf:parseType","Resource"),o.writeElementString("pdfaProperty:name","ConformanceLevel"),o.writeElementString("pdfaProperty:valueType","Text"),o.writeElementString("pdfaProperty:category","external"),this.zugferdComplianceMode==at.c.StiPdfZUGFeRDComplianceMode.V2_1?o.writeElementString("pdfaProperty:description","Conformance level of the embedded Factur-X/ZUGFeRD XML invoice data"):o.writeElementString("pdfaProperty:description","The conformance level of the ZUGFeRD data"),o.writeFullEndElement(),o.writeFullEndElement(),o.writeFullEndElement(),o.writeFullEndElement(),o.writeFullEndElement(),o.writeFullEndElement(),o.writeFullEndElement(),o.writeStartElement("rdf:Description"),this.zugferdComplianceMode==at.c.StiPdfZUGFeRDComplianceMode.V1&&(o.writeAttributeString("xmlns:zf","urn:ferd:pdfa:CrossIndustryDocument:invoice:1p0#"),o.writeAttributeString("zf:DocumentFileName","ZUGFeRD-invoice.xml"),o.writeAttributeString("zf:ConformanceLevel",this.zugferdConformanceLevel),o.writeAttributeString("zf:DocumentType","INVOICE"),o.writeAttributeString("zf:Version","1.0")),this.zugferdComplianceMode==at.c.StiPdfZUGFeRDComplianceMode.V2&&(o.writeAttributeString("xmlns:zf","urn:zugferd:pdfa:CrossIndustryDocument:invoice:2p0#"),o.writeAttributeString("zf:DocumentFileName","zugferd-invoice.xml"),o.writeAttributeString("zf:ConformanceLevel",this.zugferdConformanceLevel),o.writeAttributeString("zf:DocumentType","INVOICE"),o.writeAttributeString("zf:Version","1.0")),this.zugferdComplianceMode==at.c.StiPdfZUGFeRDComplianceMode.V2_1&&(o.writeAttributeString("xmlns:fx","urn:factur-x:pdfa:CrossIndustryDocument:invoice:1p0#"),o.writeAttributeString("fx:DocumentFileName","factur-x.xml"),o.writeAttributeString("fx:ConformanceLevel",this.zugferdConformanceLevel),o.writeAttributeString("fx:DocumentType","INVOICE"),o.writeAttributeString("fx:Version","1.0")),o.writeAttributeString("rdf:about",""),o.writeFullEndElement()),this.usePdfA){o.writeStartElement("rdf:Description"),o.writeAttributeString("rdf:about",""),o.writeAttributeString("xmlns:pdfaid","http://www.aiim.org/pdfa/ns/id/");let t="1";switch(this.pdfComplianceMode){case at.c.StiPdfComplianceMode.A1:t="1";break;case at.c.StiPdfComplianceMode.A2:t="2";break;case at.c.StiPdfComplianceMode.A3:t="3";break}let e="A";switch(this.zugferdComplianceMode){case at.c.StiPdfZUGFeRDComplianceMode.V1:e="A";break;case at.c.StiPdfZUGFeRDComplianceMode.V2:e="B";break;case at.c.StiPdfZUGFeRDComplianceMode.V2_1:e="B";break}o.writeElementString("pdfaid:part",t),o.writeElementString("pdfaid:conformance",e),o.writeFullEndElement()}o.writeFullEndElement(),o.writeFullEndElement(),o.writeString("                              \r\n"),o.writeString("                              \r\n"),o.writeString("                              \r\n"),o.writeString("                              \r\n"),o.writeString("                              \r\n");var t=s.toArray();o.close(),s.close(),e.write(t,0,t.length),e.writeString('<?xpacket end="w"?>'),this.addXref(this.info.metadata.ref),this.sw.writeLine1("{0} 0 obj",this.info.metadata.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Metadata"),this.sw.writeLine("/Subtype /XML"),this.storeMemoryStream2(e,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}renderColorSpace(){this.addXref(this.info.destOutputProfile.ref),this.sw.writeLine1("{0} 0 obj",this.info.destOutputProfile.ref),this.sw.writeLine("<<"),this.sw.writeLine("/N 3");let t=null,e=null;e=1==this.compressed?(t=at.c.StiExportUtils.makePdfDeflateStream(at.c.StiPdfResources.sRGBprofile),"/Length {0} /Filter [/FlateDecode] /Length1 "+at.c.StiPdfResources.sRGBprofile.length.toString()):((t=new tt).write(at.c.StiPdfResources.sRGBprofile,0,at.c.StiPdfResources.sRGBprofile.length),"/Length {0}"),this.storeMemoryStream2(t,e),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.outputIntents.ref),this.sw.writeLine1("{0} 0 obj",this.info.outputIntents.ref),this.sw.writeLine("[<<"),this.storeStringLine("/Info","sRGB IEC61966-2.1"),this.storeStringLine("/OutputConditionIdentifier","Custom"),this.storeStringLine("/OutputCondition",""),this.storeStringLine("/RegistryName",""),this.sw.writeLine("/S /GTS_PDFA1"),this.sw.writeLine1("/DestOutputProfile {0} 0 R",this.info.destOutputProfile.ref),this.sw.writeLine("/Type /OutputIntent"),this.sw.writeLine(">>]"),this.sw.writeLine("endobj"),this.sw.writeLine("")}renderAutoPrint(){this.autoPrint!=at.c.StiPdfAutoPrintMode.None&&(this.addXref(this.info.embeddedJS.ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedJS.ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Names [(EmbeddedJS) {0} 0 R]",this.info.embeddedJS.content.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.embeddedJS.content.ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedJS.content.ref),this.sw.writeLine("<<"),this.sw.writeLine("/S /JavaScript"),this.sw.writeLine1("/JS (print\\({0}\\);)",this.autoPrint==at.c.StiPdfAutoPrintMode.Dialog?"true":"false"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""))}renderEmbeddedFiles(){for(let e=0;e<this.info.embeddedFilesList.length;e++){let t=this.embeddedFiles[e];var i,i;this.addXref(this.info.embeddedFilesList[e].ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedFilesList[e].ref),this.sw.writeLine("<<"),this.storeStringLine("/F",t.name,!0),this.sw.writeLine("/Type /Filespec"),this.sw.writeLine("/EF <<"),this.sw.writeLine1("/F {0} 0 R",this.info.embeddedFilesList[e].content.ref),this.sw.writeLine(">>"),this.zugferdComplianceMode==at.c.StiPdfZUGFeRDComplianceMode.None&&this.pdfComplianceMode!=at.c.StiPdfComplianceMode.A3||this.sw.writeLine("/AFRelationship /Alternative"),this.storeStringLine("/UF",t.name,!0),this.storeStringLine("/Desc",t.description,!0),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.embeddedFilesList[e].content.ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedFilesList[e].content.ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Subtype /{0}",t.MIMEType.stimulsoft().replaceAll("/","#2F")),this.sw.writeLine("/Type /EmbeddedFile"),this.sw.writeLine("/Params <<"),this.storeStringLine("/ModDate ","D:"+this.currentDateTime),this.sw.writeLine1("/Size {0}",t.data.length),this.sw.writeLine(">>"),this.compressed?(i=at.c.StiExportUtils.makePdfDeflateStream(t.data),this.storeMemoryStream2(i,"/Filter [/FlateDecode] /Length {0}")):t.data instanceof Uint8Array?this.storeMemoryStream3(t.data,"/Length {0}"):t.data instanceof Array?this.storeMemoryStream4(t.data,"/Length {0}"):(i=rt.System.Text.Encoding.UTF8.getBytes(t.data),this.storeMemoryStream4(i,"/Length {0}")),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}addBookmarkNode(r,t){let e=new Ii;e.Parent=-1,e.First=-1,e.Last=-1,e.Prev=-1,e.Next=-1,e.Count=-1,e.Page=-1,e.Y=-1,e.Title="",e.Guid="",e.Used=-1==t,this.bookmarksTree.push(e);var n=this.bookmarksTree.stimulsoft().countItems-1;if(e.Parent=t,e.Title=r.text,e.Guid=r.componentGuid,0==r.bookmarks.count)e.Count=0;else{let i=-1;for(let e=0;e<=r.bookmarks.count-1;e++){var a=this.bookmarksTree.stimulsoft().countItems,s=r.bookmarks.list[e];this.addBookmarkNode(s,n);let t=this.bookmarksTree[a];e<r.bookmarks.count-1&&(t.Next=this.bookmarksTree.stimulsoft().countItems),0<e&&(t.Prev=i),this.bookmarksTree[a]=t,i=a}e.First=n+1,e.Last=this.bookmarksTree.stimulsoft().countItems-1,e.Count=this.bookmarksTree.stimulsoft().countItems-n-1}this.bookmarksTree[n]=e}makeBookmarkFromTree(e,i){if(e.text=i.Title,e.bookmarks=new B,0<i.Count){let t=i.First;while(-1!=t){var r=this.bookmarksTree[t],n;r.Used&&(n=new qt,e.bookmarks.add(n),this.makeBookmarkFromTree(n,r)),t=r.Next}}}exportPdf(t,e,i){try{this.exportPdf1(t,e,i)}finally{}}exportPdf1(a,M,t){var i;if(at.a.StiLogService.write(this.stimulsoft().getType(),"Export report to Pdf format"),null==t)throw new Error("The 'settings' argument cannot be equal in null.");this.report=a;let e=t.pageRange,s=t.imageResolution;this.imageResolutionMode=t.imageResolutionMode,this.imageQuality=t.imageQuality,this.embeddedFonts=t.embeddedFonts,this.standardPdfFonts=!!t.standardPdfFonts,this.compressed=!!t.compressed,this.useUnicodeMode=t.useUnicode;var H=t.passwordInputUser,O=t.passwordInputOwner,U=t.userAccessPrivileges,r=(this.keyLength=t.keyLength,this.pdfComplianceMode=t.pdfComplianceMode,this.autoPrint=t.autoPrintMode,this.allowEditable=t.allowEditable,this.embeddedFiles=t.embeddedFiles,this.zugferdComplianceMode=t.ZUGFeRDComplianceMode,this.zugferdConformanceLevel=t.ZUGFeRDConformanceLevel,t.ZUGFeRDInvoiceData),n,n;if(this.creatorName=rt["StiOptions"].Export.Pdf.creatorString,this.keywords=rt["StiOptions"].Export.Pdf.keywordsString,pt.isNullOrEmpty(t.creatorString)||(this.creatorName=t.creatorString),pt.isNullOrEmpty(t.keywordsString)||(this.keywords=t.keywordsString),pt.isNullOrEmpty(this.creatorName)&&(this.creatorName=this.producerName),null==this.embeddedFiles&&(this.embeddedFiles=new Wt),null!=a.dictionary.resources)for(var o of a.dictionary.resources.list){o.availableInTheViewer&&(n=o.alias!=o.name?o.alias:"",n=new Xt(o.name+o.getFileExt(),n,o.content,o.getContentType()),this.embeddedFiles.add(n)),o.type==Jt.Xml&&("ZUGFeRD-invoice"==o.name?(this.zugferdComplianceMode=at.c.StiPdfZUGFeRDComplianceMode.V1,this.embeddedFiles.add(new Xt("ZUGFeRD-invoice.xml","ZUGFeRD Invoice",o.content,"text/xml"))):"zugferd-invoice"==o.name.toLowerCase()?(this.zugferdComplianceMode=at.c.StiPdfZUGFeRDComplianceMode.V2,this.embeddedFiles.add(new Xt("zugferd-invoice.xml","ZUGFeRD Invoice",o.content,"text/xml"))):"factur-x"==o.name.toLowerCase()&&(this.zugferdComplianceMode=at.c.StiPdfZUGFeRDComplianceMode.V2_1,this.embeddedFiles.add(new Xt("factur-x.xml","Factur-X/ZUGFeRD",o.content,"text/xml"))))}if(this.zugferdComplianceMode!=at.c.StiPdfZUGFeRDComplianceMode.None&&(this.pdfComplianceMode=at.c.StiPdfComplianceMode.A3,null!=r)){let t=!1;for(var l of this.embeddedFiles){var l=l.name.toLowerCase();"zugferd-invoice.xml"!=l&&"factur-x.xml"!=l||(t=!0)}t||(this.zugferdComplianceMode==at.c.StiPdfZUGFeRDComplianceMode.V1&&this.embeddedFiles.add(new Xt("ZUGFeRD-invoice.xml","ZUGFeRD Rechnung",r)),this.zugferdComplianceMode==at.c.StiPdfZUGFeRDComplianceMode.V2&&this.embeddedFiles.add(new Xt("zugferd-invoice.xml","ZUGFeRD Rechnung",r)),this.zugferdComplianceMode==at.c.StiPdfZUGFeRDComplianceMode.V2_1&&this.embeddedFiles.add(new Xt("factur-x.xml","Factur-X/ZUGFeRD",r)))}1<this.embeddedFiles.countItems&&(this.embeddedFiles=this.embeddedFiles.orderBy(t=>t.name).toList()),this.usePdfA=this.pdfComplianceMode!=at.c.StiPdfComplianceMode.None,this.useTransparency=this.pdfComplianceMode!=at.c.StiPdfComplianceMode.A1,this.embeddedFonts||(this.useUnicodeMode=!1),this.compressedFonts=!0,this.usePdfA&&(this.standardPdfFonts=!1,this.embeddedFonts=!0,this.useUnicodeMode=!0);var t=e.rangeType!=at.a.StiRangeType.All,W=!this.usePdfA,m,X,z,c;this.embeddedFonts&&(this.standardPdfFonts=!1),this.imageQuality<0&&(this.imageQuality=0),1<this.imageQuality&&(this.imageQuality=1),this.useUnicodeMode&&(this.standardPdfFonts=!1),s<10&&(s=10),s/=100,this.imageResolutionMain=s,this.bidi=new at.c.StiBidirectionalConvert(!0),this.pdfFont=new at.c.PdfFonts,this.pdfFont.standardPdfFonts=this.standardPdfFonts,this.pdfFont.forceUseUnicode=this.useUnicodeMode,this.fontGlyphsReduceNotNeed=null;for(let e=0;e<=255;e++){let t=st.round2(e/255,3);var V=t.toString().split(",").join(rt.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator);this.colorTable[e]=V,this.alphaTable[e]=!1}switch(this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,this.colorStack=new Array,this.imageList=new Array,this.imageCompressionMethod){case at.c.StiPdfImageCompressionMethod.Flate:this.imageCache=new at.a.StiImageCache(!0,!0,at.a.ImageFormat.MemoryBmp,this.imageQuality,W);break;default:this.imageCache=new at.a.StiImageCache(!0,!0,at.a.ImageFormat.Jpeg,this.imageQuality,W);break}this.imageInterpolationTable=new ct,this.imageCacheIndexToList=new ct,this.imageInfoList=new ct,this.imageInfoCounter=0,this.pdfFont.fontList=new Array,this.xref=new Array,this.bookmarksTree=new Array,this.haveBookmarks=!1,this.linksArray=new Array,this.annotsArray=new Array,this.annots2Array=new Array,this.unsignedSignaturesArray=new Array,this.shadingArray=new Array,this.shadingFunctionArray=new Array,this.hatchArray=new Array,this.tooltipsArray=new Array,this.sw=M,this.fontsCounter=0,this.bookmarksCounter=0,this.linksCounter=0,this.annotsCounter=0,this.annots2Counter=0,this.tooltipsCounter=0;for(let t=0;t<256;t++)this.CodePage1252[t]=t;for(let t=0;t<32;t++)this.CodePage1252[128+t]=this.CodePage1252part80AF[t];this.fontGlyphsReduceNotNeed=mt.create(Boolean,256);let g=gt.now,G=g.toString("yyyyMMddHHmmsszzz"),h=(this.currentDateTime=G.substr(0,17)+"'"+G.substr(18,2)+"'",this.currentDateTimeMeta=g.toString("yyyy-MM-ddTHH:mm:sszzz"),g.toString("yyyyMMddHHmmssffff")),Y=(h=(h=(h=(h=(h+=this.producerName)+this.creatorName)+a.reportAuthor)+a.reportAlias)+a.reportName,"");for(let t=0;t<h.length;t++)Y+=String.fromCharCode(255&h.charCodeAt(t));this.IDValue=rt.Base.StiMD5Helper.MD5(Y,!1);let j="";for(let t=0;t<this.IDValue.length;t++)j+=at.c.StiExportUtils.toHex(this.IDValue[t]);this.IDValueString=j,this.IDValueStringMeta=pt.format("uuid:{0}-{1}-{2}-{3}-{4}",this.IDValueString.substring(0,8),this.IDValueString.substring(8,4),this.IDValueString.substring(12,4),this.IDValueString.substring(16,4),this.IDValueString.substring(20,12)).toLowerCase(),this.pdfSecurity=new at.c.StiPdfSecurity(this),this.usePdfA||(this.encrypted=this.pdfSecurity.computingCryptoValues(U,O,H,this.keyLength,this.IDValue)),this.encrypted&&this.useUnicodeMode&&(this.embeddedFonts=!0),this.currentPassNumber=0,this.maximumPassNumber=rt["StiOptions"].Export.Pdf.divideSegmentPages?3:2;let p=e.getSelectedPages(a.renderedPages),w=(rt["StiOptions"].Export.Pdf.divideSegmentPages&&(p=at.c.StiSegmentPagesDivider.divide(p,this),this.currentPassNumber++),null!=a.bookmark&&0!=a.bookmark.bookmarks.count&&(this.addBookmarkNode(a.bookmark,-1),this.haveBookmarks=!0,this.bookmarksCounter=this.bookmarksTree.stimulsoft().countItems),0);for(m of p.list){if(p.getPage(m),this.storeShadingData1(m.brush,w),this.storeHatchData(m.brush),null!=m.hyperlinkValue&&0<m.hyperlinkValue.toString().trim().length&&!m.hyperlinkValue.toString().trim().stimulsoft().startsWith("javascript:")&&!this.usePdfA){let t=new Pt;t.Link=m.hyperlinkValue.ToString(),t.Page=w,this.linksArray.push(t)}if(null!=m.watermark&&m.watermark.enabled){if(!pt.isNullOrEmpty(m.watermark.text)){null!=m.watermark.font&&this.pdfFont.getFontNumber(m.watermark.font);let t=new ut(m.watermark.text);t=this.bidi.convert(t,!1),this.pdfFont.storeUnicodeSymbolsInMap(t.toString()),this.storeShadingData1(m.watermark.textBrush,w),this.storeHatchData(m.watermark.textBrush)}1==m.watermark.showImageBehind&&null!=m.watermark.image&&this.storeImageData(m.watermark.image,s,!1,!1)}for(var d of m.components.list)if(d.enabled&&(!a.isPrinting||d.printable)){if(this.imageInfoCounter++,0<d.width&&0<d.height){var S=d.as(Ot);null!=S&&(this.storeShadingData1(S.brush,w),this.storeHatchData(S.brush));let t=d.isExportAsImage(at.a.StiExportFormat.Pdf),e=d.as(Nt);if(null!=e&&at.c.StiPdfRenderPrimitives.checkShape(e)&&(t=!1),d.is(nt)){var S=d;if(this.storeShadingData1(S.textBrush,w),this.storeHatchData(S.textBrush),this.allowEditable==at.c.StiPdfAllowEditable.Yes&&S.editable){let t=new ki;t.Page=w,t.Component=d,this.annots2Array.push(t)}continue}if(t){let e=!1;var S=d,S,u,f,S;if(this.imageResolutionMode!=at.c.StiImageResolutionMode.Exactly&&null!=S&&null!=S.imageToDraw&&null!=S.imageToDraw.bytes){e=!0;let t=S.imageToDraw.horizontalResolution/100;this.imageResolutionMode==at.c.StiImageResolutionMode.NoMoreThan&&(t=S.stretch?S.imageToDraw.width/a.unit.convertToHInches(d.width):1/S.multipleFactor),t=this.storeImageData(S.imageToDraw,t,!0,S.smoothing),this.imageInfoList.set(this.imageInfoCounter,t)}if(!e){let t=d.as(Lt);null!=t&&(u={ref:S=s},f=t.getImage(u,at.a.StiExportFormat.Pdf),S=u.ref,null!=f&&(this.storeImageData(f,S,!1,!1),this.imageInfoList.set(this.imageInfoCounter,S)))}}var u=d.as(Dt),f=(null!=u&&this.pdfFont.getFontNumber(u.font),d.stimulsoft().as(St));if(d.is(lt)&&!t){let t=d;var S=null!=f&&null!=f.textOptions&&f.textOptions.rightToLeft;let e=new ut(t.text);if(t.allowHtmlTags)if(rt["StiOptions"].Engine.useNewHtmlEngine)this.storeWysiwygSymbols(t,w);else{var v=new rt.Base.Drawing.StiHtmlTagsState(t.font.bold,t.font.italic,t.font.underline,t.font.strikeout,t.font.size,t.font.name,Et.toColor(t.textBrush),Et.toColor(t.brush),!1,!1,0,0,1,t.horAlignment),v=new rt.Base.Drawing.StiHtmlState(v,0),_=rt.Base.Drawing.StiTextRenderer.parseHtmlToStates(t.text,v);e=new ut;for(let t=0;t<_.length;t++){var q=_[t];e.append(rt.Base.Drawing.StiTextRenderer.prepareStateText(q.text))}}e=this.bidi.convert(e,S),this.pdfFont.storeUnicodeSymbolsInMap(e.toString());var v=d.as(Bt);if(null!=t&&null!=v&&(this.storeShadingData1(v.textBrush,w),this.storeHatchData(v.textBrush)),this.allowEditable==at.c.StiPdfAllowEditable.Yes&&t.editable){let t=new ki;t.Page=w,this.annotsArray.push(t),this.fontGlyphsReduceNotNeed[this.pdfFont.currentFont]=!0}if(null!=t.indicator){var S=t.indicator.stimulsoft().as(_t),S,S,S,S=(null==S||S.icon==jt.None&&null==S.customIcon||(S=Yt.getIcon(S),S=this.storeImageData(S,S=1,!1,!0,!0),this.imageInfoList[this.imageInfoCounter]=S),t.indicator.stimulsoft().as(Gt));if(null!=S&&0!=S.value&&S.brushType==at.a.Components.StiBrushType.Gradient){var S=S.value<0?S.negativeColor:S.positiveColor,E=Vt.light(S,200);let t=new Ci;t.Page=w,t.FunctionIndex=this.getShadingFunctionNumber(S,E,!1),this.shadingArray.push(t)}}}if(null!=e&&!t&&!pt.isNullOrWhiteSpace(e.getParsedText())){let t=this.bidi.convert(new ut(e.getParsedText()),!1);this.pdfFont.storeUnicodeSymbolsInMap(t.toString())}if(d.is(Zt)&&!t){let t=new at.c.StiPdfGeomWriter(this.pageStream,this,!0);t.pageNumber=w;var S=at.c.StiBarCodeExportPainter.createNew(t),E;let e=d;pt.isNullOrEmpty(e.codeValue)||null==e.page||(E=a.unit.convertRectangleToHInches(e.clientRectangle),e.barCodeType.draw(S,e,E,1))}else if(d.is(Qt)&&!t){let t=new Pi(this);t.Component=d,at.c.StiPdfRenderChart.renderChart(t,!0,w)}else if(d.is(zt)&&!t){let t=new Pi(this);t.Component=d,at.c.StiPdfRenderChart.renderSparkline(t,!0,w)}}if(null!=d.hyperlinkValue&&0<d.hyperlinkValue.toString().trim().length&&!d.hyperlinkValue.toString().trim().stimulsoft().startsWith("javascript:")){let t=new Pt;t.Link=d.hyperlinkValue.toString(),t.Page=w,this.linksArray.push(t)}if(null!=d.toolTipValue&&0<d.toolTipValue.toString().trim().length&&!this.usePdfA){let t=new Pt;t.Page=w,this.tooltipsArray.push(t)}if(null!=d.tagValue&&"pdfunsignedsignaturefield"==d.tagValue.toString().toLowerCase()&&!this.usePdfA){let t=new ki;t.Page=w,this.unsignedSignaturesArray.push(t)}}w++,null!=m.watermark&&m.watermark.enabled&&0==m.watermark.showImageBehind&&null!=m.watermark.image&&this.storeImageData(m.watermark.image,s,!1,!1)}for(let t=0;t<this.pdfFont.fontList.length;t++)this.pdfFont.currentFont=t,this.pdfFont.storeUnicodeSymbolsInMap("…");if(0<this.unsignedSignaturesArray.stimulsoft().countItems&&(0<this.annotsArray.stimulsoft().countItems||0<this.annots2Array.stimulsoft().countItems))for(let t=0;t<this.pdfFont.fontList.stimulsoft().countItems;t++){"Arial"==this.pdfFont.fontList[t].Name&&(this.fontGlyphsReduceNotNeed[t]=!0)}let K="";for(let t=32;t<256;t++)K+=String.fromCharCode(this.CodePage1252[t]);for(let t=0;t<this.pdfFont.fontList.length;t++)this.fontGlyphsReduceNotNeed[t]&&(this.pdfFont.currentFont=t,this.pdfFont.storeUnicodeSymbolsInMap(K));this.imagesCurrent=0,this.annotsCurrent=0,this.annots2Current=0,this.shadingCurrent=0,this.linksCounter=this.linksArray.stimulsoft().countItems,this.haveLinks=0<this.linksCounter,this.annotsCounter=this.annotsArray.length,this.annots2Counter=this.annots2Array.length,this.unsignedSignaturesCounter=this.unsignedSignaturesArray.length,this.haveAnnots=0<this.annotsCounter||0<this.annots2Counter||0<this.unsignedSignaturesCounter,this.tooltipsCounter=this.tooltipsArray.stimulsoft().countItems,this.haveTooltips=0<this.tooltipsCounter,this.pdfFont.InitFontsData(a),this.fontsCounter=this.pdfFont.fontList.length,this.info=new at.c.StiPdfStructure;for(let t=0;t<p.count;t++)this.info.pageList.push(this.info.createContentObject(!0));for(let t=0;t<this.imageCache.imagePackedStore.length;t++)this.info.xObjectList.push(this.info.createXObject(!0,null!=this.imageCache.imageMaskStore[t]));for(let t=0;t<this.pdfFont.fontList.length;t++){var Q=this.pdfFont.fontList[t];this.info.fontList.push(this.info.createFontObject(!0,Q.UseUnicode,this.standardPdfFonts,this.embeddedFonts||at.c.PdfFonts.isFontStimulsoft(Q.Name)))}if(this.info.outlines=this.info.createOutlinesObject(this.haveBookmarks),this.haveBookmarks)for(let t=0;t<this.bookmarksCounter;t++)this.info.outlines.items.push(this.info.createObject(!0));this.info.patterns=this.info.createPatternsObject(!0);for(let t=0;t<this.hatchArray.length;t++)this.info.patterns.hatchItems.push(this.info.createObject(!0));for(let t=0;t<this.shadingArray.length;t++)this.info.patterns.shadingItems.push(this.info.createObject(!0));for(let t=0;t<this.shadingFunctionArray.length;t++)this.info.patterns.shadingFunctionItems.push(this.info.createObject(!0));for(let t=0;t<this.linksCounter;t++)this.info.linkList.push(this.info.createObject(!0));if(this.info.encode=this.info.createObject(this.encrypted),this.info.extGState=this.info.createObject(!0),this.info.acroForm=this.info.createAcroFormObject(this.haveAnnots||this.haveTooltips),this.haveAnnots){for(let t=0;t<this.annotsCounter;t++)this.info.acroForm.annots.push(this.info.createAnnotObject(!0,!0,0));for(let t=0;t<this.fontsCounter;t++)this.info.acroForm.annotFontItems.push(this.info.createFontObject(!0,!1,!1,!1,!0));for(let t=0;t<this.annots2Counter;t++)this.info.acroForm.checkBoxes.push(new at.c.StiPdfCheckBoxObjInfo),this.info.acroForm.checkBoxes[t].items=[],this.info.acroForm.checkBoxes[t].items.push(this.info.createAnnotObject(!0,!0,2)),this.info.acroForm.checkBoxes[t].items.push(this.info.createAnnotObject(!0,!0,2)),null==this.annots2Array[t].Component.as(nt).checkedValue&&this.info.acroForm.checkBoxes[t].items.push(this.info.createAnnotObject(!0,!1,2));for(let t=0;t<this.unsignedSignaturesCounter;t++)this.info.acroForm.unsignedSignatures.push(this.info.createAnnotObject(!0,!1,0))}for(let t=0;t<this.tooltipsCounter;t++)this.info.acroForm.tooltips.push(this.info.createAnnotObject(!0,!1,0));this.info.metadata=this.info.createObject(!0),this.info.destOutputProfile=this.info.createObject(!0),this.info.outputIntents=this.info.createObject(!0),this.info.embeddedJS=this.info.createContentObject(this.autoPrint!=at.c.StiPdfAutoPrintMode.None),null!=this.embeddedFiles&&0<this.embeddedFiles.countItems&&this.embeddedFiles.forEach(t=>this.info.embeddedFilesList.push(this.info.createContentObject(!0))),this.renderStartDoc(a,p);let b=0;this.linksArray.stimulsoft().clear(),this.tagsArray=new Array,this.tooltipsArray.stimulsoft().clear(),this.unsignedSignaturesArray.stimulsoft().clear(),this.imageInfoCounter=0,this.currentPassNumber++;for(c of p.list){if(p.getPage(c),this.isStopped)return;this.renderPageHeader(b++);let r=this.hiToTwips*a.unit.convertToHInches(c.pageHeight*c.segmentPerHeight);var x=this.hiToTwips*a.unit.convertToHInches(c.pageWidth*c.segmentPerWidth),y=this.hiToTwips*a.unit.convertToHInches(c.margins.left),Z=this.hiToTwips*a.unit.convertToHInches(c.margins.right),A=this.hiToTwips*a.unit.convertToHInches(c.margins.top),T=this.hiToTwips*a.unit.convertToHInches(c.margins.bottom),P,J;if(14400<r&&(r=14400),this.haveBookmarks&&(!pt.isNullOrEmpty(c.guid)||null!=c.bookmarkValue&&""!=c.bookmarkValue.toString())){let i=0;while(i<this.bookmarksCounter){let e=this.bookmarksTree[i];if(0==e.Used&&-1==e.Page){let t=!1;if(pt.isNullOrEmpty(e.Guid)?pt.isNullOrEmpty(e.Title)||null!=c.bookmarkValue&&0<c.bookmarkValue.length&&e.Title==c.bookmarkValue&&(t=!0):pt.isNullOrEmpty(c.guid)||e.Guid!=c.guid||(t=!0),t){e.Page=b-1,e.Y=r,e.Used=!0,this.bookmarksTree[i]=e;break}}i++}}if(null!=c.hyperlinkValue&&0<c.hyperlinkValue.toString().trim().length&&!c.hyperlinkValue.toString().trim().stimulsoft().startsWith("javascript:")&&!this.usePdfA){let t=new Pt;t.Link=c.hyperlinkValue.toString(),t.X=0,t.Y=0,t.Width=x,t.Height=r,t.Page=b,t.DestPage=-1,t.DestY=-1,this.linksArray.push(t)}if(null!=c.brush){let t=new Pi(this),e=(t.X=0,t.Y=0,t.Width=x,t.Height=r,new Ut);e.brush=c.brush,e.border=null,t.Component=e,at.c.StiPdfRenderPrimitives.renderBorder1(t)}this.renderWatermark(c,!0,x,r,s);let t=null==(i=c.tagValue)?void 0:i.stimulsoft().as(String);if(!pt.isNullOrWhiteSpace(t)&&t.startsWith("Segments:")){var i=rt.System.StiNumber.tryParse(t.substring(9));if(i.successfully){var i=i.result;let t=new xt(0,0,x,r);var L=1;0<(i&ft.Left)&&(t.x+=y-L,t.width-=y-L),0<(i&ft.Right)&&(t.width-=Z-L),0<(i&ft.Top)&&(t.height-=A-L),0<(i&ft.Bottom)&&(t.y+=T-L,t.height-=T-L),this.pageStream.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(t.x),this.convertToString(t.y),this.convertToString(t.width),this.convertToString(t.height))}}let e=new Array;for(P of c.components.list)if(P.enabled&&(!a.isPrinting||P.printable)){this.imageInfoCounter++;var C=this.hiToTwips*a.unit.convertToHInches(P.left),F=this.hiToTwips*a.unit.convertToHInches(P.top),k=this.hiToTwips*a.unit.convertToHInches(P.right),I=this.hiToTwips*a.unit.convertToHInches(P.bottom),$;let n=new Pi(this);if(n.X=C+y,n.Y=F+A,n.Width=k-C,n.Height=I-F,n.Y=r-(n.Y+n.Height),0<(n.Component=P).width&&0<P.height){var k=P.isExportAsImage(at.a.StiExportFormat.Pdf),B;if(this.usePdfA||P.printable||this.pageStream.writeLine("/OC /oc1 BDC"),P.is(Nt)||at.c.StiPdfRenderPrimitives.renderBorder1(n),P.is(lt)&&!k){let r=P,e=0;this.haveAnnots&&r.editable&&(e=this.pageStream.position,this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255);var C=at.c.StiPdfRenderIndicators.renderIndicators(n);if(r.allowHtmlTags){if(at.c.StiPdfRenderText.renderTextFont(C),rt["StiOptions"].Engine.useNewHtmlEngine)at.c.StiPdfRenderText.renderText2(n,b);else{var I=new rt.Base.Drawing.StiHtmlTagsState(r.font.bold,r.font.italic,r.font.underline,r.font.strikeout,r.font.size,r.font.name,Et.toColor(r.textBrush),Et.toColor(r.brush),!1,!1,0,0,1,r.horAlignment),F=new rt.Base.Drawing.StiHtmlState(I,0),tt=rt.Base.Drawing.StiTextRenderer.parseHtmlToStates(r.text,F);let i="";for(let e=0;e<tt.length;e++){let t=tt[e];if(t.ts.tag.tag==Kt.P&&"\n"==t.text.toString())continue;i+=rt.Base.Drawing.StiTextRenderer.prepareStateText(t.text)}let t=r.clone(!0);t.text=i,n.Component=t,at.c.StiPdfRenderText.renderTextFont(C),at.c.StiPdfRenderText.renderText(C)}if(this.haveAnnots&&r.editable){let e=this.annotsArray[this.annotsCurrent];e.Multiline=r.wordWrap,e.X=n.X,e.Y=n.Y,e.Width=n.Width,e.Height=n.Height,e.Component=n.Component,e.Alignment=rt.Base.Drawing.StiTextHorAlignment.Left;var I=n.Component.as(Ct);if(null!=I){let t=I.horAlignment;var F=n.Component.as(St);null!=F&&null!=F.textOptions&&F.textOptions.rightToLeft&&(t==rt.Base.Drawing.StiTextHorAlignment.Left?t=rt.Base.Drawing.StiTextHorAlignment.Right:t==rt.Base.Drawing.StiTextHorAlignment.Right&&(t=rt.Base.Drawing.StiTextHorAlignment.Left)),e.Alignment=t}e.Text=n.Component.as(lt).text.toString().split("\n").join("")}}else at.c.StiPdfRenderText.renderTextFont(C),at.c.StiPdfRenderText.renderText(C);if(this.haveAnnots&&r.editable){this.pageStream.flush();var I=this.pageStream.position,F=(this.pageStream.seek(e,rt.System.IO.SeekOrigin.Begin),[]);this.pageStream.read(F,0,I-e),this.pageStream.seek(e,rt.System.IO.SeekOrigin.Begin),this.pageStream.setLength(e);let t=this.annotsArray[this.annotsCurrent];t.Content=F,this.annotsCurrent++,this.popColorFromStack()}}if(P.is(Nt))at.c.StiPdfRenderPrimitives.renderShape(n,s);else if(P.is(Zt)&&!k){let e=new at.c.StiPdfGeomWriter(this.pageStream,this);var C=at.c.StiBarCodeExportPainter.createNew(e);let i=P;if(e.componentAngle=-i.angle,!pt.isNullOrEmpty(i.codeValue)&&null!=i.page){this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(n.X),this.convertToString(n.Y),this.convertToString(n.Width),this.convertToString(n.Height)),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(y),this.convertToString(r-A)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips));let t=new Tt(1,0,0,1,0,0);t.translate(y,r-A),t.scale(1,-1),t.scale(this.hiToTwips,this.hiToTwips),e.pageNumber=b,e.matrixCache.push(t);var I=a.unit.convertRectangleToHInches(i.clientRectangle);i.barCodeType.draw(C,i,I,1),this.pageStream.writeLine("Q"),this.popColorFromStack()}}else if(P.is(Qt)&&!k)this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(n.X),this.convertToString(n.Y+n.Height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips/.96)),at.c.StiPdfRenderChart.renderChart(n,!1,b-1),this.pageStream.writeLine("Q"),this.popColorFromStack();else if(P.is(zt)&&!k)this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(n.X),this.convertToString(n.Y+n.Height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips/.96)),at.c.StiPdfRenderChart.renderSparkline(n,!1,b-1),this.pageStream.writeLine("Q"),this.popColorFromStack();else if(P.is(nt)){var F=P;if(this.haveAnnots&&F.editable){let t=this.annots2Array[this.annots2Current];t.Multiline=!1,t.X=n.X,t.Y=n.Y,t.Width=n.Width,t.Height=n.Height,t.Component=n.Component,t.Alignment=rt.Base.Drawing.StiTextHorAlignment.Center,t.Text="";var C=n.X,I=n.Y,B=(n.X=0,n.Y=0,this.pageStream.flush(),this.pageStream.position),D=(this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,at.c.StiPdfRenderPrimitives.renderCheckbox(n,!0),this.pageStream.flush(),this.pageStream.position),R=(this.pageStream.seek(B,rt.System.IO.SeekOrigin.Begin),[]);this.pageStream.read(R,0,D-B),this.pageStream.seek(B,rt.System.IO.SeekOrigin.Begin),t.Content=R,this.popColorFromStack(),this.pageStream.flush(),B=this.pageStream.position,this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,at.c.StiPdfRenderPrimitives.renderCheckbox(n,!1,!1),this.pageStream.flush(),D=this.pageStream.position,this.pageStream.seek(B,rt.System.IO.SeekOrigin.Begin),this.pageStream.read(R=[],0,D-B),this.pageStream.seek(B,rt.System.IO.SeekOrigin.Begin),t.Content2=R,this.popColorFromStack(),this.annots2Current++,n.X=C,n.Y=I}else{var D=at.c.StiPdfRenderPrimitives.getCheckBoxValue(F);null!=D&&at.c.StiPdfRenderPrimitives.renderCheckbox(n,D)}}else k&&this.renderImage(n,s);P.is(It)?at.c.StiPdfRenderPrimitives.renderRoundedRectanglePrimitive(n):null!=(B=n.Component.as(Ht))&&null!=B.border&&B.border.topmost?e.push(n):at.c.StiPdfRenderPrimitives.renderBorder2(n),this.usePdfA||P.printable||this.pageStream.writeLine("EMC")}if(this.haveBookmarks&&(!pt.isNullOrEmpty(P.guid)||null!=P.bookmarkValue&&""!=P.bookmarkValue)){let i=0;while(i<this.bookmarksCounter){let e=this.bookmarksTree[i];if(0==e.Used&&-1==e.Page){let t=!1;if(pt.isNullOrEmpty(e.Guid)?pt.isNullOrEmpty(e.Title)||null!=P.bookmarkValue&&0<P.bookmarkValue.length&&e.Title==P.bookmarkValue&&(t=!0):pt.isNullOrEmpty(P.guid)||e.Guid!=P.guid||(t=!0),t){e.Page=b-1,e.Y=n.Y+n.Height,e.Used=!0,this.bookmarksTree[i]=e;break}}i++}}if(null!=P.hyperlinkValue&&0<P.hyperlinkValue.toString().trim().length&&!P.hyperlinkValue.toString().trim().stimulsoft().startsWith("javascript:")){let t=new Pt;t.Link=P.hyperlinkValue.toString(),t.X=n.X,t.Y=n.Y,t.Width=n.Width,t.Height=n.Height,t.Page=b,t.DestPage=-1,t.DestY=-1,this.linksArray.push(t)}if(null!=P.tagValue&&0<P.tagValue.toString().trim().length){let e=new Pt;if(e.Link=P.tagValue.toString(),e.X=n.X,e.Y=n.Y,e.Width=n.Width,e.Height=n.Height,e.Page=b-1,e.DestPage=-1,e.DestY=-1,this.tagsArray.push(e),"pdfunsignedsignaturefield"==e.Link.trim().toLowerCase()&&!this.usePdfA){let t=new ki;t.X=e.X,t.Y=e.Y,t.Width=e.Width,t.Height=e.Height,t.Page=e.Page,t.Component=P,this.unsignedSignaturesArray.push(t)}}if(null!=P.pointerValue&&!pt.isNullOrWhiteSpace(P.pointerValue)&&!pt.isNullOrWhiteSpace(P.guid)){var R="#"+P.pointerValue+"#GUID#"+P.guid;let t=new Pt;t.Link=R,t.X=n.X,t.Y=n.Y,t.Width=n.Width,t.Height=n.Height,t.Page=b-1,t.DestPage=-1,t.DestY=-1,this.tagsArray.push(t)}if(null!=P.toolTipValue&&0<P.toolTipValue.toString().trim().length&&!this.usePdfA){let t=new Pt;t.Link=P.toolTipValue.toString().trim(),t.X=n.X,t.Y=n.Y,t.Width=n.Width,t.Height=n.Height,t.Page=b-1,t.DestPage=-1,t.DestY=-1,this.tooltipsArray.push(t)}}for(J of e)at.c.StiPdfRenderPrimitives.renderBorder2(J);if(e.stimulsoft().clear(),null!=c.border){let t=new Pi(this),e=(t.X=y,t.Y=T,t.Width=x-y-Z,t.Height=r-A-T,new Ut);e.border=c.border,t.Component=e,at.c.StiPdfRenderPrimitives.renderBorder2(t)}this.renderWatermark(c,!1,x,r,s),this.renderPageFooter(r,x)}if(this.bookmarksTreeTemp=null,this.haveBookmarks&&t){for(let e=0;e<this.bookmarksTree.stimulsoft().countItems;e++){let t=this.bookmarksTree[e];if(t.Used)while(-1!=t.Parent)(t=this.bookmarksTree[t.Parent]).Used=!0}var r=new qt,et=(this.makeBookmarkFromTree(r,this.bookmarksTree[0]),this.bookmarksTreeTemp=this.bookmarksTree,this.bookmarksTree=new Array,this.addBookmarkNode(r,-1),this.bookmarksCounter-this.bookmarksTree.stimulsoft().countItems),N;if(0<et){let e=new Ii;e.Parent=-1,e.First=-1,e.Last=-1,e.Prev=-1,e.Next=-1,e.Count=-1,e.Page=-1,e.Y=-1,e.Title="";for(let t=0;t<et;t++)this.bookmarksTree.push(e)}let i=new ct;for(let t=0;t<this.bookmarksTreeTemp.stimulsoft().countItems;t++){var it=this.bookmarksTreeTemp[t];i.set(it.Title,it)}for(let e=0;e<this.bookmarksTree.stimulsoft().countItems;e++){let t=this.bookmarksTree[e];pt.isNullOrEmpty(t.Title)||(N=i.get(t.Title),t.Page=N.Page,t.Y=N.Y)}this.bookmarksTreeTemp=null}this.renderImageTable(),this.renderFontTable(),this.renderBookmarksTable(),this.renderPatternTable(),this.renderLinkTable(),this.renderEncodeRecord(),this.renderExtGStateRecord(),this.renderAnnotTable(),this.renderTooltipTable(),this.renderMetadata(a),this.renderColorSpace(),this.renderAutoPrint(),this.renderEmbeddedFiles(),this.renderEndDoc(),this.xref=null,this.bookmarksTree=null,this.linksArray=null,this.tagsArray=null,this.tooltipsArray=null,this.annotsArray=null,this.annots2Array=null,this.unsignedSignaturesArray=null,this.shadingArray=null,this.hatchArray=null,this.colorStack=null,this.pdfFont.clear(),this.pdfFont=null,this.bidi.clear(),this.bidi=null}}Bi.regexEscape=new RegExp("([{}()^$&.*?/+|[\\\\]|]|-)","g"),at.c.StiPdfExportService=Bi}let N=rt.System.Drawing.FontStyle;{class Di{}at.c.PdfFontInfo=Di;class Ri{}at.c.pfontInfo=Ri;class Ni{constructor(){this.TagString=null,this.Tag=0,this.CheckSum=0,this.Offset=0,this.Length=0,this.NewOffset=0,this.NewLength=0,this.Required=!1,this.NewTable=null}}class Mi{constructor(){this.HeaderOffset=0,this.NumTables=0,this.NumTablesRequired=0,this.SfntVersion=0,this.Tables=null,this.HeadCheckSumOffset=0,this.NumGlyphs=0,this.IndexToLocFormat=0,this.IndexLocaTable=0,this.IndexGlyfTable=0,this.IndexCmapTable=0,this.IndexCFFTable=-1,this.FontName=null,this.HeaderOffset=0,this.NumTables=0,this.NumTablesRequired=0,this.SfntVersion=0,this.Tables=null,this.HeadCheckSumOffset=0,this.NumGlyphs=0,this.IndexToLocFormat=0,this.IndexLocaTable=0,this.IndexGlyfTable=0,this.FontName=new ct}}class Hi extends Di{constructor(){super(),this.standardFontQuantity=12,this.standardFontNumWidths=310,this.standardFontNumChars=3680+189,this.firstMappedSymbol=64,this.factor=1,this.maxSymbols=32767,this.forceUseUnicode=!0,this.WIDTHS=null,this.fonts=null,this.UnicodeMapsList=null,this.GlyphMapsList=null,this.standardPdfFonts=!0,this.fontsInfoStore=null,this.family_Helvetica=["Arial","Arial Black","Arial Narrow","Century Gothic","Comic Sans MS","Impact","Microsoft Sans Serif","Tahoma","Verdana"],this.family_Courier=["Courier New","Lucida Console"],this.family_Times_Roman=["Book Antiqua","Bookman Old Style","Garamond","Georgia","Times New Roman"],this.family_Symbol=["Symbol"],this.family_ZapfDingbats=["Wingdings 2"],this.PdfFontName=["Helvetica","Helvetica-Bold","Helvetica-Oblique","Helvetica-BoldOblique","Times-Roman","Times-Bold","Times-Italic","Times-BoldItalic","Courier","Courier-Bold","Courier-Oblique","Courier-BoldOblique","Symbol","ZapfDingbats"],this._currentFont=-1,this.TtfHeaderSize=12,this.ARG_1_AND_2_ARE_WORDS=1,this.ARGS_ARE_XY_VALUES=2,this.ROUND_XY_TO_GRID=4,this.WE_HAVE_A_SCALE=8,this.MORE_COMPONENTS=32,this.WE_HAVE_AN_X_AND_Y_SCALE=64,this.WE_HAVE_A_TWO_BY_TWO=128,this.WE_HAVE_INSTRUCTIONS=256,this.USE_MY_METRICS=512,this.OVERLAP_COMPOUND=1024,this.SCALED_COMPONENT_OFFSET=2048,this.UNSCALED_COMPONENT_OFFSET=4096,this.TablesNames=["head","hhea","hmtx","maxp","cmap","OS/2","post","cvt ","fpgm","glyf","loca","prep","name"],this.fontList=new Array,this.UnicodeMapsList=new Array,this.GlyphMapsList=new Array,this.fontsInfoStore=new Oi}getFontMetrics(t,r,e,i){if(this.WIDTHS=mt.create(Number,this.maxSymbols+1),null==t)return;var n=new j(t.name,1024,t.style,rt.System.Drawing.GraphicsUnit.Pixel),n=(mt.copy(r.UnicodeMapBack,0,this.WIDTHS,r.MappedSymbolsCount),rt.System.Drawing.Graphics.measureChars(this.WIDTHS,r.MappedSymbolsCount,n)),a=n.height,n=n.width;r.CH=0,r.tmASC=st.round2(.8*a*this.factor),r.tmDESC=st.round2(.2*a*this.factor),r.tmExternal=st.round2((n-a)*this.factor),r.LLX=0,r.LLY=0,r.URX=0,r.URY=0,r.StemV=0,r.ItalicAngle=0,r.UnderscoreSize=st.round2(a*(t.bold?.08:.06)*this.factor),r.UnderscorePosition=st.round2(.1*-a*this.factor),r.StrikeoutSize=st.round2(.045*a*this.factor),r.StrikeoutPosition=st.round2(.25*a*this.factor);for(let t=0;t<r.MappedSymbolsCount;t++)this.WIDTHS[t]=st.round2(this.WIDTHS[t]*this.factor,0);var n=this.getFontDataBuf(t,i);if(n instanceof Uint8Array&&0<n.byteLength){var s=this.getCharToGlyphTable(n,t.name);if(null!=s){let i=0;"Wingdings"!=t.name&&"Wingdings 2"!=t.name&&"Wingdings 3"!=t.name||(i=61440);for(let e=0;e<r.MappedSymbolsCount;e++){let t=r.UnicodeMapBack[e];32<=t&&t<=255&&(t+=i),r.GlyphList[e]=s[t]}}}r.NeedSyntBold=this.NeedSyntBold,r.NeedSyntItalic=this.NeedSyntItalic}static isFontStimulsoft(t){return"Stimulsoft"==t}get currentFont(){return this._currentFont}set currentFont(t){this._currentFont!=t&&(this._currentFont=t,null!=this.fonts&&0<this.fonts.length&&(this.Widths=this.fonts[this._currentFont].Widths,this.CH=this.fonts[this._currentFont].CH,this.XH=this.fonts[this._currentFont].XH,this.ASC=this.fonts[this._currentFont].ASC,this.DESC=this.fonts[this._currentFont].DESC,this.tmASC=this.fonts[this._currentFont].tmASC,this.tmDESC=this.fonts[this._currentFont].tmDESC,this.tmExternal=this.fonts[this._currentFont].tmExternal,this.MacAscend=this.fonts[this._currentFont].MacAscend,this.MacDescend=this.fonts[this._currentFont].MacDescend,this.MacLineGap=this.fonts[this._currentFont].MacLineGap,this.LLX=this.fonts[this._currentFont].LLX,this.LLY=this.fonts[this._currentFont].LLY,this.URX=this.fonts[this._currentFont].URX,this.URY=this.fonts[this._currentFont].URY,this.StemV=this.fonts[this._currentFont].StemV,this.ItalicAngle=this.fonts[this._currentFont].ItalicAngle,this.LineGap=this.fonts[this._currentFont].LineGap,this.NtmFlags=this.fonts[this._currentFont].NtmFlags,this.UnderscoreSize=this.fonts[this._currentFont].UnderscoreSize,this.UnderscorePosition=this.fonts[this._currentFont].UnderscorePosition,this.StrikeoutSize=this.fonts[this._currentFont].StrikeoutSize,this.StrikeoutPosition=this.fonts[this._currentFont].StrikeoutPosition,this.UnicodeMap=this.fonts[this._currentFont].UnicodeMap,this.UnicodeMapBack=this.fonts[this._currentFont].UnicodeMapBack,this.GlyphList=this.fonts[this._currentFont].GlyphList,this.GlyphBackList=this.fonts[this._currentFont].GlyphBackList,this.GlyphRtfList=this.fonts[this._currentFont].GlyphRtfList,this.SymsToPDF=this.fonts[this._currentFont].SymsToPDF,this.CharPdfNames=this.fonts[this._currentFont].CharPdfNames,this.MappedSymbolsCount=this.fonts[this._currentFont].MappedSymbolsCount,this.NeedSyntBold=this.fonts[this._currentFont].NeedSyntBold,this.NeedSyntItalic=this.fonts[this._currentFont].NeedSyntItalic,this.GlyphWidths=this.fonts[this._currentFont].GlyphWidths,this.ChildFontsMap=this.fonts[this._currentFont].ChildFontsMap,this.UseUnicode=this.fonts[this._currentFont].UseUnicode))}InitFontsData(t){var e=this.fontList.length,i,i;for(let l=0;l<e;l++){let s=this.fontList[l],o=this.forceUseUnicode;if(!o||(i=null)!=(i=this.getFontDataBuf(s.Font,t))&&0!=i.Length||(o=!1),s.UseUnicode=o,this.fontList[l]=s,!o){var m=this.UnicodeMapsList[l];let a=this.firstMappedSymbol;for(let t=this.firstMappedSymbol;t<65536;t++)0<m[t]&&a++;if(255<a){s=this.fontList[l];let e=null,i=mt.create(Number,65536),r=this.fontList.length;for(let t=0;t<this.firstMappedSymbol;t++)i[t]=r;let n=!0;a=this.firstMappedSymbol;for(let t=this.firstMappedSymbol;t<65536;t++){if(n){let t=new Ri;t.Name=s.Name,t.PdfName=s.PdfName,t.Bold=s.Bold,t.Italic=s.Italic,t.Number=s.Number,t.Font=s.Font,t.ParentFontNumber=l,t.UseUnicode=o,this.fontList.push(t),e=mt.create(Number,65536),mt.copy(m,0,e,64),this.UnicodeMapsList.push(e),this.GlyphMapsList.push(mt.create(Number,65536)),r=this.fontList.length-1,a=this.firstMappedSymbol,n=!1}0<m[t]&&(e[t]=1,i[t]=r,254==++a&&(n=!0))}s.ChildFontsMap=i,this.fontList[l]=s}}}this.fonts=mt.create(Di,this.fontList.length);for(let r=0;r<this.fontList.length;r++){this.fonts[r]=new Di;let i=this.fonts[r];i.UnicodeMap=this.UnicodeMapsList[r],i.UnicodeMapBack=mt.create(Number,this.maxSymbols+1),i.UseUnicode=this.fontList[r].UseUnicode;var n=this.GlyphMapsList[r];let e=this.firstMappedSymbol;for(let t=this.firstMappedSymbol;t<65536;t++)0!=i.UnicodeMap[t]&&(i.UnicodeMap[t]=e,i.UnicodeMapBack[e]=t,++e>this.maxSymbols&&(e=this.maxSymbols),i.UseUnicode||92!=e||(i.UnicodeMapBack[e]=t,e++));var a=8226;i.UnicodeMap[a]=e,i.UnicodeMapBack[e]=a,e++,i.MappedSymbolsCount=e;for(let t=0;t<this.firstMappedSymbol;t++)i.UnicodeMap[t]=t,i.UnicodeMapBack[t]=t;i.CharPdfNames=mt.create(String,e),i.SymsToPDF=mt.create(Number,e);for(let e=32;e<i.MappedSymbolsCount;e++){var s=-1;for(let t=0;t<this.standardFontNumWidths;t++);i.SymsToPDF[e]=s;let t=at.c.StiPdfResources.standardFontCharsNames[i.UnicodeMapBack[e]];null==t&&(t="uni"+i.UnicodeMapBack[e].toString(16).toUpperCase().stimulsoft().padLeft(4,"0")),i.CharPdfNames[e]=t}i.GlyphList=mt.create(Number,e);var a=this.fontList[r];this.fonts[r].Widths=mt.create(Number,e),this.getFontMetrics(a.Font,i,n,t);for(let t=0;t<e-32;t++)this.fonts[r].Widths[t]=this.WIDTHS[32+t];this.standardPdfFonts,null!=this.fontList[r].ChildFontsMap&&(i.MappedSymbolsCount=255,i.ChildFontsMap=this.fontList[r].ChildFontsMap)}this._currentFont=-1,this.currentFont=0}getFontNumber(e){let i=-1;if(0<this.fontList.length)for(let t=0;t<this.fontList.length;t++){var r=this.fontList[t];if(r.Name==e.name&&r.Bold==e.bold&&r.Italic==e.italic){i=t;break}}if(-1==i){let t=new Ri;t.Name=e.name,t.Bold=e.bold,t.Italic=e.italic,t.Font=e,t.ParentFontNumber=-1,i=0;for(var n of this.family_Helvetica)t.Name==n&&(i=0);for(var a of this.family_Times_Roman)t.Name==a&&(i=4);for(var s of this.family_Courier)t.Name==s&&(i=8);i<12&&(1==t.Bold&&(i+=1),1==t.Italic&&(i+=2)),t.Number=i,t.PdfName=this.PdfFontName[i],this.fontList.push(t),i=this.fontList.length-1,this.UnicodeMapsList.push(mt.create(Number,65536)),this.GlyphMapsList.push(mt.create(Number,65536))}return this.currentFont=i}storeUnicodeSymbolsInMap(i){if(!pt.isNullOrEmpty(i)&&-1!=this.currentFont){let e=this.UnicodeMapsList[this.currentFont];for(let t=0;t<i.length;t++)e[i.charCodeAt(t)]=1}}storeGlyphsInMap(i){if(0<i.length&&-1!=this.currentFont){let e=this.GlyphMapsList[this.currentFont];for(let t=0;t<i.length;t++)e[i.charCodeAt(t)]=1;e[65535]=1}}getCharToGlyphTable(t,e){var e=this.scanFontFile(t,e);if(null!=e)return this.getCmapTable(t,e);return null}reduceFontSize(c,r,n){let g=this.scanFontFile(c,r),a=null;if(null!=g){if(g.IndexLocaTable==g.IndexGlyfTable&&-1!=g.IndexCFFTable&&(g.Tables[g.IndexCFFTable].Required=!0,g.NumTablesRequired++,n=!1),n){let n=mt.create(Boolean,g.NumGlyphs),i=mt.create(Boolean,g.NumGlyphs);for(let t=0;t<this.GlyphList.length;t++){var h=this.GlyphList[t];h<g.NumGlyphs&&(n[h]=!0,i[h]=!0)}n[0]=!0,n[1]=!0,n[2]=!0,n[3]=!0,i[0]=!0,i[1]=!0,i[2]=!0,i[3]=!0;var p=g.Tables[g.IndexLocaTable].Offset,w=g.Tables[g.IndexGlyfTable].Offset;let r=!0;while(r){r=!1;for(let e=0;e<g.NumGlyphs;e++)if(1==i[e]){i[e]=!1;var d=p+e*(1==g.IndexToLocFormat?4:2);let t=0;if(t=1==g.IndexToLocFormat?this.GetUInt32(c,d):2*this.GetUInt16(c,d),t+=w,-1==this.GetInt16(c,t)){r=!0,t+=10;var S=0;do{var S=this.GetUInt16(c,t),u=this.GetUInt16(c,t+2);u<g.NumGlyphs&&(n[u]=!0,i[u]=!0),t+=4,0<(S&this.ARG_1_AND_2_ARE_WORDS)?t=t+2+2:t+=2,0<(S&this.WE_HAVE_A_SCALE)?t+=2:0<(S&this.WE_HAVE_AN_X_AND_Y_SCALE)?t=t+2+2:0<(S&this.WE_HAVE_A_TWO_BY_TWO)&&(t=(t=t+2+2)+2+2)}while(0<(S&this.MORE_COMPONENTS))}}}let a=0,s=p;for(let i=0;i<g.NumGlyphs;i++){let t=0,e=0;1==g.IndexToLocFormat?(t=this.GetUInt32(c,s),e=this.GetUInt32(c,s+4),s+=4):(t=2*this.GetUInt16(c,s),e=2*this.GetUInt16(c,s+2),s+=2),n[i]&&(a+=e-t)}let o=new Uint8Array(a+4);var f=new Uint8Array(g.Tables[g.IndexLocaTable].Length+4);let l=0,m=(s=p,0);for(let r=0;r<g.NumGlyphs;r++){let e=0,t=0,i=(1==g.IndexToLocFormat?(e=this.GetUInt32(c,s),t=this.GetUInt32(c,s+4),s+=4):(e=2*this.GetUInt16(c,s),t=2*this.GetUInt16(c,s+2),s+=2),t-e);if(1==n[r])for(let t=0;t<i;t++)o[l+t]=c[w+e+t];else i=0;0==g.IndexToLocFormat?this.SetUInt16(f,m,l/2):this.SetUInt32(f,m,l),l+=i,m+=1==g.IndexToLocFormat?4:2}0==g.IndexToLocFormat?this.SetUInt16(f,m,l/2):this.SetUInt32(f,m,l),g.Tables[g.IndexGlyfTable].NewLength=l,g.Tables[g.IndexGlyfTable].NewTable=o,g.Tables[g.IndexLocaTable].NewTable=f}var s=new Uint8Array(this.TtfHeaderSize+16*g.NumTablesRequired);this.copyUint8Array(c,g.HeaderOffset,s,0,s.length);let t=1;while(2<<t-1<=g.NumTablesRequired)t++;var r=16*(2<<--t-1),n=t,o=16*g.NumTablesRequired-r,l,l,m;this.SetUInt16(s,4,g.NumTablesRequired),this.SetUInt16(s,6,r),this.SetUInt16(s,8,n),this.SetUInt16(s,10,o);let e=0,i=this.TtfHeaderSize+16*g.NumTablesRequired;for(let t=0;t<g.NumTables;t++){g.Tables[t].Required&&(g.Tables[t].NewOffset=i,0<(l=(i+=g.Tables[t].NewLength)%4)&&(i+=4-l),l=this.TtfHeaderSize+16*e,this.SetUInt32(s,l,g.Tables[t].Tag),this.SetUInt32(s,l+4,g.Tables[t].CheckSum),this.SetUInt32(s,l+8,g.Tables[t].NewOffset),this.SetUInt32(s,l+12,g.Tables[t].NewLength),e++)}(a=new tt).writeBytes(s,0,s.length);for(let t=0;t<g.NumTables;t++){g.Tables[t].Required&&(null!=g.Tables[t].NewTable?a.writeBytes(g.Tables[t].NewTable,0,g.Tables[t].NewLength):a.writeBytes(c,g.Tables[t].Offset,g.Tables[t].NewLength),0<(m=g.Tables[t].NewLength%4)&&a.write(mt.create(Number,4-m),0,4-m))}a.flush()}return a}scanFontFile(e,i){let r=null;var t=this.GetUInt32(e,0);if(65536==t||1330926671==t)r=this.getTtfInfo(e,0);else{var n=this.GetUInt32(e,4),a;if(1953784678==t&&(65536==n||131072==n))for(let t=this.GetUInt32(e,8)-1;0<=t;t--){var s=this.GetUInt32(e,12+4*t),o=this.GetUInt32(e,s);if(65536==o&&(r=this.getTtfInfo(e,s)).FontName.contains(i))break}}return r}getCmapTable(i,t){let r=null;var e=t.Tables[t.IndexCmapTable].Offset,n=this.GetUInt16(i,e+2);for(let t=0;t<n;t++){var a=e+4+8*t,s=this.GetUInt16(i,a),o=this.GetUInt16(i,a+2),l=e+this.GetUInt32(i,a+4),m;if(3==s&&(1==o||0==o))if(4==this.GetUInt16(i,l)){r=mt.create(Number,65536);for(let t=0;t<65536;t++)r[t]=65535;var c=this.GetUInt16(i,l+6);for(let t=0;t<c;t+=2){var g=l+14+t,h=this.GetUInt16(i,g),p=this.GetUInt16(i,g+2+c),w=this.GetInt16(i,g+2+2*c),d=this.GetUInt16(i,g+2+3*c),S;if(65535!=p)for(let e=p;e<=h;e++){let t=65535;0==d?t=w+e&65535:(S=d+2*(e-p)+(g+2+3*c),0!=(t=this.GetUInt16(i,S))&&(t+=w)),r[e]=t}}}}return r}copyUint8Array(e,i,r,n,a){for(let t=0;t<a;t++)r[n+t]=e[i+t]}getTtfInfo(r,t){let n=new Mi;n.HeaderOffset=t,n.SfntVersion=this.GetUInt32(r,n.HeaderOffset),n.NumTables=this.GetUInt16(r,n.HeaderOffset+4),n.NumTablesRequired=0,n.Tables=[];for(let t=0;t<n.NumTables;t++)n.Tables[t]=new Ni;for(let i=0;i<n.NumTables;i++){var a=n.HeaderOffset+this.TtfHeaderSize+16*i;let e=new ut;for(let t=0;t<4;t++)e.append(String.fromCharCode(this.GetUInt8(r,a+t)));n.Tables[i].Tag=this.GetUInt32(r,a),n.Tables[i].TagString=e.toString(),n.Tables[i].CheckSum=this.GetUInt32(r,a+4),n.Tables[i].Offset=this.GetUInt32(r,a+8),n.Tables[i].Length=this.GetUInt32(r,a+12),n.Tables[i].NewLength=n.Tables[i].Length;for(let t=0;t<this.TablesNames.length;t++)if(n.Tables[i].TagString==this.TablesNames[t]){n.Tables[i].Required=!0,n.NumTablesRequired++;break}switch(n.Tables[i].TagString){case"head":n.IndexToLocFormat=this.GetUInt16(r,n.Tables[i].Offset+50);break;case"maxp":n.NumGlyphs=this.GetUInt16(r,n.Tables[i].Offset+4);break;case"loca":n.IndexLocaTable=i;break;case"glyf":n.IndexGlyfTable=i;break;case"cmap":n.IndexCmapTable=i;break;case"CFF ":n.IndexCFFTable=i;break;case"name":var s=n.Tables[i].Offset,o=this.GetUInt16(r,s+2),l=this.GetUInt16(r,s+4);for(let t=0;t<o;t++){var m=s+6+12*t,c=this.GetUInt16(r,m),g=this.GetUInt16(r,m+2),h=this.GetUInt16(r,m+6),p=this.GetUInt16(r,m+8),w=this.GetUInt16(r,m+10);if(3==c&&1==g&&1==h||0==c&&3==g&&1==h){let e=new ut;for(let t=0;t<p/2;t++)e.append(String.fromCharCode(this.GetUInt16(r,s+l+w+2*t)));var m=e.toString();n.FontName.set(m,m)}}break}}return n}GetUInt8(t,e){return t[e]}GetUInt16(t,e){return(t[e]<<8)+t[e+1]}GetUInt32(t,e){return(t[e]<<24)+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3]}GetInt16(t,e){var t=(t[e]<<8)+t[e+1];return 32767<t?t-65536:t}SetUInt16(t,e,i){t[e+0]=i>>>8&255,t[e+1]=255&i}SetUInt32(t,e,i){t[e+0]=i>>>24&255,t[e+1]=i>>>16&255,t[e+2]=i>>>8&255,t[e+3]=255&i}clear(){this.fonts=null,this.fontList=null,this.UnicodeMapsList=null,this.GlyphMapsList=null,this.Widths=null,this.CharPdfNames=null,this.UnicodeMap=null,this.UnicodeMapBack=null,this.GlyphList=null,this.GlyphBackList=null,this.GlyphRtfList=null,this.SymsToPDF=null,this.GlyphWidths=null,this.fontsInfoStore.clear()}getFontDataBuf(t,e){return this.getFontDataFromGdi(t,e)}getFontDataFromGdi(e,i){let r=null;var t,t,n,t;if(Hi.isFontStimulsoft(e.name))return t=at.a.Resources.StimulsoftFont.getContent(),new Uint8Array(t);let a=rt.Base.StiFontCollection.getBinFont(e.name,e.style);if(null==(r=(r=null!=a?a.data:null)instanceof Uint8Array?r:null)&&(t=0<(e.style&N.Bold),n=0<(e.style&N.Italic),t&&n?null!=(a=rt.Base.StiFontCollection.getBinFont(e.name,N.Italic))&&null!=a.data?(r=a.data,this.NeedSyntBold=!0):null!=(a=rt.Base.StiFontCollection.getBinFont(e.name,N.Bold))&&null!=a.data?(r=a.data,this.NeedSyntItalic=!0):null!=(a=rt.Base.StiFontCollection.getBinFont(e.name,N.Regular))&&null!=a.data&&(r=a.data,this.NeedSyntItalic=!0,this.NeedSyntBold=!0):(t&&null!=(a=rt.Base.StiFontCollection.getBinFont(e.name,N.Regular))&&null!=a.data&&(r=a.data,this.NeedSyntBold=!0),n&&null!=(a=rt.Base.StiFontCollection.getBinFont(e.name,N.Regular))&&null!=a.data&&(r=a.data,this.NeedSyntItalic=!0))),null==r){let t=i.dictionary.resources.getByName(e.name);null!=(t=null==t?i.dictionary.resources.getByAlias(e.name):t)&&null!=t.content&&0<t.content.length&&(r=new Uint8Array(t.content),this.NeedSyntBold=!0,this.NeedSyntItalic=!0)}if(null==r)return t=at.a.Resources.RobotoFont.getContent(),new Uint8Array(t);return r}}at.c.PdfFonts=Hi;class Oi{clear(){}}at.c.FontsInfoStore=Oi}let L=rt.System.Drawing.Point,M=rt.Base.Context.StiPenGeom,H=rt.Base.Drawing.StiPenUtils,O=rt.System.Drawing.Drawing2D.DashStyle,U=rt.System.Drawing.StringFormat,W=rt.System.Drawing.StringAlignment,X=rt.System.Drawing.StringFormatFlags,z=rt.System.Drawing.Size,K=rt.Base.Drawing.StiCornerRadius;{let o=rt.System.Drawing.Rectangle;at.c.StiPdfGeomWriter=class{constructor(t,e,i=!1){this.penWidthDefault=.1,this.precision_digits=3,this.hiToTwips=.72,this.pdfCKT=.55228,this.makepath=!1,this.pathClosed=!1,this.path=null,this.pageStream=null,this.pdfService=null,this.assembleData=!1,this.pageNumber=0,this.matrixCache=null,this.componentAngle=0,this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null,this.pageStream=t,this.pdfService=e,this.assembleData=i,this.matrixCache=new Array}calculateMinMax(t){null==this.xmin?this.xmin=t.x:this.xmin=Math.min(this.xmin,t.x),null==this.xmax?this.xmax=t.x:this.xmax=Math.max(this.xmax,t.x),null==this.ymin?this.ymin=t.y:this.ymin=Math.min(this.ymin,t.y),null==this.ymax?this.ymax=t.y:this.ymax=Math.max(this.ymax,t.y)}convertToString(t){return st.round2(t,this.precision_digits).toString().stimulsoft().replaceAll(",",rt.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator)}setPen(r,n=!1){if(null==r)return!1;let a=!1;if(r.stimulsoft().is(rt.Base.Context.StiPenGeom)){let t=r.stimulsoft().as(M),e=ht.transparent,i=(e=t.brush instanceof ht?t.brush:Et.toColor(t.brush.stimulsoft().as(Et)),this.pdfService.setStrokeColor(e),1<t.thickness?t.thickness:t.thickness*this.hiToTwips);0==i&&(i=this.penWidthDefault),this.pageStream.writeLine1("{0} w",this.convertToString(i)),(a=n&&t.penStyle!=bt.Solid)&&this.pageStream.writeLine("q");var r=this.getPenStyleDashString(H.getPenStyle(t.penStyle),.025*t.thickness);null!=r&&this.pageStream.writeLine(r)}return a}setBrush(e,i,t=!1,r=null){if(null!=r&&(r.ref=!1),null==e)return!1;if(this.assembleData)return e instanceof ht||!(e.is(vt)||e.is(yt)||e.is(At)||e.is(R))||(this.pdfService.storeShadingData1(e.stimulsoft().as(Et),this.pageNumber),this.pdfService.storeHatchData(e.stimulsoft().as(Et))),!1;let n=!1,a=ht.transparent;if(a=e instanceof ht?e:Et.toColor(e.stimulsoft().as(Et)),this.pdfService.setNonStrokeColor(a),0==a.a&&null!=r&&(r.ref=!0),!(e instanceof ht)&&(e.is(vt)||e.is(yt)||e.is(At)||e.is(R))){let t=this.matrixCache.stimulsoft().peek();var s,o,r=[new L(i.x,i.bottom),new L(i.right,i.y)],i=(t.transformPoints(r),new xt(r[0].x,r[0].y,r[1].x-r[0].x,r[1].y-r[0].y)),r=this.pdfService.storeShadingData2(Math.min(i.x,i.right),Math.min(i.y,i.bottom),Math.abs(i.width),Math.abs(i.height),e.stimulsoft().as(Et),this.componentAngle),l;if((e.is(vt)||e.is(yt))&&this.pageStream.writeLine1("/Pattern cs /P{0} scn",1+r),e.is(At)&&this.pageStream.writeLine1("/Cs1 cs /PH{0} scn",this.pdfService.getHatchNumber(e)+1),e.is(R)){let t=e.as(R);this.pdfService.setNonStrokeColor(t.getTopColor()),this.pdfService.setNonStrokeColor(t.getBottomColor())}n=!0}return(n=n&&t)&&this.pageStream.writeLine("q"),n}outputLineString(t,e){var e;null!=e&&(e=this.setPen(e,!0),this.pageStream.writeLine(t),e&&this.pageStream.writeLine("Q"))}convertArcToBezierPoints(t,i,e){var r=t.x+t.width/2,n=t.y+t.height/2,a=t.width/2,s=t.height/2,o=(i*=Math.PI/180,e*=Math.PI/180,Math.ceil(Math.abs(e)/(Math.PI/2)));let l=mt.create(L,3*o+1,!0);var m=e/o,t=Math.sin(m/2),e=Math.cos(m/2),c=4*(1-e)/3,g=t-c*e/(t+1e-4);let h=[],p=[];h[0]=e,p[0]=-t,h[1]=e+c,p[1]=-g,h[2]=e+c,p[2]=g,h[3]=e,p[3]=t;var w=Math.sin(i+m/2),d=Math.cos(i+m/2);l[0].x=r+a*(h[0]*d-p[0]*w),l[0].y=n+s*(h[0]*w+p[0]*d);for(let e=0;e<o;e++){var S=i+m*e,w=Math.sin(S+m/2),d=Math.cos(S+m/2);for(let t=1;t<=3;t++)l[t+3*e].x=r+a*(h[t]*d-p[t]*w),l[t+3*e].y=n+s*(h[t]*w+p[t]*d)}return l}convertSplineToCubicBezier(e,i){var r=e.length,t=3*r-2;let n=[];i*=.3,n[0]=e[0],n[1]=this.calculateCurveBezierEndPoints(e[0],e[1],i);for(let t=0;t<r-2;t++){var a=this.calculateCurveBezier(e,t,i);n[3*t+2]=a[0],n[3*t+3]=e[t+1],n[3*t+4]=a[1]}return n[t-2]=this.calculateCurveBezierEndPoints(e[r-1],e[r-2],i),n[t-1]=e[r-1],n}calculateCurveBezier(t,e,i){var r=t[e+2].x-t[e+0].x,n=t[e+2].y-t[e+0].y,a,s;return[new L(t[e+1].x-i*r,t[e+1].y-i*n),new L(t[e+1].x+i*r,t[e+1].y+i*n)]}calculateCurveBezierEndPoints(t,e,i){return new L(i*(e.x-t.x)+t.x,i*(e.y-t.y)+t.y)}getPointString(t){return this.calculateMinMax(t),pt.format("{0} {1} {2} ",this.convertToString(t.x),this.convertToString(t.y),this.makepath&&0<this.path.length?"l":"m")}getLineToString(t){return this.calculateMinMax(t),pt.format("{0} {1} l ",this.convertToString(t.x),this.convertToString(t.y))}getRectString4(t,e,i,r){return this.getRectString(new xt(t,e,i,r))}getRectString(t){return pt.format("{0} {1} {2} {3} re ",this.convertToString(t.x),this.convertToString(t.top),this.convertToString(t.right-t.x),this.convertToString(t.bottom-t.y))}getRectWithCornersString(t,e){if(null==e)return this.getRectString(t);this.beginPath();let i=2*e.topLeft*this.hiToTwips;return 0==e.topLeft?this.moveTo(new L(t.x,t.top)):this.drawArc(new xt(t.x,t.top,i,i),180,90),i=2*e.topRight*this.hiToTwips,0==e.topRight?this.moveTo(new L(t.right,t.top)):this.drawArc(new xt(t.right-i,t.top,i,i),270,90),i=2*e.bottomRight*this.hiToTwips,0==e.bottomRight?this.moveTo(new L(t.right,t.bottom)):this.drawArc(new xt(t.right-i,t.bottom-i,i,i),0,90),i=2*e.bottomLeft*this.hiToTwips,0==e.bottomLeft?this.moveTo(new L(t.x,t.bottom)):this.drawArc(new xt(t.x,t.bottom-i,i,i),90,90),this.closeFigure(),this.endPath(),this.path.toString()}getBezierString(t,e,i){return this.calculateMinMax(t),this.calculateMinMax(e),this.calculateMinMax(i),pt.format("{0} {1} {2} {3} {4} {5} c ",this.convertToString(t.x),this.convertToString(t.y),this.convertToString(e.x),this.convertToString(e.y),this.convertToString(i.x),this.convertToString(i.y))}getBezierString2(t,e,i,r,n,a){return this.calculateMinMax(new L(t,e)),this.calculateMinMax(new L(i,r)),this.calculateMinMax(new L(n,a)),pt.format("{0} {1} {2} {3} {4} {5} c ",this.convertToString(t),this.convertToString(e),this.convertToString(i),this.convertToString(r),this.convertToString(n),this.convertToString(a))}getPolylineString(e,t,i){let r=new ut;i||r.append(this.getPointString(e[0]));for(let t=i?0:1;t<e.length;t++)r.append(this.getLineToString(e[t]));return t&&r.append("h "),r.toString()}getEllipseString4(t,e,i,r){return this.getEllipseString(new xt(t,e,i,r))}getEllipseString(t){var e=t.width/2*(1-this.pdfCKT),i=t.height/2*(1-this.pdfCKT);let r=new ut;return r.appendFormat("{0} {1} m ",this.convertToString(t.x),this.convertToString(t.y+t.height/2)),r.append(this.getBezierString2(t.x,t.y+t.height-i,t.x+e,t.y+t.height,t.x+t.width/2,t.y+t.height)),r.append(this.getBezierString2(t.x+t.width-e,t.y+t.height,t.x+t.width,t.y+t.height-i,t.x+t.width,t.y+t.height/2)),r.append(this.getBezierString2(t.x+t.width,t.y+i,t.x+t.width-e,t.y,t.x+t.width/2,t.y)),r.append(this.getBezierString2(t.x+e,t.y,t.x,t.y+i,t.x,t.y+t.height/2)),r.toString()}getPenStyleDashString(t,e){switch(t){case O.Dot:return pt.format("[{0} {1}] 0 d",this.convertToString(e),this.convertToString(58*e));case O.Dash:return pt.format("[{0} {1}] 0 d",this.convertToString(49.5*e),this.convertToString(62*e));case O.DashDot:return pt.format("[{0} {1} {2} {1}] 0 d",this.convertToString(50*e),this.convertToString(55*e),this.convertToString(e));case O.DashDotDot:return pt.format("[{0} {1} {2} {1} {2} {1}] 0 d",this.convertToString(50*e),this.convertToString(55*e),this.convertToString(e))}return null}beginPath(){if(this.assembleData)return;this.path=new ut,this.makepath=!0,this.pathClosed=!1,this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null}closeFigure(){if(this.assembleData)return;this.path.append("h "),this.pathClosed=!0}endPath(){if(this.assembleData)return;this.makepath=!1}fillPath(t){var e=this.assembleData?new xt:new xt(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),i={ref:!1},t=this.setBrush(t,e,!0,i),e=i.ref;if(this.assembleData)return;this.pathClosed||this.endPath(),e||(this.pageStream.writeString(this.path.toString()),this.pageStream.writeLine("f")),t&&this.pageStream.writeLine("Q")}strokePath(t){if(this.assembleData)return;this.setPen(t),this.pageStream.writeString(this.path.toString()),this.pageStream.writeLine("S")}moveTo(t){if(this.assembleData)return;this.lastPoint=t;var t=this.getPointString(t);this.makepath?this.path.appendLine(t):this.pageStream.writeLine(t)}drawLine(t,e,i){if(this.assembleData)return;var t=this.getPointString(t)+this.getLineToString(e);this.makepath?this.path.appendLine(t):this.outputLineString(t+"S",i),this.lastPoint=e}drawLineTo(t,e){if(this.assembleData)return;var i=this.getLineToString(t);this.makepath?this.path.appendLine(i):this.outputLineString(i+"S",e),this.lastPoint=t}drawRectangle(t,e,i){if(this.assembleData)return;this.outputLineString(this.getRectWithCornersString(t,i)+"S",e)}fillRectangle(e,i,r){var t={ref:!1},n=this.setBrush(i,e,!0,t),a;if(this.assembleData)return;if(null!=i&&!t.ref){let t=i.stimulsoft().as(R);null!=t?(this.pdfService.setNonStrokeColor(t.getTopColor()),null==r?this.pageStream.writeLine(this.getRectString4(e.x,e.y,e.width,e.height/2)+"f"):this.pageStream.writeLine(this.getRectWithCornersString(new xt(e.x,e.y,e.width,e.height/2),new K(r.topLeft,r.topRight,0,0))+"f"),this.pdfService.setNonStrokeColor(t.getBottomColor()),null==r?this.pageStream.writeLine(this.getRectString4(e.x,e.y+e.height/2,e.width,e.height/2)+"f"):this.pageStream.writeLine(this.getRectWithCornersString(new xt(e.x,e.y+e.height/2,e.width,e.height/2),new K(0,0,r.bottomRight,r.bottomLeft))+"f")):this.pageStream.writeLine(this.getRectWithCornersString(e,r)+"f")}n&&this.pageStream.writeLine("Q")}drawPolygon(t,e){this.drawPolyline(t,e,!0)}drawPolyline(t,e,i=!1,r=!1){if(this.assembleData)return;var i=this.getPolylineString(t,i,r);this.makepath?this.path.appendLine(i):this.outputLineString(i+"S",e),this.lastPoint=t[t.length-1]}drawPolylineTo(t,e){this.drawPolyline(t,e,!1,!0)}fillPolygon(t,e){for(var i of t)this.calculateMinMax(i);var r=new xt(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n={ref:!1},r=this.setBrush(e,r,!0,n),a,e;if(this.assembleData)return;null==e||n.ref||(e=this.getPolylineString(t,!0,!1),this.pageStream.writeLine(e+"f")),r&&this.pageStream.writeLine("Q")}fillPolygons(t,e){for(var i of t)for(var r of i)this.calculateMinMax(r);var n=new o(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),a={ref:!1},n=this.setBrush(e,n,!0,a),a=a.ref;if(this.assembleData)return;if(this.makepath)throw new Error;if(null!=e&&!a)for(var s of t){var s=this.getPolylineString(s.stimulsoft().toArray(),!0,!1);this.pageStream.writeLine(s+"f")}n&&this.pageStream.writeLine("Q")}drawBezier(t,e,i,r,n){if(this.assembleData)return;var t=this.getPointString(t)+this.getBezierString(e,i,r);this.makepath?this.path.appendLine(t):this.outputLineString(t+"S",n),this.lastPoint=r}drawBezierTo(t,e,i,r){if(this.assembleData)return;var t=this.getBezierString(t,e,i);this.makepath?this.path.appendLine(t):this.outputLineString(t+"S",r),this.lastPoint=i}drawSpline(t,e,i){if(this.assembleData)return;var r=this.convertSplineToCubicBezier(t,e),n=(r.length-1)/3;let a=new ut;a.append(this.getPointString(r[0])+this.getBezierString(r[1],r[2],r[3]));for(let t=1;t<n;t++)a.append(this.getBezierString(r[3*t+1],r[3*t+2],r[3*t+3]));this.makepath?this.path.appendLine(a.toString()):this.outputLineString(a.toString()+"S",i),this.lastPoint=r[r.length-1]}drawArc(t,e,i){if(this.assembleData)return;var r=this.convertArcToBezierPoints(t,e,i),n=(r.length-1)/3;this.drawBezier(r[0],r[1],r[2],r[3],null);for(let t=1;t<n;t++)this.drawBezierTo(r[3*t+1],r[3*t+2],r[3*t+3],null)}drawEllipse(t,e){if(this.assembleData)return;this.outputLineString(this.getEllipseString(t)+"S",e)}fillEllipse(t,e){var i={ref:!1},r=this.setBrush(e,t,!0,i),n;if(this.assembleData)return;null==e||i.ref||this.pageStream.writeLine(this.getEllipseString(t)+"f"),r&&this.pageStream.writeLine("Q")}drawPie(t,e,i){if(this.assembleData)return;var r=this.convertArcToBezierPoints(t,e,i),n=(r.length-1)/3,e=t.x+t.width/2,i=t.y+t.height/2;this.drawBezier(r[0],r[1],r[2],r[3],null);for(let t=1;t<n;t++)this.drawBezierTo(r[3*t+1],r[3*t+2],r[3*t+3],null);this.drawLineTo(new L(e,i),null),this.drawLineTo(r[0],null)}drawString(t,e,i,r,n){if(this.assembleData)return null!=e&&this.pdfService.pdfFont.getFontNumber(e),this.pdfService.pdfFont.storeUnicodeSymbolsInMap(t),void this.pdfService.storeShadingData1(i,this.pageNumber);let a=new lt,s=(a.clientRectangle=new o(r.x,r.y,r.width,r.height),a.text=t,a.font=e,a.textBrush=i,(n=n||new U).alignment==W.Center&&(a.horAlignment=wt.Center),n.alignment==W.Far&&(a.horAlignment=wt.Right),n.lineAlignment==W.Center&&(a.vertAlignment=dt.Center),n.lineAlignment==W.Far&&(a.vertAlignment=dt.Bottom),0==(n.formatFlags&X.NoWrap)&&(a.wordWrap=!0),new at.c.StiPdfData(this.pdfService));s.Component=a,s.Width=r.width*this.hiToTwips,s.Height=r.height*this.hiToTwips,this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(r.x),this.convertToString(r.y+r.height)),this.pageStream.writeLine("1.39 0 0 -1.39 0 0 cm"),at.c.StiPdfRenderText.renderTextFont(s),at.c.StiPdfRenderText.renderText(s),this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack()}saveState(){if(this.assembleData)return;this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),0<this.matrixCache.length&&this.matrixCache.push(this.matrixCache.stimulsoft().peek().clone())}restoreState(){if(this.assembleData)return;this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack(),0<this.matrixCache.length&&this.matrixCache.pop()}translateTransform(t,e){if(this.assembleData)return;this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(t),this.convertToString(e)),0<this.matrixCache.length&&this.matrixCache.stimulsoft().peek().translate(t,e)}rotateTransform(t){if(this.assembleData)return;var e=t*Math.PI/180;this.pageStream.writeLine1("{0} {1} {2} {3} 0 0 cm",this.convertToString(Math.cos(e)),this.convertToString(Math.sin(e)),this.convertToString(-Math.sin(e)),this.convertToString(Math.cos(e))),0<this.matrixCache.length&&this.matrixCache.stimulsoft().peek().rotate(t)}setClip(t){if(this.assembleData)return;this.pageStream.writeLine(this.getRectString(t)+"W n")}drawArc2(t,e,i,r){}drawText(t,e,i,r,n,a,s){}setPixel(t,e){}measureString(t,e){return new z(0,0)}drawImage(t,e){let i=new E;if(i.clientRectangle=e,i.imageToDraw=t,i.smoothing=!0,i.stretch=!0,this.assembleData)return void this.pdfService.storeImageDataForGeom(i);let r=new at.c.StiPdfData(this.pdfService);r.Component=i,r.Width=e.width,r.Height=e.height,this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(e.x),this.convertToString(e.y+e.height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pdfService.renderImage(r,100),this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack()}}}let Q=at.a.Painters.StiSparklinePainter,Z=rt.System.Drawing.Graphics,J=rt.Base.Context.StiContext,$=rt.Base.Context.StiContextPainter,$t=rt.Base.Drawing.StiRotationMode,te=rt.Base.Context.StiPushTranslateTransformGeom,ee=rt.Base.Context.StiPushRotateTransformGeom,ie=rt.Base.Context.StiPopTransformGeom,re=rt.Base.Context.StiBorderGeom,ne=rt.Base.Context.StiLineGeom,ae=rt.Base.Context.StiLinesGeom,se=rt.Base.Context.StiPushClipGeom,oe=rt.Base.Context.StiPopClipGeom,le=rt.Base.Context.StiPushSmothingModeToAntiAliasGeom,me=rt.Base.Context.StiPopSmothingModeGeom,ce=rt.Base.Context.StiPushTextRenderingHintToAntiAliasGeom,ge=rt.Base.Context.StiPopTextRenderingHintGeom,he=rt.Base.Context.StiCurveGeom,pe=rt.Base.Context.StiEllipseGeom,we=rt.Base.Context.StiCachedShadowGeom,de=rt.Base.Drawing.StiShadowSides,Se=rt.Base.Drawing.StiSolidBrush,ue=rt.Base.Context.StiTextGeom,fe=rt.Base.Context.StiPathGeom,ve=rt.Base.Context.StiPieSegmentGeom,Ee=rt.Base.Context.StiArcSegmentGeom,be=rt.Base.Context.StiLineSegmentGeom,xe=rt.Base.Context.StiLinesSegmentGeom,ye=rt.Base.Context.StiCurveSegmentGeom,Ae=rt.Base.Context.StiCloseFigureSegmentGeom,Te=(at.c.StiPdfRenderChart=class{static renderChart(e,t,i){let r=e.Component.as(Qt);var n=.96;let a=e.service.report.unit.convertToHInches(e.Component.width)*n,s=e.service.report.unit.convertToHInches(e.Component.height)*n,o=0,l=0,m=0,c=1,g=1;switch(r.rotation){case f.Rotate90CCW:o=-90,m=s;break;case f.Rotate90CW:o=90,l=a;break;case f.Rotate180:o=-180,l=a,m=s;break;case f.FlipVertical:g=-1,m=s;break;case f.FlipHorizontal:c=-1,l=a;break}switch(r.rotation){case f.Rotate90CCW:case f.Rotate90CW:var h=a;a=s,s=h;break}if(!t&&r.rotation!=f.None){let t=new Tt(1,0,0,1,0,0);t.translate(l,m),t.scale(c,g),t.rotate(o),e.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",e.service.convertToString(t.elements[0]),e.service.convertToString(t.elements[1]),e.service.convertToString(t.elements[2]),e.service.convertToString(t.elements[3]),e.service.convertToString(t.elements[4]),e.service.convertToString(t.elements[5]))}var n=new $,n=new J(n,!0,!1,!1,1),p=r.isAnimation;r.isAnimation=!1;let w=r.core.render(n,new xt(0,0,a,s),!0);w.drawGeom(n),r.isAnimation=p,this.renderContext(e,t,i,n)}static renderSparkline(t,e,i){var r=t.Component.as(zt),n=.96,a=t.service.report.unit.convertToHInches(t.Component.width)*n,n=t.service.report.unit.convertToHInches(t.Component.height)*n,s=new $,s=new J(s,!0,!1,!1,1);Q.renderSparkline(s,new xt(0,0,a,n),r,1),this.renderContext(t,e,i,s)}static renderContext(t,e,i,r){var n,a,n,s;let o=new Tt(1,0,0,1,0,0);var l=t.service.hiToTwips/.96,m,c,c,g,g,h,h,p,p;o.translate(t.X,t.Y+t.Height),o.scale(1,-1),o.scale(l,l);let w=new at.c.StiPdfGeomWriter(t.service.pageStream,t.service,e);w.pageNumber=i,w.matrixCache.push(o);for(m of r.geoms){if(m.is(te)&&(c=m,w.saveState(),w.translateTransform(c.x,c.y)),m.is(ee)&&(c=m,w.saveState(),w.rotateTransform(c.angle)),m.is(ie)&&w.restoreState(),m.is(se)&&(g=m,w.saveState(),w.setClip(g.clipRectangle)),m.is(oe)&&w.restoreState(),m.is(le)&&w.saveState(),m.is(me)&&w.restoreState(),m.is(ce)&&w.saveState(),m.is(ge)&&w.restoreState(),m.is(re)&&(null!=(g=m).background&&w.fillRectangle(this.rectToRectangle(g.rect),g.background,g.cornerRadius),this.checkPenGeom(g.borderPen)&&w.drawRectangle(this.rectToRectangle(g.rect),g.borderPen,g.cornerRadius)),m.is(ne)&&(h=m,this.checkPenGeom(h.pen)&&w.drawLine(new L(h.x1,h.y1),new L(h.x2,h.y2),h.pen)),m.is(ae)&&(h=m,this.checkPenGeom(h.pen)&&w.drawPolyline(h.points,h.pen)),m.is(he)&&(p=m,this.checkPenGeom(p.pen)&&w.drawSpline(p.points,p.tension,p.pen)),m.is(pe)&&(null!=(p=m).background&&w.fillEllipse(this.rectToRectangle(p.rect),p.background),this.checkPenGeom(p.borderPen)&&w.drawEllipse(this.rectToRectangle(p.rect),p.borderPen)),m.is(we)){var d=m,S=d.rect,u=d.sides;let i=S.y+8,r=S.x+8;var f=0<(u&de.Edge)?4:0;0<(u&de.Top)&&(i=S.y+4),0<(u&de.Left)&&(r=S.x+4);for(let e=0;e<3;e++){let t=new Array;0<(u&de.Right)?(t.push(new L(S.right,i)),0<(u&de.Bottom)?(t.push(new L(S.right,S.bottom)),t.push(new L(r,S.bottom)),t.push(new L(r,S.bottom+e+1)),t.push(new L(S.right+e+1,S.bottom+e+1))):(t.push(new L(S.right,S.bottom+f)),t.push(new L(S.right+e+1,S.bottom+f))),t.push(new L(S.right+e+1,i))):(t.push(new L(r,S.bottom)),t.push(new L(S.right+f,S.bottom)),t.push(new L(S.right+f,S.bottom+e+1)),t.push(new L(r,S.bottom+e+1)));var v=new Se(ht.fromArgb(40-10*e,ht.black));w.fillPolygon(t,v)}}if(m.is(ue)){var d=m,E=new j(d.font.fontName,d.font.fontSize,d.font.fontStyle,d.font.unit);let i=new U;i.alignment=d.stringFormat.alignment,i.formatFlags=d.stringFormat.formatFlags,i.hotkeyPrefix=d.stringFormat.hotkeyPrefix,i.lineAlignment=d.stringFormat.lineAlignment,i.trimming=d.stringFormat.trimming;var b=this.brushToStiBrush(d.brush);if(d.isRotatedText){let t=new L;var x,x=(t=d.location instanceof L?d.location:(x=this.rectToRectangle(d.location),new L(x.x+x.width/2,x.y+x.height/2)),Z.measureString(d.text,E,d.maximalWidth));let e=new xt(0,0,x.width,x.height);var y=this.getStartPoint(d.rotationMode,e);e.x-=y.x,e.y-=y.y,i.alignment==rt.System.Drawing.StringAlignment.Center&&--e.x,i.alignment==rt.System.Drawing.StringAlignment.Far&&(e.x-=2),e.width+=2.5,w.saveState(),w.translateTransform(t.x,t.y),0!=d.angle&&w.rotateTransform(d.angle),w.drawString(d.text,E,b,e,i),w.restoreState()}else w.drawString(d.text,E,b,this.rectToRectangle(d.location),i)}if(m.is(fe)){var y=m,A,T,n,a,T,a,s,s,P,P;w.beginPath();for(A of y.geoms){A.is(ve)&&(n=null!=(n=(T=A).realStartAngle)?n:T.startAngle,a=null!=(a=T.realSweepAngle)?a:T.sweepAngle,w.drawPie(T.rect,n,a)),A.is(Ee)&&(a=null!=(n=(T=A).realStartAngle)?n:T.startAngle,s=null!=(s=T.realSweepAngle)?s:T.sweepAngle,w.drawArc(T.rect,a,s)),A.is(be)&&(s=A,w.drawLine(new L(s.x1,s.y1),new L(s.x2,s.y2),null)),A.is(xe)&&(P=A,w.drawPolyline(P.points,null)),A.is(ye)&&(P=A,w.drawSpline(P.points,P.tension,null)),A.is(Ae)&&w.closeFigure()}w.closeFigure(),w.endPath(),null!=y.background&&w.fillPath(y.background),this.checkPenGeom(y.pen)&&w.strokePath(y.pen)}}}static getStartPoint(t,e){var i=new L(e.x+e.width/2,e.y+e.height/2);switch(t){case $t.LeftCenter:return new L(e.x,i.y);case $t.LeftBottom:return new L(e.x,e.bottom);case $t.CenterTop:return new L(i.x,e.top);case $t.CenterCenter:return i;case $t.CenterBottom:return new L(i.x,e.bottom);case $t.RightTop:return new L(e.right,e.top);case $t.RightCenter:return new L(e.right,i.y);case $t.RightBottom:return new L(e.right,e.bottom);default:return new L(e.x,e.y)}}static rectToRectangle(t){if(null==t)return new xt;if(t instanceof xt)return t;return new xt}static brushToStiBrush(t){if(null==t)return null;return t instanceof ht?new Se(t):t;return null}static checkPenGeom(t){return!(null==t||null==t.brush||t.penStyle==bt.None)}},at.a.Components.StiDataBarDirection),n=rt.System.Drawing.ContentAlignment,Pe=(at.c.StiPdfRenderIndicators=class{static renderIndicators(a){let e=a.Component.as(lt);if(null==e||null==e.indicator)return a;let s=new xt(a.X,a.Y,a.Width,a.Height);var o=e.indicator.stimulsoft().as(_t);if(null!=o&&(o.icon!=jt.None||null!=o.customIcon)){var l=a.service.imageList[a.service.imagesCurrent],i=l.Width*a.service.hiToTwips,r=l.Height*a.service.hiToTwips;let t=s.clone();var l=a.service.hiToTwips;switch(t.inflate(-l,-l),o.alignment){case n.TopLeft:t=new xt(t.x,t.bottom-r,i,r),s.x+=t.width+1,s.width-=t.width+1;break;case n.TopCenter:t=new xt(t.x+(t.width-i)/2,t.bottom-r,i,r);break;case n.TopRight:t=new xt(t.right-i,t.bottom-r,i,r),s.width-=t.width+1;break;case n.MiddleLeft:t=new xt(t.x,t.y+(t.height-r)/2,i,r),s.x+=t.width+1,s.width-=t.width+1;break;case n.MiddleCenter:t=new xt(t.x+(t.width-i)/2,t.y+(t.height-r)/2,i,r);break;case n.MiddleRight:t=new xt(t.right-i,t.y+(t.height-r)/2,i,r),s.width-=t.width+1;break;case n.BottomLeft:t=new xt(t.x,t.y,i,r),s.x+=t.width+1,s.width-=t.width+1;break;case n.BottomCenter:t=new xt(t.x+(t.width-i)/2,t.y,i,r);break;case n.BottomRight:t=new xt(t.right-i,t.y,i,r),s.width-=t.width+1;break}let e=new at.c.StiPdfData(a.service);e.X=t.x,e.Y=t.y,e.Width=t.width,e.Height=t.height,a.service.writeImageInfo2(e,1,1)}var l=e.indicator.stimulsoft().as(Gt);if(null!=l&&0!=l.value){let i=s.clone();var o=a.service.hiToTwips,o=(i.inflate(-2*o,-2*o),l.maximum+Math.abs(l.minimum)),m=i.width*Math.abs(l.minimum)/o,c=i.width*l.maximum/o,o=i.width*Math.abs(l.value)/o;let t=l.direction,r=0,n=((t=t==Te.Default?null!=e.textOptions&&e.textOptions.rightToLeft?Te.RighToLeft:Te.LeftToRight:t)==Te.LeftToRight?l.value<0?i.x+=m-o:i.x+=m:(r=180,l.value<0?i.x=i.right-m:i.x=i.right-m-o),i.width=o,l.value<0&&(r+=180),!1);if(0<i.width&&0<i.height){if(l.brushType==at.a.Components.StiBrushType.Gradient){let e;if(e=t==Te.LeftToRight?0<l.value?new xt(s.left+m,s.top,c,s.height):new xt(s.left,s.top,m,s.height):l.value<0?new xt(s.left+c,s.top,m,s.height):new xt(s.left,s.top,c,s.height),0<i.width&&i.width<1&&(i.width=1),0<e.width&&e.width<1&&(e.width=1),0<e.width&&0<i.width){var o=l.value<0?l.negativeColor:l.positiveColor,m=Vt.light(o,200),c=(e.x-=.1*e.width,e.width+=.2*e.width,new vt(o,m,r));a.service.fillRectBrush(c,i);let t=a.service.shadingArray[a.service.shadingCurrent-1];t.Angle=r,t.X=e.x,t.Y=e.y,t.Width=e.width,t.Height=e.height,t.FunctionIndex=a.service.getShadingFunctionNumber(o,m,!1),a.service.shadingArray[a.service.shadingCurrent-1]=t,n=!0}}else{var c=new Se(l.value<0?l.negativeColor:l.positiveColor);a.service.fillRectBrush(c,i)}l.showBorder&&(a.service.pageStream.writeLine("q"),a.service.pushColorToStack(),a.service.setStrokeColor(l.value<0?l.negativeBorderColor:l.positiveBorderColor),a.service.pageStream.writeLine1("{0} {1} {2} {3} re S",a.service.convertToString(i.x),a.service.convertToString(i.y),a.service.convertToString(i.width),a.service.convertToString(i.height)),a.service.pageStream.writeLine("Q"),a.service.popColorFromStack())}n||l.brushType!=at.a.Components.StiBrushType.Gradient||a.service.shadingCurrent++}let t=new at.c.StiPdfData(a.service);return t.X=s.x,t.Y=a.Y,t.Width=s.width,t.Height=a.Height,t.Component=a.Component,t}},at.a.Components.StiVerticalLineShapeType),Le=at.a.Components.StiHorizontalLineShapeType,Ce=at.a.Components.StiTopAndBottomLineShapeType,Fe=at.a.Components.StiLeftAndRightLineShapeType,ke=at.a.Components.StiRectangleShapeType,Ie=at.a.Components.StiRoundedRectangleShapeType,Be=at.a.Components.StiDiagonalDownLineShapeType,De=at.a.Components.StiDiagonalUpLineShapeType,Re=at.a.Components.StiTriangleShapeType,Ne=at.a.Components.StiOvalShapeType,Me=at.a.Components.StiArrowShapeType,He=at.a.Components.StiOctagonShapeType,Oe=at.a.Components.StiComplexArrowShapeType,Ue=at.a.Components.StiBentArrowShapeType,We=at.a.Components.StiChevronShapeType,Xe=at.a.Components.StiDivisionShapeType,ze=at.a.Components.StiEqualShapeType,Ve=at.a.Components.StiFlowchartCardShapeType,Ge=at.a.Components.StiFlowchartCollateShapeType,Ye=at.a.Components.StiFlowchartDecisionShapeType,je=at.a.Components.StiFlowchartManualInputShapeType,_e=at.a.Components.StiFlowchartOffPageConnectorShapeType,qe=at.a.Components.StiFlowchartPreparationShapeType,Ke=at.a.Components.StiFlowchartSortShapeType,Qe=at.a.Components.StiFrameShapeType,Ze=at.a.Components.StiMinusShapeType,Je=at.a.Components.StiMultiplyShapeType,$e=at.a.Components.StiParallelogramShapeType,ti=at.a.Components.StiPlusShapeType,ei=at.a.Components.StiRegularPentagonShapeType,ii=at.a.Components.StiTrapezoidShapeType,ri=at.a.Components.StiSnipSameSideCornerRectangleShapeType,ni=at.a.Components.StiSnipDiagonalSideCornerRectangleShapeType,b=at.a.Components.StiShapeDirection,ai=at.a.Components.StiCheckStyle,si=at.a.Components.StiRoundedRectanglePrimitive;at.c.StiPdfRenderPrimitives=class{static renderBorder1(t){let e=null;var i=t.Component.as(Ot);null!=(e=null!=i&&null!=i.brush?i.brush:e)&&t.service.fillRectBrush(e,new xt(t.X,t.Y,t.Width,t.Height))}static renderBorder2(i){let r=i.Component.as(Ht);if(null!=r){var n=ht.transparent,a,n;r.border.dropShadow&&null!=r.border.shadowBrush&&0!=(n=Et.toColor(r.border.shadowBrush)).a&&(a=.8*r.border.shadowSize,i.service.setNonStrokeColor(n),i.service.pageStream.writeLine1("{0} {1} {2} {3} re f",i.service.convertToString(i.X+a),i.service.convertToString(i.Y-a),i.service.convertToString(i.Width-a),i.service.convertToString(a)),i.service.pageStream.writeLine1("{0} {1} {2} {3} re f",i.service.convertToString(i.X+i.Width),i.service.convertToString(i.Y-a),i.service.convertToString(a),i.service.convertToString(i.Height)));let e=new w(r.border.color,r.border.size,r.border.style);var n=r.border.stimulsoft().as(Mt),a=null!=n,s=r.border.isLeftBorderSidePresent,o=r.border.isRightBorderSidePresent,l=r.border.isTopBorderSidePresent,m=r.border.isBottomBorderSidePresent,c=r.border.style!=bt.None&&r.border.style!=bt.Solid;let t=r.border.side!=ft.None&&r.border.style!=bt.None;if(t=a?n.side!=ft.None:t){let t=0;a||(c&&(i.service.pageStream.writeLine("q"),i.service.pushColorToStack()),t=this.storeBorderSideData(e,i)),a||r.border.side!=ft.All?(s&&(a&&((e=n.leftSide).style!=bt.Solid&&(i.service.pageStream.writeLine("q"),i.service.pushColorToStack()),t=this.storeBorderSideData(e,i)),i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(i.X-t),i.service.convertToString(i.Y-t)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(i.X-t),i.service.convertToString(i.Y+i.Height+t)),e.style==bt.Double&&(i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(i.X+t),i.service.convertToString(i.Y+(m?t:-t))),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(i.X+t),i.service.convertToString(i.Y+i.Height+(l?-t:t)))),a&&e.style!=bt.Solid&&(i.service.pageStream.writeLine("Q"),i.service.popColorFromStack())),o&&(a&&((e=n.rightSide).style!=bt.Solid&&(i.service.pageStream.writeLine("q"),i.service.pushColorToStack()),t=this.storeBorderSideData(e,i)),i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(i.X+i.Width+t),i.service.convertToString(i.Y-t)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(i.X+i.Width+t),i.service.convertToString(i.Y+i.Height+t)),e.style==bt.Double&&(i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(i.X+i.Width-t),i.service.convertToString(i.Y+(m?t:-t))),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(i.X+i.Width-t),i.service.convertToString(i.Y+i.Height+(l?-t:t)))),a&&e.style!=bt.Solid&&(i.service.pageStream.writeLine("Q"),i.service.popColorFromStack())),l&&(a&&((e=n.topSide).style!=bt.Solid&&(i.service.pageStream.writeLine("q"),i.service.pushColorToStack()),t=this.storeBorderSideData(e,i)),i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(i.X-t),i.service.convertToString(i.Y+i.Height+t)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(i.X+i.Width+t),i.service.convertToString(i.Y+i.Height+t)),e.style==bt.Double&&(i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(i.X+(s?t:-t)),i.service.convertToString(i.Y+i.Height-t)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(i.X+i.Width+(o?-t:t)),i.service.convertToString(i.Y+i.Height-t))),a&&e.style!=bt.Solid&&(i.service.pageStream.writeLine("Q"),i.service.popColorFromStack())),m&&(a&&((e=n.bottomSide).style!=bt.Solid&&(i.service.pageStream.writeLine("q"),i.service.pushColorToStack()),t=this.storeBorderSideData(e,i)),i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(i.X-t),i.service.convertToString(i.Y-t)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(i.X+i.Width+t),i.service.convertToString(i.Y-t)),e.style==bt.Double&&(i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(i.X+(s?t:-t)),i.service.convertToString(i.Y+t)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(i.X+i.Width+(o?-t:t)),i.service.convertToString(i.Y+t))),a&&e.style!=bt.Solid&&(i.service.pageStream.writeLine("Q"),i.service.popColorFromStack()))):(i.service.pageStream.writeLine1("{0} {1} {2} {3} re S",i.service.convertToString(i.X-t),i.service.convertToString(i.Y-t),i.service.convertToString(i.Width+2*t),i.service.convertToString(i.Height+2*t)),r.border.style==bt.Double&&i.service.pageStream.writeLine1("{0} {1} {2} {3} re S",i.service.convertToString(i.X+t),i.service.convertToString(i.Y+t),i.service.convertToString(i.Width-2*t),i.service.convertToString(i.Height-2*t))),!a&&c&&(i.service.pageStream.writeLine("Q"),i.service.popColorFromStack())}}}static storeBorderSideData(t,e){let i=t.size;i<1&&(i=1);var r=(i=t.style==bt.Double?1:i)*e.service.hiToTwips*.955,n=(e.service.pageStream.writeLine1("{0} w",e.service.convertToString(r)),this.getPenStyleDashString(t.style,.04*r,e));return null!=n&&e.service.pageStream.writeLine(n),e.service.setStrokeColor(t.color),t.style==bt.Double?r:0}static getPenStyleDashString(t,e,i){switch(t){case bt.Dot:return pt.format("[{0} {1}] 0 d",i.service.convertToString(e),i.service.convertToString(58*e));case bt.Dash:return pt.format("[{0} {1}] 0 d",i.service.convertToString(49.5*e),i.service.convertToString(62*e));case bt.DashDot:return pt.format("[{0} {1} {2} {1}] 0 d",i.service.convertToString(50*e),i.service.convertToString(55*e),i.service.convertToString(e));case bt.DashDotDot:return pt.format("[{0} {1} {2} {1} {2} {1}] 0 d",i.service.convertToString(50*e),i.service.convertToString(55*e),i.service.convertToString(e))}return null}static checkShape(t){if(t.shapeType.is2(Pe)||t.shapeType.is2(Le)||t.shapeType.is2(Ce)||t.shapeType.is2(Fe)||t.shapeType.is2(ke)||t.shapeType.is2(Ie)||t.shapeType.is2(Be)||t.shapeType.is2(De)||t.shapeType.is2(Re)||t.shapeType.is2(Ne)||t.shapeType.is2(Me)||t.shapeType.is2(He)||t.shapeType.is2(Oe)||t.shapeType.is2(Ue)||t.shapeType.is2(We)||t.shapeType.is2(Xe)||t.shapeType.is2(ze)||t.shapeType.is2(Ve)||t.shapeType.is2(Ge)||t.shapeType.is2(Ye)||t.shapeType.is2(je)||t.shapeType.is2(_e)||t.shapeType.is2(qe)||t.shapeType.is2(Ke)||t.shapeType.is2(Qe)||t.shapeType.is2(Ze)||t.shapeType.is2(Je)||t.shapeType.is2($e)||t.shapeType.is2(ti)||t.shapeType.is2(ei)||t.shapeType.is2(ii)||t.shapeType.is2(ri)||t.shapeType.is2(ni))return!0;return!1}static renderShape(n,t){let a=n.Component.as(Nt);if(null!=a&&1==this.checkShape(a)){let t=n.Component.as(Ot),e=new at.c.StiPdfGeomWriter(n.service.pageStream,n.service,!1),i=ht.transparent;var s,s=(0!=(i=null!=t?Et.toColor(t.brush):i).a&&n.service.setNonStrokeColor(i),null!=t&&((t.brush.is(vt)||t.brush.is(yt))&&(n.service.storeShadingData2(n.X,n.Y,n.Width,n.Height,t.brush),n.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+n.service.shadingCurrent)),t.brush.is(At)&&(s=t.brush,n.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",n.service.getHatchNumber(s)+1))),a.borderColor),s=(n.service.setStrokeColor(s),0<i.a),o=a.style!=bt.None;if(!s&&!o)return;let r=s?o?"B":"f":o?"S":"n";n.service.pageStream.writeLine1("{0} w",n.service.convertToString(a.size*n.service.hiToTwips)),n.service.pageStream.writeLine("q");var l=a.size*n.service.hiToTwips*.04,m,s,m,o,m,s,o,m,s,o,s,m,s,o,s,m,o,s;switch(a.style){case bt.Dot:n.service.pageStream.writeLine1("[{0} {1}] 0 d",n.service.convertToString(l),n.service.convertToString(55*l));break;case bt.Dash:n.service.pageStream.writeLine1("[{0} {1}] 0 d",n.service.convertToString(50*l),n.service.convertToString(55*l));break;case bt.DashDot:n.service.pageStream.writeLine1("[{0} {1} {2} {1}] 0 d",n.service.convertToString(50*l),n.service.convertToString(55*l),n.service.convertToString(l));break;case bt.DashDotDot:n.service.pageStream.writeLine1("[{0} {1} {2} {1} {2} {1}] 0 d",n.service.convertToString(50*l),n.service.convertToString(55*l),n.service.convertToString(l));break}if(a.shapeType.is(Pe)&&(s&&n.service.pageStream.writeLine1("{0} {1} {2} {3} re f",n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.Width),n.service.convertToString(n.Height)),o&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l S",n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y+n.Height)))),a.shapeType.is(Le)&&(s&&n.service.pageStream.writeLine1("{0} {1} {2} {3} re f",n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.Width),n.service.convertToString(n.Height)),o&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height/2)),n.service.pageStream.writeLine1("{0} {1} l S",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height/2)))),a.shapeType.is(Ce)&&(s&&n.service.pageStream.writeLine1("{0} {1} {2} {3} re f",n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.Width),n.service.convertToString(n.Height)),o&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l S",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l S",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y)))),a.shapeType.is(Fe)&&(s&&n.service.pageStream.writeLine1("{0} {1} {2} {3} re f",n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.Width),n.service.convertToString(n.Height)),o&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l S",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l S",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height)))),a.shapeType.is(ke)&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y))),a.shapeType.is(Be)&&(s&&n.service.pageStream.writeLine1("{0} {1} {2} {3} re f",n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.Width),n.service.convertToString(n.Height)),o&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l S",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y)))),a.shapeType.is(De)&&(s&&n.service.pageStream.writeLine1("{0} {1} {2} {3} re f",n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.Width),n.service.convertToString(n.Height)),o&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l S",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height)))),a.shapeType.is(Re)&&((m=a.shapeType.direction)==b.Up&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y))),m==b.Down&&(r=s?o?"B*":"f*":o?"S":"n",n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height))),m==b.Left&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height/2)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l "+r,n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y))),m==b.Right&&(r=s?o?"B*":"f*":o?"S":"n",n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height/2)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y)))),a.shapeType.is(Ne)&&n.service.pageStream.writeLine1(e.getEllipseString(new xt(n.X,n.Y,n.Width,n.Height))+r),a.shapeType.is(Ie)){var m=a.shapeType.round;let t=n.Width;t>n.Height&&(t=n.Height);var s=Math.min(t,70)*m,o=s*(1-n.service.pdfCKT);n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y+s)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height-s)),n.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height-o),n.service.convertToString(n.X+o),n.service.convertToString(n.Y+n.Height),n.service.convertToString(n.X+s),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width-s),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",n.service.convertToString(n.X+n.Width-o),n.service.convertToString(n.Y+n.Height),n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height-o),n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height-s)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+s)),n.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+o),n.service.convertToString(n.X+n.Width-o),n.service.convertToString(n.Y),n.service.convertToString(n.X+n.Width-s),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+s),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c "+r,n.service.convertToString(n.X+o),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Y+o),n.service.convertToString(n.X),n.service.convertToString(n.Y+s))}if(a.shapeType.is(Me)){var m=a.shapeType.direction,o=a.shapeType.arrowWidth,s=a.shapeType.arrowHeight;let t=n.Width*o,e=n.Height*s;m!=b.Left&&m!=b.Right||(t=n.Height*o,e=n.Width*s),0==s&&(e=Math.min(n.Width/2,n.Height/2)),m==b.Up&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X+t),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+t),n.service.convertToString(n.Y+n.Height-e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height-e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height-e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width-t),n.service.convertToString(n.Y+n.Height-e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width-t),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l "+r,n.service.convertToString(n.X+t),n.service.convertToString(n.Y))),m==b.Down&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X+n.Width-t),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width-t),n.service.convertToString(n.Y+e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+t),n.service.convertToString(n.Y+e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+t),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l "+r,n.service.convertToString(n.X+n.Width-t),n.service.convertToString(n.Y+n.Height))),m==b.Left&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+t)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+e),n.service.convertToString(n.Y+t)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+e),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height/2)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+e),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+e),n.service.convertToString(n.Y+n.Height-t)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height-t)),n.service.pageStream.writeLine1("{0} {1} l "+r,n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+t))),m==b.Right&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height-t)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width-e),n.service.convertToString(n.Y+n.Height-t)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width-e),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height/2)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width-e),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width-e),n.service.convertToString(n.Y+t)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+t)),n.service.pageStream.writeLine1("{0} {1} l "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height-t)))}if(a.shapeType.is(He)){var o=a.shapeType;let t=(null!=a.report?a.report.unit.convertToHInches(o.bevel):o.bevel)*n.service.hiToTwips,e=t;o.autoSize&&(t=n.Width/(2.414*1.414),e=n.Height/(2.414*1.414)),t>n.Width/2&&(t=n.Width/2),e>n.Height/2&&(e=n.Height/2),n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X+t),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width-t),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width),n.service.convertToString(n.Y+n.Height-e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width-t),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+t),n.service.convertToString(n.Y+n.Height)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height-e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+e)),n.service.pageStream.writeLine1("{0} {1} l "+r,n.service.convertToString(n.X+t),n.service.convertToString(n.Y))}if(a.shapeType.is(Oe)){var c=n.Width<n.Height?n.Width/2:n.Height/2,g=n.Height/3.8,h=n.Width/3.8,p=n.Height<n.Width?n.Height/2:n.Width/2;switch(a.shapeType.direction){case b.Left:case b.Right:n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height/2)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+c),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+c),n.service.convertToString(n.Y+g)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-c),n.service.convertToString(n.Y+g)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-c),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right),n.service.convertToString(n.Y+n.Height/2)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-c),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-c),n.service.convertToString(n.Top-g)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+c),n.service.convertToString(n.Top-g)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+c),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y+n.Height/2));break;case b.Down:case b.Up:n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y+p)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right),n.service.convertToString(n.Y+p)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-h),n.service.convertToString(n.Y+p)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-h),n.service.convertToString(n.Top-p)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right),n.service.convertToString(n.Top-p)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Top-p)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+h),n.service.convertToString(n.Top-p)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+h),n.service.convertToString(n.Y+p)),n.service.pageStream.writeLine1("{0} {1} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y+p));break}}if(a.shapeType.is(Ue)){let t=0,e=0,i=0;switch(i=(n.Height>n.Width?(e=n.Width/4,t=e):(t=Math.floor(n.Height/4),e=t),e/2),a.shapeType.direction){case b.Up:n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+t)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-(i+t)),n.service.convertToString(n.Y+t)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-(i+t)),n.service.convertToString(n.Top-e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-2*e),n.service.convertToString(n.Top-e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-e),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right),n.service.convertToString(n.Top-e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-i),n.service.convertToString(n.Top-e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-i),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y));break;case b.Left:n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.Right),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right),n.service.convertToString(n.Top-i)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+e),n.service.convertToString(n.Top-i)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+e),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Top-e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+e),n.service.convertToString(n.Top-2*e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+e),n.service.convertToString(n.Top-e-i)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-t),n.service.convertToString(n.Top-e-i)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-t),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l h "+r,n.service.convertToString(n.Right),n.service.convertToString(n.Y));break;case b.Down:n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.Right),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+i),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+i),n.service.convertToString(n.Y+e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+e),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+2*e),n.service.convertToString(n.Y+e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+e+i),n.service.convertToString(n.Y+e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+e+i),n.service.convertToString(n.Top-t)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right),n.service.convertToString(n.Top-t)),n.service.pageStream.writeLine1("{0} {1} l h "+r,n.service.convertToString(n.Right),n.service.convertToString(n.Top));break;case b.Right:n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+i)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-e),n.service.convertToString(n.Y+i)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-e),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right),n.service.convertToString(n.Y+e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-e),n.service.convertToString(n.Y+2*e)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-e),n.service.convertToString(n.Y+e+i)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+t),n.service.convertToString(n.Y+e+i)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+t),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Top));break}}if(a.shapeType.is(We)){var w=n.Width>n.Height?n.Height/2:n.Width/2;switch(a.shapeType.direction){case b.Right:n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+w),n.service.convertToString(n.Top-n.Height/2)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-w),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right),n.service.convertToString(n.Top-n.Height/2)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-w),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Top));break;case b.Left:n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.Right),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+w),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Top-n.Height/2)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+w),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right-w),n.service.convertToString(n.Top-n.Height/2)),n.service.pageStream.writeLine1("{0} {1} l h "+r,n.service.convertToString(n.Right),n.service.convertToString(n.Top));break;case b.Up:n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Top-w)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right),n.service.convertToString(n.Top-w)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y+w)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Top-w));break;case b.Down:n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Top-w)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.Right),n.service.convertToString(n.Y+w)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l",n.service.convertToString(n.X),n.service.convertToString(n.Y+w)),n.service.pageStream.writeLine1("{0} {1} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Top));break}}if(a.shapeType.is(Xe)&&(s=n.Height/3,m=4*n.service.hiToTwips,n.service.pageStream.writeLine1(e.getRectString4(n.X,n.Y+s+m,n.Width,s-2*m)+r),n.service.pageStream.writeLine1(e.getEllipseString4(n.X+n.Width/2-s/2,n.Top-n.service.hiToTwips-s,s,s)+r),n.service.pageStream.writeLine1(e.getEllipseString4(n.X+n.Width/2-s/2,n.Y+2*n.service.hiToTwips,s,s)+r)),a.shapeType.is(ze)&&(o=(n.Height-n.Height/6)/2,n.service.pageStream.writeLine1(e.getRectString4(n.X,n.Top-o,n.Width,o)+r),n.service.pageStream.writeLine1(e.getRectString4(n.X,n.Y,n.Width,o)+r)),a.shapeType.is(Ve)&&(n.service.pageStream.writeLine1("{0} {1} m {2} {3} l",n.service.convertToString(n.Right),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Top-n.Height/5),n.service.convertToString(n.X+n.Width/5),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Top))),a.shapeType.is(Ge))switch(a.shapeType.direction){case b.Down:case b.Up:n.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Top),n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y+n.Height/2)),n.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y+n.Height/2),n.service.convertToString(n.Right),n.service.convertToString(n.Y));break;case b.Left:case b.Right:n.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Top),n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y+n.Height/2)),n.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+r,n.service.convertToString(n.Right),n.service.convertToString(n.Y),n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y+n.Height/2),n.service.convertToString(n.Right),n.service.convertToString(n.Top));break}if(a.shapeType.is(Ye)&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Top-n.Height/2)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Top-n.Height/2),n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Top-n.Height/2))),a.shapeType.is(je)&&(n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Top-n.Height/5)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.Right),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Top-n.Height/5))),a.shapeType.is(_e)){var d=n.Height/5,S=n.Width/5;switch(a.shapeType.direction){case b.Down:n.service.pageStream.writeLine1("{0} {1} m {2} {3} l",n.service.convertToString(n.X),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.Right),n.service.convertToString(n.Y+d),n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Y+d),n.service.convertToString(n.X),n.service.convertToString(n.Top));break;case b.Up:n.service.pageStream.writeLine1("{0} {1} m {2} {3} l",n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Top-d)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Top-d),n.service.convertToString(n.Right),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Y));break;case b.Left:n.service.pageStream.writeLine1("{0} {1} m {2} {3} l",n.service.convertToString(n.X+S),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.Right),n.service.convertToString(n.Y),n.service.convertToString(n.X+S),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Top-n.Height/2),n.service.convertToString(n.X+S),n.service.convertToString(n.Top));break;case b.Right:n.service.pageStream.writeLine1("{0} {1} m {2} {3} l",n.service.convertToString(n.X),n.service.convertToString(n.Top),n.service.convertToString(n.Right-S),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.Right),n.service.convertToString(n.Top-n.Height/2),n.service.convertToString(n.Right-S),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Top));break}}if(a.shapeType.is(qe)){var u=n.Width/5,f=n.Height/5,v=n.Width/2,E=n.Height/2;switch(a.shapeType.direction){case b.Left:case b.Right:n.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",n.service.convertToString(n.X),n.service.convertToString(n.Top-E),n.service.convertToString(n.X+u),n.service.convertToString(n.Top),n.service.convertToString(n.Right-u),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.Right),n.service.convertToString(n.Top-E),n.service.convertToString(n.Right-u),n.service.convertToString(n.Y),n.service.convertToString(n.X+u),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Top-E));break;case b.Down:case b.Up:n.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",n.service.convertToString(n.X+v),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Top-f),n.service.convertToString(n.Right),n.service.convertToString(n.Y+f)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.X+v),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Y+f),n.service.convertToString(n.X),n.service.convertToString(n.Top-f),n.service.convertToString(n.X+v),n.service.convertToString(n.Top));break}}a.shapeType.is(Ke)&&(n.service.pageStream.writeLine1("{0} {1} m {2} {3} l",n.service.convertToString(n.X),n.service.convertToString(n.Top-n.Height/2),n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.Right),n.service.convertToString(n.Top-n.Height/2),n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Top-n.Height/2),n.service.convertToString(n.Right),n.service.convertToString(n.Top-n.Height/2))),a.shapeType.is(Qe)&&(m=n.Width/7,s=n.Height/7,n.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h",n.service.convertToString(n.X),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Y)),n.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.X+m),n.service.convertToString(n.Top-s),n.service.convertToString(n.X+m),n.service.convertToString(n.Y+s),n.service.convertToString(n.Right-m),n.service.convertToString(n.Y+s),n.service.convertToString(n.Right-m),n.service.convertToString(n.Top-s))),a.shapeType.is(Ze)&&(o=n.Height/3,n.service.pageStream.writeLine1(e.getRectString4(n.X,n.Y+o,n.Width,o)+r)),a.shapeType.is(Je)&&(m=n.Width/4,s=n.Height/4,n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X),n.service.convertToString(n.Top-s)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",n.service.convertToString(n.X+m),n.service.convertToString(n.Top),n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Top-s),n.service.convertToString(n.Right-m),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Top-s)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",n.service.convertToString(n.Right-m),n.service.convertToString(n.Top-n.Height/2),n.service.convertToString(n.Right),n.service.convertToString(n.Y+s),n.service.convertToString(n.Right-m),n.service.convertToString(n.Y),n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Y+s)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+r,n.service.convertToString(n.X+m),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Y+s),n.service.convertToString(n.X+m),n.service.convertToString(n.Top-n.Height/2))),a.shapeType.is($e)&&n.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.X+n.Width/5),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Top),n.service.convertToString(n.Right-n.Width/5),n.service.convertToString(n.Y)),a.shapeType.is(ti)&&(o=n.Width/3,s=n.Height/3,n.service.pageStream.writeLine1("{0} {1} m",n.service.convertToString(n.X+o),n.service.convertToString(n.Top)),
n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",n.service.convertToString(n.Right-o),n.service.convertToString(n.Top),n.service.convertToString(n.Right-o),n.service.convertToString(n.Top-s),n.service.convertToString(n.Right),n.service.convertToString(n.Top-s),n.service.convertToString(n.Right),n.service.convertToString(n.Y+s)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",n.service.convertToString(n.Right-o),n.service.convertToString(n.Y+s),n.service.convertToString(n.Right-o),n.service.convertToString(n.Y),n.service.convertToString(n.X+o),n.service.convertToString(n.Y),n.service.convertToString(n.X+o),n.service.convertToString(n.Y+s)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y+s),n.service.convertToString(n.X),n.service.convertToString(n.Top-s),n.service.convertToString(n.X+o),n.service.convertToString(n.Top-s),n.service.convertToString(n.X+o),n.service.convertToString(n.Top))),a.shapeType.is(ei)&&(m=n.Height/2.6,s=n.Width/5.5,n.service.pageStream.writeLine1("{0} {1} m {2} {3} l",n.service.convertToString(n.X),n.service.convertToString(n.Top-m),n.service.convertToString(n.X+n.Width/2),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.Right),n.service.convertToString(n.Top-m),n.service.convertToString(n.Right-s),n.service.convertToString(n.Y),n.service.convertToString(n.X+s),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Top-m))),a.shapeType.is(ii)&&(o=n.Width/4.75,n.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+r,n.service.convertToString(n.X),n.service.convertToString(n.Y),n.service.convertToString(n.X+o),n.service.convertToString(n.Top),n.service.convertToString(n.Right-o),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Y))),a.shapeType.is(ri)&&(s=n.Width/7.2,m=n.Height/4.6,n.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",n.service.convertToString(n.X),n.service.convertToString(n.Top-m),n.service.convertToString(n.X+s),n.service.convertToString(n.Top),n.service.convertToString(n.Right-s),n.service.convertToString(n.Top)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+r,n.service.convertToString(n.Right),n.service.convertToString(n.Top-m),n.service.convertToString(n.Right),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Y))),a.shapeType.is(ni)&&(o=n.Width/7.2,s=n.Height/4.6,n.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",n.service.convertToString(n.X),n.service.convertToString(n.Top),n.service.convertToString(n.Right-o),n.service.convertToString(n.Top),n.service.convertToString(n.Right),n.service.convertToString(n.Top-s)),n.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+r,n.service.convertToString(n.Right),n.service.convertToString(n.Y),n.service.convertToString(n.X+o),n.service.convertToString(n.Y),n.service.convertToString(n.X),n.service.convertToString(n.Y+s))),n.service.pageStream.writeLine("Q");var m=a.getParsedText();if(!pt.isNullOrWhiteSpace(m)){let t=new lt(a.clientRectangle),e=(t.text=m,t.font=a.font,t.textBrush=new Se(a.foreColor),t.horAlignment=a.horAlignment,t.vertAlignment=a.vertAlignment,t.margins=a.margins,t.wordWrap=!0,t.textQuality=at.a.Components.StiTextQuality.Typographic,t.page=a.page,n.clone());e.Component=t,at.c.StiPdfRenderText.renderTextFont(e),at.c.StiPdfRenderText.renderText(e)}}}static renderRoundedRectanglePrimitive(i){var r=i.Component.as(Ht);if(null!=r){var n=new w(r.border.color,r.border.size,r.border.style),a=i.Component.as(si);if(a.style==bt.None)return;var r=r.border.style!=bt.None&&r.border.style!=bt.Solid,s=(r&&(i.service.pageStream.writeLine("q"),i.service.pushColorToStack()),this.storeBorderSideData(n,i));let t=Math.min(i.Width<i.Height?i.Width:i.Height,100*i.Component.page.zoom)*a.round,e=t*(1-i.service.pdfCKT);var o=i.X-s,l=i.X+i.Width+s,m=i.X+i.Width/2,c=i.Y-s,g=i.Y+i.Height+s,n,h,p,s;a.leftSide&&(a.bottomSide?(i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(a.rightSide?m:l),i.service.convertToString(c)),i.service.pageStream.writeLine1("{0} {1} l",i.service.convertToString(o+t),i.service.convertToString(c)),i.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",i.service.convertToString(o+e),i.service.convertToString(c),i.service.convertToString(o),i.service.convertToString(c+e),i.service.convertToString(o),i.service.convertToString(c+t))):i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(o),i.service.convertToString(c)),a.topSide?(i.service.pageStream.writeLine1("{0} {1} l",i.service.convertToString(o),i.service.convertToString(g-t)),i.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",i.service.convertToString(o),i.service.convertToString(g-e),i.service.convertToString(o+e),i.service.convertToString(g),i.service.convertToString(o+t),i.service.convertToString(g)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(a.rightSide?m:l),i.service.convertToString(g))):i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(o),i.service.convertToString(g))),a.rightSide&&(a.bottomSide?(i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(a.leftSide?m:o),i.service.convertToString(c)),i.service.pageStream.writeLine1("{0} {1} l",i.service.convertToString(l-t),i.service.convertToString(c)),i.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",i.service.convertToString(l-e),i.service.convertToString(c),i.service.convertToString(l),i.service.convertToString(c+e),i.service.convertToString(l),i.service.convertToString(c+t))):i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(l),i.service.convertToString(c)),a.topSide?(i.service.pageStream.writeLine1("{0} {1} l",i.service.convertToString(l),i.service.convertToString(g-t)),i.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",i.service.convertToString(l),i.service.convertToString(g-e),i.service.convertToString(l-e),i.service.convertToString(g),i.service.convertToString(l-t),i.service.convertToString(g)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(a.leftSide?m:o),i.service.convertToString(g))):i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(l),i.service.convertToString(g))),!a.topSide||a.leftSide||a.rightSide||(i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(o),i.service.convertToString(g)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(l),i.service.convertToString(g))),!a.bottomSide||a.leftSide||a.rightSide||(i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(o),i.service.convertToString(c)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(l),i.service.convertToString(c))),n.style==bt.Double&&(t-=2*s,e=t*(1-i.service.pdfCKT),n=i.X+s,h=i.X+i.Width-s,p=i.Y+s,s=i.Y+i.Height-s,a.leftSide&&(a.bottomSide?(i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(a.rightSide?m:l),i.service.convertToString(p)),i.service.pageStream.writeLine1("{0} {1} l",i.service.convertToString(n+t),i.service.convertToString(p)),i.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",i.service.convertToString(n+e),i.service.convertToString(p),i.service.convertToString(n),i.service.convertToString(p+e),i.service.convertToString(n),i.service.convertToString(p+t))):i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(n),i.service.convertToString(c)),a.topSide?(i.service.pageStream.writeLine1("{0} {1} l",i.service.convertToString(n),i.service.convertToString(s-t)),i.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",i.service.convertToString(n),i.service.convertToString(s-e),i.service.convertToString(n+e),i.service.convertToString(s),i.service.convertToString(n+t),i.service.convertToString(s)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(a.rightSide?m:l),i.service.convertToString(s))):i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(n),i.service.convertToString(g))),a.rightSide&&(a.bottomSide?(i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(a.leftSide?m:o),i.service.convertToString(p)),i.service.pageStream.writeLine1("{0} {1} l",i.service.convertToString(h-t),i.service.convertToString(p)),i.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",i.service.convertToString(h-e),i.service.convertToString(p),i.service.convertToString(h),i.service.convertToString(p+e),i.service.convertToString(h),i.service.convertToString(p+t))):i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(h),i.service.convertToString(c)),a.topSide?(i.service.pageStream.writeLine1("{0} {1} l",i.service.convertToString(h),i.service.convertToString(s-t)),i.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",i.service.convertToString(h),i.service.convertToString(s-e),i.service.convertToString(h-e),i.service.convertToString(s),i.service.convertToString(h-t),i.service.convertToString(s)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(a.leftSide?m:o),i.service.convertToString(s))):i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(h),i.service.convertToString(g))),!a.topSide||a.leftSide||a.rightSide||(i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(o),i.service.convertToString(s)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(l),i.service.convertToString(s))),!a.bottomSide||a.leftSide||a.rightSide||(i.service.pageStream.writeLine1("{0} {1} m",i.service.convertToString(o),i.service.convertToString(p)),i.service.pageStream.writeLine1("{0} {1} l S",i.service.convertToString(l),i.service.convertToString(p)))),r&&(i.service.pageStream.writeLine("Q"),i.service.popColorFromStack())}}static renderCheckbox(e,i,r=!0){let n=e.Component.as(nt);if(null!=n){let t=null;switch(i?n.checkStyleForTrue:n.checkStyleForFalse){case ai.Cross:t="62.568 52.024 m 62.018 52.166 60.405 52.537 58.984 52.848 c 55.336 53.645 49.313 58.685 44.741 64.767 c 40.839 69.958 l 45.919 71.092 l \r\n"+"53.272 72.735 59.559 76.81 67.746 85.239 c 74.954 92.661 l 68.543 100.174 l 56.77 113.972 54.196 123.193 59.915 131.088 c 62.809 135.083 71.734 143.458 73.097 143.458 c \r\n"+"73.509 143.458 74.16 141.77 74.546 139.708 c 75.526 134.457 81.002 122.942 85.482 116.708 c 87.557 113.82 89.473 111.458 89.74 111.458 c \r\n"+"90.006 111.458 93.515 114.945 97.537 119.208 c 113.934 136.584 127.211 138.972 135.818 126.095 c 139.973 119.877 140.004 118.024 135.958 117.739 c \r\n"+"130.11 117.329 118.795 109.205 110.443 99.42 c 105.812 93.994 l 110.69 89.679 l 117.241 83.884 129.589 77.786 136.531 76.919 c \r\n"+"139.576 76.539 142.068 75.813 142.068 75.307 c 142.068 72.526 132.802 60.889 129.038 58.942 c 121.077 54.825 112.668 58.23 96.273 72.209 c \r\n"+"91.287 76.46 l 84.2 67.488 l 80.303 62.554 75.379 57.368 73.259 55.965 c 69.353 53.38 64.393 51.552 62.568 52.024 c h";break;case ai.Check:t="60.972 37.503 m 51.173 63.277 43.562 76.623 35.37 82.397 c 30.912 85.54 l 33.664 88.435 l 37.539 92.513 43.698 95.935 48.566 96.713 c \r\n"+"52.426 97.33 53.024 97.093 57.102 93.334 c 59.763 90.882 63.368 85.726 66.269 80.223 c 68.899 75.234 71.18 71.153 71.337 71.153 c \r\n"+"71.493 71.153 73.65 74.19 76.13 77.903 c 96.259 108.044 129.683 141.214 157.565 158.718 c 166.414 164.274 l 168.677 161.643 l \r\n"+"170.941 159.012 l 163.178 152.717 l 139.859 133.81 108.017 94.486 89.043 61.164 c 82.362 49.432 81.87 48.851 73.952 43.345 c \r\n"+"69.45 40.214 64.908 37.04 63.858 36.292 c 62.149 35.074 61.848 35.2 60.972 37.503 c h";break;case ai.CrossRectangle:t="24.153 97.958 m 24.153 170.458 l 98.653 170.458 l 173.153 170.458 l 173.153 97.958 l 173.153 25.458 l 98.653 25.458 l 24.153 25.458 l 24.153 97.958 l h \r\n"+"157.911 97.708 m 157.653 154.958 l 98.653 154.958 l 39.653 154.958 l 39.393 98.958 l 39.25 68.158 39.348 42.395 39.611 41.708 c \r\n"+"39.987 40.727 52.819 40.458 99.129 40.458 c 158.169 40.458 l 157.911 97.708 l h \r\n"+"67.337 54.521 m 65.513 54.912 62.41 56.378 60.442 57.778 c 57.123 60.14 48.153 70.186 48.153 71.541 c 48.153 71.87 50.57 72.68 53.525 73.342 c \r\n"+"60.71 74.95 67.272 79.277 75.328 87.718 c 82.003 94.713 l 75.624 102.027 l 64.931 114.288 61.644 123.705 65.472 131.108 c \r\n"+"67.054 134.168 78.562 145.458 80.098 145.458 c 80.556 145.458 81.245 143.77 81.63 141.708 c 82.611 136.457 88.086 124.942 92.567 118.708 c \r\n"+"94.642 115.82 96.558 113.458 96.824 113.458 c 97.091 113.458 100.6 116.945 104.622 121.208 c 121.019 138.584 134.296 140.972 142.903 128.095 c \r\n"+"147.058 121.877 147.089 120.024 143.043 119.739 c 137.213 119.33 124.806 110.39 117.127 101.066 c 113.226 96.33 113.155 96.112 114.876 94.198 c \r\n"+"118.066 90.648 128.579 83.654 133.847 81.578 c 136.682 80.461 141.285 79.244 144.077 78.873 c 146.868 78.503 149.153 77.878 149.153 77.484 c \r\n"+"149.153 75.37 140.777 64.275 137.501 62.048 c 129.107 56.344 120.869 59.278 103.358 74.209 c 98.372 78.46 l 91.285 69.488 l \r\n"+"81.563 57.18 74.76 52.928 67.337 54.521 c h";break;case ai.CheckRectangle:t="19.915 96.5 m 19.915 169 l 91.857 169 l 163.8 169 l 170.357 173.111 l 176.914 177.223 l 178.882 174.861 l 179.963 173.563 180.864 172.217 180.882 171.872 c \r\n"+"180.9 171.526 178.44 169.334 175.415 167 c 169.915 162.757 l 169.915 93.378 l 169.915 24 l 94.915 24 l 19.915 24 l 19.915 96.5 l h \r\n"+"153.915 92.622 m 153.915 141.962 153.786 146.137 152.294 144.899 c 149.513 142.592 136.609 126.998 127.965 115.5 c 117.473 101.544 104.486 81.963 98.451 71 c \r\n"+"93.993 62.903 93.316 62.192 84.16 56 c 78.873 52.425 74.256 49.375 73.9 49.223 c 73.544 49.07 71.988 52.22 70.441 56.223 c \r\n"+"68.895 60.225 65.183 68.635 62.192 74.911 c 57.906 83.903 55.515 87.56 50.914 92.161 c 47.703 95.372 44.364 98 43.495 98 c \r\n"+"40.697 98 41.79 99.66 47.479 104.049 c 53.073 108.365 60.662 111.14 64.28 110.194 c 67.84 109.263 73.689 102.039 78.2 93.002 c \r\n"+"82.663 84.062 l 87.207 90.895 l 95.518 103.394 108.214 118.311 125.807 136.25 c 143.215 154 l 89.565 154 l 35.915 154 l 35.915 96.5 l \r\n"+"35.915 39 l 94.915 39 l 153.915 39 l 153.915 92.622 l h";break;case ai.CrossCircle:t="83.347 26.864 m 61.07 31.95 42.193 47.128 32.202 67.986 c 23.401 86.36 23.68 110.034 32.919 128.958 c 41.882 147.315 60.868 162.86 80.847 168.201 c \r\n"+"91.083 170.936 112.112 170.628 121.812 167.6 c 147.999 159.425 167.881 138.673 173.432 113.721 c 175.869 102.768 175 85.662 171.452 74.743 c \r\n"+"164.795 54.256 145.804 35.792 124.126 28.729 c 117.735 26.647 113.94 26.133 102.847 25.845 c 93.814 25.61 87.363 25.947 83.347 26.864 c h \r\n"+"112.414 41.542 m 129.545 44.672 146.131 57.503 153.827 73.579 c 168.725 104.698 152.719 141.239 119.425 152.119 c 112.712 154.313 109.49 154.763 100.347 154.781 c \r\n"+"90.993 154.8 88.185 154.404 81.579 152.131 c 64.423 146.231 51.91 134.6 45.14 118.265 c 42.988 113.072 42.446 109.911 42.069 100.368 c \r\n"+"41.551 87.229 42.811 81.166 48.181 70.958 c 52.288 63.15 63.613 51.864 71.549 47.67 c 83.611 41.295 98.688 39.034 112.414 41.542 c h \r\n"+"69.097 66.583 m 66.21 69.342 63.847 71.942 63.847 72.361 c 63.847 72.78 69.506 78.671 76.422 85.451 c 88.996 97.78 l 76.198 110.607 l 63.4 123.434 l \r\n"+"68.336 128.446 l 71.051 131.202 73.641 133.458 74.091 133.458 c 74.542 133.458 80.666 127.846 87.7 120.988 c 100.49 108.517 l 104.919 113.071 l \r\n"+"107.354 115.575 113.31 121.259 118.154 125.701 c 126.961 133.777 l 132.308 128.496 l 137.656 123.215 l 124.694 110.658 l 111.733 98.1 l 124.866 84.939 l \r\n"+"137.999 71.779 l 132.815 67.118 l 129.964 64.555 127.11 62.458 126.474 62.458 c 125.837 62.458 119.93 67.858 113.347 74.458 c \r\n"+"106.765 81.058 100.96 86.458 100.449 86.458 c 99.938 86.458 93.856 80.857 86.933 74.013 c 74.347 61.567 l 69.097 66.583 l h";break;case ai.DotCircle:t="81.653 29.406 m 59.375 34.493 40.499 49.67 30.507 70.529 c 21.706 88.903 21.985 112.576 31.224 131.5 c 40.187 149.857 59.173 165.402 79.153 170.743 c \r\n"+"89.388 173.479 110.417 173.17 120.117 170.142 c 146.304 161.968 166.186 141.215 171.737 116.263 c 174.174 105.311 173.305 88.205 169.757 77.285 c \r\n"+"163.1 56.798 144.109 38.334 122.431 31.271 c 116.04 29.189 112.245 28.675 101.153 28.387 c 92.119 28.152 85.668 28.49 81.653 29.406 c h \r\n"+"111.653 44.504 m 132.341 48.848 149.671 64.959 155.751 85.5 c 158.113 93.481 158.113 107.519 155.751 115.5 c 150.089 134.629 134.635 149.703 114.653 155.588 c \r\n"+"106.553 157.973 90.741 157.974 82.695 155.589 c 62.46 149.592 46.687 133.961 41.605 114.869 c 39.656 107.547 39.74 91.753 41.764 84.932 c \r\n"+"50.494 55.507 80.736 38.013 111.653 44.504 c h \r\n"+"90.005 77.33 m 76.55 82.362 69.825 98.176 75.898 110.5 c 78.035 114.836 83.045 119.856 87.653 122.277 c 93.231 125.208 104.066 125.204 109.705 122.27 c \r\n"+"127.735 112.887 128.781 89.485 111.62 79.428 c 106.047 76.162 95.789 75.166 90.005 77.33 c h";break;case ai.DotRectangle:t="23.847 98.805 m 23.847 171.305 l 98.347 171.305 l 172.847 171.305 l 172.847 98.805 l 172.847 26.305 l 98.347 26.305 l 23.847 26.305 l 23.847 98.805 l h \r\n"+"157.847 98.813 m 157.847 156.321 l 98.597 156.063 l 39.347 155.805 l 39.089 98.555 l 38.831 41.305 l 98.339 41.305 l 157.847 41.305 l 157.847 98.813 l h \r\n"+"63.527 64.959 m 63.153 65.333 62.847 80.638 62.847 98.972 c 62.847 132.305 l 98.361 132.305 l 133.874 132.305 l 133.611 98.555 l 133.347 64.805 l \r\n"+"98.777 64.542 l 79.763 64.398 63.901 64.585 63.527 64.959 c h";break;case ai.NoneCircle:t="83.5 29.406 m 61.222 34.493 42.346 49.67 32.355 70.529 c 23.554 88.903 23.832 112.576 33.071 131.5 c 42.034 149.857 61.02 165.402 81 170.743 c \r\n"+"91.235 173.479 112.265 173.17 121.965 170.142 c 148.151 161.968 168.034 141.215 173.585 116.263 c 176.022 105.311 175.152 88.205 171.605 77.285 c \r\n"+"164.948 56.798 145.957 38.334 124.278 31.271 c 117.887 29.189 114.092 28.675 103 28.387 c 93.966 28.152 87.515 28.49 83.5 29.406 c h \r\n"+"113.5 44.504 m 134.189 48.848 151.519 64.959 157.598 85.5 c 159.961 93.481 159.961 107.519 157.598 115.5 c 151.937 134.629 136.483 149.703 116.5 155.588 c \r\n"+"108.401 157.973 92.589 157.974 84.543 155.589 c 64.308 149.592 48.534 133.961 43.453 114.869 c 41.504 107.547 41.588 91.753 43.612 84.932 c \r\n"+"52.342 55.507 82.583 38.013 113.5 44.504 c h";break;case ai.NoneRectangle:t="24.153 97.958 m 24.153 170.458 l 98.653 170.458 l 173.153 170.458 l 173.153 97.958 l 173.153 25.458 l 98.653 25.458 l 24.153 25.458 l 24.153 97.958 l h \r\n"+"157.911 97.708 m 157.653 154.958 l 98.653 154.958 l 39.653 154.958 l 39.393 98.958 l 39.25 68.158 39.348 42.395 39.611 41.708 c \r\n"+"39.987 40.727 52.819 40.458 99.129 40.458 c 158.169 40.458 l 157.911 97.708 l h";break}e.service.pageStream.writeLine("q"),e.service.pushColorToStack();var i=Et.toColor(n.textBrush),i,r=(0!=i.a&&e.service.setNonStrokeColor(i),(n.textBrush.is(vt)||n.textBrush.is(yt))&&(r&&e.service.storeShadingData2(e.X,e.Y,e.Width,e.Height,n.textBrush),e.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+e.service.shadingCurrent)),n.textBrush.is(At)&&(i=n.textBrush,e.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",e.service.getHatchNumber(i)+1)),e.service.setStrokeColor(n.contourColor),e.service.pageStream.writeLine1("{0} w",e.service.convertToString(n.size)),e.service.pageStream.writeLine1("1 0 0 1 {0} {1} cm",e.service.convertToString(e.X+e.Width/2),e.service.convertToString(e.Y+e.Height/2)),Math.min(e.Width,e.Height)),a;e.service.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",e.service.convertToString(r/200)),e.service.pageStream.writeLine("1 0 0 1 -98 -98 cm"),e.service.pageStream.writeLine(t),e.service.pageStream.writeLine("B"),e.service.pageStream.writeLine("Q"),e.service.popColorFromStack()}}static getCheckBoxValue(e){let i=null;if(null!=e&&null!=e.checkedValue){i=!1;var r=e.checkedValue.toString().trim().toLowerCase(),e;let t=e.values.split("/");null!=(t=1==(t=1==t.length?e.values.split(";"):t).length?e.values.split(","):t)&&0<t.length&&(e=t[0].trim().toLowerCase(),i=r==e)}return i}};{class Ui{static renderText(y){let m=y.Component.as(Bt);var c=y.Component.as(Rt),A=y.Component.as(St),T=y.Component.as(Ct),h=y.Component.as(Ft);let p=y.Component.as(lt),w=null!=A&&A.textOptions.wordWrap;var P=null!=T&&T.horAlignment==wt.Width,d=y.service.haveAnnots&&p.editable,J=null!=A&&null!=A.textOptions&&A.textOptions.rightToLeft;let S=null;var L=0;let C=0;var F=p.textQuality==at.a.Components.StiTextQuality.Wysiwyg,k=(P&&(w=!0),y.service.pdfFont.UseUnicode);if(null!=c){var I=p.margins,B=this.hiToTwips*I.left,D=this.hiToTwips*I.right,R=this.hiToTwips*I.top,I=this.hiToTwips*I.bottom,B;let v=y.X+B,E=y.Y+I,b=y.Width-B-D,e=y.Height-R-I,t=0,i=0,r=0,n=0,a=(p.border.style!=bt.None&&(B=p.border.getSizeOffset(),p.border.isLeftBorderSidePresent&&(t=B),p.border.isRightBorderSidePresent&&(i=B),p.border.isTopBorderSidePresent&&(r=B),p.border.isBottomBorderSidePresent&&(n=B)),p.border.stimulsoft().as(Mt));null!=a&&(t=a.leftSide.getSizeOffset(),i=a.rightSide.getSizeOffset(),r=a.topSide.getSizeOffset(),n=a.bottomSide.getSizeOffset());var D=.94,R;v+=this.hiToTwips*D*t,E+=this.hiToTwips*D*n,b-=this.hiToTwips*D*(t+i),e-=this.hiToTwips*D*(r+n),d||(y.service.pageStream.writeLine("q"),y.service.pushColorToStack(),y.service.pageStream.writeLine1("{0} {1} {2} {3} re W n",y.service.convertToString(y.X),y.service.convertToString(y.Y),y.service.convertToString(y.Width),y.service.convertToString(y.Height)));let s=ht.transparent;if(null!=m)if(s=Et.toColor(m.textBrush),y.service.setNonStrokeColor(s),y.service.storeShadingData2(y.X,y.Y,y.Width,y.Height,m.textBrush),(m.textBrush.is(vt)||m.textBrush.is(yt))&&y.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+y.service.shadingCurrent),m.textBrush.is(At)&&(R=m.textBrush.as(At),y.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",y.service.getHatchNumber(R)+1)),d){let t=y.service.annotsArray[y.service.annotsCurrent];t.FontColor=s}let x=1;var N=y.Component.as(Dt),I=1,B=(x=null!=N?N.font.sizeInPoints:x)*this.fontCorrectValue*y.service.pdfFont.tmASC/1e3*I,D=x*this.fontCorrectValue*y.service.pdfFont.tmDESC/1e3*-1*I,R=x*this.fontCorrectValue*y.service.pdfFont.tmExternal/1e3*I,$=x*this.fontCorrectValue*y.service.pdfFont.UnderscoreSize/1e3*I,tt=x*this.fontCorrectValue*y.service.pdfFont.UnderscorePosition/1e3*I,et=x*this.fontCorrectValue*y.service.pdfFont.StrikeoutSize/1e3*I,I=x*this.fontCorrectValue*y.service.pdfFont.StrikeoutPosition/1e3*I,R=B-D+R,M=R*p.lineSpacing,B=B,D=D,H,O,H;let o=!1,g=(null!=A&&(C=A.textOptions.angle,o=45<C&&C<135||225<C&&C<315),d&&(v-=y.X,E-=y.Y),0),l=(p.textQuality==at.a.Components.StiTextQuality.Standard&&(H=.35-.04*(14-x),O=(g=137.61)*(x*this.fontCorrectValue)/1e3,o?(E+=H+O,e-=2*(H+O)):(v+=H+O,b-=2*(H+O))),p.textQuality==at.a.Components.StiTextQuality.Typographic&&(H=.05+.009*(8-x),o?(E+=H,e-=2*H):(v+=H,b-=2*H)),c.text);if(null==l&&(l=""),l=y.service.stringReplace(l,"\r",""),l=y.service.stringReplace(l,"",""),d&&(S=y.service.stringReplace(c.text,"\n","")),0<b&&0<l.length){var O=v,H=E,c=b,U=e,W,it;null!=A&&0!=(C=A.textOptions.angle)&&(o&&(W=b,b=e,e=W),v=-b/2,E=-e/2);let d=at.c.StiExportUtils.splitString(l,!1);if(w)for(let c=0;c<d.length;c++){let i=d[c];if(i.length<2)continue;let e=new ut,r=0;while(r<i.length)if(ot.isWhitespace(i,r))e.append(i.charAt(r)),r++;else{let t=new ut;while(r<i.length&&!ot.isWhitespace(i,r))t.append(i.charAt(r)),r++;var X=y.service.bidi.convert(t,!1),X=(e.append(X),t.length-X.length);0<X&&e.append(pt.repeat(String.fromCharCode(0),X))}let n=[],a=e.toString();for(let t=0;t<i.length;t++)n[t]=y.service.pdfFont.UnicodeMap[a.charCodeAt(t)];let s=mt.create(Number,i.length),o=mt.create(Number,i.length),l=0,m=0;for(let t=0;t<n.length;t++)32<=n[t]&&(m+=y.service.pdfFont.Widths[n[t]-32]),9==n[t]&&(m+=this.getTabsSize(A,x,m+g)+g),s[t]=st.trunc(m),this.isWordWrapSymbol(a,t)&&0<t&&l++,o[t]=l;if(m*(x*this.fontCorrectValue)/1e3>b){let t=i.length-1;var rt=st.trunc(1e3*b/(x*this.fontCorrectValue));while(s[t]>rt&&0<t)t--;let e=t;if(0<o[t])if(o[t]!=o[t+1]){e=t++;while(ot.isWhitespace(a,t)&&"\t"!=a.charAt(t))t++}else{while(!this.isWordWrapSymbol(a,t))t--;e=t-1;while(ot.isWhitespace(a,e)&&0<e)e--;while(ot.isWhitespace(a,t)&&"\t"!=a.charAt(t))t++}else t++;d[c]=P?i.substr(0,e+1)+this.charCode07:i.substr(0,e+1),d.stimulsoft().insert(c+1,i.substr(t,i.length-t).stimulsoft().trimStart(" "))}}var L=d.length,z=-1,h,W,D;for(let r=0;r<d.length;r++){let t=d[r],e=(0!=y.service.pdfFont.UnicodeMap[160]&&65535==y.service.pdfFont.GlyphList[y.service.pdfFont.UnicodeMap[160]]&&(t=y.service.stringReplace(t," "," ")),y.service.bidi.convert(new ut(t),J).toString()),i="";for(let t=0;t<e.length;t++)i+=String.fromCharCode(y.service.pdfFont.UnicodeMap[e.charCodeAt(t)]);d[r]=i}if(null!=h){var W=(L-1)*M+R;let t=h.vertAlignment;(t=0!=C&&90!=C&&180!=C&&270!=C?dt.Center:t)==dt.Top&&(E+=e-W+(R-B)),t==dt.Center&&(p.textQuality==at.a.Components.StiTextQuality.Typographic?E+=(e-W)/2-D:E+=(e-W)/2+1.2*(R-B)),t==dt.Bottom&&(p.textQuality==at.a.Components.StiTextQuality.Typographic?E+=-D:E+=1.4*(R-B))}y.service.pageStream.writeLine("BT");let t=0,S=0,u=mt.create2(Number,d.length,3),f=null;0!=C&&(h=C*Math.PI/180,f=new Tt(Math.cos(h),Math.sin(h),-Math.sin(h),Math.cos(h),O+c/2,H+U/2),y.service.pdfFont.NeedSyntItalic&&null!=N&&N.font.italic||y.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",y.service.convertToString(f.elements[0]),y.service.convertToString(f.elements[1]),y.service.convertToString(f.elements[2]),y.service.convertToString(f.elements[3]),y.service.convertToString(f.elements[4]),y.service.convertToString(f.elements[5]))),y.service.pdfFont.NeedSyntBold&&null!=N&&N.font.bold&&(y.service.pageStream.writeLine1("{0} w 2 Tr",y.service.convertToString(this.boldFontStrokeWidthValue*x,3)),y.service.setStrokeColor(s));for(let w=0;w<L;w++){let n=d[w],r=mt.create(Number,n.length),e=0,a=0,i=0;var nt=1e3*b/(x*this.fontCorrectValue),V=y.service.pdfFont.Widths[y.service.pdfFont.UnicodeMap["…".charCodeAt(0)]];let s=0;for(let t=0;t<n.length;t++){var G=n.charCodeAt(t),G;32<=G&&(a+=y.service.pdfFont.Widths[G-32]),9==G&&(G=this.getTabsSize(A,x,a),a+=G,r[e++]=G),a+V<nt&&(i=a,s=t)}if(a=a*(x*this.fontCorrectValue)/1e3,-1!=z&&(w==L-1&&z<d.length||a>b)&&(n=n.substr(0,s)+String.fromCharCode(y.service.pdfFont.UnicodeMap["…".charCodeAt(0)]),a=(i+V)*(x*this.fontCorrectValue)/1e3),k){let e=new ut;for(let t=0;t<n.length;t++){t%121==120&&e.appendLine("\r");var Y=n.charCodeAt(t);if(32==Y||9==Y||7==Y)e.append(n.charAt(t));else{let t=y.service.pdfFont.GlyphList[Y];65535==t&&(t=0),e.appendFormat("{0:X4}",t)}}n=e.toString()}else n=at.c.StiPdfExportService.convertToEscapeSequence(n);let o=v;var j=E+M*(L-w-1),_;let l=!1,m=!1;if(null!=T){let t=T.horAlignment;if(P&&(0<n.length&&7===n.charCodeAt(n.length-1)?n=n.substr(0,n.length-1):t=wt.Left),0!=C&&90!=C&&180!=C&&270!=C&&(t=wt.Center),null!=A&&null!=A.textOptions&&A.textOptions.rightToLeft&&(t==wt.Left?t=wt.Right:t==wt.Right&&(t=wt.Left)),t==wt.Center&&(o+=(b-a)/2),t==wt.Right&&(o+=b-a),t==wt.Width){let e=0;for(let t=0;t<n.length;t++)32===n.charCodeAt(t)&&e++;if(0<e&&(w!=d.length-1||F&&a>b)){m=!0;let i=(b-a)/e*1e3/(x*this.fontCorrectValue);if(0<i||F){l=!0,(i+=y.service.pdfFont.Widths[0])<.5*y.service.pdfFont.Widths[0]&&(i=.5*y.service.pdfFont.Widths[0]);let e=k?"<":"(";for(let t=0;t<n.length;t++)32===n.charCodeAt(t)?e+=k?">-"+y.service.convertToString(i)+"<":")-"+y.service.convertToString(i)+"(":e+=n[t];e+=k?">":")",n=e}}}}if(0<e){let e=0,i="";0==m&&(i+=k?"<":"(");for(let t=0;t<n.length;t++){"\t"==n[t]?(_=r[e++],i+=k?">-"+y.service.convertToString(_)+"<":")-"+y.service.convertToString(_)+"("):i+=n[t]}0==m&&(i+=k?">":")"),n=i}k&&(n=y.service.stringReplace(n," ",y.service.pdfFont.GlyphList[32].toString(16).toUpperCase().stimulsoft().padLeft(4,"0")).stimulsoft().replaceAll(this.charCode07,"0000"));var q=null!=y.service.pdfFont.ChildFontsMap;let c=0,g=mt.create(Number,n.length),h=new Array;for(let r=0;r<n.length;r++){var K=n.charCodeAt(r);let i=!1;if(13==(g[r]=K)&&(h.push(r),i=!0),q){let t=y.service.pdfFont.UnicodeMapBack[K],e=(92==K&&(t=y.service.pdfFont.UnicodeMapBack[n.charCodeAt(r+1)]),y.service.pdfFont.ChildFontsMap[t]);t<64&&(0<r?e=c:1<n.length&&(e=y.service.pdfFont.ChildFontsMap[y.service.pdfFont.UnicodeMapBack[n.charCodeAt(1)]])),92!=K&&(g[r]=y.service.pdfFont.fonts[e].UnicodeMap[t]),e==c||i||0==r||h.push(r),c=e}}if(h.push(n.length),u[w][0]=o,u[w][1]=j,u[w][2]=a,y.service.pdfFont.NeedSyntItalic&&null!=N&&N.font.italic){let t=new Tt(1,0,this.italicAngleTanValue,1,o,j);null!=f&&t.multiplyAppend(t),y.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",y.service.convertToString(t.elements[0]),y.service.convertToString(t.elements[1]),y.service.convertToString(t.elements[2]),y.service.convertToString(t.elements[3]),y.service.convertToString(t.elements[4]),y.service.convertToString(t.elements[5]))}else y.service.pageStream.writeLine1("{0} {1} Td",y.service.convertToString(o-t),y.service.convertToString(j-S)),t=o,S=j;let p=0;for(let t=0;t<h.length;t++){var Q,Q,Q=(q&&0<n.length&&(Q=n.charCodeAt(p)<64&&n.length>p+1?p+1:p,Q=y.service.pdfFont.ChildFontsMap[y.service.pdfFont.UnicodeMapBack[n.charCodeAt(Q)]],y.service.pageStream.writeLine1("/F{0} {1} Tf",Q,y.service.convertToString(x*this.fontCorrectValue,this.precision_digits_font))),h[t]),Z=Q-p;0<Z&&(l||0<e?(y.service.pageStream.writeString("["),0<t&&y.service.pageStream.writeString(k?"<":"("),y.service.pageStream.write(g,p,Z),t<h.length-1&&y.service.pageStream.writeString(k?">":")"),y.service.pageStream.writeLine("] TJ")):(y.service.pageStream.writeString(k?"<":"("),y.service.pageStream.write(g,p,Z),y.service.pageStream.writeLine1("{0} Tj",k?">":")"))),(p=Q)<g.length-1&&13==g[Q]&&p++}}if(y.service.pdfFont.NeedSyntBold&&null!=N&&N.font.bold&&y.service.pageStream.writeLine("0 Tr"),y.service.pageStream.writeLine("ET"),null!=N&&N.font.underline){y.service.pageStream.writeLine("q"),y.service.pushColorToStack();let t=.07*x,e=.1*-x;0!=y.service.pdfFont.UnderscoreSize&&(t=$,e=tt),t<.1&&(t=.1),y.service.pageStream.writeLine1("{0} w",y.service.convertToString(t)),0!=C&&(W=C*Math.PI/180,y.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",y.service.convertToString(Math.cos(W)),y.service.convertToString(Math.sin(W)),y.service.convertToString(-Math.sin(W)),y.service.convertToString(Math.cos(W)),y.service.convertToString(O+c/2),y.service.convertToString(H+U/2))),null!=m&&y.service.setStrokeColor(s);for(let t=0;t<d.length;t++)0!=u[t][2]&&(y.service.pageStream.writeLine1("{0} {1} m",y.service.convertToString(u[t][0]),y.service.convertToString(u[t][1]+e)),y.service.pageStream.writeLine1("{0} {1} l S",y.service.convertToString(u[t][0]+u[t][2]),y.service.convertToString(u[t][1]+e)));y.service.pageStream.writeLine("Q"),y.service.popColorFromStack()}if(null!=N&&N.font.strikeout){y.service.pageStream.writeLine("q"),y.service.pushColorToStack();let t=.045*x,e=.25*x;0!=y.service.pdfFont.StrikeoutSize&&(t=et,e=I),t<.1&&(t=.1),y.service.pageStream.writeLine1("{0} w",y.service.convertToString(t)),0!=C&&(D=C*Math.PI/180,y.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",y.service.convertToString(Math.cos(D)),y.service.convertToString(Math.sin(D)),y.service.convertToString(-Math.sin(D)),y.service.convertToString(Math.cos(D)),y.service.convertToString(O+c/2),y.service.convertToString(H+U/2))),null!=m&&y.service.setStrokeColor(s);for(let t=0;t<d.length;t++)0!=u[t][2]&&(y.service.pageStream.writeLine1("{0} {1} m",y.service.convertToString(u[t][0]),y.service.convertToString(u[t][1]+e)),y.service.pageStream.writeLine1("{0} {1} l S",y.service.convertToString(u[t][0]+u[t][2]),y.service.convertToString(u[t][1]+e)));y.service.pageStream.writeLine("Q"),y.service.popColorFromStack()}}if(d){let e=y.service.annotsArray[y.service.annotsCurrent];if(e.Multiline=w,e.X=y.X,e.Y=y.Y,e.Width=y.Width,e.Height=y.Height,e.Text=S,e.Component=y.Component,e.Alignment=wt.Left,null!=T){let t=T.horAlignment;null!=A&&null!=A.textOptions&&A.textOptions.rightToLeft&&(t==wt.Left?t=wt.Right:t==wt.Right&&(t=wt.Left)),e.Alignment=t}}d||(y.service.pageStream.writeLine("Q"),y.service.popColorFromStack())}}static isWordWrapSymbol(t,e){var i=t.charCodeAt(e),r=t.charAt(e);if(12288<=i&&i<=55215||ot.isWhitespace(t,e)&&160!=i||"("==r||"{"==r)return!0;if(0<e){var i=t.charCodeAt(e-1);if(12288<=i&&i<=55215)return!0;var r=t.charAt(e-1);if("!"==r||"%"==r||")"==r||"}"==r||"-"==r||"?"==r)return!0}return!1}static getTabsSize(e,i,r){if(null!=e&&null!=e.textOptions){let t=r;var i=750/i,n=i*e.textOptions.distanceBetweenTabs,i=i*e.textOptions.firstTabOffset+n,e;return r<i?t=i:0<e.textOptions.distanceBetweenTabs&&(e=st.trunc((r-i)/n),e++,t=i+e*n),t-r}return 0}static renderTextFont(e){var i=e.Component.as(Dt);if(null!=i){var r=e.service.pdfFont.getFontNumber(i.font),i=i.font.sizeInPoints*this.fontCorrectValue;if(e.service.pageStream.writeLine1("/F{0} {1} Tf",r,e.service.convertToString(i,this.precision_digits_font)),e.service.pdfFont.currentFont=r,e.service.haveAnnots&&e.Component.as(lt).editable){let t=e.service.annotsArray[e.service.annotsCurrent];t.FontNumber=r,t.FontSize=i}}}static renderText2(m,c=-1){var t=m.Component.as(Rt),e=m.Component.as(St);let g=m.Component.as(lt);if(null==t||m.Width<=0)return;if(pt.isNullOrWhiteSpace(t.text))return;var i=m.service.haveAnnots&&g.editable;let h=0;var r=g.margins,n=0,a=n*r.left,M=n*r.right,H=n*r.top,n=n*r.bottom;let p=m.X+a,w=m.Y+n,s=m.Width-a-M,o=m.Height-H-n;if(s<=0)return;i||(m.service.pageStream.writeLine("q"),m.service.pushColorToStack(),m.service.pageStream.writeLine1("{0} {1} {2} {3} re W n",m.service.convertToString(m.X),m.service.convertToString(m.Y),m.service.convertToString(m.Width),m.service.convertToString(m.Height)));let d=!1;null!=e&&(h=e.textOptions.angle,d=45<h&&h<135||225<h&&h<315),i&&(p-=m.X,w-=m.Y);var S=p,u=w,f=s,v=o,r,a=(null!=e&&0!=(h=e.textOptions.angle)&&(d&&(r=s,s=o,o=r),p=-s/2,w=-o/2),[]),E=[];if(q.drawTextForOutput(g,a,E),rt["StiOptions"].Export.Pdf.useProperCaseFontNamesFromHtml)for(var l of E){var b=l.fontName,O,x;let e=!1;for(let t=0;t<b.length;t++)if(ot.isUpper(b,t)){e=!0;break}if(!e){let t=rt.System.Globalization.CultureInfo.InvariantCulture.textInfo.toTitleCase(b),e=null;if(-1!=t.indexOf(",")){for(x of t.split(","))if((e=new j(x,l.fontBase.size,l.fontBase.style)).name.toLowerCase()==x.toLowerCase())break}else e=new j(t,l.fontBase.size,l.fontBase.style);l.fontBase=e,l.fontName=e.name}}var U=Et.toColor(g.brush);let y=!1;var A=g.page.unit.convertRectangleToHInches(m.Component.componentToPage(m.Component.clientRectangle)),T=g.convertTextMargins(A,!1),T=g.convertTextBorders(T,!1),P;for(P of a){let i=p+this.hiToTwips*(T.left+P.xPos-A.left),r=w+this.hiToTwips*(A.bottom-(T.top+P.yPos));d&&(i=p+this.hiToTwips*(A.bottom-T.bottom+P.xPos),r=w+this.hiToTwips*(A.right-(T.left+P.yPos))),m.service.pageStream.writeLine("q"),m.service.pushColorToStack();var L=E[P.fontIndex].fontBase,C=m.service.pdfFont.getFontNumber(L),F=L.sizeInPoints*this.fontCorrectValue,k=(m.service.pageStream.writeLine1("/F{0} {1} Tf",C,m.service.convertToString(F,this.precision_digits_font)),m.service.pdfFont.currentFont=C,m.service.pdfFont.UseUnicode),F=L.sizeInPoints,C=1,I=F*this.fontCorrectValue*m.service.pdfFont.tmASC/1e3*C,B=F*this.fontCorrectValue*m.service.pdfFont.tmDESC/1e3*-1*C,D=F*this.fontCorrectValue*m.service.pdfFont.tmExternal/1e3*C,R=F*this.fontCorrectValue*m.service.pdfFont.UnderscoreSize/1e3*C,W=F*this.fontCorrectValue*m.service.pdfFont.UnderscorePosition/1e3*C,X=F*this.fontCorrectValue*m.service.pdfFont.StrikeoutSize/1e3*C,C=F*this.fontCorrectValue*m.service.pdfFont.StrikeoutPosition/1e3*C,D=(I-B+D)*g.lineSpacing,I=I,z=B;let n=!0;if(k&&-1==P.glyphIndexList[0]){n=!1;for(let t=0;t<P.text.length;t++)P.glyphIndexList[t]=m.service.pdfFont.GlyphList[m.service.pdfFont.UnicodeMap[P.text.charCodeAt(t)]]}r-=I;let a=0,s=0;for(let i=0;i<P.glyphIndexList.length;i++){let t=P.text.charCodeAt(i);k&&n&&(t=P.glyphIndexList[i],t=m.service.pdfFont.GlyphBackList[t]);var V=m.service.pdfFont.UnicodeMap[t];let e=1e3;32<=V&&(e=m.service.pdfFont.Widths[V-32]),0==t&&null!=m.service.pdfFont.GlyphWidths&&(e=m.service.pdfFont.GlyphWidths[P.glyphIndexList[i]]),e*=P.scaleList[i],k?0<P.glyphWidths[i]&&(a+=P.glyphWidths[i],s+=e):(a+=P.widths[i],s+=e)}var I=a*this.hiToTwips,G=I/(F*this.fontCorrectValue/1e3)/s,B,B,B,B,B,R;(y=y||P.backColor.equals(U)?y:!0)&&0!=P.backColor.a&&(m.service.setNonStrokeColor(P.backColor),m.service.pageStream.writeLine1("{0} {1} {2} {3} re f",m.service.convertToString(i),m.service.convertToString(r- -B),m.service.convertToString(I),m.service.convertToString(D))),m.service.setNonStrokeColor(P.textColor);let o=new ut,l=(a=0,s=0);o.append(k?"<":"(");for(let r=0;r<P.glyphIndexList.length;r++){let t=P.text.charCodeAt(r);k&&n&&(t=P.glyphIndexList[r],t=m.service.pdfFont.GlyphBackList[t]);var N=m.service.pdfFont.UnicodeMap[t];let e=1e3,i=(32<=N&&(e=m.service.pdfFont.Widths[N-32]),0);if(0<(k?P.glyphWidths:P.widths)[r]?(s+=e*P.scaleList[r],l+=e,i=-(s*G-l),l+=-i):i=e,k){let t=P.glyphIndexList[r];65535==t&&(t=0),o.appendFormat("{0:X4}",t),r<P.glyphIndexList.length-1&&o.append(">"+m.service.convertToString(i)+"<")}else o.append(at.c.StiPdfExportService.convertToEscapeSequencePlusTabs(String.fromCharCode(N))),r<P.glyphIndexList.length-1&&o.append(")"+m.service.convertToString(i)+"(")}o.append(k?">":")");let e=mt.create(Number,o.length);for(let t=0;t<o.length;t++)e[t]=o.charCodeAt(t);m.service.pageStream.writeLine("BT");let t=null;if(0!=h&&(B=h*Math.PI/180,t=new Tt(Math.cos(B),Math.sin(B),-Math.sin(B),Math.cos(B),S+f/2,u+v/2),B=new Tt(1,0,0,1,i,r),t.multiplyPrepend(B)),m.service.pdfFont.NeedSyntItalic&&L.italic&&(null!=t?(B=new Tt(1,0,this.italicAngleTanValue,1,0,0),t.multiplyPrepend(B)):(B=new Tt(1,0,this.italicAngleTanValue,1,i,r),t=B)),null!=t?m.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",m.service.convertToString(t.elements[0],7),m.service.convertToString(t.elements[1],7),m.service.convertToString(t.elements[2],7),m.service.convertToString(t.elements[3],7),m.service.convertToString(t.elements[4],6),m.service.convertToString(t.elements[5],6)):m.service.pageStream.writeLine1("{0} {1} Td",m.service.convertToString(i),m.service.convertToString(r)),m.service.pdfFont.NeedSyntBold&&L.bold&&(m.service.pageStream.writeLine1("{0} w 2 Tr",m.service.convertToString(this.boldFontStrokeWidthValue*F*this.fontCorrectValue,this.precision_digits_font)),m.service.setStrokeColor(P.textColor)),m.service.pageStream.writeString("["),m.service.pageStream.flush(),m.service.pageStream.write(e,0,e.length),m.service.pageStream.writeLine("] TJ"),m.service.pageStream.writeLine("ET"),m.service.pdfFont.NeedSyntBold&&L.bold&&m.service.pageStream.writeLine("0 Tr"),L.underline){m.service.pageStream.writeLine("q"),m.service.pushColorToStack();let t=.09*F,e=.115*-F;0!=m.service.pdfFont.UnderscoreSize&&(t=R,e=W),t<.1&&(t=.1),m.service.pageStream.writeLine1("{0} w",m.service.convertToString(t)),0!=h&&(B=h*Math.PI/180,m.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",m.service.convertToString(Math.cos(B),7),m.service.convertToString(Math.sin(B),7),m.service.convertToString(-Math.sin(B),7),m.service.convertToString(Math.cos(B),7),m.service.convertToString(S+f/2,6),m.service.convertToString(u+v/2,6))),m.service.setStrokeColor(P.textColor),m.service.pageStream.writeLine1("{0} {1} m",m.service.convertToString(i),m.service.convertToString(r+e)),m.service.pageStream.writeLine1("{0} {1} l S",m.service.convertToString(i+I),m.service.convertToString(r+e)),m.service.pageStream.writeLine("Q"),m.service.popColorFromStack()}if(L.strikeout){m.service.pageStream.writeLine("q"),m.service.pushColorToStack();let t=.09*F,e=.4*F;0!=m.service.pdfFont.StrikeoutSize&&(t=X,e=C),t<.1&&(t=.1),m.service.pageStream.writeLine1("{0} w",m.service.convertToString(t)),0!=h&&(R=h*Math.PI/180,m.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",m.service.convertToString(Math.cos(R),7),m.service.convertToString(Math.sin(R),7),m.service.convertToString(-Math.sin(R),7),m.service.convertToString(Math.cos(R),7),m.service.convertToString(S+f/2,6),m.service.convertToString(u+v/2,6))),m.service.setStrokeColor(P.textColor),m.service.pageStream.writeLine1("{0} {1} m",m.service.convertToString(i),m.service.convertToString(r+e)),m.service.pageStream.writeLine1("{0} {1} l S",m.service.convertToString(i+I),m.service.convertToString(r+e)),m.service.pageStream.writeLine("Q"),m.service.popColorFromStack()}if(m.service.pageStream.writeLine("Q"),m.service.popColorFromStack(),-1!=c&&!pt.isNullOrWhiteSpace(P.href)&&!P.href.trim().startsWith("javascript:")&&!m.service.usePdfA){let t=new at.c.StiLinkObject;t.Link=P.href,t.X=i,t.Y=r+z,t.Width=I,t.Height=D,t.Page=c,t.DestPage=-1,t.DestY=-1,m.service.linksArray.push(t)}}t.linesOfUnderline,bt.None,i||(m.service.pageStream.writeLine("Q"),m.service.popColorFromStack())}}Ui.hiToTwips=.72,Ui.precision_digits_font=3,Ui.fontCorrectValue=.955,Ui.boldFontStrokeWidthValue=.031,Ui.italicAngleTanValue=.325,Ui.charCode07=String.fromCharCode(7),at.c.StiPdfRenderText=Ui}{class Wi{static get standardFontCharsNames(){if(null==this._standardFontCharsNames){let e=["0020space","0021exclam","0022quotedbl","0023numbersign","0024dollar","0025percent","0026ampersand","0027quotesingle","0028parenleft","0029parenright","002Aasterisk","002Bplus","002Ccomma","002Dhyphen","002Eperiod","002Fslash","0030zero","0031one","0032two","0033three","0034four","0035five","0036six","0037seven","0038eight","0039nine","003Acolon","003Bsemicolon","003Cless","003Dequal","003Egreater","003Fquestion","0040at","0041A","0042B","0043C","0044D","0045E","0046F","0047G","0048H","0049I","004AJ","004BK","004CL","004DM","004EN","004FO","0050P","0051Q","0052R","0053S","0054T","0055U","0056V","0057W","0058X","0059Y","005AZ","005Bbracketleft","005Cbackslash","005Dbracketright","005Easciicircum","005Funderscore","0060grave","0061a","0062b","0063c","0064d","0065e","0066f","0067g","0068h","0069i","006Aj","006Bk","006Cl","006Dm","006En","006Fo","0070p","0071q","0072r","0073s","0074t","0075u","0076v","0077w","0078x","0079y","007Az","007Bbraceleft","007Cbar","007Dbraceright","007Easciitilde","007FcontrolDEL","00A0nbspace","00A1exclamdown","00A2cent","00A3sterling","00A4currency","00A5yen","00A6brokenbar","00A7section","00A8dieresis","00A9copyright","00AAordfeminine","00ABguillemotleft","00AClogicalnot","00ADsofthyphen","00AEregistered","00AFmacron","00B0degree","00B1plusminus","00B2twosuperior","00B3threesuperior","00B4acute","00B5mu","00B6paragraph","00B7periodcentered","00B8cedilla","00B9onesuperior","00BAordmasculine","00BBguillemotright","00BConequarter","00BDonehalf","00BEthreequarters","00BFquestiondown","00C0Agrave","00C1Aacute","00C2Acircumflex","00C3Atilde","00C4Adieresis","00C5Aring","00C6AE","00C7Ccedilla","00C8Egrave","00C9Eacute","00CAEcircumflex","00CBEdieresis","00CCIgrave","00CDIacute","00CEIcircumflex","00CFIdieresis","00D0Eth","00D1Ntilde","00D2Ograve","00D3Oacute","00D4Ocircumflex","00D5Otilde","00D6Odieresis","00D7multiply","00D8Oslash","00D9Ugrave","00DAUacute","00DBUcircumflex","00DCUdieresis","00DDYacute","00DEThorn","00DFgermandbls","00E0agrave","00E1aacute","00E2acircumflex","00E3atilde","00E4adieresis","00E5aring","00E6ae","00E7ccedilla","00E8egrave","00E9eacute","00EAecircumflex","00EBedieresis","00ECigrave","00EDiacute","00EEicircumflex","00EFidieresis","00F0eth","00F1ntilde","00F2ograve","00F3oacute","00F4ocircumflex","00F5otilde","00F6odieresis","00F7divide","00F8oslash","00F9ugrave","00FAuacute","00FBucircumflex","00FCudieresis","00FDyacute","00FEthorn","00FFydieresis","0100Amacron","0101amacron","0102Abreve","0103abreve","0104Aogonek","0105aogonek","0106Cacute","0107cacute","0108Ccircumflex","0109ccircumflex","010ACdotaccent","010Bcdotaccent","010CCcaron","010Dccaron","010EDcaron","010Fdcaron","0110Dcroat","0111dcroat","0112Emacron","0113emacron","0114Ebreve","0115ebreve","0116Edotaccent","0117edotaccent","0118Eogonek","0119eogonek","011AEcaron","011Becaron","011CGcircumflex","011Dgcircumflex","011EGbreve","011Fgbreve","0120Gdotaccent","0121gdotaccent","0122Gcommaaccent","0123gcommaaccent","0124Hcircumflex","0125hcircumflex","0126Hbar","0127hbar","0128Itilde","0129itilde","012AImacron","012Bimacron","012CIbreve","012Dibreve","012EIogonek","012Fiogonek","0130Idotaccent","0131dotlessi","0132IJ","0133ij","0134Jcircumflex","0135jcircumflex","0136Kcommaaccent","0137kcommaaccent","0138kgreenlandic","0139Lacute","013Alacute","013BLcommaaccent","013Clcommaaccent","013DLcaron","013Elcaron","013FLdot","0140ldot","0141Lslash","0142lslash","0143Nacute","0144nacute","0145Ncommaaccent","0146ncommaaccent","0147Ncaron","0148ncaron","0149napostrophe","014AEng","014Beng","014COmacron","014Domacron","014EObreve","014Fobreve","0150Ohungarumlaut","0151ohungarumlaut","0152OE","0153oe","0154Racute","0155racute","0156Rcommaaccent","0157rcommaaccent","0158Rcaron","0159rcaron","015ASacute","015Bsacute","015CScircumflex","015Dscircumflex","015EScedilla","015Fscedilla","0160Scaron","0161scaron","0162Tcommaaccent","0163tcommaaccent","0164Tcaron","0165tcaron","0166Tbar","0167tbar","0168Utilde","0169utilde","016AUmacron","016Bumacron","016CUbreve","016Dubreve","016EUring","016Furing","0170Uhungarumlaut","0171uhungarumlaut","0172Uogonek","0173uogonek","0174Wcircumflex","0175wcircumflex","0176Ycircumflex","0177ycircumflex","0178Ydieresis","0179Zacute","017Azacute","017BZdotaccent","017Czdotaccent","017DZcaron","017Ezcaron","017Flongs","0180bstroke","0181Bhook","0182Btopbar","0183btopbar","0184Tonesix","0185tonesix","0186Oopen","0187Chook","0188chook","0189Dafrican","018ADhook","018BDtopbar","018Cdtopbar","018Ddeltaturned","018EEreversed","018FSchwa","0190Eopen","0191Fhook","0192florin","0193Ghook","0194Gammaafrican","0195hv","0196Iotaafrican","0197Istroke","0198Khook","0199khook","019Albar","019Blambdastroke","019CMturned","019DNhookleft","019Enlegrightlong","019FOcenteredtilde","01A0Ohorn","01A1ohorn","01A2Oi","01A3oi","01A4Phook","01A5phook","01A6yr","01A7Tonetwo","01A8tonetwo","01A9Esh","01AAeshreversedloop","01ABtpalatalhook","01ACThook","01ADthook","01AETretroflexhook","01AFUhorn","01B0uhorn","01B1Upsilonafrican","01B2Vhook","01B3Yhook","01B4yhook","01B5Zstroke","01B6zstroke","01B7Ezh","01B8Ezhreversed","01B9ezhreversed","01BAezhtail","01BBtwostroke","01BCTonefive","01BDtonefive","01BEglottalinvertedstroke","01BFwynn","01C0clickdental","01C1clicklateral","01C2clickalveolar","01C3clickretroflex","01C4DZcaron","01C5Dzcaron","01C6dzcaron","01C7LJ","01C8Lj","01C9lj","01CANJ","01CBNj","01CCnj","01CDAcaron","01CEacaron","01CFIcaron","01D0icaron","01D1Ocaron","01D2ocaron","01D3Ucaron","01D4ucaron","01F0jcaron","01F1DZ","01F2Dz","01F3dz","01F4Gacute","01F5gacute","01FAAringacute","01FBaringacute","01FCAEacute","01FDaeacute","01FEOslashacute","01FFoslashacute","0254oopen","0255ccurl","0256dtail","0257dhook","0258ereversed","0259schwa","025Aschwahook","025Beopen","025Fjdotlessstroke","0260ghook","0261gscript","0264ramshorn","0265hturned","0266hhook","0267henghook","0268istroke","0269iotalatin","026Clbelt","026Elezh","026Fmturned","0271mhook","0272nhookleft","0275obarred","0278philatin","0279rturned","027Brhookturned","027Crlongleg","027Drhook","027Erfishhook","0282shook","0283esh","0286eshcurl","0287tturned","0289ubar","028Bvhook","028Cvturned","028Dwturned","028Eyturned","0290zretroflexhook","0291zcurl","0292ezh","0293ezhcurl","0294glottalstop","02A3dzaltone","02A4dezh","02A5dzcurl","02A6ts","02A7tesh","02A8tccurl","02D6plusmod","02D7minusmod","02D8breve","02D9dotaccent","02DAring","02DBogonek","02DCtilde","0391Alpha","0392Beta","0393Gamma","0394Deltagreek","0395Epsilon","0396Zeta","0397Eta","0398Theta","0399Iota","039AKappa","039BLambda","039CMu","039DNu","039EXi","039FOmicron","03A0Pi","03A1Rho","03A3Sigma","03A4Tau","03A5Upsilon","03A6Phi","03A7Chi","03A8Psi","03A9Omegagreek","03AAIotadieresis","03ABUpsilondieresis","03ACalphatonos","03ADepsilontonos","03AEetatonos","03AFiotatonos","03B0upsilondieresistonos","03B1alpha","03B2beta","03B3gamma","03B4delta","03B5epsilon","03B6zeta","03B7eta","03B8theta","03B9iota","03BAkappa","03BBlambda","03BCmu","03BDnu","03BExi","03BFomicron","03C0pi","03C1rho","03C2sigma1","03C3sigma","03C4tau","03C5upsilon","03C6phi","03C7chi","03C8psi","03C9omega","03CAiotadieresis","03CBupsilondieresis","03CComicrontonos","03CDupsilontonos","03CEomegatonos","03D0betasymbolgreek","03D1theta1","03D2Upsilon1","03D5phi1","03D6omega1","03DAStigmagreek","03DCDigammagreek","03DEKoppagreek","03E0Sampigreek","03E2Sheicoptic","03E3sheicoptic","03E4Feicoptic","03E5feicoptic","03E6Kheicoptic","03E7kheicoptic","03E8Horicoptic","03E9horicoptic","03EAGangiacoptic","03EBgangiacoptic","03ECShimacoptic","03EDshimacoptic","03EEDeicoptic","03EFdeicoptic","03F0kappasymbolgreek","03F1rhosymbolgreek","03F3yotgreek","0401afii10023","0402afii10051","0403afii10052","0404afii10053","0405afii10054","0406afii10055","0407afii10056","0408afii10057","0409afii10058","040Aafii10059","040Bafii10060","040Cafii10061","040Eafii10062","040Fafii10145","0410afii10017","0411afii10018","0412afii10019","0413afii10020","0414afii10021","0415afii10022","0416afii10024","0417afii10025","0418afii10026","0419afii10027","041Aafii10028","041Bafii10029","041Cafii10030","041Dafii10031","041Eafii10032","041Fafii10033","0420afii10034","0421afii10035","0422afii10036","0423afii10037","0424afii10038","0425afii10039","0426afii10040","0427afii10041","0428afii10042","0429afii10043","042Aafii10044","042Bafii10045","042Cafii10046","042Dafii10047","042Eafii10048","042Fafii10049","0430afii10065","0431afii10066","0432afii10067","0433afii10068","0434afii10069","0435afii10070","0436afii10072","0437afii10073","0438afii10074","0439afii10075","043Aafii10076","043Bafii10077","043Cafii10078","043Dafii10079","043Eafii10080","043Fafii10081","0440afii10082","0441afii10083","0442afii10084","0443afii10085","0444afii10086","0445afii10087","0446afii10088","0447afii10089","0448afii10090","0449afii10091","044Aafii10092","044Bafii10093","044Cafii10094","044Dafii10095","044Eafii10096","044Fafii10097","0451afii10071","0452afii10099","0453afii10100","0454afii10101","0455afii10102","0456afii10103","0457afii10104","0458afii10105","0459afii10106","045Aafii10107","045Bafii10108","045Cafii10109","045Eafii10110","045Fafii10193","0462afii10146","0463afii10194","0472afii10147","0473afii10195","0474afii10148","0475afii10196","0490afii10050","0491afii10098","04D9afii10846","060Cafii57388","061Bafii57403","061Fafii57407","0621afii57409","0622afii57410","0623afii57411","0624afii57412","0625afii57413","0626afii57414","0627afii57415","0628afii57416","0629afii57417","062Aafii57418","062Bafii57419","062Cafii57420","062Dafii57421","062Eafii57422","062Fafii57423","0630afii57424","0631afii57425","0632afii57426","0633afii57427","0634afii57428","0635afii57429","0636afii57430","0637afii57431","0638afii57432","0639afii57433","063Aafii57434","0640afii57440","0641afii57441","0642afii57442","0643afii57443","0644afii57444","0645afii57445","0646afii57446","0647afii57470","0648afii57448","0649afii57449","064Aafii57450","064Bafii57451","064Cafii57452","064Dafii57453","064Eafii57454","064Fafii57455","0650afii57456","0651afii57457","0652afii57458","0660afii57392","0661afii57393","0662afii57394","0663afii57395","0664afii57396","0665afii57397","0666afii57398","0667afii57399","0668afii57400","0669afii57401","066Aafii57381","066Bdecimalseparatorarabic","066Cthousandsseparatorarabic","066Dafii63167","0679afii57511","067Eafii57506","0686afii57507","0688afii57512","0691afii57513","0698afii57508","06A4afii57505","06AFafii57509","06BAafii57514","06C1hehaltonearabic","06D1yehthreedotsbelowarabic","06D2afii57519","06D5afii57534","06F0zeropersian","06F1onepersian","06F2twopersian","06F3threepersian","06F4fourpersian","06F5fivepersian","06F6sixpersian","06F7sevenpersian","06F8eightpersian","06F9ninepersian","1E00Aringbelow","1E01aringbelow","1E02Bdotaccent","1E03bdotaccent","1E04Bdotbelow","1E05bdotbelow","1E06Blinebelow","1E07blinebelow","1E08Ccedillaacute","1E09ccedillaacute","1E0ADdotaccent","1E0Bddotaccent","1E0CDdotbelow","1E0Dddotbelow","1E0EDlinebelow","1E0Fdlinebelow","1E10Dcedilla","1E11dcedilla","1E12Dcircumflexbelow","1E13dcircumflexbelow","1E14Emacrongrave","1E15emacrongrave","1E16Emacronacute","1E17emacronacute","1E18Ecircumflexbelow","1E19ecircumflexbelow","1E1AEtildebelow","1E1Betildebelow","1E1CEcedillabreve","1E1Decedillabreve","1E1EFdotaccent","1E1Ffdotaccent","1E20Gmacron","1E21gmacron","1E22Hdotaccent","1E23hdotaccent","1E24Hdotbelow","1E25hdotbelow","1E26Hdieresis","1E27hdieresis","1E28Hcedilla","1E29hcedilla","1E2AHbrevebelow","1E2Bhbrevebelow","1E2CItildebelow","1E2Ditildebelow","1E2EIdieresisacute","1E2Fidieresisacute","1E30Kacute","1E31kacute","1E32Kdotbelow","1E33kdotbelow","1E34Klinebelow","1E35klinebelow","1E36Ldotbelow","1E37ldotbelow","1E38Ldotbelowmacron","1E39ldotbelowmacron","1E3ALlinebelow","1E3Bllinebelow","1E3CLcircumflexbelow","1E3Dlcircumflexbelow","1E3EMacute","1E3Fmacute","1E40Mdotaccent","1E41mdotaccent","1E42Mdotbelow","1E43mdotbelow","1E44Ndotaccent","1E45ndotaccent","1E46Ndotbelow","1E47ndotbelow","1E48Nlinebelow","1E49nlinebelow","1E4ANcircumflexbelow","1E4Bncircumflexbelow","1E4COtildeacute","1E4Dotildeacute","1E4EOtildedieresis","1E4Fotildedieresis","1E50Omacrongrave","1E51omacrongrave","1E52Omacronacute","1E53omacronacute","1E54Pacute","1E55pacute","1E56Pdotaccent","1E57pdotaccent","1E58Rdotaccent","1E59rdotaccent","1E5ARdotbelow","1E5Brdotbelow","1E5CRdotbelowmacron","1E5Drdotbelowmacron","1E5ERlinebelow","1E5Frlinebelow","1E60Sdotaccent","1E61sdotaccent","1E62Sdotbelow","1E63sdotbelow","1E64Sacutedotaccent","1E65sacutedotaccent","1E66Scarondotaccent","1E67scarondotaccent","1E68Sdotbelowdotaccent","1E69sdotbelowdotaccent","1E6ATdotaccent","1E6Btdotaccent","1E6CTdotbelow","1E6Dtdotbelow","1E6ETlinebelow","1E6Ftlinebelow","1E70Tcircumflexbelow","1E71tcircumflexbelow","1E72Udieresisbelow","1E73udieresisbelow","1E74Utildebelow","1E75utildebelow","1E76Ucircumflexbelow","1E77ucircumflexbelow","1E78Utildeacute","1E79utildeacute","1E7AUmacrondieresis","1E7Bumacrondieresis","1E7CVtilde","1E7Dvtilde","1E7EVdotbelow","1E7Fvdotbelow","1E80Wgrave","1E81wgrave","1E82Wacute","1E83wacute","1E84Wdieresis","1E85wdieresis","1E86Wdotaccent","1E87wdotaccent","1E88Wdotbelow","1E89wdotbelow","1E8AXdotaccent","1E8Bxdotaccent","1E8CXdieresis","1E8Dxdieresis","1E8EYdotaccent","1E8Fydotaccent","1E90Zcircumflex","1E91zcircumflex","1E92Zdotbelow","1E93zdotbelow","1E94Zlinebelow","1E95zlinebelow","1E96hlinebelow","1E97tdieresis","1E98wring","1E99yring","1E9Aarighthalfring","1E9Bslongdotaccent","1EA0Adotbelow","1EA1adotbelow","1EA2Ahookabove","1EA3ahookabove","1EA4Acircumflexacute","1EA5acircumflexacute","1EA6Acircumflexgrave","1EA7acircumflexgrave","1EA8Acircumflexhookabove","1EA9acircumflexhookabove","1EAAAcircumflextilde","1EABacircumflextilde","1EACAcircumflexdotbelow","1EADacircumflexdotbelow","1EAEAbreveacute","1EAFabreveacute","1EB0Abrevegrave","1EB1abrevegrave","1EB2Abrevehookabove","1EB3abrevehookabove","1EB4Abrevetilde","1EB5abrevetilde","1EB6Abrevedotbelow","1EB7abrevedotbelow","1EB8Edotbelow","1EB9edotbelow","1EBAEhookabove","1EBBehookabove","1EBCEtilde","1EBDetilde","1EBEEcircumflexacute","1EBFecircumflexacute","1EC0Ecircumflexgrave","1EC1ecircumflexgrave","1EC2Ecircumflexhookabove","1EC3ecircumflexhookabove","1EC4Ecircumflextilde","1EC5ecircumflextilde","1EC6Ecircumflexdotbelow","1EC7ecircumflexdotbelow","1EC8Ihookabove","1EC9ihookabove","1ECAIdotbelow","1ECBidotbelow","1ECCOdotbelow","1ECDodotbelow","1ECEOhookabove","1ECFohookabove","1ED0Ocircumflexacute","1ED1ocircumflexacute","1ED2Ocircumflexgrave","1ED3ocircumflexgrave","1ED4Ocircumflexhookabove","1ED5ocircumflexhookabove","1ED6Ocircumflextilde","1ED7ocircumflextilde","1ED8Ocircumflexdotbelow","1ED9ocircumflexdotbelow","1EDAOhornacute","1EDBohornacute","1EDCOhorngrave","1EDDohorngrave","1EDEOhornhookabove","1EDFohornhookabove","1EE0Ohorntilde","1EE1ohorntilde","1EE2Ohorndotbelow","1EE3ohorndotbelow","1EE4Udotbelow","1EE5udotbelow","1EE6Uhookabove","1EE7uhookabove","1EE8Uhornacute","1EE9uhornacute","1EEAUhorngrave","1EEBuhorngrave","1EECUhornhookabove","1EEDuhornhookabove","1EEEUhorntilde","1EEFuhorntilde","1EF0Uhorndotbelow","1EF1uhorndotbelow","1EF2Ygrave","1EF3ygrave","1EF4Ydotbelow","1EF5ydotbelow","1EF6Yhookabove","1EF7yhookabove","1EF8Ytilde","1EF9ytilde","2002enspace","200Bzerowidthspace","200Cafii61664","200Dafii301","200Eafii299","200Fafii300","2010hyphentwo","2012figuredash","2013endash","2014emdash","2015afii00208","2016dblverticalbar","2017underscoredbl","2018quoteleft","2019quoteright","201Aquotesinglbase","201Bquotereversed","201Cquotedblleft","201Dquotedblright","201Equotedblbase","2020dagger","2021daggerdbl","2022bullet","2024onedotenleader","2025twodotenleader","2026ellipsis","202Cafii61573","202Dafii61574","202Eafii61575","2030perthousand","2032minute","2033second","2035primereversed","2039guilsinglleft","203Aguilsinglright","203Breferencemark","203Cexclamdbl","203Eoverline","2042asterism","2044fraction","2070zerosuperior","2074foursuperior","2075fivesuperior","2076sixsuperior","2077sevensuperior","2078eightsuperior","2079ninesuperior","207Aplussuperior","207Cequalsuperior","207Dparenleftsuperior","207Eparenrightsuperior","207Fnsuperior","2080zeroinferior","2081oneinferior","2082twoinferior","2083threeinferior","2084fourinferior","2085fiveinferior","2086sixinferior","2087seveninferior","2088eightinferior","2089nineinferior","208Dparenleftinferior","208Eparenrightinferior","20A1colonmonetary","20A2cruzeiro","20A3franc","20A4afii08941","20A7peseta","20A9won","20AAafii57636","20ABdong","20ACEuro","2103centigrade","2105afii61248","2109fahrenheit","2111Ifraktur","2113afii61289","2116afii61352","2118weierstrass","211CRfraktur","211Eprescription","2121telephone","2122trademark","2126Omega","212Bangstrom","212Eestimated","2135aleph","2153onethird","2154twothirds","215Boneeighth","215Cthreeeighths","215Dfiveeighths","215Eseveneighths","2160Oneroman","2161Tworoman","2162Threeroman","2163Fourroman","2164Fiveroman","2165Sixroman","2166Sevenroman","2167Eightroman","2168Nineroman","2169Tenroman","216AElevenroman","216BTwelveroman","2170oneroman","2171tworoman","2172threeroman","2173fourroman","2174fiveroman","2175sixroman","2176sevenroman","2177eightroman","2178nineroman","2179tenroman","217Aelevenroman","217Btwelveroman","2200universal","2202partialdiff","2203existential","2205emptyset","2206Delta","2207gradient","2208element","2209notelement","220Bsuchthat","220Cnotcontains","220Fproduct","2211summation","2212minus","2213minusplus","2215divisionslash","2217asteriskmath","2219bulletoperator","221Aradical","221Dproportional","221Einfinity","221Forthogonal","2220angle","2223divides","2225parallel","2226notparallel","2227logicaland","2228logicalor","2229intersection","222Aunion","222Bintegral","222Cdblintegral","222Econtourintegral","2234therefore","2235because","2236ratio","2237proportion","223Csimilar","223Dreversedtilde","2243asymptoticallyequal","2245congruent","2248approxequal","224Callequal","2250approaches","2251geometricallyequal","2252approxequalorimage","2253imageorapproximatelyequal","2260notequal","2261equivalence","2262notidentical","2264lessequal","2265greaterequal","2266lessoverequal","2267greateroverequal","226Amuchless","226Bmuchgreater","226Enotless","226Fnotgreater","2270notlessnorequal","2271notgreaternorequal","2272lessorequivalent","2273greaterorequivalent","2276lessorgreater","2277greaterorless","2279notgreaternorless","227Aprecedes","227Bsucceeds","2280notprecedes","2281notsucceeds","2282propersubset","2283propersuperset","2284notsubset","2285notsuperset","2286reflexsubset","2287reflexsuperset","228Asubsetnotequal","228Bsupersetnotequal","2295circleplus","2296minuscircle","2297circlemultiply","2299circleot","22A3tackleft","22A4tackdown","22A5perpendicular","22BFrighttriangle","22C5dotmath","22CEcurlyor","22CFcurlyand","22DAlessequalorgreater","22DBgreaterequalorless","22EEellipsisvertical","F6BEdotlessj","F6BFLL","F6C0ll","F6C3commaaccent","F6C4afii10063","F6C5afii10064","F6C6afii10192","F6C7afii10831","F6C8afii10832","F6C9Acute","F6CACaron","F6CBDieresis","F6CCDieresisAcute","F6CDDieresisGrave","F6CEGrave","F6CFHungarumlaut","F6D0Macron","F6D1cyrBreve","F6D2cyrFlex","F6D3dblGrave","F6D4cyrbreve","F6D5cyrflex","F6D6dblgrave","F6D7dieresisacute","F6D8dieresisgrave","F6D9copyrightserif","F6DAregisterserif","F6DBtrademarkserif","F6DConefitted","F6DDrupiah","F8FFapple","FB00ff","FB01fi","FB02fl","FB03ffi","FB04ffl","FE61asterisksmall","FE62plussmall","FE63hyphensmall","FE64lesssmall","FE65greatersmall","FE66equalsmall","FE69dollarsmall","FE6Apercentsmall","FE6Batsmall"];this._standardFontCharsNames=[];for(let t=0;t<e.length;t++){var i=parseInt(e[t].substr(0,4),16);this._standardFontCharsNames[i]=e[t].substr(4)}}return this._standardFontCharsNames}}Wi.sRGBprofile=[0,0,12,72,76,105,110,111,2,16,0,0,109,110,116,114,82,71,66,32,88,89,90,32,7,206,0,2,0,9,0,6,0,49,0,0,97,99,115,112,77,83,70,84,0,0,0,0,73,69,67,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,246,214,0,1,0,0,0,0,211,45,72,80,32,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,99,112,114,116,0,0,1,80,0,0,0,51,100,101,115,99,0,0,1,132,0,0,0,108,119,116,112,116,0,0,1,240,0,0,0,20,98,107,112,116,0,0,2,4,0,0,0,20,114,88,89,90,0,0,2,24,0,0,0,20,103,88,89,90,0,0,2,44,0,0,0,20,98,88,89,90,0,0,2,64,0,0,0,20,100,109,110,100,0,0,2,84,0,0,0,112,100,109,100,100,0,0,2,196,0,0,0,136,118,117,101,100,0,0,3,76,0,0,0,134,118,105,101,119,0,0,3,212,0,0,0,36,108,117,109,105,0,0,3,248,0,0,0,20,109,101,97,115,0,0,4,12,0,0,0,36,116,101,99,104,0,0,4,48,0,0,0,12,114,84,82,67,0,0,4,60,0,0,8,12,103,84,82,67,0,0,4,60,0,0,8,12,98,84,82,67,0,0,4,60,0,0,8,12,116,101,120,116,0,0,0,0,67,111,112,121,114,105,103,104,116,32,40,99,41,32,49,57,57,56,32,72,101,119,108,101,116,116,45,80,97,99,107,97,114,100,32,67,111,109,112,97,110,121,0,0,100,101,115,99,0,0,0,0,0,0,0,18,115,82,71,66,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,18,115,82,71,66,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,88,89,90,32,0,0,0,0,0,0,243,81,0,1,0,0,0,1,22,204,88,89,90,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,88,89,90,32,0,0,0,0,0,0,111,162,0,0,56,245,0,0,3,144,88,89,90,32,0,0,0,0,0,0,98,153,0,0,183,133,0,0,24,218,88,89,90,32,0,0,0,0,0,0,36,160,0,0,15,132,0,0,182,207,100,101,115,99,0,0,0,0,0,0,0,22,73,69,67,32,104,116,116,112,58,47,47,119,119,119,46,105,101,99,46,99,104,0,0,0,0,0,0,0,0,0,0,0,22,73,69,67,32,104,116,116,112,58,47,47,119,119,119,46,105,101,99,46,99,104,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,101,115,99,0,0,0,0,0,0,0,46,73,69,67,32,54,49,57,54,54,45,50,46,49,32,68,101,102,97,117,108,116,32,82,71,66,32,99,111,108,111,117,114,32,115,112,97,99,101,32,45,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,46,73,69,67,32,54,49,57,54,54,45,50,46,49,32,68,101,102,97,117,108,116,32,82,71,66,32,99,111,108,111,117,114,32,115,112,97,99,101,32,45,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,101,115,99,0,0,0,0,0,0,0,44,82,101,102,101,114,101,110,99,101,32,86,105,101,119,105,110,103,32,67,111,110,100,105,116,105,111,110,32,105,110,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,44,82,101,102,101,114,101,110,99,101,32,86,105,101,119,105,110,103,32,67,111,110,100,105,116,105,111,110,32,105,110,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,118,105,101,119,0,0,0,0,0,19,164,254,0,20,95,46,0,16,207,20,0,3,237,204,0,4,19,11,0,3,92,158,0,0,0,1,88,89,90,32,0,0,0,0,0,76,9,86,0,80,0,0,0,87,31,231,109,101,97,115,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,143,0,0,0,2,115,105,103,32,0,0,0,0,67,82,84,32,99,117,114,118,0,0,0,0,0,0,4,0,0,0,0,5,0,10,0,15,0,20,0,25,0,30,0,35,0,40,0,45,0,50,0,55,0,59,0,64,0,69,0,74,0,79,0,84,0,89,0,94,0,99,0,104,0,109,0,114,0,119,0,124,0,129,0,134,0,139,0,144,0,149,0,154,0,159,0,164,0,169,0,174,0,178,0,183,0,188,0,193,0,198,0,203,0,208,0,213,0,219,0,224,0,229,0,235,0,240,0,246,0,251,1,1,1,7,1,13,1,19,1,25,1,31,1,37,1,43,1,50,1,56,1,62,1,69,1,76,1,82,1,89,1,96,1,103,1,110,1,117,1,124,1,131,1,139,1,146,1,154,1,161,1,169,1,177,1,185,1,193,1,201,1,209,1,217,1,225,1,233,1,242,1,250,2,3,2,12,2,20,2,29,2,38,2,47,2,56,2,65,2,75,2,84,2,93,2,103,2,113,2,122,2,132,2,142,2,152,2,162,2,172,2,182,2,193,2,203,2,213,2,224,2,235,2,245,3,0,3,11,3,22,3,33,3,45,3,56,3,67,3,79,3,90,3,102,3,114,3,126,3,138,3,150,3,162,3,174,3,186,3,199,3,211,3,224,3,236,3,249,4,6,4,19,4,32,4,45,4,59,4,72,4,85,4,99,4,113,4,126,4,140,4,154,4,168,4,182,4,196,4,211,4,225,4,240,4,254,5,13,5,28,5,43,5,58,5,73,5,88,5,103,5,119,5,134,5,150,5,166,5,181,5,197,5,213,5,229,5,246,6,6,6,22,6,39,6,55,6,72,6,89,6,106,6,123,6,140,6,157,6,175,6,192,6,209,6,227,6,245,7,7,7,25,7,43,7,61,7,79,7,97,7,116,7,134,7,153,7,172,7,191,7,210,7,229,7,248,8,11,8,31,8,50,8,70,8,90,8,110,8,130,8,150,8,170,8,190,8,210,8,231,8,251,9,16,9,37,9,58,9,79,9,100,9,121,9,143,9,164,9,186,9,207,9,229,9,251,10,17,10,39,10,61,10,84,10,106,10,129,10,152,10,174,10,197,10,220,10,243,11,11,11,34,11,57,11,81,11,105,11,128,11,152,11,176,11,200,11,225,11,249,12,18,12,42,12,67,12,92,12,117,12,142,12,167,12,192,12,217,12,243,13,13,13,38,13,64,13,90,13,116,13,142,13,169,13,195,13,222,13,248,14,19,14,46,14,73,14,100,14,127,14,155,14,182,14,210,14,238,15,9,15,37,15,65,15,94,15,122,15,150,15,179,15,207,15,236,16,9,16,38,16,67,16,97,16,126,16,155,16,185,16,215,16,245,17,19,17,49,17,79,17,109,17,140,17,170,17,201,17,232,18,7,18,38,18,69,18,100,18,132,18,163,18,195,18,227,19,3,19,35,19,67,19,99,19,131,19,164,19,197,19,229,20,6,20,39,20,73,20,106,20,139,20,173,20,206,20,240,21,18,21,52,21,86,21,120,21,155,21,189,21,224,22,3,22,38,22,73,22,108,22,143,22,178,22,214,22,250,23,29,23,65,23,101,23,137,23,174,23,210,23,247,24,27,24,64,24,101,24,138,24,175,24,213,24,250,25,32,25,69,25,107,25,145,25,183,25,221,26,4,26,42,26,81,26,119,26,158,26,197,26,236,27,20,27,59,27,99,27,138,27,178,27,218,28,2,28,42,28,82,28,123,28,163,28,204,28,245,29,30,29,71,29,112,29,153,29,195,29,236,30,22,30,64,30,106,30,148,30,190,30,233,31,19,31,62,31,105,31,148,31,191,31,234,32,21,32,65,32,108,32,152,32,196,32,240,33,28,33,72,33,117,33,161,33,206,33,251,34,39,34,85,34,130,34,175,34,221,35,10,35,56,35,102,35,148,35,194,35,240,36,31,36,77,36,124,36,171,36,218,37,9,37,56,37,104,37,151,37,199,37,247,38,39,38,87,38,135,38,183,38,232,39,24,39,73,39,122,39,171,39,220,40,13,40,63,40,113,40,162,40,212,41,6,41,56,41,107,41,157,41,208,42,2,42,53,42,104,42,155,42,207,43,2,43,54,43,105,43,157,43,209,44,5,44,57,44,110,44,162,44,215,45,12,45,65,45,118,45,171,45,225,46,22,46,76,46,130,46,183,46,238,47,36,47,90,47,145,47,199,47,254,48,53,48,108,48,164,48,219,49,18,49,74,49,130,49,186,49,242,50,42,50,99,50,155,50,212,51,13,51,70,51,127,51,184,51,241,52,43,52,101,52,158,52,216,53,19,53,77,53,135,53,194,53,253,54,55,54,114,54,174,54,233,55,36,55,96,55,156,55,215,56,20,56,80,56,140,56,200,57,5,57,66,57,127,57,188,57,249,58,54,58,116,58,178,58,239,59,45,59,107,59,170,59,232,60,39,60,101,60,164,60,227,61,34,61,97,61,161,61,224,62,32,62,96,62,160,62,224,63,33,63,97,63,162,63,226,64,35,64,100,64,166,64,231,65,41,65,106,65,172,65,238,66,48,66,114,66,181,66,247,67,58,67,125,67,192,68,3,68,71,68,138,68,206,69,18,69,85,69,154,69,222,70,34,70,103,70,171,70,240,71,53,71,123,71,192,72,5,72,75,72,145,72,215,73,29,73,99,73,169,73,240,74,55,74,125,74,196,75,12,75,83,75,154,75,226,76,42,76,114,76,186,77,2,77,74,77,147,77,220,78,37,78,110,78,183,79,0,79,73,79,147,79,221,80,39,80,113,80,187,81,6,81,80,81,155,81,230,82,49,82,124,82,199,83,19,83,95,83,170,83,246,84,66,84,143,84,219,85,40,85,117,85,194,86,15,86,92,86,169,86,247,87,68,87,146,87,224,88,47,88,125,88,203,89,26,89,105,89,184,90,7,90,86,90,166,90,245,91,69,91,149,91,229,92,53,92,134,92,214,93,39,93,120,93,201,94,26,94,108,94,189,95,15,95,97,95,179,96,5,96,87,96,170,96,252,97,79,97,162,97,245,98,73,98,156,98,240,99,67,99,151,99,235,100,64,100,148,100,233,101,61,101,146,101,231,102,61,102,146,102,232,103,61,103,147,103,233,104,63,104,150,104,236,105,67,105,154,105,241,106,72,106,159,106,247,107,79,107,167,107,255,108,87,108,175,109,8,109,96,109,185,110,18,110,107,110,196,111,30,111,120,111,209,112,43,112,134,112,224,113,58,113,149,113,240,114,75,114,166,115,1,115,93,115,184,116,20,116,112,116,204,117,40,117,133,117,225,118,62,118,155,118,248,119,86,119,179,120,17,120,110,120,204,121,42,121,137,121,231,122,70,122,165,123,4,123,99,123,194,124,33,124,129,124,225,125,65,125,161,126,1,126,98,126,194,127,35,127,132,127,229,128,71,128,168,129,10,129,107,129,205,130,48,130,146,130,244,131,87,131,186,132,29,132,128,132,227,133,71,133,171,134,14,134,114,134,215,135,59,135,159,136,4,136,105,136,206,137,51,137,153,137,254,138,100,138,202,139,48,139,150,139,252,140,99,140,202,141,49,141,152,141,255,142,102,142,206,143,54,143,158,144,6,144,110,144,214,145,63,145,168,146,17,146,122,146,227,147,77,147,182,148,32,148,138,148,244,149,95,149,201,150,52,150,159,151,10,151,117,151,224,152,76,152,184,153,36,153,144,153,252,154,104,154,213,155,66,155,175,156,28,156,137,156,247,157,100,157,210,158,64,158,174,159,29,159,139,159,250,160,105,160,216,161,71,161,182,162,38,162,150,163,6,163,118,163,230,164,86,164,199,165,56,165,169,166,26,166,139,166,253,167,110,167,224,168,82,168,196,169,55,169,169,170,28,170,143,171,2,171,117,171,233,172,92,172,208,173,68,173,184,174,45,174,161,175,22,175,139,176,0,176,117,176,234,177,96,177,214,178,75,178,194,179,56,179,174,180,37,180,156,181,19,181,138,182,1,182,121,182,240,183,104,183,224,184,89,184,209,185,74,185,194,186,59,186,181,187,46,187,167,188,33,188,155,189,21,189,143,190,10,190,132,190,255,191,122,191,245,192,112,192,236,193,103,193,227,194,95,194,219,195,88,195,212,196,81,196,206,197,75,197,200,198,70,198,195,199,65,199,191,200,61,200,188,201,58,201,185,202,56,202,183,203,54,203,182,204,53,204,181,205,53,205,181,206,54,206,182,207,55,207,184,208,57,208,186,209,60,209,190,210,63,210,193,211,68,211,198,212,73,212,203,213,78,213,209,214,85,214,216,215,92,215,224,216,100,216,232,217,108,217,241,218,118,218,251,219,128,220,5,220,138,221,16,221,150,222,28,222,162,223,41,223,175,224,54,224,189,225,68,225,204,226,83,226,219,227,99,227,235,228,115,228,252,229,132,230,13,230,150,231,31,231,169,232,50,232,188,233,70,233,208,234,91,234,229,235,112,235,251,236,134,237,17,237,156,238,40,238,180,239,64,239,204,240,88,240,229,241,114,241,255,242,140,243,25,243,167,244,52,244,194,245,80,245,222,246,109,246,251,247,138,248,25,248,168,249,56,249,199,250,87,250,231,251,119,252,7,252,152,253,41,253,186,254,75,254,220,255,109,255,255],Wi.hatchData=["000000FF00000000","1010101010101010","8040201008040201","0102040810204080","101010FF10101010","8142241818244281","8000000008000000","0010000100100001","2200880022008800","2288228822882288","2255885522558855","AA558A55AA55A855","AA55AA55AA55AA55","BB55EE55BB55EE55","DD77DD77DD77DD77","FFDDFF77FFDDFF77","FF7FFFF7FF7FFFF7","FF7FFFFFFFF7FFFF","8844221188442211","1122448811224488","CC663399CC663399","993366CC993366CC","E070381C0E0783C1","C183070E1C3870E0","4040404040404040","00FF000000FF0000","AAAAAAAAAAAAAAAA","FF00FF00FF00FF00","CCCCCCCCCCCCCCCC","FFFF0000FFFF0000","8844221100000000","1122448800000000","F00000000F000000","8080808008080808","0240088004200110","0C8DB130031BD8C0","8403304884033048","00304A8100304A81","0102040818244281","202020FF020202FF","1422518854224588","F0F0F0F0AA55AA55","0100201020000102","AA00800080008000","0020008800020088","8448300C02010103","33FFCCFF33FFCCFF","98F8F877898F8F77","111111FF111111FF","3333CCCC3333CCCC","0F0F0F0FF0F0F0F0","0502058850205088","10387CFE7C381000","0000000000000000"],Wi.standardFontWidths=null,Wi.standardFontInfo=null,Wi._standardFontCharsNames=null,at.c.StiPdfResources=Wi}{class l{constructor(t){this.ownerValue=[],this.userValue=[],this.ownerExtendedValue=[],this.userExtendedValue=[],this.permsValue=[],this.IDValue=null,this.encryptionKey=null,this.encryptionKeyLength=0,this.passwordOwner="",this.passwordUser="",this.securityFlags=0,this.keyLength=at.c.StiPdfEncryptionKeyLength.Bit40,this.pdfService=null,this.pdfService=t}padPassword(t){let e=[],i=0;for(;i<t.length;i++)e[i]=t.charCodeAt(i);for(let t=0;t<l.paddingString.length;t++)e[i++]=l.paddingString[t];let r=[];for(i=0;i<32;i++)r[i]=e[i];return r}computingCryptoValues(t,e,i,r,n){this.securityFlags=4294967232;let a=0,s=(0!=(t&at.c.StiUserAccessPrivileges.PrintDocument)&&(a|=1<<2),0!=(t&at.c.StiUserAccessPrivileges.ModifyContents)&&(a|=1<<3),0!=(t&at.c.StiUserAccessPrivileges.CopyTextAndGraphics)&&(a|=1<<4),0!=(t&at.c.StiUserAccessPrivileges.AddOrModifyTextAnnotations)&&(a|=1<<5),this.securityFlags|=a,null==i&&(i=""),this.passwordOwner=e=null==e?"":e,this.passwordUser=i,this.keyLength=r,this.IDValue=n,!1);var o;return(0<this.passwordOwner.length||0<this.passwordUser.length||t!=at.c.StiUserAccessPrivileges.All)&&(s=!0,this.computingCryptoValues2()||(s=!1,this.throwEncryptionError(0,"Encryption not work!"))),s}computingCryptoValues2(){if(this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit128_r4)return this.computingCryptoValuesV4();if(this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit256_r6)return this.computingCryptoValuesV5();let t=this.passwordOwner;pt.isNullOrEmpty(this.passwordOwner)&&(t=this.passwordUser);var e=this.padPassword(t);let r=this.computeHashMD5(e);if(this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit128)for(let t=0;t<50;t++)r=this.computeHashMD5(r);if(this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit40){let t=[];t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],r=t}let i=this.padPassword(this.passwordUser);if(i=this.rc4(i,r),this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit128)for(let e=1;e<=19;e++){for(let t=0;t<16;t++)r[t]^=e-1,r[t]^=e;i=this.rc4(i,r)}i.stimulsoft().copyTo(this.ownerValue,0);var e=this.passwordUser,e=this.padPassword(e),n=this.getBytesUInt32(this.securityFlags);let a=[];if(a.stimulsoft().addRange(e),a.stimulsoft().addRange(i),a.stimulsoft().addRange(n),a.stimulsoft().addRange(this.IDValue),r=this.computeHashMD5(a),this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit128)for(let t=0;t<50;t++)r=this.computeHashMD5(r);this.encryptionKey=[],this.encryptionKeyLength=this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit128?16:5;for(let t=0;t<this.encryptionKeyLength;t++)this.encryptionKey[t]=r[t];let s=[];if(this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit128){(a=[]).stimulsoft().addRange(l.paddingString),a.stimulsoft().addRange(this.IDValue),r=this.computeHashMD5(a),r=this.rc4(r,this.encryptionKey);let i=[];for(let e=1;e<=19;e++){for(let t=0;t<16;t++)i[t]=this.encryptionKey[t]^e;r=this.rc4(r,i)}l.paddingString.stimulsoft().copyTo(s,0),r.stimulsoft().copyTo(s,0)}else l.paddingString.stimulsoft().copyTo(s,0),s=this.rc4(s,this.encryptionKey);return s.stimulsoft().copyTo(this.userValue,0),!0}computingCryptoValuesV4(){let t=this.passwordOwner;pt.isNullOrEmpty(this.passwordOwner)&&(t=this.passwordUser);var e=this.padPassword(t);let i=this.computeHashMD5(e);for(let t=0;t<50;t++)i=this.computeHashMD5(i);let r=this.padPassword(this.passwordUser);r=this.rc4(r,i);for(let e=1;e<=19;e++){for(let t=0;t<16;t++)i[t]^=e-1,i[t]^=e;r=this.rc4(r,i)}r.stimulsoft().copyTo(this.ownerValue,0);var e=this.passwordUser,e=this.padPassword(e),n=this.getBytesUInt32(this.securityFlags);let a=[];a.stimulsoft().addRange(e),a.stimulsoft().addRange(r),a.stimulsoft().addRange(n),a.stimulsoft().addRange(this.IDValue),i=this.computeHashMD5(a);for(let t=0;t<50;t++)i=this.computeHashMD5(i);this.encryptionKey=[],this.encryptionKeyLength=16;for(let t=0;t<this.encryptionKeyLength;t++)this.encryptionKey[t]=i[t];let s=[],o=((a=[]).stimulsoft().addRange(l.paddingString),a.stimulsoft().addRange(this.IDValue),i=this.computeHashMD5(a),i=this.rc4(i,this.encryptionKey),[]);for(let e=1;e<=19;e++){for(let t=0;t<16;t++)o[t]=this.encryptionKey[t]^e;i=this.rc4(i,o)}return l.paddingString.stimulsoft().copyTo(s,0),i.stimulsoft().copyTo(s,0),s.stimulsoft().copyTo(this.userValue,0),!0}computingCryptoValuesV5(){let t=new rt.System.Crypt.SecureRandom,e=null,i=null;var r=t.createNextBytes(32),n,n;let a=t.createNextBytes(8),s=t.createNextBytes(8),o=t.createNextBytes(8),l=t.createNextBytes(8),m=rt.System.Text.Encoding.UTF8.getBytes(this.passwordUser),c=(127<m.length&&(n=[],mt.copy2(m,0,n,0,127),m=n),(i=this.getHashV5(m,a,null)).stimulsoft().copyTo(this.userValue,0),a.stimulsoft().copyTo(this.userValue,32),s.stimulsoft().copyTo(this.userValue,40),i=this.getHashV5(m,s,null),this.encodeKeyDataV5(i,r,!0).stimulsoft().copyTo(this.userExtendedValue,0),this.passwordOwner),g=(pt.isNullOrEmpty(this.passwordOwner)&&(c=this.passwordUser),rt.System.Text.Encoding.UTF8.getBytes(c));return 127<g.length&&(n=[],mt.copy2(g,0,n,0,127),g=n),(i=this.getHashV5(g,o,this.userValue)).stimulsoft().copyTo(this.ownerValue,0),o.stimulsoft().copyTo(this.ownerValue,32),l.stimulsoft().copyTo(this.ownerValue,40),i=this.getHashV5(g,l,this.userValue),this.encodeKeyDataV5(i,r,!0).stimulsoft().copyTo(this.ownerExtendedValue,0),e=t.createNextBytes(16),this.getBytesUInt32(this.securityFlags).stimulsoft().copyTo(e,0),e[4]=255,e[5]=255,e[6]=255,e[7]=255,e[8]=84,e[9]=97,e[10]=100,e[11]=98,this.permsValue=this.encodeKeyDataV5(r,e,!1),i=this.getHashV5(m,s,null),this.encryptionKey=this.decodeKeyDataV5(i,this.userExtendedValue,!0),97==(e=this.decodeKeyDataV5(this.encryptionKey,this.permsValue,!1))[9]&&100==e[10]&&98==e[11]||this.throwEncryptionError(102,"Verifying key calculation failed"),!0}encodeKeyDataV5(e,i,t){let r=null;if(t){var n;let t=new rt.ExternalLibrary.aesjs.ModeOfOperation.cbc(e,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);r=t.encrypt(i)}else{let t=new rt.ExternalLibrary.aesjs.ModeOfOperation.ecb(e);r=t.encrypt(i)}let a=[];for(let t=0;t<r.length;t++)a[t]=r[t];return a}decodeKeyDataV5(e,i,t){let r=null;if(t){var n;let t=new rt.ExternalLibrary.aesjs.ModeOfOperation.cbc(e,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);r=t.decrypt(i)}else{let t=new rt.ExternalLibrary.aesjs.ModeOfOperation.ecb(e);r=t.decrypt(i)}let a=[];for(let t=0;t<r.length;t++)a[t]=r[t];return a}getHashV5(t,e,i){return this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit256_r5?l.calculate_hash_r5(t,e,i):l.calculate_hash_r6(t,e,i)}static calculate_hash_r5(t,e,i){let r=[];return r.stimulsoft().addRange(t),r.stimulsoft().addRange(e),null!=i&&r.stimulsoft().addRange(i),rt.System.Crypt.SHA2.SHA256(r)}static calculate_hash_r6(i,t,r){let n=[];var a=[];let s=32,o=0,l=null;var m=[],c=[];let g=new rt.System.Crypt.SHA2;(l=[]).stimulsoft().addRange(i),l.stimulsoft().addRange(t),null!=r&&l.stimulsoft().addRange(r),g.SHA2_256(l).stimulsoft().copyTo(a,0);for(let t=0;t<64||t<n[64*o-1]+32;t++){l.stimulsoft().clear(),l.stimulsoft().addRange(i);for(let t=0;t<s;t++)l.push(a[t]);o=i.length+s,null!=r&&(l.stimulsoft().addRange(r),o+=48);for(let t=0;t<64;t++)l.stimulsoft().copyTo(n,t*o);mt.copy2(a,0,m,0,16),mt.copy2(a,16,c,0,16);let t=new rt.ExternalLibrary.aesjs.ModeOfOperation.cbc(m,c);var h=t.encrypt(n.slice(0,64*o));for(let t=0;t<h.length;t++)n[t]=h[t];let e=0;for(let t=0;t<16;t++)e+=n[t];switch(s=32+e%3*16){case 32:g.SHA2_256(n.slice(0,64*o)).stimulsoft().copyTo(a,0);break;case 48:g.SHA2_384(n.slice(0,64*o)).stimulsoft().copyTo(a,0);break;case 64:g.SHA2_512(n.slice(0,64*o)).stimulsoft().copyTo(a,0);break}}var t=[];return mt.copy2(a,0,t,0,32),t}encryptData(r,n,a){if(this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit40||this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit128){var s=n,o=a,l=[];this.encryptionKey.stimulsoft().copyTo(l,0),this.getBytesUInt32(s).stimulsoft().copyTo(l,this.encryptionKeyLength),this.getBytesUint16(o).stimulsoft().copyTo(l,this.encryptionKeyLength+3);let t=this.computeHashMD5(l);this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit40&&(t=t.slice(0,10)),r=this.rc4(r,t)}else if(this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit128_r4){var s=n,o=a;let t=[];this.encryptionKey.stimulsoft().copyTo(t,0),this.getBytesUInt32(s).stimulsoft().copyTo(t,16),this.getBytesUint16(o).stimulsoft().copyTo(t,19),t[21]=115,t[22]=65,t[23]=108,t[24]=84;var l=this.computeHashMD5(t),n=(new rt.System.Crypt.SecureRandom).createNextBytes(16);let e=[],i=(e.stimulsoft().addRange(n),e.stimulsoft().addRange(r),e=new rt.ExternalLibrary.aesjs.padding.pkcs7.pad(e),new rt.ExternalLibrary.aesjs.ModeOfOperation.cbc(l,n));r=i.encrypt(e)}else{var a=(new rt.System.Crypt.SecureRandom).createNextBytes(16);let t=[],e=(t.stimulsoft().addRange(a),t.stimulsoft().addRange(r),t=new rt.ExternalLibrary.aesjs.padding.pkcs7.pad(t),new rt.ExternalLibrary.aesjs.ModeOfOperation.cbc(this.encryptionKey,a));r=e.encrypt(t)}return r}throwEncryptionError(t,e){throw new Error(pt.format("EncryptionError at step {0} : {1}",t,e))}renderEncodeRecord(r){let t="",e="",i=32,n=(this.keyLength!=at.c.StiPdfEncryptionKeyLength.Bit256_r5&&this.keyLength!=at.c.StiPdfEncryptionKeyLength.Bit256_r6||(i=48),0);for(n=0;n<i;n++)t+=String.fromCharCode(this.ownerValue[n]),e+=String.fromCharCode(this.userValue[n]);if(r.writeLine("/Filter /Standard"),this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit128)r.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/V2/Length 16>>>>"),r.writeLine("/StmF /StdCF"),r.writeLine("/StrF /StdCF"),r.writeLine("/R 3"),r.writeLine("/V 2"),r.writeLine("/Length 128");else if(this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit128_r4)r.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/AESV2/Length 16>>>>"),r.writeLine("/StmF /StdCF"),r.writeLine("/StrF /StdCF"),r.writeLine("/R 4"),r.writeLine("/V 4"),r.writeLine("/Length 128");else if(this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit256_r6){r.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/AESV3/Length 32>>>>"),r.writeLine("/StmF /StdCF"),r.writeLine("/StrF /StdCF"),r.writeLine1("/R {0}",this.keyLength==at.c.StiPdfEncryptionKeyLength.Bit256_r5?5:6),r.writeLine("/V 5"),r.writeLine("/Length 256");let t="",e="";for(n=0;n<32;n++)t+=String.fromCharCode(this.ownerExtendedValue[n]),e+=String.fromCharCode(this.userExtendedValue[n]);let i="";for(n=0;n<16;n++)i+=String.fromCharCode(this.permsValue[n]);r.writeString(pt.format("/OE ({0})",at.c.StiPdfExportService.convertToEscapeSequencePlusTabs(t)),!0),r.writeString(pt.format("/UE ({0})",at.c.StiPdfExportService.convertToEscapeSequencePlusTabs(e)),!0),r.writeString(pt.format("/Perms ({0})",at.c.StiPdfExportService.convertToEscapeSequencePlusTabs(i)),!0)}else r.writeLine("/R 2"),r.writeLine("/V 1"),r.writeLine("/Length 40");r.writeString(pt.format("/O ({0})",at.c.StiPdfExportService.convertToEscapeSequencePlusTabs(t)),!0),r.writeString(pt.format("/U ({0})",at.c.StiPdfExportService.convertToEscapeSequencePlusTabs(e)),!0),r.writeLine1("/P {0}",this.securityFlags)}getBytesUInt32(t){let e=[];return e.push(255&t),e.push(t>>8&255),e.push(t>>16&255),e.push(t>>24&255),e}getBytesUint16(t){let e=[];return e.push(255&t),e.push(t>>8&255),e}rc4(e,t){let i=[],r=0,n=0,a,s=[];var o=t.length,l=e.length;for(r=0;r<256;r++)i[r]=r;for(r=0;r<256;r++)n=(n+i[r]+t[r%o])%256,a=i[r],i[r]=i[n],i[n]=a;r=0;for(let t=n=0;t<l;t++)r=(r+1)%256,n=(n+i[r])%256,a=i[r],i[r]=i[n],i[n]=a,s.push(e[t]^i[(i[r]+i[n])%256]);return s}computeHashMD5(e){let i="";for(let t=0;t<e.length;t++)i+=String.fromCharCode(e[t]);return rt.Base.StiMD5Helper.MD5(i,!1)}}l.paddingString=[40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122],at.c.StiPdfSecurity=l}{class i{constructor(){this.ref=-1,this.info=null}get isUsed(){return!(-1==this.ref)}addRef(){this.info.addRef(this)}toString(){if(-1==this.ref)return"-";return pt.format("ref = {0}",this.ref)}}at.c.StiPdfObjInfo=i;class Xi extends i{}at.c.StiPdfContentObjInfo=Xi;class zi extends i{}at.c.StiPdfXObjectObjInfo=zi;class Vi extends i{}at.c.StiPdfFontObjInfo=Vi;class Gi extends i{}at.c.StiPdfOutlinesObjInfo=Gi;class Yi extends i{}at.c.StiPdfPatternsObjInfo=Yi;class ji extends i{}at.c.StiPdfAnnotObjInfo=ji;class _i{}at.c.StiPdfCheckBoxObjInfo=_i;class qi extends i{}at.c.StiPdfAcroFormObjInfo=qi,at.c.StiPdfStructure=class{constructor(){this.objectsCounter=0,this.objects=null,this.objectsCounter=0,this.objects=[],this.root=this.createObject(!0),this.info=this.createObject(!0),this.colorSpace=this.createObject(!0),this.pages=this.createObject(!0),this.structTreeRoot=this.createObject(!0),this.optionalContentGroup=this.createObject(!0),this.pageList=[],this.xObjectList=[],this.fontList=[],this.linkList=[],this.embeddedFilesList=[]}addRef(t){this.objectsCounter++,t.ref=this.objectsCounter}createObject(t=!1){let e=new i;return e.info=this,t&&this.addRef(e),e}createContentObject(t=!1){let e=new Xi;return e.info=this,t&&this.addRef(e),e.content=this.createObject(t),e}createXObject(t=!1,e=!1){let i=new zi;return i.info=this,t&&this.addRef(i),i.mask=this.createObject(t&&e),i}createFontObject(t=!1,e=!0,i=!1,r=!0,n=!1){let a=new Vi;return a.info=this,t&&this.addRef(a),a.descendantFont=this.createObject(t&&e),a.toUnicode=this.createObject(t&&e),a.cIDSet=this.createObject(t&&e),a.encoding=this.createObject(t&&!e&&!n),a.fontDescriptor=this.createObject(t&&!i),a.fontFile2=this.createObject(t&&r),a}createOutlinesObject(t=!1){let e=new Gi;return e.info=this,t&&this.addRef(e),e.items=[],e}createPatternsObject(t=!1){let e=new Yi;return e.info=this,e.resources=this.createObject(t),e.first=this.createObject(t),e.hatchItems=[],e.shadingItems=[],e.shadingFunctionItems=[],e}createAcroFormObject(t=!1){let e=new qi;return e.info=this,t&&this.addRef(e),e.annots=[],e.checkBoxes=[],e.unsignedSignatures=[],e.signatures=[],e.tooltips=[],e.annotFontItems=[],e}createAnnotObject(e=!1,t=!1,i=0){let r=new ji;r.info=this,e&&this.addRef(r),r.aP=this.createObject(e&&t),r.aA=[];for(let t=0;t<i;t++)r.aA.push(this.createObject(e));return r}}}{class Ki{static run(t,e){if(void 0===t)return void Ki.run(rt,"Stimulsoft");for(var i in e=e.stimulsoft().replaceAll("Stimulsoft.System","System"),t)"function"==typeof t[i]?(t[i].ssTypeName=i,t[i].ssNamespace=e):"object"==typeof t[i]&&Ki.run(t[i],e+"."+i)}}at.b.StiTypesHelper=Ki}return at.b.StiTypesHelper.run(),{Stimulsoft:rt}});